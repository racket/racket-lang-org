((3) 0 () 131 ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2011-05-26-racket-on-floss-weekly.md" . unix) (p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2011-04-30-racket-v511.md" . unix) (p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2016-02-08-racket-web-server-security-vulnerability.md" . unix) (p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2016-02-08-racket-v64.md" . unix) (p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2010-01-02-scheme-videos-lectures-and-talks.md" . unix) (p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2009-12-07-futures-fine-grained-parallelism-in-plt.md" . unix) (p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2007-12-29-plt-scheme-v372.md" . unix) (p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2009-01-21-plt-scheme-v414.md" . unix) (p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2009-01-29-cfp-scheme-workshop-2009.md" . unix) (p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2011-06-29-come-to-racketcon.md" . unix) (p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2011-05-26-multi-file-code-coverage-viewing-tool.md" . unix) (p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2011-07-29-racketcon-recap.md" . unix) (p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2008-10-06-web-application-development-in-plt-scheme.md" . unix) (p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2015-06-19-racket-v62.md" . unix) (p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2015-08-10-racket-v621.md" . unix) (p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2008-01-14-a-privacy-flaw-thwarted.md" . unix) (p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2007-12-29-the-design-of-extended-exercises.md" . unix) (p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2011-02-14-racket-v51.md" . unix) (p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2011-04-04-writing-syntax-case-macros.md" . unix) (p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2015-05-03-king-of-the-hill-on-rosetta-code.md" . unix) (p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2011-11-09-racket-v52.md" . unix) (p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2016-04-28-racket-v65.md" . unix) (p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2008-06-22-plt-scheme-v401.md" . unix) (p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2008-06-12-plt-scheme-v40.md" . unix) (p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2007-11-12-getting-rid-of-set-car-and-set-cdr.md" . unix) (p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2007-12-19-your-security-hole-is-my-fun-hack-or-computing-factorial-in-drscheme-with-a-click-powered-loop.md" . unix) (p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2009-02-14-new-contract-related-features.md" . unix) (p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2009-05-18-soft-state-in-the-plt-web-server.md" . unix) (p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2009-05-18-the-two-state-solution-native-and-serializable-continuations-in-the-plt-web-server.md" . unix) (p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2015-08-11-modules-packages-and-collections.md" . unix) (p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2012-08-25-dynamic-programming-versus-memoization.md" . unix) (p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2012-11-15-drracket-now-more-responsive.md" . unix) (p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2012-11-07-racket-v531.md" . unix) (p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2012-11-23-roman-numerals-in-racket-sources.md" . unix) (p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2010-03-08-talk-at-flourish.md" . unix) (p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2010-04-02-plt-scheme-v425.md" . unix) (p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2012-02-02-racket-v521.md" . unix) (p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2015-11-23-racket-v63.md" . unix) (p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2015-10-30-retiring-unstable.md" . unix) (p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2007-09-14-dont-say-abstract-instead-say-general.md" . unix) (p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2008-02-23-dirty-looking-hygiene.md" . unix) (p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2008-06-06-the-tour-in-video.md" . unix) (p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2007-07-27-callcc-and-self-modifying-code.md" . unix) (p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2007-06-14-small-is-beautiful-large-is-useful-and-scheme-is-both.md" . unix) (p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2012-02-01-zack-gallers-experience-with-stateful-vs-stateless-web-apps.md" . unix) (p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2012-03-26-fixed-racket-v521-installers.md" . unix) (p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2010-12-08-rebuilding-rackets-graphics-layer.md" . unix) (p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2011-03-19-languages-as-libraries-pldi-2011.md" . unix) (p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2011-10-18-on-eval-in-dynamic-languages-generally-and-in-racket-specifically.md" . unix) (p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2010-08-03-racket-v501.md" . unix) (p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2010-06-07-racket.md" . unix) (p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2010-09-15-extending-typed-racket-part-1.md" . unix) (p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2008-08-12-plt-scheme-v41.md" . unix) (p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2008-10-05-plt-scheme-v411.md" . unix) (p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2008-06-03-plt-scheme-version-40-is-coming-soon.md" . unix) (p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2009-05-18-scheme-workshop-deadline-not-extended.md" . unix) (p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2009-03-29-the-drscheme-repl-isnt-the-one-in-emacs.md" . unix) (p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2009-03-22-plt-scheme-v415.md" . unix) (p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2009-05-06-what-is-sendsuspend.md" . unix) (p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2014-05-08-racket-v601.md" . unix) (p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2007-06-09-r6rs-is-perfect.md" . unix) (p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2009-02-18-steering-scheme.md" . unix) (p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2007-07-30-control-resumed.md" . unix) (p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2010-01-28-plt-scheme-v424.md" . unix) (p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2007-08-06-macros-and-hygiene-resumed.md" . unix) (p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2007-08-07-plt-modules-and-separate-compilation.md" . unix) (p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2008-07-29-search-in-drscheme.md" . unix) (p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2008-07-04-plt-scheme-v402.md" . unix) (p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2009-03-12-maintaining-self-references-in-planet-packages.md" . unix) (p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2009-02-24-call-for-participation-writing-typed-scheme-wrapper-modules.md" . unix) (p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2013-03-25-200.md" . unix) (p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2009-07-30-plt-scheme-v421.md" . unix) (p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2009-06-23-serializable-closures-in-plt-scheme.md" . unix) (p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2009-06-01-plt-scheme-v42.md" . unix) (p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2013-05-08-racket-v534.md" . unix) (p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2009-05-25-typed-scheme-20.md" . unix) (p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2009-05-24-explicit-renaming-macros-implicitly.md" . unix) (p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2013-06-18-racket-v535.md" . unix) (p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2013-05-29-marketplace-a-language-for-network-aware-programming.md" . unix) (p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2014-12-10-the-racket-package-system-and-planet.md" . unix) (p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2014-11-23-800.md" . unix) (p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2015-04-20-scheme-workshop-2015.md" . unix) (p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2013-01-31-racket-v532.md" . unix) (p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2012-12-22-simple-test-coverage-a-macro-with-line-numbers-and-lifting.md" . unix) (p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2013-02-15-racket-v533.md" . unix) (p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2014-02-26-racket-v60.md" . unix) (p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2013-12-17-typed-racket-and-classes.md" . unix) (p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2014-03-12-the-new-racket-home-page.md" . unix) (p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2014-08-02-racket-v61.md" . unix) (p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2014-11-04-racket-v611.md" . unix) (p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2007-08-02-relationally-parametric-polymorphic-contracts.md" . unix) (p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2007-08-03-control-and-macros.md" . unix) (p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2013-08-10-racket-v536.md" . unix) (p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2013-07-31-racketcon-2013-signup.md" . unix) (p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2012-04-02-scribble-your-blogs.md" . unix) (p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2012-06-03-submodules.md" . unix) (p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2012-08-07-racket-v53.md" . unix) (p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2013-05-08-racketcon-2013.md" . unix) (p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2009-09-21-set-vs-set-box-and-unbox.md" . unix) (p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2014-07-26-scheme-workshop-2014.md" . unix) (p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2014-10-07-plt-redex-summer-school-call-for-participation.md" . unix) (p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2007-05-10-adjusting-drschemes-keybindings.md" . unix) (p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2007-05-10-xml-transformation-in-scheme.md" . unix) (p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2015-09-22-racket-package-server-security-vulnerabilities.md" . unix) (p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2007-08-22-new-debugger-features.md" . unix) (p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2007-08-18-plt-scheme-v371.md" . unix) (p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2007-09-03-birthday-easter-eggs-in-drscheme.md" . unix) (p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2010-11-07-racket-v502.md" . unix) (p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2010-10-03-the-two-state-solution-native-and-serializable-continuations-accord.md" . unix) (p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2008-11-24-simple-gnuplotting.md" . unix) (p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2008-11-21-plt-scheme-v413.md" . unix) (p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2011-08-16-racket-v513.md" . unix) (p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2011-08-03-racket-v512.md" . unix) (p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2012-11-01-generics.md" . unix) (p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2007-08-03-experience-report-scheme-in-commercial-web-application-development.md" . unix) (p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2012-08-24-fully-inlined-merge-sort.md" . unix) (p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2012-08-29-racketcon-2012.md" . unix) (p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2008-10-28-plt-scheme-v412.md" . unix) (p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2010-02-28-dags-vs-trees.md" . unix) (p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2010-01-29-benchmarks.md" . unix) (p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2014-04-24-registration-for-fourth-racketcon.md" . unix) (p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2007-05-16-looking-for-small-scheme-scripts.md" . unix) (p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2007-05-22-plt-scheme-version-370.md" . unix) (p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2009-12-01-plt-scheme-v423.md" . unix) (p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2009-10-04-plt-scheme-v422.md" . unix) (p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2007-09-06-how-many-occurrences-of-car-in-the-plt-source-code.md" . unix) (p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2007-09-09-completions-in-drscheme-finally.md" . unix) (p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2012-11-25-tutorial-contributing-to-racket.md" . unix) (p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2012-10-24-the-3n1-problem.md" . unix) (p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2012-09-28-i-write-funny-lookin-racket-code-an-alternate-style-for-delimiters-and-indentation.md" . unix) (p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2007-05-03-macros-matter.md" . unix)) () (h ! (equal) ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2009-12-07-futures-fine-grained-parallelism-in-plt.md" . unix) f post (u . "Futures: Fine Grained Parallelism in PLT") (? . 5) 1467223812 (p+ #"/Users/MB/git/racket-lang-org/blog/2009/12/futures-fine-grained-parallelism-in-plt.html" . unix) "/2009/12/futures-fine-grained-parallelism-in-plt.html" (u . "2009-12-07T13:18:00.002-05:00") (? . 123) (? . 4) (c (u . "")) (u . "\n<p><em>posted by Robby Findler</em></p>\n\n<p>We&rsquo;re pleased to announce the initial release of parallel futures, a construct for fine-grained parallelism in PLT. Roughly speaking, a programmer passes a thunk to &lsquo;future&rsquo; and it gets run in parallel. That &ldquo;roughly&rdquo; holds a few gotchas, partly because we&rsquo;re just getting started and partly due to the technique we&rsquo;re using. See the documentation for more details:</p>\n\n<p><a href=\"http://pre.plt-scheme.org/docs/html/futures/\">http://pre.plt-scheme.org/docs/html/futures/</a></p>\n\n<p>If you&rsquo;ve got a multicore machine where you can&rsquo;t keep the cores busy or your office/machine room is a bit cold, try this program:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"kn\">#lang </span><span class=\"nn\">scheme</span>\n<span class=\"p\">(</span><span class=\"k\">require</span> <span class=\"n\">scheme/future</span><span class=\"p\">)</span>\n<span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">loop</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"n\">loop</span><span class=\"p\">))</span>\n<span class=\"p\">(</span><span class=\"nb\">for-each</span>\n <span class=\"nb\">touch</span>\n <span class=\"p\">(</span><span class=\"k\">for/list</span> <span class=\"p\">([</span><span class=\"n\">i</span> <span class=\"p\">(</span><span class=\"nb\">in-range</span> <span class=\"mi\">0</span> <span class=\"p\">(</span><span class=\"nb\">processor-count</span><span class=\"p\">))])</span>\n  <span class=\"p\">(</span><span class=\"nb\">future</span> <span class=\"n\">loop</span><span class=\"p\">)))</span>\n</pre></div>\n\n</div>\n\n<p>Note that you have to build mzscheme with futures; it isn&rsquo;t enabled by default, but see the docs above for how to do that. Beyond the above, we&rsquo;ve also gotten a few parallel kernels going and are seeing good scalability up to 8 cores (the biggest machine we have around for the time being).</p>") #t (u . "\n<p><em>posted by Robby Findler</em></p>\n\n<p>We&rsquo;re pleased to announce the initial release of parallel futures, a construct for fine-grained parallelism in PLT. Roughly speaking, a programmer passes a thunk to &lsquo;future&rsquo; and it gets run in parallel. That &ldquo;roughly&rdquo; holds a few gotchas, partly because we&rsquo;re just getting started and partly due to the technique we&rsquo;re using. See the documentation for more details:</p>\n\n<p><a href=\"http://pre.plt-scheme.org/docs/html/futures/\">http://pre.plt-scheme.org/docs/html/futures/</a></p>\n\n<p>If you&rsquo;ve got a multicore machine where you can&rsquo;t keep the cores busy or your office/machine room is a bit cold, try this program:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"kn\">#lang </span><span class=\"nn\">scheme</span>\n<span class=\"p\">(</span><span class=\"k\">require</span> <span class=\"n\">scheme/future</span><span class=\"p\">)</span>\n<span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">loop</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"n\">loop</span><span class=\"p\">))</span>\n<span class=\"p\">(</span><span class=\"nb\">for-each</span>\n <span class=\"nb\">touch</span>\n <span class=\"p\">(</span><span class=\"k\">for/list</span> <span class=\"p\">([</span><span class=\"n\">i</span> <span class=\"p\">(</span><span class=\"nb\">in-range</span> <span class=\"mi\">0</span> <span class=\"p\">(</span><span class=\"nb\">processor-count</span><span class=\"p\">))])</span>\n  <span class=\"p\">(</span><span class=\"nb\">future</span> <span class=\"n\">loop</span><span class=\"p\">)))</span>\n</pre></div>\n\n</div>\n\n<p>Note that you have to build mzscheme with futures; it isn&rsquo;t enabled by default, but see the docs above for how to do that. Beyond the above, we&rsquo;ve also gotten a few parallel kernels going and are seeing good scalability up to 8 cores (the biggest machine we have around for the time being).</p>\n<!-- more-->\n\n<hr />\n\n<p>Why is the touch explicit?</p>\n\n<p>Why don&rsquo;t you use future-strict primitives to force future values?</p>\n\n<p>— <em>matthias, 7 December 2009</em></p>\n\n<hr />\n\n<p>One could build another layer on top of this one to do things like that (and perhaps we should not have taken over the names &lsquo;future&rsquo; and &lsquo;touch&rsquo; and let a library like that have them).</p>\n\n<p>touch is explicit so that the runtime system primitives that depend on a particular context are well-defined (eg, exception handlers and continuation marks).</p>\n\n<p>— <em>Robby, 7 December 2009</em></p>\n\n<hr />\n\n<p>Will never versions have it enabled by default for the OSX package?</p>\n\n<p>— <em>Robert, 7 December 2009</em></p>\n\n<hr />\n\n<p>Eventually, yes. But it is easy to build under mac os x. Just make sure you have the developer tool installed and then it is only a few simple commands in a Terminal window.</p>\n\n<p>— <em>Robby, 7 December 2009</em></p>\n\n<hr />\n\n<p>Does that &ldquo;mess up&rdquo; anything with the packaged installation?</p>\n\n<p>— <em>Robert, 7 December 2009</em></p>\n\n<hr />\n\n<p>No. You can have as many versions as you want, completely separate. (Double clicking in the finder will always choose one of the open drschemes; I haven&rsquo;t figured out what the OS does when none of them are open.)</p>\n\n<p>— <em>Robby, 7 December 2009</em></p>\n\n<hr />\n\n<p>It seems to me that delay/thread in scheme/promise has an analogous existing interface to a later forced-touched promise-future. Outside the very important and appreciated implementation difference of having multiple CPUs, where does the analogy fall short enough to require a different set of functions?</p>\n\n<p>— <em>griffinish, 20 December 2009</em></p>\n\n<hr />\n\n<p>Well, parallelism is an important difference, of course (enough that warrants its own, separate api so programmers know what they are getting), but another difference is that with promises the computation won&rsquo;t get &ldquo;frozen&rdquo; in the way that futures can get frozen.</p>\n\n<p>— <em>Robby, 20 December 2009</em></p>\n\n<hr />")) ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2014-04-24-registration-for-fourth-racketcon.md" . unix) f post (u . "Registration for (fourth RacketCon)") (? . 120) 1467223812 (p+ #"/Users/MB/git/racket-lang-org/blog/2014/04/registration-for-fourth-racketcon.html" . unix) "/2014/04/registration-for-fourth-racketcon.html" (u . "2014-04-24T14:50:00.001-04:00") (? . 87) (? . 59) (c (u . "")) (u . "\n<p><em>posted by Asumu Takikawa</em></p>\n\n<p>Registration for (fourth RacketCon) is now open. Tickets are 30$.</p>\n\n<p><a href=\"https://www.eventbrite.com/e/racketcon-2014-tickets-11408046775\">https://www.eventbrite.com/e/racketcon&ndash;2014-tickets&ndash;11408046775</a></p>\n\n<p>(fourth RacketCon) will be held on September 20th, and will be co-located with <a href=\"https://thestrangeloop.com/\">Strange Loop</a> in St. Louis.</p>\n\n<p>RacketCon is a yearly event where members of the Racket community get together, featuring talks and demos about the things you do with Racket.</p>\n\n<p>To get you excited, here&rsquo;s a sneak peek at the roster of speakers so far:</p>\n\n<ul>\n <li>\n  <p>Michael Fogus (keynote)</p></li>\n <li>\n  <p>Matthew Butterick</p></li>\n <li>\n  <p>Matthew Flatt</p></li>\n <li>\n  <p>Jay McCarthy</p></li>\n <li>\n  <p>Daniel Prager</p></li>\n <li>\n  <p>Neil Toronto</p></li></ul>\n\n<p>We still have room for more speakers. If you&rsquo;ve built something cool with Racket, we want to hear about it!</p>\n\n<p>Hope to see you there!</p>\n\n<p>Vincent, for the Racket team</p>") #f (u . "\n<p><em>posted by Asumu Takikawa</em></p>\n\n<p>Registration for (fourth RacketCon) is now open. Tickets are 30$.</p>\n\n<p><a href=\"https://www.eventbrite.com/e/racketcon-2014-tickets-11408046775\">https://www.eventbrite.com/e/racketcon&ndash;2014-tickets&ndash;11408046775</a></p>\n\n<p>(fourth RacketCon) will be held on September 20th, and will be co-located with <a href=\"https://thestrangeloop.com/\">Strange Loop</a> in St. Louis.</p>\n\n<p>RacketCon is a yearly event where members of the Racket community get together, featuring talks and demos about the things you do with Racket.</p>\n\n<p>To get you excited, here&rsquo;s a sneak peek at the roster of speakers so far:</p>\n\n<ul>\n <li>\n  <p>Michael Fogus (keynote)</p></li>\n <li>\n  <p>Matthew Butterick</p></li>\n <li>\n  <p>Matthew Flatt</p></li>\n <li>\n  <p>Jay McCarthy</p></li>\n <li>\n  <p>Daniel Prager</p></li>\n <li>\n  <p>Neil Toronto</p></li></ul>\n\n<p>We still have room for more speakers. If you&rsquo;ve built something cool with Racket, we want to hear about it!</p>\n\n<p>Hope to see you there!</p>\n\n<p>Vincent, for the Racket team</p>")) ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2016-02-08-racket-v64.md" . unix) f post (u . "Racket v6.4") (? . 3) 1467223812 (p+ #"/Users/MB/git/racket-lang-org/blog/2016/02/racket-v64.html" . unix) "/2016/02/racket-v64.html" (u . "2016-02-08T11:04:00.000-05:00") (? . 37) (? . 2) (c (u . "")) (u . "\n<p><em>posted by Ryan Culpepper</em></p>\n\n<p>Racket version 6.4 is now available from <a href=\"http://racket-lang.org/\">http://racket-lang.org/</a></p>\n\n<ul>\n <li>\n  <p>We fixed a security vulnerability in the web server. The existing web server is vulnerable to a navigation attack if it is also enabled to serve files statically; that is, any file readable by the web server is accessible remotely. For more information, see <a href=\"../../2016/02/racket-web-server-security-vulnerability.html\">this post</a>.</p></li>\n <li>\n  <p>DrRacket&rsquo;s scrolling is faster.</p></li>\n <li>\n  <p>Incremental garbage-collection mode can eliminate long pauses in a program. For example, incremental mode is useful for avoiding pauses in games and animations.</p></li></ul>\n\n<p>Programs must specifically request incremental mode with <code>(collect-garbage 'incremental)</code>, but libraries such as <code>2htdp/universe</code> include the request as part of the library&rsquo;s implementation.</p>\n\n<ul>\n <li>\n  <p>The default package catalog is an HTTPS address instead of HTTP, and package operations properly validate server certificates when using HTTPS.</p></li>\n <li>\n  <p>Documentation may define their own categories for the manual top-level page by using strings, rather than only symbols that name pre-defined categories.</p></li>\n <li>\n  <p>The Racket cheat sheet is included in the main distribution.</p></li>\n <li>\n  <p>DrRacket is available in Bulgarian, thanks to Alexander Shopov.</p></li>\n <li>\n  <p>The contract Typed Racket generates for the <code>Any</code> type is more permissive, allowing more typed/untyped programs to work without contract errors.</p></li>\n <li>\n  <p>Redex supports binding specifications; describe which variables bind in which expressions and your metafunctions and reduction relations automatically become scope-sensitive. Thanks to Paul Stansifer for this improvement.</p></li>\n <li>\n  <p>All <code>pict</code> functions accept <code>pict-convertible</code>s. This allows for transparent interoperability between <code>pict</code> and libraries like <code>2htdp/image</code>.</p></li>\n <li>\n  <p>The <code>raco profile</code> and <code>raco contract-profile</code> commands provide easy access to profiling tools, without requiring program modifications.</p></li></ul>\n\n<p>Feedback Welcome</p>") #t (u . "\n<p><em>posted by Ryan Culpepper</em></p>\n\n<p>Racket version 6.4 is now available from <a href=\"http://racket-lang.org/\">http://racket-lang.org/</a></p>\n\n<ul>\n <li>\n  <p>We fixed a security vulnerability in the web server. The existing web server is vulnerable to a navigation attack if it is also enabled to serve files statically; that is, any file readable by the web server is accessible remotely. For more information, see <a href=\"../../2016/02/racket-web-server-security-vulnerability.html\">this post</a>.</p></li>\n <li>\n  <p>DrRacket&rsquo;s scrolling is faster.</p></li>\n <li>\n  <p>Incremental garbage-collection mode can eliminate long pauses in a program. For example, incremental mode is useful for avoiding pauses in games and animations.</p></li></ul>\n\n<p>Programs must specifically request incremental mode with <code>(collect-garbage 'incremental)</code>, but libraries such as <code>2htdp/universe</code> include the request as part of the library&rsquo;s implementation.</p>\n\n<ul>\n <li>\n  <p>The default package catalog is an HTTPS address instead of HTTP, and package operations properly validate server certificates when using HTTPS.</p></li>\n <li>\n  <p>Documentation may define their own categories for the manual top-level page by using strings, rather than only symbols that name pre-defined categories.</p></li>\n <li>\n  <p>The Racket cheat sheet is included in the main distribution.</p></li>\n <li>\n  <p>DrRacket is available in Bulgarian, thanks to Alexander Shopov.</p></li>\n <li>\n  <p>The contract Typed Racket generates for the <code>Any</code> type is more permissive, allowing more typed/untyped programs to work without contract errors.</p></li>\n <li>\n  <p>Redex supports binding specifications; describe which variables bind in which expressions and your metafunctions and reduction relations automatically become scope-sensitive. Thanks to Paul Stansifer for this improvement.</p></li>\n <li>\n  <p>All <code>pict</code> functions accept <code>pict-convertible</code>s. This allows for transparent interoperability between <code>pict</code> and libraries like <code>2htdp/image</code>.</p></li>\n <li>\n  <p>The <code>raco profile</code> and <code>raco contract-profile</code> commands provide easy access to profiling tools, without requiring program modifications.</p></li></ul>\n\n<p>Feedback Welcome</p>\n<!-- more-->\n\n<hr />\n\n<p>Great work! and thank you.</p>\n\n<p>I was wondering why isn&rsquo;t incremental garbage collection the default option?</p>\n\n<p>— <em>Harikrishnan, 8 February 2016</em></p>\n\n<hr />\n\n<p>Incremental mode has shorter GC pauses, but it tends to use more memory and use more time overall. Those trade-offs are usually worthwhile for interactive programs, but not for batch programs.</p>\n\n<p>Given the trade-offs, non-incremental mode is a more transparent default. It&rsquo;s easy to tell when an interactive program suffers from pauses and needs to turn on incremental mode. It would be more difficult to notice that a batch program runs too slowly because incremental mode hasn&rsquo;t been disabled.</p>\n\n<p>(Incremental mode uses more memory because it moves objects to the old generation sooner, and because the old generation is not compacted. Incremental mode uses more time because extra steps are needed to pause and resume traversal of the old generation – and also because it uses more memory.)</p>\n\n<p>— <em>Matthew Flatt, 9 February 2016</em></p>\n\n<hr />")) ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2012-11-25-tutorial-contributing-to-racket.md" . unix) f post (u . "Tutorial: Contributing to Racket") (? . 127) 1467223812 (p+ #"/Users/MB/git/racket-lang-org/blog/2012/11/tutorial-contributing-to-racket.html" . unix) "/2012/11/tutorial-contributing-to-racket.html" (u . "2012-11-25T17:02:00.001-05:00") (? . 33) (? . 83) (c (u . "")) (u . "\n<p><em>posted by Joe Gibbs Politz</em></p>\n\n<p><em>Originally posted on <a href=\"http://jpolitz.github.com/blog/2012/11/21/racket-contributing-tutorial.html\">jpolitz.github.com</a>.</em></p>\n\n<p>I&rsquo;ve been a longtime user and sometimes fanboy of <a href=\"http://racket-lang.org/\">Racket</a>, but aside from a few bug reports, before this week I hadn&rsquo;t contributed anything back to the language. This week, I started using a little helper macro, which wasn&rsquo;t in the core utils, to make some of my testing easier. I mentioned it to the super-friendly Racket community, they told me they liked it, and my pull request was merged within about 12 hours.</p>\n\n<p>I&rsquo;ve been using Racket for a while, so I knew roughly where to lookto put my code, tests, and documentation. A newer user might not know,so this post outlines, in some detail, the steps I went through to puttogether a tiny feature extension for Racket.</p>\n\n<h2 id=\"a-tiny-feature\">A Tiny Feature</h2>\n\n<p>I&rsquo;m dabbling in the implementation of a <a href=\"http://github.com/brownplt/pyret-lang\">small scripting language called Pyret</a> to study features of scripting objects. The language has a parser, which generates AST nodes. The nodes keep track of their location in the original program for error reporting, unbound identifier reporting, and the like. I wanted to write some test cases for our</p>\n\n<p>parser, which generates things like:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"nb\">&gt;</span> <span class=\"p\">(</span><span class=\"n\">parse</span> <span class=\"s2\">\"o.x\"</span><span class=\"p\">)</span>\n<span class=\"p\">(</span><span class=\"n\">s-block</span> <span class=\"p\">(</span><span class=\"nb\">srcloc</span> <span class=\"s2\">\"parse-tests.rkt\"</span> <span class=\"mi\">1</span> <span class=\"mi\">0</span> <span class=\"no\">#f</span> <span class=\"no\">#f</span><span class=\"p\">)</span>\n         <span class=\"p\">(</span><span class=\"nb\">list</span> <span class=\"p\">(</span><span class=\"n\">s-dot</span>\n                <span class=\"p\">(</span><span class=\"nb\">srcloc</span> <span class=\"s2\">\"parse-tests.rkt\"</span> <span class=\"mi\">1</span> <span class=\"mi\">0</span> <span class=\"no\">#f</span> <span class=\"no\">#f</span><span class=\"p\">)</span>\n                <span class=\"p\">(</span><span class=\"n\">s-id</span> <span class=\"p\">(</span><span class=\"nb\">srcloc</span> <span class=\"s2\">\"parse-tests.rkt\"</span> <span class=\"mi\">1</span> <span class=\"mi\">0</span> <span class=\"no\">#f</span> <span class=\"no\">#f</span><span class=\"p\">)</span> <span class=\"o\">&#39;</span><span class=\"ss\">o</span><span class=\"p\">)</span>\n                <span class=\"o\">&#39;</span><span class=\"ss\">x</span><span class=\"p\">)))</span>\n</pre></div>\n\n</div>\n\n<p>A ton of detail is in the output keeping track of line number information. But I don&rsquo;t want to have to type out the line numbers and get them right for each test. I&rsquo;d like to write:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"n\">check-match</span> <span class=\"p\">(</span><span class=\"n\">parse</span> <span class=\"s2\">\"o.x\"</span><span class=\"p\">)</span>\n<span class=\"p\">(</span><span class=\"n\">s-block</span> <span class=\"k\">_</span> <span class=\"p\">(</span><span class=\"nb\">list</span> <span class=\"p\">(</span><span class=\"n\">s-dot</span> <span class=\"k\">_</span> <span class=\"p\">(</span><span class=\"n\">s-id</span> <span class=\"k\">_</span> <span class=\"o\">&#39;</span><span class=\"ss\">o</span><span class=\"p\">)</span> <span class=\"o\">&#39;</span><span class=\"ss\">x</span><span class=\"p\">))))</span>\n</pre></div>\n\n</div>\n\n<p>Which checks that all the things I care about for the parse are true: the program parses to a block of code, with a single statement, which is a dot expression of the identifier <code>o</code> and the symbol <code>x</code>. With a little help from <a href=\"http://www.jonahkagan.me/\">Jonah Kagan</a>, I produced a macro that does exactly that, and works nicely with <a href=\"http://docs.racket-lang.org/rackunit/api.html\">RackUnit</a>, Racket&rsquo;s unit-testing framework (<a href=\"https://github.com/brownplt/pyret-lang/blob/master/src/tests/parse-tests.rkt#L36\">see it in action</a>, with a slightly different name).</p>\n\n<p>I thought <code>check-match</code> was pretty useful, and figured I&rsquo;d see if the Racket folks at large would agree. I <a href=\"http://www.mail-archive.com/dev@racket-lang.org/msg07427.html\">wrote a message</a> to the Racket mailing list, figuring someone might think it was neat. There was some <a href=\"http://www.mail-archive.com/dev@racket-lang.org/msg07429.html\">immediate</a> <a href=\"http://www.mail-archive.com/dev@racket-lang.org/msg07430.html\">positive</a> <a href=\"http://www.mail-archive.com/dev@racket-lang.org/msg07428.html\">feedback</a>, so I decided to go ahead and try to add it.</p>\n\n<p>Getting and Extending Racket &mdash;</p>\n\n<p><a href=\"http://github.com/plt/racket\">Racket&rsquo;s repo</a> is hosted on Github. The easiest way to contribute is to <a href=\"https://help.github.com/articles/fork-a-repo\">fork it</a>, and then check out your own copy. The check-out and build process is fairly standard; you should, however, make a directory called <code>build/</code> to hold the binaries that will be created:</p>\n\n<div class=\"brush: bash\">\n <div class=\"pygments\">\n  <pre><span class=\"nv\">$ </span>git clone git://github.com/&lt;your-username&gt;/racket.git\n<span class=\"nv\">$ </span><span class=\"nb\">cd </span>racket/src\n<span class=\"nv\">$ </span>mkdir build\n<span class=\"nv\">$ </span><span class=\"nb\">cd </span>build\n<span class=\"nv\">$ </span>../configure\n<span class=\"nv\">$ </span>make\n<span class=\"nv\">$ </span>make install\n</pre></div>\n\n</div>\n\n<p>This takes about 20&ndash;30 minutes, and installs all the necessary Racket binaries locally in place (no <code>sudo</code> or anything needed).</p>\n\n<p>Next up was to find RackUnit and the code I&rsquo;d need to extend.</p>\n\n<p>Most of what goes on in Racket&rsquo;s core utilities happens in <em>collections</em>, found in the <code>collects/</code> directory of the base directory of the checkout. For my implementation, I&rsquo;d be looking at <code>collects/rackunit</code>.</p>\n\n<p>I want to implement a new kind of <code>check</code>, so let&rsquo;s find that in RackUnit. Here&rsquo;s what the RackUnit directory looks like:</p>\n\n<div class=\"brush: bash\">\n <div class=\"pygments\">\n  <pre><span class=\"nv\">$ </span>ls collects/rackunit/\ncompiled           gui.rkt   main.rkt  scribblings  tool.rkt\ndocs-complete.rkt  info.rkt  private   text-ui.rkt\n</pre></div>\n\n</div>\n\n<p>The <code>private/</code> directory contains most of the internals of the built-in collections&rsquo; behavior, so let&rsquo;s look at that:</p>\n\n<div class=\"brush: bash\">\n <div class=\"pygments\">\n  <pre><span class=\"nv\">$ </span>ls collects/rackunit/private/\nbase.rkt        counter.rkt     location.rkt        <span class=\"nb\">test</span>-case.rkt\ncheck-info.rkt  format.rkt      monad.rkt           test.rkt\ncheck.rkt       gui             name-collector.rkt  <span class=\"nb\">test</span>-suite.rkt\ncompiled        <span class=\"nb\">hash</span>-monad.rkt  result.rkt          text-ui-util.rkt\n</pre></div>\n\n</div>\n\n<p>Well, <code>check.rkt</code> seems awfully promising. It defines all of the checks that you can see in the RackUnit docs:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">provide</span> <span class=\"k\">...</span>\n         <span class=\"n\">check-eq?</span>\n         <span class=\"n\">check-eqv?</span>\n         <span class=\"n\">check-equal?</span>\n         <span class=\"n\">check-=</span>\n         <span class=\"k\">...</span><span class=\"p\">)</span>\n\n<span class=\"p\">(</span><span class=\"n\">define-binary-check</span> <span class=\"p\">(</span><span class=\"n\">check-eq?</span> <span class=\"nb\">eq?</span> <span class=\"n\">expr1</span> <span class=\"n\">expr2</span><span class=\"p\">))</span>\n\n<span class=\"p\">(</span><span class=\"n\">define-binary-check</span> <span class=\"p\">(</span><span class=\"n\">check-eqv?</span> <span class=\"nb\">eqv?</span> <span class=\"n\">expr1</span> <span class=\"n\">expr2</span><span class=\"p\">))</span>\n\n<span class=\"p\">(</span><span class=\"n\">define-binary-check</span> <span class=\"p\">(</span><span class=\"n\">check-equal?</span> <span class=\"n\">expr1</span> <span class=\"n\">expr2</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"nb\">equal?</span> <span class=\"n\">expr1</span> <span class=\"n\">expr2</span><span class=\"p\">))</span>\n\n<span class=\"p\">(</span><span class=\"n\">define-simple-check</span> <span class=\"p\">(</span><span class=\"n\">check-=</span> <span class=\"n\">expr1</span> <span class=\"n\">expr2</span> <span class=\"n\">epsilon</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span> <span class=\"p\">(</span><span class=\"nb\">magnitude</span> <span class=\"p\">(</span><span class=\"nb\">-</span> <span class=\"n\">expr1</span> <span class=\"n\">expr2</span><span class=\"p\">))</span> <span class=\"n\">epsilon</span><span class=\"p\">))</span>\n\n<span class=\"k\">...</span>\n</pre></div>\n\n</div>\n\n<p>But before I go sticking my code in there willy-nilly, it&rsquo;s important to realize there are three things that need to go with a commit like this:</p>\n\n<ul>\n <li>\n  <p>Tests</p></li>\n <li>\n  <p>Implementation</p></li>\n <li>\n  <p>Documentation</p></li></ul>\n\n<p>We&rsquo;ll build up our commit in those stages.</p>\n\n<h2 id=\"adding-tests\">Adding Tests</h2>\n\n<p>First, I need to know how I&rsquo;m going to test this to make sure I don&rsquo;t screw anything up with my edits. There&rsquo;s actually a whole collection for tests in <code>collects/tests/</code>, which includes a rackunit subdirectory. Conveniently, this has been further divided into files that correspond to the files from the RackUnit collection itself:</p>\n\n<div class=\"brush: bash\">\n <div class=\"pygments\">\n  <pre><span class=\"nv\">$ </span>ls collects/tests/rackunit/\nall-rackunit-tests.rkt  monad-test.rkt                \nbase-test.rkt           pr10950.rkt                   \ncheck-info-test.rkt     result-test.rkt               \ncheck-test.rkt          run-tests.rkt                 \ncounter-test.rkt        standalone-check-test.rkt     \nformat-test.rkt         standalone.rkt                \n<span class=\"nb\">hash</span>-monad-test.rkt     standalone-test-case-test.rkt\nlocation-test.rkt       <span class=\"nb\">test</span>-case-test.rkt\n</pre></div>\n\n</div>\n\n<p>So, we can add a few expected uses to <code>check-test.rkt</code>, which will be tested against the implementation. I found the end of the check-tests, and inserted some simple test cases there, using the existing style of the file:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"k\">...</span>\n   <span class=\"c1\">;; existing tests</span>\n   <span class=\"p\">(</span><span class=\"n\">test-case</span> <span class=\"s2\">\"Use of check as expression\"</span>\n              <span class=\"p\">(</span><span class=\"nb\">for-each</span> <span class=\"n\">check-false</span> <span class=\"o\">&#39;</span><span class=\"p\">(</span><span class=\"no\">#f</span> <span class=\"no\">#f</span> <span class=\"no\">#f</span><span class=\"p\">)))</span>\n   <span class=\"p\">(</span><span class=\"n\">test-case</span> <span class=\"s2\">\"Use of local check as expression\"</span>\n              <span class=\"p\">(</span><span class=\"k\">let</span> <span class=\"p\">()</span>\n                <span class=\"p\">(</span><span class=\"n\">define-simple-check</span> <span class=\"p\">(</span><span class=\"n\">check-symbol?</span> <span class=\"n\">x</span><span class=\"p\">)</span>\n                  <span class=\"p\">(</span><span class=\"nb\">symbol?</span> <span class=\"n\">x</span><span class=\"p\">))</span>\n                <span class=\"p\">(</span><span class=\"nb\">for-each</span> <span class=\"n\">check-symbol?</span> <span class=\"o\">&#39;</span><span class=\"p\">(</span><span class=\"ss\">a</span> <span class=\"ss\">b</span> <span class=\"ss\">c</span><span class=\"p\">))))</span>\n   <span class=\"c1\">;; my added tests</span>\n   <span class=\"p\">(</span><span class=\"n\">test-case</span> <span class=\"s2\">\"Trivial check-match test\"</span>\n              <span class=\"p\">(</span><span class=\"n\">check-match</span> <span class=\"s2\">\"dirigible\"</span> <span class=\"k\">_</span><span class=\"p\">))</span>\n\n   <span class=\"p\">(</span><span class=\"n\">test-case</span> <span class=\"s2\">\"Simple check-match test\"</span>\n              <span class=\"p\">(</span><span class=\"n\">check-match</span> <span class=\"p\">(</span><span class=\"nb\">list</span> <span class=\"mi\">1</span> <span class=\"mi\">2</span> <span class=\"mi\">3</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"nb\">list</span> <span class=\"k\">_</span> <span class=\"k\">_</span> <span class=\"mi\">3</span><span class=\"p\">)))</span>\n\n   <span class=\"p\">(</span><span class=\"n\">test-case</span> <span class=\"s2\">\"check-match with a nested struct\"</span>\n              <span class=\"p\">(</span><span class=\"k\">let</span> <span class=\"p\">()</span>\n                <span class=\"p\">(</span><span class=\"k\">struct</span> <span class=\"n\">data</span> <span class=\"p\">(</span><span class=\"n\">f1</span> <span class=\"n\">f2</span> <span class=\"n\">f3</span><span class=\"p\">))</span>\n                <span class=\"p\">(</span><span class=\"n\">check-match</span> <span class=\"p\">(</span><span class=\"n\">data</span> <span class=\"mi\">1</span> <span class=\"mi\">2</span> <span class=\"p\">(</span><span class=\"n\">data</span> <span class=\"mi\">1</span> <span class=\"mi\">2</span> <span class=\"mi\">3</span><span class=\"p\">))</span>\n                             <span class=\"p\">(</span><span class=\"n\">data</span> <span class=\"k\">_</span> <span class=\"mi\">2</span> <span class=\"p\">(</span><span class=\"n\">data</span> <span class=\"k\">_</span> <span class=\"k\">_</span> <span class=\"k\">_</span><span class=\"p\">)))))</span>\n</pre></div>\n\n</div>\n\n<h2 id=\"implementation-and-running-tests\">Implementation and Running Tests</h2>\n\n<p>With the tests written, it&rsquo;s safe to go back and add my implementation to <code>check.rkt</code>, since I&rsquo;ll know if I&rsquo;ve succeeded or not via these tests. I added my implementation there, with some comment caveats about how <code>check-match</code> differs from other checks:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"c1\">;; NOTE(jpolitz): This match form isn&#39;t eager like the others, hence</span>\n<span class=\"c1\">;; the define-syntax and the need to carry around location information</span>\n<span class=\"p\">(</span><span class=\"k\">define-syntax</span> <span class=\"p\">(</span><span class=\"n\">check-match</span> <span class=\"n\">stx</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"k\">syntax-case</span> <span class=\"n\">stx</span> <span class=\"p\">()</span>\n   <span class=\"p\">((</span><span class=\"k\">_</span> <span class=\"n\">actual</span> <span class=\"n\">expected</span> <span class=\"n\">pred</span><span class=\"p\">)</span>\n     <span class=\"c1\">;;... implementation here ...</span>\n   <span class=\"p\">)))</span>\n</pre></div>\n\n</div>\n\n<p>The actual implementation of <code>check-match</code> is turns the pieces into an instance of <code>match</code> that yields true or false depending on if the value was matched. Here&rsquo;s the essence:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">define-syntax</span> <span class=\"n\">check-match</span>\n  <span class=\"p\">(</span><span class=\"k\">syntax-rules</span> <span class=\"p\">()</span>\n    <span class=\"p\">[(</span><span class=\"k\">_</span> <span class=\"n\">actual</span> <span class=\"n\">expected</span> <span class=\"n\">pred</span><span class=\"p\">)</span>\n     <span class=\"p\">(</span><span class=\"k\">let</span> <span class=\"p\">([</span><span class=\"n\">actual-val</span> <span class=\"n\">actual</span><span class=\"p\">])</span>\n      <span class=\"p\">(</span><span class=\"n\">check-true</span> <span class=\"p\">(</span><span class=\"k\">match</span> <span class=\"n\">actual-val</span>\n                   <span class=\"p\">[</span><span class=\"n\">expected</span> <span class=\"n\">pred</span><span class=\"p\">]</span>\n                   <span class=\"p\">[</span><span class=\"k\">_</span> <span class=\"no\">#f</span><span class=\"p\">])))))]</span>\n    <span class=\"p\">[(</span><span class=\"k\">_</span> <span class=\"n\">actual</span> <span class=\"n\">expected</span><span class=\"p\">)</span>\n     <span class=\"p\">(</span><span class=\"n\">check-match</span> <span class=\"n\">actual</span> <span class=\"n\">expected</span> <span class=\"no\">#t</span><span class=\"p\">)]</span><span class=\"err\">))</span>\n</pre></div>\n\n</div>\n\n<p>In reality, this gives lousy error reporting, so the <a href=\"https://github.com/plt/racket/blob/e264e4148884f0675bd21e889525ccb7239eb4b4/collects/rackunit/private/check.rkt#L286\">actual implementation</a> leverages the helpful <a href=\"http://docs.racket-lang.org/rackunit/api.html#(form._((lib._rackunit/main..rkt)._with-check-info))\">with-check-info</a> form to populate the test with reporting information for failures.</p>\n\n<p>With the implementation in place, it&rsquo;s time to run the tests, and figure out if what I did broke anything. To run a particular test suite, Racket provides a tool called <code>raco</code> that was built by the <code>make install</code> above. To run our tests, we do (from the base <code>racket/</code> directory):</p>\n\n<div class=\"brush: bash\">\n <div class=\"pygments\">\n  <pre><span class=\"nv\">$ </span>./bin/raco <span class=\"nb\">test </span>collects/tests/rackunit\n</pre></div>\n\n</div>\n\n<p>I iterated through this a few times to suss out all the minor bugs in what I&rsquo;d written. I also wanted to check that my tests were actually adding to the count, so I compared to the version without my changes by doing:</p>\n\n<div class=\"brush: bash\">\n <div class=\"pygments\">\n  <pre><span class=\"nv\">$ </span>git stash\n<span class=\"c\"># stores my edits temporarily in git&#39;s stash</span>\n<span class=\"nv\">$ </span>./bin/raco <span class=\"nb\">test </span>collects/tests/rackunit\n<span class=\"c\"># Output including \"120 tests passed, 0 tests failed\"</span>\n<span class=\"nv\">$ </span>git stash apply\n<span class=\"c\"># re-applies my edits</span>\n<span class=\"nv\">$ </span>./bin/raco <span class=\"nb\">test </span>collects/tests/rackunit\n<span class=\"c\"># Output including \"127 tests passed, 0 tests failed\", which seems good,</span>\n<span class=\"c\"># since I wrote 7 new tests</span>\n</pre></div>\n\n</div>\n\n<p>So, I&rsquo;m happy with my implementation. All that&rsquo;s left is to write something down about this feature that others will be able to find it and use it in the future.</p>\n\n<h2 id=\"adding-documentation\">Adding Documentation</h2>\n\n<p>Racket uses a tool called <a href=\"http://docs.racket-lang.org/scribble/index.html\">Scribble</a> for documentation, and by convention, a collection&rsquo;s documentation is stored in the <code>scribblings/</code> subdirectory of the collection:</p>\n\n<div class=\"brush: bash\">\n <div class=\"pygments\">\n  <pre><span class=\"nv\">$ </span>ls collects/rackunit/scribblings/\nacknowledgements.scrbl  control-flow.scrbl  philosophy.scrbl\napi.scrbl               file.rkt            quick-start.scrbl\nbase.rkt                file-test.rkt       rackunit.scrbl\ncheck.scrbl             internals.scrbl     release-notes.scrbl\ncompiled                misc.scrbl          ui.scrbl\ncompound-testing.scrbl  overview.scrbl      utils.scrbl\n</pre></div>\n\n</div>\n\n<p>Keeping with the theme, we&rsquo;ll be editing <code>check.scrbl</code> which is the file that&rsquo;s used to generate <a href=\"http://docs.racket-lang.org/rackunit/api.html#(part._.Checks)\">this section</a> of the RackUnit documentation.</p>\n\n<p>Reading over the existing docs, I notice that our new feature is violating one of the principles of the existing documentation:</p>\n\n<blockquote>\n <p>Although checks are implemented as macros, which is necessary to grab source location, they are conceptually functions. This means, for instance, checks always evaluate their arguments.</p></blockquote>\n\n<p>Based on <a href=\"http://www.mail-archive.com/dev@racket-lang.org/msg07435.html\">Robby&rsquo;s recommendation</a> (the mailing list is helpful and responsive again!) I simply added a caveat \"(with the exception of @racket[check-match] below)\", and moved on to adding actual documentation for <code>check-match</code>.</p>\n\n<p>Scribble does two very cool things when documenting definitions. First, it has explicit syntax for telling the documentation system that you&rsquo;re introducing a new identifier that should be indexed and linkable. Second, it lets you write Racket code examples directly into the documentation, and even runs them and renders their results inline into the documenation. Here&rsquo;s a snippet of what I add:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"n\">@defform*</span><span class=\"p\">[((</span><span class=\"n\">check-match</span> <span class=\"n\">v</span> <span class=\"n\">pattern</span><span class=\"p\">)</span>\n           <span class=\"p\">(</span><span class=\"n\">check-match</span> <span class=\"n\">v</span> <span class=\"n\">pattern</span> <span class=\"n\">pred</span><span class=\"p\">))]{</span>\n\n<span class=\"n\">A</span> <span class=\"n\">check</span> <span class=\"n\">that</span> <span class=\"n\">pattern</span> <span class=\"n\">matches</span> <span class=\"n\">on</span> <span class=\"n\">the</span> <span class=\"n\">test</span> <span class=\"n\">value.</span>  <span class=\"n\">Matches</span> <span class=\"n\">the</span> <span class=\"n\">test</span> <span class=\"n\">value</span>\n<span class=\"n\">@racket</span><span class=\"p\">[</span><span class=\"n\">v</span><span class=\"p\">]</span> <span class=\"n\">against</span> <span class=\"n\">@racket</span><span class=\"p\">[</span><span class=\"n\">pattern</span><span class=\"p\">]</span> <span class=\"n\">as</span> <span class=\"n\">a</span> <span class=\"n\">@racket</span><span class=\"p\">[</span><span class=\"k\">match</span><span class=\"p\">]</span> <span class=\"n\">clause.</span>  <span class=\"n\">If</span> <span class=\"n\">no</span>\n<span class=\"n\">@racket</span><span class=\"p\">[</span><span class=\"n\">pred</span><span class=\"p\">]</span> <span class=\"n\">is</span> <span class=\"n\">provided</span><span class=\"o\">,</span> <span class=\"n\">then</span> <span class=\"k\">if</span> <span class=\"n\">the</span> <span class=\"k\">match</span> <span class=\"n\">succeeds</span><span class=\"o\">,</span> <span class=\"n\">the</span> <span class=\"n\">entire</span> <span class=\"n\">check</span>\n<span class=\"n\">succeeds.</span>  <span class=\"n\">For</span> <span class=\"n\">example</span><span class=\"o\">,</span> <span class=\"k\">this</span> <span class=\"n\">use</span> <span class=\"n\">succeeds:</span>\n\n<span class=\"n\">@interaction</span><span class=\"p\">[</span><span class=\"kd\">#:eval</span> <span class=\"n\">rackunit-eval</span>\n  <span class=\"p\">(</span><span class=\"n\">check-match</span> <span class=\"p\">(</span><span class=\"nb\">list</span> <span class=\"mi\">1</span> <span class=\"mi\">2</span> <span class=\"mi\">3</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"nb\">list</span> <span class=\"k\">_</span> <span class=\"k\">_</span> <span class=\"mi\">3</span><span class=\"p\">))</span>\n<span class=\"p\">]</span>\n\n<span class=\"n\">This</span> <span class=\"n\">check</span> <span class=\"n\">fails</span> <span class=\"n\">to</span> <span class=\"n\">match:</span>\n\n<span class=\"n\">@interaction</span><span class=\"p\">[</span><span class=\"kd\">#:eval</span> <span class=\"n\">rackunit-eval</span>\n  <span class=\"p\">(</span><span class=\"n\">check-match</span> <span class=\"p\">(</span><span class=\"nb\">list</span> <span class=\"mi\">1</span> <span class=\"mi\">2</span> <span class=\"mi\">3</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"nb\">list</span> <span class=\"k\">_</span> <span class=\"k\">_</span> <span class=\"mi\">4</span><span class=\"p\">))</span>\n<span class=\"p\">]</span>\n</pre></div>\n\n</div>\n\n<p>There are a few things going on here:</p>\n\n<ul>\n <li>\n  <p><code>@defform</code> tells Scribble that this is a new syntactic form that should be indexed. Scribble figures out the the name is <code>check-match</code>, and adds links for it to the table of contents and enters it in the search index.</p></li>\n <li>\n  <p><code>@racket[v]</code> tells Scribble to render <code>v</code> as Racket code, and Scribble is also smart enough to know that <code>v</code> is the same <code>v</code> in the definition, and creates a back link for it.</p></li>\n <li>\n  <p><code>@interaction[#:eval rackunit-eval ... ]</code> blocks indicate expressions that should be run, with their output rendered after them. This makes for beautiful docs with examples inline to show users exactly what their getting. To build the docs, we run:</p></li></ul>\n\n<div class=\"brush: bash\">\n <div class=\"pygments\">\n  <pre><span class=\"nv\">$ </span>./bin/raco setup collects/rackunit\n</pre></div>\n\n</div>\n\n<p>Then, the docs will appear in the local documentation directory. I can then open them up in a web browser and see the results (note the local url ending api.html; that&rsquo;s the local path to the documentation that&rsquo;s been installed):</p>\n\n<p>Looks good!</p>\n\n<h2 id=\"letting-racketeers-know\">Letting Racketeers Know</h2>\n\n<p>I packaged everything up in a <a href=\"https://github.com/jpolitz/racket/commit/023d2278c1bb9819451790d774ae8e67a5d46f22\">single commit</a>, and sent the whole thing off to the Racket folks with a <a href=\"https://github.com/plt/racket/pull/171\">pull request</a>. They then reviewed it and incorporated it into <a href=\"https://github.com/plt/racket/commit/e264e4148884f0675bd21e889525ccb7239eb4b4\">their HEAD</a> the next day.</p>\n\n<p>The Racket folks maintain a list of <a href=\"https://github.com/plt/racket/wiki/Intro-Projects\">Intro Projects</a>, so there&rsquo;s easy places to start if you want to follow this tutorial and get involved!</p>") #t (u . "\n<p><em>posted by Joe Gibbs Politz</em></p>\n\n<p><em>Originally posted on <a href=\"http://jpolitz.github.com/blog/2012/11/21/racket-contributing-tutorial.html\">jpolitz.github.com</a>.</em></p>\n\n<p>I&rsquo;ve been a longtime user and sometimes fanboy of <a href=\"http://racket-lang.org/\">Racket</a>, but aside from a few bug reports, before this week I hadn&rsquo;t contributed anything back to the language. This week, I started using a little helper macro, which wasn&rsquo;t in the core utils, to make some of my testing easier. I mentioned it to the super-friendly Racket community, they told me they liked it, and my pull request was merged within about 12 hours.</p>\n\n<p>I&rsquo;ve been using Racket for a while, so I knew roughly where to lookto put my code, tests, and documentation. A newer user might not know,so this post outlines, in some detail, the steps I went through to puttogether a tiny feature extension for Racket.</p>\n\n<h2 id=\"a-tiny-feature\">A Tiny Feature</h2>\n\n<p>I&rsquo;m dabbling in the implementation of a <a href=\"http://github.com/brownplt/pyret-lang\">small scripting language called Pyret</a> to study features of scripting objects. The language has a parser, which generates AST nodes. The nodes keep track of their location in the original program for error reporting, unbound identifier reporting, and the like. I wanted to write some test cases for our</p>\n\n<p>parser, which generates things like:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"nb\">&gt;</span> <span class=\"p\">(</span><span class=\"n\">parse</span> <span class=\"s2\">\"o.x\"</span><span class=\"p\">)</span>\n<span class=\"p\">(</span><span class=\"n\">s-block</span> <span class=\"p\">(</span><span class=\"nb\">srcloc</span> <span class=\"s2\">\"parse-tests.rkt\"</span> <span class=\"mi\">1</span> <span class=\"mi\">0</span> <span class=\"no\">#f</span> <span class=\"no\">#f</span><span class=\"p\">)</span>\n         <span class=\"p\">(</span><span class=\"nb\">list</span> <span class=\"p\">(</span><span class=\"n\">s-dot</span>\n                <span class=\"p\">(</span><span class=\"nb\">srcloc</span> <span class=\"s2\">\"parse-tests.rkt\"</span> <span class=\"mi\">1</span> <span class=\"mi\">0</span> <span class=\"no\">#f</span> <span class=\"no\">#f</span><span class=\"p\">)</span>\n                <span class=\"p\">(</span><span class=\"n\">s-id</span> <span class=\"p\">(</span><span class=\"nb\">srcloc</span> <span class=\"s2\">\"parse-tests.rkt\"</span> <span class=\"mi\">1</span> <span class=\"mi\">0</span> <span class=\"no\">#f</span> <span class=\"no\">#f</span><span class=\"p\">)</span> <span class=\"o\">&#39;</span><span class=\"ss\">o</span><span class=\"p\">)</span>\n                <span class=\"o\">&#39;</span><span class=\"ss\">x</span><span class=\"p\">)))</span>\n</pre></div>\n\n</div>\n\n<p>A ton of detail is in the output keeping track of line number information. But I don&rsquo;t want to have to type out the line numbers and get them right for each test. I&rsquo;d like to write:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"n\">check-match</span> <span class=\"p\">(</span><span class=\"n\">parse</span> <span class=\"s2\">\"o.x\"</span><span class=\"p\">)</span>\n<span class=\"p\">(</span><span class=\"n\">s-block</span> <span class=\"k\">_</span> <span class=\"p\">(</span><span class=\"nb\">list</span> <span class=\"p\">(</span><span class=\"n\">s-dot</span> <span class=\"k\">_</span> <span class=\"p\">(</span><span class=\"n\">s-id</span> <span class=\"k\">_</span> <span class=\"o\">&#39;</span><span class=\"ss\">o</span><span class=\"p\">)</span> <span class=\"o\">&#39;</span><span class=\"ss\">x</span><span class=\"p\">))))</span>\n</pre></div>\n\n</div>\n\n<p>Which checks that all the things I care about for the parse are true: the program parses to a block of code, with a single statement, which is a dot expression of the identifier <code>o</code> and the symbol <code>x</code>. With a little help from <a href=\"http://www.jonahkagan.me/\">Jonah Kagan</a>, I produced a macro that does exactly that, and works nicely with <a href=\"http://docs.racket-lang.org/rackunit/api.html\">RackUnit</a>, Racket&rsquo;s unit-testing framework (<a href=\"https://github.com/brownplt/pyret-lang/blob/master/src/tests/parse-tests.rkt#L36\">see it in action</a>, with a slightly different name).</p>\n\n<p>I thought <code>check-match</code> was pretty useful, and figured I&rsquo;d see if the Racket folks at large would agree. I <a href=\"http://www.mail-archive.com/dev@racket-lang.org/msg07427.html\">wrote a message</a> to the Racket mailing list, figuring someone might think it was neat. There was some <a href=\"http://www.mail-archive.com/dev@racket-lang.org/msg07429.html\">immediate</a> <a href=\"http://www.mail-archive.com/dev@racket-lang.org/msg07430.html\">positive</a> <a href=\"http://www.mail-archive.com/dev@racket-lang.org/msg07428.html\">feedback</a>, so I decided to go ahead and try to add it.</p>\n\n<p>Getting and Extending Racket &mdash;</p>\n\n<p><a href=\"http://github.com/plt/racket\">Racket&rsquo;s repo</a> is hosted on Github. The easiest way to contribute is to <a href=\"https://help.github.com/articles/fork-a-repo\">fork it</a>, and then check out your own copy. The check-out and build process is fairly standard; you should, however, make a directory called <code>build/</code> to hold the binaries that will be created:</p>\n\n<div class=\"brush: bash\">\n <div class=\"pygments\">\n  <pre><span class=\"nv\">$ </span>git clone git://github.com/&lt;your-username&gt;/racket.git\n<span class=\"nv\">$ </span><span class=\"nb\">cd </span>racket/src\n<span class=\"nv\">$ </span>mkdir build\n<span class=\"nv\">$ </span><span class=\"nb\">cd </span>build\n<span class=\"nv\">$ </span>../configure\n<span class=\"nv\">$ </span>make\n<span class=\"nv\">$ </span>make install\n</pre></div>\n\n</div>\n\n<p>This takes about 20&ndash;30 minutes, and installs all the necessary Racket binaries locally in place (no <code>sudo</code> or anything needed).</p>\n\n<p>Next up was to find RackUnit and the code I&rsquo;d need to extend.</p>\n\n<p>Most of what goes on in Racket&rsquo;s core utilities happens in <em>collections</em>, found in the <code>collects/</code> directory of the base directory of the checkout. For my implementation, I&rsquo;d be looking at <code>collects/rackunit</code>.</p>\n\n<p>I want to implement a new kind of <code>check</code>, so let&rsquo;s find that in RackUnit. Here&rsquo;s what the RackUnit directory looks like:</p>\n\n<div class=\"brush: bash\">\n <div class=\"pygments\">\n  <pre><span class=\"nv\">$ </span>ls collects/rackunit/\ncompiled           gui.rkt   main.rkt  scribblings  tool.rkt\ndocs-complete.rkt  info.rkt  private   text-ui.rkt\n</pre></div>\n\n</div>\n\n<p>The <code>private/</code> directory contains most of the internals of the built-in collections&rsquo; behavior, so let&rsquo;s look at that:</p>\n\n<div class=\"brush: bash\">\n <div class=\"pygments\">\n  <pre><span class=\"nv\">$ </span>ls collects/rackunit/private/\nbase.rkt        counter.rkt     location.rkt        <span class=\"nb\">test</span>-case.rkt\ncheck-info.rkt  format.rkt      monad.rkt           test.rkt\ncheck.rkt       gui             name-collector.rkt  <span class=\"nb\">test</span>-suite.rkt\ncompiled        <span class=\"nb\">hash</span>-monad.rkt  result.rkt          text-ui-util.rkt\n</pre></div>\n\n</div>\n\n<p>Well, <code>check.rkt</code> seems awfully promising. It defines all of the checks that you can see in the RackUnit docs:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">provide</span> <span class=\"k\">...</span>\n         <span class=\"n\">check-eq?</span>\n         <span class=\"n\">check-eqv?</span>\n         <span class=\"n\">check-equal?</span>\n         <span class=\"n\">check-=</span>\n         <span class=\"k\">...</span><span class=\"p\">)</span>\n\n<span class=\"p\">(</span><span class=\"n\">define-binary-check</span> <span class=\"p\">(</span><span class=\"n\">check-eq?</span> <span class=\"nb\">eq?</span> <span class=\"n\">expr1</span> <span class=\"n\">expr2</span><span class=\"p\">))</span>\n\n<span class=\"p\">(</span><span class=\"n\">define-binary-check</span> <span class=\"p\">(</span><span class=\"n\">check-eqv?</span> <span class=\"nb\">eqv?</span> <span class=\"n\">expr1</span> <span class=\"n\">expr2</span><span class=\"p\">))</span>\n\n<span class=\"p\">(</span><span class=\"n\">define-binary-check</span> <span class=\"p\">(</span><span class=\"n\">check-equal?</span> <span class=\"n\">expr1</span> <span class=\"n\">expr2</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"nb\">equal?</span> <span class=\"n\">expr1</span> <span class=\"n\">expr2</span><span class=\"p\">))</span>\n\n<span class=\"p\">(</span><span class=\"n\">define-simple-check</span> <span class=\"p\">(</span><span class=\"n\">check-=</span> <span class=\"n\">expr1</span> <span class=\"n\">expr2</span> <span class=\"n\">epsilon</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span> <span class=\"p\">(</span><span class=\"nb\">magnitude</span> <span class=\"p\">(</span><span class=\"nb\">-</span> <span class=\"n\">expr1</span> <span class=\"n\">expr2</span><span class=\"p\">))</span> <span class=\"n\">epsilon</span><span class=\"p\">))</span>\n\n<span class=\"k\">...</span>\n</pre></div>\n\n</div>\n\n<p>But before I go sticking my code in there willy-nilly, it&rsquo;s important to realize there are three things that need to go with a commit like this:</p>\n\n<ul>\n <li>\n  <p>Tests</p></li>\n <li>\n  <p>Implementation</p></li>\n <li>\n  <p>Documentation</p></li></ul>\n\n<p>We&rsquo;ll build up our commit in those stages.</p>\n\n<h2 id=\"adding-tests\">Adding Tests</h2>\n\n<p>First, I need to know how I&rsquo;m going to test this to make sure I don&rsquo;t screw anything up with my edits. There&rsquo;s actually a whole collection for tests in <code>collects/tests/</code>, which includes a rackunit subdirectory. Conveniently, this has been further divided into files that correspond to the files from the RackUnit collection itself:</p>\n\n<div class=\"brush: bash\">\n <div class=\"pygments\">\n  <pre><span class=\"nv\">$ </span>ls collects/tests/rackunit/\nall-rackunit-tests.rkt  monad-test.rkt                \nbase-test.rkt           pr10950.rkt                   \ncheck-info-test.rkt     result-test.rkt               \ncheck-test.rkt          run-tests.rkt                 \ncounter-test.rkt        standalone-check-test.rkt     \nformat-test.rkt         standalone.rkt                \n<span class=\"nb\">hash</span>-monad-test.rkt     standalone-test-case-test.rkt\nlocation-test.rkt       <span class=\"nb\">test</span>-case-test.rkt\n</pre></div>\n\n</div>\n\n<p>So, we can add a few expected uses to <code>check-test.rkt</code>, which will be tested against the implementation. I found the end of the check-tests, and inserted some simple test cases there, using the existing style of the file:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"k\">...</span>\n   <span class=\"c1\">;; existing tests</span>\n   <span class=\"p\">(</span><span class=\"n\">test-case</span> <span class=\"s2\">\"Use of check as expression\"</span>\n              <span class=\"p\">(</span><span class=\"nb\">for-each</span> <span class=\"n\">check-false</span> <span class=\"o\">&#39;</span><span class=\"p\">(</span><span class=\"no\">#f</span> <span class=\"no\">#f</span> <span class=\"no\">#f</span><span class=\"p\">)))</span>\n   <span class=\"p\">(</span><span class=\"n\">test-case</span> <span class=\"s2\">\"Use of local check as expression\"</span>\n              <span class=\"p\">(</span><span class=\"k\">let</span> <span class=\"p\">()</span>\n                <span class=\"p\">(</span><span class=\"n\">define-simple-check</span> <span class=\"p\">(</span><span class=\"n\">check-symbol?</span> <span class=\"n\">x</span><span class=\"p\">)</span>\n                  <span class=\"p\">(</span><span class=\"nb\">symbol?</span> <span class=\"n\">x</span><span class=\"p\">))</span>\n                <span class=\"p\">(</span><span class=\"nb\">for-each</span> <span class=\"n\">check-symbol?</span> <span class=\"o\">&#39;</span><span class=\"p\">(</span><span class=\"ss\">a</span> <span class=\"ss\">b</span> <span class=\"ss\">c</span><span class=\"p\">))))</span>\n   <span class=\"c1\">;; my added tests</span>\n   <span class=\"p\">(</span><span class=\"n\">test-case</span> <span class=\"s2\">\"Trivial check-match test\"</span>\n              <span class=\"p\">(</span><span class=\"n\">check-match</span> <span class=\"s2\">\"dirigible\"</span> <span class=\"k\">_</span><span class=\"p\">))</span>\n\n   <span class=\"p\">(</span><span class=\"n\">test-case</span> <span class=\"s2\">\"Simple check-match test\"</span>\n              <span class=\"p\">(</span><span class=\"n\">check-match</span> <span class=\"p\">(</span><span class=\"nb\">list</span> <span class=\"mi\">1</span> <span class=\"mi\">2</span> <span class=\"mi\">3</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"nb\">list</span> <span class=\"k\">_</span> <span class=\"k\">_</span> <span class=\"mi\">3</span><span class=\"p\">)))</span>\n\n   <span class=\"p\">(</span><span class=\"n\">test-case</span> <span class=\"s2\">\"check-match with a nested struct\"</span>\n              <span class=\"p\">(</span><span class=\"k\">let</span> <span class=\"p\">()</span>\n                <span class=\"p\">(</span><span class=\"k\">struct</span> <span class=\"n\">data</span> <span class=\"p\">(</span><span class=\"n\">f1</span> <span class=\"n\">f2</span> <span class=\"n\">f3</span><span class=\"p\">))</span>\n                <span class=\"p\">(</span><span class=\"n\">check-match</span> <span class=\"p\">(</span><span class=\"n\">data</span> <span class=\"mi\">1</span> <span class=\"mi\">2</span> <span class=\"p\">(</span><span class=\"n\">data</span> <span class=\"mi\">1</span> <span class=\"mi\">2</span> <span class=\"mi\">3</span><span class=\"p\">))</span>\n                             <span class=\"p\">(</span><span class=\"n\">data</span> <span class=\"k\">_</span> <span class=\"mi\">2</span> <span class=\"p\">(</span><span class=\"n\">data</span> <span class=\"k\">_</span> <span class=\"k\">_</span> <span class=\"k\">_</span><span class=\"p\">)))))</span>\n</pre></div>\n\n</div>\n\n<h2 id=\"implementation-and-running-tests\">Implementation and Running Tests</h2>\n\n<p>With the tests written, it&rsquo;s safe to go back and add my implementation to <code>check.rkt</code>, since I&rsquo;ll know if I&rsquo;ve succeeded or not via these tests. I added my implementation there, with some comment caveats about how <code>check-match</code> differs from other checks:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"c1\">;; NOTE(jpolitz): This match form isn&#39;t eager like the others, hence</span>\n<span class=\"c1\">;; the define-syntax and the need to carry around location information</span>\n<span class=\"p\">(</span><span class=\"k\">define-syntax</span> <span class=\"p\">(</span><span class=\"n\">check-match</span> <span class=\"n\">stx</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"k\">syntax-case</span> <span class=\"n\">stx</span> <span class=\"p\">()</span>\n   <span class=\"p\">((</span><span class=\"k\">_</span> <span class=\"n\">actual</span> <span class=\"n\">expected</span> <span class=\"n\">pred</span><span class=\"p\">)</span>\n     <span class=\"c1\">;;... implementation here ...</span>\n   <span class=\"p\">)))</span>\n</pre></div>\n\n</div>\n\n<p>The actual implementation of <code>check-match</code> is turns the pieces into an instance of <code>match</code> that yields true or false depending on if the value was matched. Here&rsquo;s the essence:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">define-syntax</span> <span class=\"n\">check-match</span>\n  <span class=\"p\">(</span><span class=\"k\">syntax-rules</span> <span class=\"p\">()</span>\n    <span class=\"p\">[(</span><span class=\"k\">_</span> <span class=\"n\">actual</span> <span class=\"n\">expected</span> <span class=\"n\">pred</span><span class=\"p\">)</span>\n     <span class=\"p\">(</span><span class=\"k\">let</span> <span class=\"p\">([</span><span class=\"n\">actual-val</span> <span class=\"n\">actual</span><span class=\"p\">])</span>\n      <span class=\"p\">(</span><span class=\"n\">check-true</span> <span class=\"p\">(</span><span class=\"k\">match</span> <span class=\"n\">actual-val</span>\n                   <span class=\"p\">[</span><span class=\"n\">expected</span> <span class=\"n\">pred</span><span class=\"p\">]</span>\n                   <span class=\"p\">[</span><span class=\"k\">_</span> <span class=\"no\">#f</span><span class=\"p\">])))))]</span>\n    <span class=\"p\">[(</span><span class=\"k\">_</span> <span class=\"n\">actual</span> <span class=\"n\">expected</span><span class=\"p\">)</span>\n     <span class=\"p\">(</span><span class=\"n\">check-match</span> <span class=\"n\">actual</span> <span class=\"n\">expected</span> <span class=\"no\">#t</span><span class=\"p\">)]</span><span class=\"err\">))</span>\n</pre></div>\n\n</div>\n\n<p>In reality, this gives lousy error reporting, so the <a href=\"https://github.com/plt/racket/blob/e264e4148884f0675bd21e889525ccb7239eb4b4/collects/rackunit/private/check.rkt#L286\">actual implementation</a> leverages the helpful <a href=\"http://docs.racket-lang.org/rackunit/api.html#(form._((lib._rackunit/main..rkt)._with-check-info))\">with-check-info</a> form to populate the test with reporting information for failures.</p>\n\n<p>With the implementation in place, it&rsquo;s time to run the tests, and figure out if what I did broke anything. To run a particular test suite, Racket provides a tool called <code>raco</code> that was built by the <code>make install</code> above. To run our tests, we do (from the base <code>racket/</code> directory):</p>\n\n<div class=\"brush: bash\">\n <div class=\"pygments\">\n  <pre><span class=\"nv\">$ </span>./bin/raco <span class=\"nb\">test </span>collects/tests/rackunit\n</pre></div>\n\n</div>\n\n<p>I iterated through this a few times to suss out all the minor bugs in what I&rsquo;d written. I also wanted to check that my tests were actually adding to the count, so I compared to the version without my changes by doing:</p>\n\n<div class=\"brush: bash\">\n <div class=\"pygments\">\n  <pre><span class=\"nv\">$ </span>git stash\n<span class=\"c\"># stores my edits temporarily in git&#39;s stash</span>\n<span class=\"nv\">$ </span>./bin/raco <span class=\"nb\">test </span>collects/tests/rackunit\n<span class=\"c\"># Output including \"120 tests passed, 0 tests failed\"</span>\n<span class=\"nv\">$ </span>git stash apply\n<span class=\"c\"># re-applies my edits</span>\n<span class=\"nv\">$ </span>./bin/raco <span class=\"nb\">test </span>collects/tests/rackunit\n<span class=\"c\"># Output including \"127 tests passed, 0 tests failed\", which seems good,</span>\n<span class=\"c\"># since I wrote 7 new tests</span>\n</pre></div>\n\n</div>\n\n<p>So, I&rsquo;m happy with my implementation. All that&rsquo;s left is to write something down about this feature that others will be able to find it and use it in the future.</p>\n\n<h2 id=\"adding-documentation\">Adding Documentation</h2>\n\n<p>Racket uses a tool called <a href=\"http://docs.racket-lang.org/scribble/index.html\">Scribble</a> for documentation, and by convention, a collection&rsquo;s documentation is stored in the <code>scribblings/</code> subdirectory of the collection:</p>\n\n<div class=\"brush: bash\">\n <div class=\"pygments\">\n  <pre><span class=\"nv\">$ </span>ls collects/rackunit/scribblings/\nacknowledgements.scrbl  control-flow.scrbl  philosophy.scrbl\napi.scrbl               file.rkt            quick-start.scrbl\nbase.rkt                file-test.rkt       rackunit.scrbl\ncheck.scrbl             internals.scrbl     release-notes.scrbl\ncompiled                misc.scrbl          ui.scrbl\ncompound-testing.scrbl  overview.scrbl      utils.scrbl\n</pre></div>\n\n</div>\n\n<p>Keeping with the theme, we&rsquo;ll be editing <code>check.scrbl</code> which is the file that&rsquo;s used to generate <a href=\"http://docs.racket-lang.org/rackunit/api.html#(part._.Checks)\">this section</a> of the RackUnit documentation.</p>\n\n<p>Reading over the existing docs, I notice that our new feature is violating one of the principles of the existing documentation:</p>\n\n<blockquote>\n <p>Although checks are implemented as macros, which is necessary to grab source location, they are conceptually functions. This means, for instance, checks always evaluate their arguments.</p></blockquote>\n\n<p>Based on <a href=\"http://www.mail-archive.com/dev@racket-lang.org/msg07435.html\">Robby&rsquo;s recommendation</a> (the mailing list is helpful and responsive again!) I simply added a caveat \"(with the exception of @racket[check-match] below)\", and moved on to adding actual documentation for <code>check-match</code>.</p>\n\n<p>Scribble does two very cool things when documenting definitions. First, it has explicit syntax for telling the documentation system that you&rsquo;re introducing a new identifier that should be indexed and linkable. Second, it lets you write Racket code examples directly into the documentation, and even runs them and renders their results inline into the documenation. Here&rsquo;s a snippet of what I add:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"n\">@defform*</span><span class=\"p\">[((</span><span class=\"n\">check-match</span> <span class=\"n\">v</span> <span class=\"n\">pattern</span><span class=\"p\">)</span>\n           <span class=\"p\">(</span><span class=\"n\">check-match</span> <span class=\"n\">v</span> <span class=\"n\">pattern</span> <span class=\"n\">pred</span><span class=\"p\">))]{</span>\n\n<span class=\"n\">A</span> <span class=\"n\">check</span> <span class=\"n\">that</span> <span class=\"n\">pattern</span> <span class=\"n\">matches</span> <span class=\"n\">on</span> <span class=\"n\">the</span> <span class=\"n\">test</span> <span class=\"n\">value.</span>  <span class=\"n\">Matches</span> <span class=\"n\">the</span> <span class=\"n\">test</span> <span class=\"n\">value</span>\n<span class=\"n\">@racket</span><span class=\"p\">[</span><span class=\"n\">v</span><span class=\"p\">]</span> <span class=\"n\">against</span> <span class=\"n\">@racket</span><span class=\"p\">[</span><span class=\"n\">pattern</span><span class=\"p\">]</span> <span class=\"n\">as</span> <span class=\"n\">a</span> <span class=\"n\">@racket</span><span class=\"p\">[</span><span class=\"k\">match</span><span class=\"p\">]</span> <span class=\"n\">clause.</span>  <span class=\"n\">If</span> <span class=\"n\">no</span>\n<span class=\"n\">@racket</span><span class=\"p\">[</span><span class=\"n\">pred</span><span class=\"p\">]</span> <span class=\"n\">is</span> <span class=\"n\">provided</span><span class=\"o\">,</span> <span class=\"n\">then</span> <span class=\"k\">if</span> <span class=\"n\">the</span> <span class=\"k\">match</span> <span class=\"n\">succeeds</span><span class=\"o\">,</span> <span class=\"n\">the</span> <span class=\"n\">entire</span> <span class=\"n\">check</span>\n<span class=\"n\">succeeds.</span>  <span class=\"n\">For</span> <span class=\"n\">example</span><span class=\"o\">,</span> <span class=\"k\">this</span> <span class=\"n\">use</span> <span class=\"n\">succeeds:</span>\n\n<span class=\"n\">@interaction</span><span class=\"p\">[</span><span class=\"kd\">#:eval</span> <span class=\"n\">rackunit-eval</span>\n  <span class=\"p\">(</span><span class=\"n\">check-match</span> <span class=\"p\">(</span><span class=\"nb\">list</span> <span class=\"mi\">1</span> <span class=\"mi\">2</span> <span class=\"mi\">3</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"nb\">list</span> <span class=\"k\">_</span> <span class=\"k\">_</span> <span class=\"mi\">3</span><span class=\"p\">))</span>\n<span class=\"p\">]</span>\n\n<span class=\"n\">This</span> <span class=\"n\">check</span> <span class=\"n\">fails</span> <span class=\"n\">to</span> <span class=\"n\">match:</span>\n\n<span class=\"n\">@interaction</span><span class=\"p\">[</span><span class=\"kd\">#:eval</span> <span class=\"n\">rackunit-eval</span>\n  <span class=\"p\">(</span><span class=\"n\">check-match</span> <span class=\"p\">(</span><span class=\"nb\">list</span> <span class=\"mi\">1</span> <span class=\"mi\">2</span> <span class=\"mi\">3</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"nb\">list</span> <span class=\"k\">_</span> <span class=\"k\">_</span> <span class=\"mi\">4</span><span class=\"p\">))</span>\n<span class=\"p\">]</span>\n</pre></div>\n\n</div>\n\n<p>There are a few things going on here:</p>\n\n<ul>\n <li>\n  <p><code>@defform</code> tells Scribble that this is a new syntactic form that should be indexed. Scribble figures out the the name is <code>check-match</code>, and adds links for it to the table of contents and enters it in the search index.</p></li>\n <li>\n  <p><code>@racket[v]</code> tells Scribble to render <code>v</code> as Racket code, and Scribble is also smart enough to know that <code>v</code> is the same <code>v</code> in the definition, and creates a back link for it.</p></li>\n <li>\n  <p><code>@interaction[#:eval rackunit-eval ... ]</code> blocks indicate expressions that should be run, with their output rendered after them. This makes for beautiful docs with examples inline to show users exactly what their getting. To build the docs, we run:</p></li></ul>\n\n<div class=\"brush: bash\">\n <div class=\"pygments\">\n  <pre><span class=\"nv\">$ </span>./bin/raco setup collects/rackunit\n</pre></div>\n\n</div>\n\n<p>Then, the docs will appear in the local documentation directory. I can then open them up in a web browser and see the results (note the local url ending api.html; that&rsquo;s the local path to the documentation that&rsquo;s been installed):</p>\n\n<p>Looks good!</p>\n\n<h2 id=\"letting-racketeers-know\">Letting Racketeers Know</h2>\n\n<p>I packaged everything up in a <a href=\"https://github.com/jpolitz/racket/commit/023d2278c1bb9819451790d774ae8e67a5d46f22\">single commit</a>, and sent the whole thing off to the Racket folks with a <a href=\"https://github.com/plt/racket/pull/171\">pull request</a>. They then reviewed it and incorporated it into <a href=\"https://github.com/plt/racket/commit/e264e4148884f0675bd21e889525ccb7239eb4b4\">their HEAD</a> the next day.</p>\n\n<p>The Racket folks maintain a list of <a href=\"https://github.com/plt/racket/wiki/Intro-Projects\">Intro Projects</a>, so there&rsquo;s easy places to start if you want to follow this tutorial and get involved!</p>\n<!-- more-->\n\n<hr />\n\n<p>For reference, cross-ref with Greg&rsquo;s post on infrequent contributions to Racket: www.greghendershott.com/2013/04/a-guide-for-infrequent-contributors-to-racket.html</p>\n\n<p>— <em>Laurent, 30 April 2013</em></p>\n\n<hr />")) ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2011-04-30-racket-v511.md" . unix) f post (u . "Racket v5.1.1") (? . 1) 1467223812 (p+ #"/Users/MB/git/racket-lang-org/blog/2011/04/racket-v511.html" . unix) "/2011/04/racket-v511.html" (u . "2011-04-30T04:19:00.002-04:00") (? . 18) (? . 0) (c (u . "")) (u . "\n<p><em>posted by Eli Barzilay</em></p>\n\n<p>Racket version 5.1.1 is now available from <a href=\"http://racket-lang.org/\">http://racket-lang.org/</a></p>\n\n<ul>\n <li>\n  <p>The new <code>racket/stream</code> library provides <code>stream-first</code>, <code>stream-rest</code>, a lazy <code>stream-cons</code>, and so on. Streams are a subtype of sequences, so they work in <code>for</code> forms. Some sequence generators, such as <code>in-range</code>, now produce streams. A <code>racket/sequence</code> library replaces the old <code>racket/stream</code> library.</p></li>\n <li>\n  <p>The new <code>racket/syntax</code> library contains facilities useful for writing macros. The new <code>syntax/srcloc</code> and <code>syntax/location</code> libraries provide support for manipulating source locations.</p></li>\n <li>\n  <p>The <code>racket/gui</code> library now supports multi-column list boxes and scrolling panels.</p></li>\n <li>\n  <p>The new <code>ffi/file</code> library is useful for writing foreign library bindings that cooperate with Racket&rsquo;s security guard mechanism.</p></li>\n <li>\n  <p>Generators from the <code>racket/generator</code> library can now have formal arguments that are used when the generator is fired up.</p></li>\n <li>\n  <p>Single-precision floating-point support is now enabled by default. Single-precision floats print differently from their default double-precision counterparts, new primitives convert between the two precisions, and new reader syntax supports single-precision literals.</p></li>\n <li>\n  <p>JIT improvements include a small change to aid x86 branch prediction on function-call returns, which can speed up some programs significantly.</p></li>\n <li>\n  <p>Typed Racket:</p></li>\n <li>\n  <p>The numeric tower has been entirely overhauled. TR programs can now use more precise types than before, and check more numeric properties, such as sign or range properties.</p></li>\n <li>\n  <p>Fixnum optimizations have been improved and should apply more broadly.</p></li>\n <li>\n  <p>The performance of the typechecker has been improved. In particular, dispatch on large union types should typecheck much faster than before.</p></li>\n <li>\n  <p>The Stepper can now step through Lazy Racket programs.</p></li>\n <li>\n  <p>The <code>racket/future</code> library includes <code>fsemaphore</code> values, the <code>future</code> primitive no longer freezes futures (so a future can spawn new futures), and <code>future</code> log messages are more informative.</p></li>\n <li>\n  <p>PLaneT development links are now version-specific.</p></li>\n <li>\n  <p>The <code>2htdp/image</code> library now includes <code>overlay/align</code>, <code>underlay/align</code>, <code>overlay/align/offset</code> and <code>underlay/align/offset</code>.</p></li>\n <li>\n  <p>The network protocol for universes in <code>2htdp/universe</code> has changed, so that v5.1.1 is incompatible with earlier versions.</p></li>\n <li>\n  <p>The &ldquo;DrScheme&rdquo; application (which simply ran DrRacket in the last few releases) has been removed. The &ldquo;MrEd&rdquo; GUI executables for Windows and Mac OS X have also been removed, although the &ldquo;mred&rdquo; console executable remains for Unix and Mac OS X to support old scripts.</p></li></ul>") #t (u . "\n<p><em>posted by Eli Barzilay</em></p>\n\n<p>Racket version 5.1.1 is now available from <a href=\"http://racket-lang.org/\">http://racket-lang.org/</a></p>\n\n<ul>\n <li>\n  <p>The new <code>racket/stream</code> library provides <code>stream-first</code>, <code>stream-rest</code>, a lazy <code>stream-cons</code>, and so on. Streams are a subtype of sequences, so they work in <code>for</code> forms. Some sequence generators, such as <code>in-range</code>, now produce streams. A <code>racket/sequence</code> library replaces the old <code>racket/stream</code> library.</p></li>\n <li>\n  <p>The new <code>racket/syntax</code> library contains facilities useful for writing macros. The new <code>syntax/srcloc</code> and <code>syntax/location</code> libraries provide support for manipulating source locations.</p></li>\n <li>\n  <p>The <code>racket/gui</code> library now supports multi-column list boxes and scrolling panels.</p></li>\n <li>\n  <p>The new <code>ffi/file</code> library is useful for writing foreign library bindings that cooperate with Racket&rsquo;s security guard mechanism.</p></li>\n <li>\n  <p>Generators from the <code>racket/generator</code> library can now have formal arguments that are used when the generator is fired up.</p></li>\n <li>\n  <p>Single-precision floating-point support is now enabled by default. Single-precision floats print differently from their default double-precision counterparts, new primitives convert between the two precisions, and new reader syntax supports single-precision literals.</p></li>\n <li>\n  <p>JIT improvements include a small change to aid x86 branch prediction on function-call returns, which can speed up some programs significantly.</p></li>\n <li>\n  <p>Typed Racket:</p></li>\n <li>\n  <p>The numeric tower has been entirely overhauled. TR programs can now use more precise types than before, and check more numeric properties, such as sign or range properties.</p></li>\n <li>\n  <p>Fixnum optimizations have been improved and should apply more broadly.</p></li>\n <li>\n  <p>The performance of the typechecker has been improved. In particular, dispatch on large union types should typecheck much faster than before.</p></li>\n <li>\n  <p>The Stepper can now step through Lazy Racket programs.</p></li>\n <li>\n  <p>The <code>racket/future</code> library includes <code>fsemaphore</code> values, the <code>future</code> primitive no longer freezes futures (so a future can spawn new futures), and <code>future</code> log messages are more informative.</p></li>\n <li>\n  <p>PLaneT development links are now version-specific.</p></li>\n <li>\n  <p>The <code>2htdp/image</code> library now includes <code>overlay/align</code>, <code>underlay/align</code>, <code>overlay/align/offset</code> and <code>underlay/align/offset</code>.</p></li>\n <li>\n  <p>The network protocol for universes in <code>2htdp/universe</code> has changed, so that v5.1.1 is incompatible with earlier versions.</p></li>\n <li>\n  <p>The &ldquo;DrScheme&rdquo; application (which simply ran DrRacket in the last few releases) has been removed. The &ldquo;MrEd&rdquo; GUI executables for Windows and Mac OS X have also been removed, although the &ldquo;mred&rdquo; console executable remains for Unix and Mac OS X to support old scripts.</p></li></ul>\n<!-- more-->\n\n<hr />\n\n<p>Are there plans to include a windows x86_64 version at some point? Thanks!</p>\n\n<p>— <em>deforce, 16 July 2011</em></p>\n\n<hr />\n\n<p>Yes, we now have a Windows x86_64 build. You can try a nightly build (http://pre.racket-lang.org/installers) or wait for the next version which should be out very soon.</p>\n\n<p>— <em>Eli Barzilay, 17 July 2011</em></p>\n\n<hr />")) ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2008-10-05-plt-scheme-v411.md" . unix) f post (u . "PLT Scheme v4.1.1") (? . 53) 1467223812 (p+ #"/Users/MB/git/racket-lang-org/blog/2008/10/plt-scheme-v411.html" . unix) "/2008/10/plt-scheme-v411.html" (u . "2008-10-05T16:34:00.001-04:00") (? . 52) (? . 12) (c (u . "")) (u . "\n<p><em>posted by Eli Barzilay</em></p>\n\n<p>PLT Scheme version 4.1.1 is now available from  <a href=\"http://plt-scheme.org/\">http://plt-scheme.org/</a>Notable changes:</p>\n\n<ul>\n <li>\n  <p>web-server: New servlet development tutorial; quick launching of servlets from DrScheme via the `web-server/insta&rsquo; language; new form abstraction through formlets.</p></li>\n <li>\n  <p>misc: mzc can &ldquo;decompile&rdquo; bytecode files; `#lang&rsquo; lines wired to the top of DrScheme&rsquo;s definition window; improved searching in DrScheme; some foreign interface extensions.[Note that mirror sites can take a while to catch up with the new downloads.]</p></li></ul>\n\n<p>Feedback Welcome.</p>") #f (u . "\n<p><em>posted by Eli Barzilay</em></p>\n\n<p>PLT Scheme version 4.1.1 is now available from  <a href=\"http://plt-scheme.org/\">http://plt-scheme.org/</a>Notable changes:</p>\n\n<ul>\n <li>\n  <p>web-server: New servlet development tutorial; quick launching of servlets from DrScheme via the `web-server/insta&rsquo; language; new form abstraction through formlets.</p></li>\n <li>\n  <p>misc: mzc can &ldquo;decompile&rdquo; bytecode files; `#lang&rsquo; lines wired to the top of DrScheme&rsquo;s definition window; improved searching in DrScheme; some foreign interface extensions.[Note that mirror sites can take a while to catch up with the new downloads.]</p></li></ul>\n\n<p>Feedback Welcome.</p>")) ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2010-04-02-plt-scheme-v425.md" . unix) f post (u . "PLT Scheme v4.2.5") (? . 35) 1467223812 (p+ #"/Users/MB/git/racket-lang-org/blog/2010/04/plt-scheme-v425.html" . unix) "/2010/04/plt-scheme-v425.html" (u . "2010-04-02T21:51:00.001-04:00") (? . 34) (? . 50) (c (u . "")) (u . "\n<p><em>posted by Eli Barzilay</em></p>\n\n<p>PLT Scheme version 4.2.5 is now available from <a href=\"http://plt-scheme.org/\"><code>http://plt-scheme.org/</code></a></p>\n\n<ul>\n <li>PLT now supports multi-core parallelism via futures. Futures create tasks that run in parallel, as long as the tasks stay in the &ldquo;fast path&rdquo; of the runtime system. For more information, see <a href=\"http://docs.plt-scheme.org/guide/performance.html?q=future#%28part._effective-futures%29\">the guide</a>.</li>\n <li>Our unit testing framework, schemeunit, is now included in the distribution. A graphical test runner is available via <code>schemeunit/gui</code>.</li>\n <li>The support languages for the &ldquo;Programming Languages: Application and Interpretation&rdquo; textbook by Shriram Krishnamurthi are now part of PLT Scheme. In addition the PLAI GC language comes with a random mutator generator (to help test collectors) and an improved heap visualizer.</li>\n <li>New Russian and Ukranian translations, thanks to Sergey Semerikov.</li>\n <li>A number of improvements to Redex&rsquo;s typesetting facilities.</li>\n <li>Typed Scheme users can now automatically generate predicates from types with <code>define-predicate</code>. Typed code can be inserted in untyped modules by requiring <code>with-type</code> from <code>typed/scheme</code>.</li>\n <li>The <code>scheme/class</code> library now provides contract combinators for classes (<code>class/c</code>) and objects (<code>object/c</code>). See the Reference and Guide for details. Also, a backwards-compatible <code>object-contract</code> version of <code>object/c</code> has replaced the old <code>object-contract</code> combinator.</li>\n <li>Writing new kinds of contracts is now easier with keyword-based constructors (<code>make-contract</code> and <code>make-flat-contract</code>), a simpler set of structure properties (<code>prop:contract</code> and <code>prop:flat-contract</code>), and the introduction of blame objects for tracking contract metadata.</li>\n <li>The Scheme-implemented bytecode reader fails less often. This is used by &ldquo;mzc &mdash;decompile&rdquo;. The Scheme-implemented bytecode writer uses the compact bytecode format and fails less often. This may be used in the future for Scheme-implement bytecode processors.</li>\n <li>The language dialog now suggests using \"#lang\" more strongly as the default language. DrScheme no longer uses the term `Module language&rsquo;.</li></ul>") #t (u . "\n<p><em>posted by Eli Barzilay</em></p>\n\n<p>PLT Scheme version 4.2.5 is now available from <a href=\"http://plt-scheme.org/\"><code>http://plt-scheme.org/</code></a></p>\n\n<ul>\n <li>PLT now supports multi-core parallelism via futures. Futures create tasks that run in parallel, as long as the tasks stay in the &ldquo;fast path&rdquo; of the runtime system. For more information, see <a href=\"http://docs.plt-scheme.org/guide/performance.html?q=future#%28part._effective-futures%29\">the guide</a>.</li>\n <li>Our unit testing framework, schemeunit, is now included in the distribution. A graphical test runner is available via <code>schemeunit/gui</code>.</li>\n <li>The support languages for the &ldquo;Programming Languages: Application and Interpretation&rdquo; textbook by Shriram Krishnamurthi are now part of PLT Scheme. In addition the PLAI GC language comes with a random mutator generator (to help test collectors) and an improved heap visualizer.</li>\n <li>New Russian and Ukranian translations, thanks to Sergey Semerikov.</li>\n <li>A number of improvements to Redex&rsquo;s typesetting facilities.</li>\n <li>Typed Scheme users can now automatically generate predicates from types with <code>define-predicate</code>. Typed code can be inserted in untyped modules by requiring <code>with-type</code> from <code>typed/scheme</code>.</li>\n <li>The <code>scheme/class</code> library now provides contract combinators for classes (<code>class/c</code>) and objects (<code>object/c</code>). See the Reference and Guide for details. Also, a backwards-compatible <code>object-contract</code> version of <code>object/c</code> has replaced the old <code>object-contract</code> combinator.</li>\n <li>Writing new kinds of contracts is now easier with keyword-based constructors (<code>make-contract</code> and <code>make-flat-contract</code>), a simpler set of structure properties (<code>prop:contract</code> and <code>prop:flat-contract</code>), and the introduction of blame objects for tracking contract metadata.</li>\n <li>The Scheme-implemented bytecode reader fails less often. This is used by &ldquo;mzc &mdash;decompile&rdquo;. The Scheme-implemented bytecode writer uses the compact bytecode format and fails less often. This may be used in the future for Scheme-implement bytecode processors.</li>\n <li>The language dialog now suggests using \"#lang\" more strongly as the default language. DrScheme no longer uses the term `Module language&rsquo;.</li></ul>\n<!-- more-->\n\n<hr />\n\n<p>Just wondering&hellip;does the future hold a 64-bit version for OSX?</p>\n\n<p>— <em>Robert, 2 April 2010</em></p>\n\n<hr />")) ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2011-05-26-racket-on-floss-weekly.md" . unix) f post (u . "Racket on FLOSS Weekly") (? . 0) 1467223812 (p+ #"/Users/MB/git/racket-lang-org/blog/2011/05/racket-on-floss-weekly.html" . unix) "/2011/05/racket-on-floss-weekly.html" (u . "2011-05-26T08:21:00.004-04:00") (? . 1) (? . 10) (c (u . "")) (u . "\n<p><em>posted by Robby Findler</em></p>\n\n<p>Our own <a href=\"http://www.cs.utah.edu/~mflatt/\">Matthew Flatt</a> was interviewed about Racket <a href=\"http://twit.tv/floss167\">on FLOSS Weekly</a>. Also available on <a href=\"http://www.youtube.com/watch?v=vJGV7HaTdbg\">YouTube</a>.</p>") #t (u . "\n<p><em>posted by Robby Findler</em></p>\n\n<p>Our own <a href=\"http://www.cs.utah.edu/~mflatt/\">Matthew Flatt</a> was interviewed about Racket <a href=\"http://twit.tv/floss167\">on FLOSS Weekly</a>. Also available on <a href=\"http://www.youtube.com/watch?v=vJGV7HaTdbg\">YouTube</a>.</p>\n<!-- more-->\n\n<hr />\n\n<p>Audio for this episode and other information about FLOSS Weekly is available here.</p>\n\n<p>— <em>Jordan Henderson, 26 May 2011</em></p>\n\n<hr />\n\n<p>Thanks &mdash; I&rsquo;ve updated the post with the link.</p>\n\n<p>— <em>Eli Barzilay, 26 May 2011</em></p>\n\n<hr />\n\n<p>Thoroughly enjoyed this episode. When is the Racket book coming out? The online docs are great and the various books like PLAI and HTDP are wonderful, but I want more information on DSLs, continuations, hygenic macros and other advanced features of Racket that I probably don&rsquo;t even know exist.</p>\n\n<p>— <em>Dwayne R. Crooks, 27 May 2011</em></p>\n\n<hr />\n\n<p>The show was excellent&hellip; It really feels like the possibilities with Racket are unlimited :D</p>\n\n<p>— <em>Rodolfo, 27 May 2011</em></p>\n\n<hr />\n\n<p>Nice! Looking at this video I just got an idea of how to populate Racket more: With Screencasts!</p>\n\n<p>— <em>Hoornet, 3 June 2011</em></p>\n\n<hr />\n\n<p>Very illuminating&hellip; Incidentally this is the first FLOSS Video I&rsquo;ve seen, and I loved it.</p>\n\n<p>We&rsquo;re teaching the Principles of Programming Languages course here at our University in India using Racket&hellip; :)</p>\n\n<p>Cheers!</p>\n\n<p>— <em>Sankalp, 18 August 2011</em></p>\n\n<hr />")) ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2011-10-18-on-eval-in-dynamic-languages-generally-and-in-racket-specifically.md" . unix) f post (u . "On `eval` in dynamic languages generally and in Racket specifically") (? . 48) 1467223812 (p+ #"/Users/MB/git/racket-lang-org/blog/2011/10/on-eval-in-dynamic-languages-generally-and-in-racket-specifically.html" . unix) "/2011/10/on-eval-in-dynamic-languages-generally-and-in-racket-specifically.html" (u . "2011-10-18T14:28:00.004-04:00") (? . 111) (? . 20) (c (u . "")) (u . "\n<p><em>posted by Matthew Flatt</em></p>\n\n<p>The <code>eval</code> function is at the heart of a dynamic language, and it strikes many newcomers as an amazingly powerful tool. At the same time, experienced programmers avoid <code>eval</code>, because unnecessary use creates trouble. It&rsquo;s not easy to explain why <code>eval</code> should be avoided or when it\"s appropriate to use <code>eval</code>, but I&rsquo;ll take another stab at it here.</p>\n\n<h2 id=\"what-is-eval\">What is <code>eval</code>?</h2>\n\n<p>Consider the following &ldquo;program&rdquo; in English prose:</p>\n\n<blockquote>\n <p>Assume that your favorite color is red. Now imagine a balloon that is  your favorite color. Paint a canvas the same color as the balloon.</p></blockquote>\n\n<p>As English goes, that&rsquo;s a fairly clear program with a fairly well-defined result. When I follow those instructions, at least, I will always produce a red canvas (assuming that I have a canvas and some red paint, but a potential lack of art supplies is not the point here).</p>\n\n<p>I would come up with a red canvas even if I read the instructions when surrounded by people who speak only Chinese, obviously, since I&rsquo;m the one reading the instructions. Furthermore, it would be straightforward to translate the program to Chinese, and then a person who reads Chinese would produce a red canvas.</p>\n\n<p>A translator might even take the liberty of simplifying the program to just</p>\n\n<blockquote>\n <p>Paint a canvas red.</p></blockquote>\n\n<p>The translation loses some of the poetry of the original, but the result is the same.</p>\n\n<p>In Racket terms, the paragraph corresponds to a module. It can be compiled (i.e., translated) and optimized (i.e., simplified). A program can be made up of multiple modules that are written in different languages, but since each module can be reliably translated, they can all be compiled into some common language to run the program.</p>\n\n<p>Here&rsquo;s a different program:</p>\n\n<blockquote>\n <p>Tell the person next to you &ldquo;Assume that your favorite color is red.&rdquo; Tell the person &ldquo;Now, imagine a balloon that is your favorite color.&rdquo; Tell the person &ldquo;Paint canvas the same color as the balloon.&rdquo;</p></blockquote>\n\n<p>Getting a red canvas back may be a little trickier in this case. If the person next to me speaks only Chinese, then my program may fail with a message-not-understood error.</p>\n\n<p>If I want to translate the program to Chinese, then it&rsquo;s not clear whether the parts in quotes should be translated. Maybe I mean for a person who can read Chinese but only sound out English to run the program when surrounded by English speakers, or maybe I mean for a Chinese person to run the program when surrounded by Chinese people. Either way, I have to be a lot more specific to a translator. For more complex programs, the instructions to the translator can become complex and fragile.</p>\n\n<p>Finally, a translator probably won&rsquo;t feel comfortable simplifying the program to</p>\n\n<blockquote>\n <p>Tell the person next to you &ldquo;Paint a canvas red.&rdquo;</p></blockquote>\n\n<p>because there could be all sorts of environmental conditions that make the result different&mdash;such as people who are willing to paint but unwilling to accept assumptions about their favorite colors.</p>\n\n<p>The paragraph with &ldquo;tell the person&hellip;&rdquo; is a program that uses <code>eval</code>. It can&rsquo;t be compiled and optimized as well as the earlier paragraph, and the language context in which it is run may change the result. The quotes around sentences correspond to the quote in front of an expression passed to <code>eval</code> in Racket; there&rsquo;s no particular reason that the language for <code>eval</code> will match the language of the program that has the quoted text. The issues become even more complex if you try to implement different parts of the program in different languages.</p>\n\n<p>If the analogy to multiple spoken languages seems strange&mdash;maybe your language is Javascript, period&mdash;the problem of translation to another language is really a proxy for program understanding. There&rsquo;s a direct connection to performance and optimization (i.e., translation to efficient machine code), but using <code>eval</code> also makes a program more difficult to understand for the same reasons that it makes the program more difficult to translate. For example, a reader of your program may not be able to tell whether &ldquo;assume your favorite color is red&rdquo; is just a rhetorical device to get to a red canvas or whether some new instructions will arrive that will ask for your favorite color.</p>\n\n<h2 id=\"when-is-eval-good\">When is <code>eval</code> Good?</h2>\n\n<p>The program with &ldquo;tell the person next to you&rdquo; above uses <code>eval</code> in a bad way. The task could just as well be performed by the person reading the instructions, instead of getting another nearby person involved.</p>\n\n<p>Some other uses <code>eval</code> are both good and necessary. For example, consider the following program:</p>\n\n<blockquote>\n <p>Ask the construction manager for instructions. Walk to the building  site and convey those instructions to the construction crew.</p></blockquote>\n\n<p>This program uses <code>eval</code> when it conveys instructions to the construction crew, but no quoted forms appear in the program. The absence of quoted code is one sign that <code>eval</code> may be appropriate. Note that the program could work no matter what language the manager and crew speak, although there is an implicit (and sometimes non-trivial) assumption that the manager and crew speak the same language.</p>\n\n<p>Here&rsquo;s another example:</p>\n\n<blockquote>\n <p>Go outside, and tell each member of the construction crew &ldquo;take a  lunch break, now.&rdquo;</p></blockquote>\n\n<p>There&rsquo;s a quoted program in this case, but it&rsquo;s crucial to ask other people to run the quoted program, instead of just taking the lunch break yourself. That is, <code>eval</code> is really necessary. The implementor of this program takes on the burden of making sure that the instructions are in a suitable language, however, and may need to parameterize the quoted program by an explicit action to translate it to a language understood by the construction crew.</p>\n\n<p>Here&rsquo;s one more reasonable example:</p>\n\n<blockquote>\n <p>Ask the construction manager for instructions. Follow them.</p></blockquote>\n\n<p>In this case, it&rsquo;s the construction manager&rsquo;s problem to give you instructions in a language that you understand.</p>\n\n<p>Here&rsquo;s a questionable example:</p>\n\n<blockquote>\n <p>Decide how long to work before lunch, say N hours, and write a note  to yourself to work N hours. Add to the note by telling yourself to  take a lunch break afterward.</p></blockquote>\n\n<p>If you could really write that program without quotes, then it&rsquo;s probably ok. The example is misleading, though, because languages don&rsquo;t usually support</p>\n\n<blockquote>\n <p>write a note to yourself to work N hours</p></blockquote>\n\n<p>You&rsquo;d have to write instead</p>\n\n<blockquote>\n <p>write a note to yourself that says &ldquo;work&rdquo; followed by the number N  and then &ldquo;hours&rdquo;</p></blockquote>\n\n<p>and the quote marks are where the problem comes in. If you translate the program to Chinese, then you have to be careful to somehow translate &ldquo;work&rdquo; and &ldquo;hours&rdquo; to Chinese, too.</p>\n\n<p>The point here is not that programs without quoted text are clearly good or that programs with quoted text are clearly bad. The real point is that a programmer has to be especially careful about passing around instructions and using quoted instructions. Using <code>eval</code> means accepting the burden of using instructions will make sense by the time they are delivered. That burdened is best avoided, which is why experienced programmers avoid <code>eval</code>, but some of the examples illustrate cases where the burden is not avoidable or where the actions enabled by <code>eval</code> make the burden worthwhile.</p>\n\n<h2 id=\"using-eval-in-racket\">Using <code>eval</code> in Racket</h2>\n\n<p>In the context of Racket, the multiple-language analogy is relatively accurate, because Racket is about having many programming languages work together and allowing programmers to define ever better languages and language constructs. In Racket, it&rsquo;s especially likely that a library written in one language is used in a context where another language is the default.</p>\n\n<p>Newcomers to Racket sometimes stumble over the fact that</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre> <span class=\"kn\">#lang </span><span class=\"nn\">racket</span>\n <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"n\">my-x</span> <span class=\"mi\">1</span><span class=\"p\">)</span>\n <span class=\"p\">(</span><span class=\"nb\">eval</span> <span class=\"o\">&#39;</span><span class=\"p\">(</span><span class=\"ss\">+</span> <span class=\"ss\">my-x</span> <span class=\"mi\">2</span><span class=\"p\">))</span>\n</pre></div>\n\n</div>\n\n<p>or even</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre> <span class=\"kn\">#lang </span><span class=\"nn\">racket</span>\n <span class=\"p\">(</span><span class=\"nb\">eval</span> <span class=\"o\">&#39;</span><span class=\"p\">(</span><span class=\"ss\">+</span> <span class=\"mi\">1</span> <span class=\"mi\">2</span><span class=\"p\">))</span>\n</pre></div>\n\n</div>\n\n<p>does not work at all, and yet if the program</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre> <span class=\"kn\">#lang </span><span class=\"nn\">racket</span>\n <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"n\">my-x</span> <span class=\"mi\">1</span><span class=\"p\">)</span>\n</pre></div>\n\n</div>\n\n<p>is loaded into a read-eval-print loop&mdash;for example, by clicking the &ldquo;Run&rdquo; button in DrRacket and then typing into the lower interactions panel&mdash;then</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre> <span class=\"p\">(</span><span class=\"nb\">eval</span> <span class=\"o\">&#39;</span><span class=\"p\">(</span><span class=\"ss\">+</span> <span class=\"ss\">my-x</span> <span class=\"mi\">2</span><span class=\"p\">))</span>\n</pre></div>\n\n</div>\n\n<p>works as expected.</p>\n\n<p>DrRacket&rsquo;s interactions window has to use <code>eval</code> in the sense that it reads an expression to evaluate and then passes it on to the interpreter for an answer. More generally, to make various pieces of the environment fit together, DrRacket sets <code>eval</code> globally to use the module&rsquo;s language while evaluating expressions in the interactions window. In Racket terminology, DrRacket sets the <code>current-namespace</code> parameter to the module&rsquo;s namespace when it initializes the interactions window. In contrast, while the module body is being evaluated, <code>eval</code> treats expressions as being in the language that is empty by default, which is why <code>eval</code> during the module evaluation produces a different result from <code>eval</code> during the interactions windows.</p>\n\n<p>You may wonder why DrRacket doesn&rsquo;t initialize the namespace of <code>eval</code> to be the module&rsquo;s namespace from the start, so that in-module uses of <code>eval</code> and the interactions window behave the same. In a program that is implemented by multiple modules, which module&rsquo;s language should be used? In particular, if the language it&rsquo;s always the main module&rsquo;s language, then a module may behave differently on its own than as part of a larger program. In the process of developing Racket and DrRacket, we&rsquo;ve seen many such problems, and so Racket now arranges for the default language to be empty (which is different from any useful language) to help programmers remember that there&rsquo;s a language issue to consider whenever <code>eval</code> is used.</p>\n\n<p>The Racket Guide&rsquo;s chapter 15 covers in more depth the issues and namespace tools of Racket for harnessing the power of <code>eval</code>:</p>\n\n<p> <a href=\"http://docs.racket-lang.org/guide/reflection.html\">http://docs.racket-lang.org/guide/reflection.html</a></p>\n\n<p>Think of <code>eval</code> as a power tool. For some tasks, there&rsquo;s no real substitute, and so we want <code>eval</code> around. At the same time, <code>eval</code> should be used with care. In dynamic languages generally, that means a reluctant and targeted use <code>eval</code>. In Racket specifically, it means knowing the namespace toolbox and being as explicit as possible about the intended context for dynamic evaluation.</p>") #t (u . "\n<p><em>posted by Matthew Flatt</em></p>\n\n<p>The <code>eval</code> function is at the heart of a dynamic language, and it strikes many newcomers as an amazingly powerful tool. At the same time, experienced programmers avoid <code>eval</code>, because unnecessary use creates trouble. It&rsquo;s not easy to explain why <code>eval</code> should be avoided or when it\"s appropriate to use <code>eval</code>, but I&rsquo;ll take another stab at it here.</p>\n\n<h2 id=\"what-is-eval\">What is <code>eval</code>?</h2>\n\n<p>Consider the following &ldquo;program&rdquo; in English prose:</p>\n\n<blockquote>\n <p>Assume that your favorite color is red. Now imagine a balloon that is  your favorite color. Paint a canvas the same color as the balloon.</p></blockquote>\n\n<p>As English goes, that&rsquo;s a fairly clear program with a fairly well-defined result. When I follow those instructions, at least, I will always produce a red canvas (assuming that I have a canvas and some red paint, but a potential lack of art supplies is not the point here).</p>\n\n<p>I would come up with a red canvas even if I read the instructions when surrounded by people who speak only Chinese, obviously, since I&rsquo;m the one reading the instructions. Furthermore, it would be straightforward to translate the program to Chinese, and then a person who reads Chinese would produce a red canvas.</p>\n\n<p>A translator might even take the liberty of simplifying the program to just</p>\n\n<blockquote>\n <p>Paint a canvas red.</p></blockquote>\n\n<p>The translation loses some of the poetry of the original, but the result is the same.</p>\n\n<p>In Racket terms, the paragraph corresponds to a module. It can be compiled (i.e., translated) and optimized (i.e., simplified). A program can be made up of multiple modules that are written in different languages, but since each module can be reliably translated, they can all be compiled into some common language to run the program.</p>\n\n<p>Here&rsquo;s a different program:</p>\n\n<blockquote>\n <p>Tell the person next to you &ldquo;Assume that your favorite color is red.&rdquo; Tell the person &ldquo;Now, imagine a balloon that is your favorite color.&rdquo; Tell the person &ldquo;Paint canvas the same color as the balloon.&rdquo;</p></blockquote>\n\n<p>Getting a red canvas back may be a little trickier in this case. If the person next to me speaks only Chinese, then my program may fail with a message-not-understood error.</p>\n\n<p>If I want to translate the program to Chinese, then it&rsquo;s not clear whether the parts in quotes should be translated. Maybe I mean for a person who can read Chinese but only sound out English to run the program when surrounded by English speakers, or maybe I mean for a Chinese person to run the program when surrounded by Chinese people. Either way, I have to be a lot more specific to a translator. For more complex programs, the instructions to the translator can become complex and fragile.</p>\n\n<p>Finally, a translator probably won&rsquo;t feel comfortable simplifying the program to</p>\n\n<blockquote>\n <p>Tell the person next to you &ldquo;Paint a canvas red.&rdquo;</p></blockquote>\n\n<p>because there could be all sorts of environmental conditions that make the result different&mdash;such as people who are willing to paint but unwilling to accept assumptions about their favorite colors.</p>\n\n<p>The paragraph with &ldquo;tell the person&hellip;&rdquo; is a program that uses <code>eval</code>. It can&rsquo;t be compiled and optimized as well as the earlier paragraph, and the language context in which it is run may change the result. The quotes around sentences correspond to the quote in front of an expression passed to <code>eval</code> in Racket; there&rsquo;s no particular reason that the language for <code>eval</code> will match the language of the program that has the quoted text. The issues become even more complex if you try to implement different parts of the program in different languages.</p>\n\n<p>If the analogy to multiple spoken languages seems strange&mdash;maybe your language is Javascript, period&mdash;the problem of translation to another language is really a proxy for program understanding. There&rsquo;s a direct connection to performance and optimization (i.e., translation to efficient machine code), but using <code>eval</code> also makes a program more difficult to understand for the same reasons that it makes the program more difficult to translate. For example, a reader of your program may not be able to tell whether &ldquo;assume your favorite color is red&rdquo; is just a rhetorical device to get to a red canvas or whether some new instructions will arrive that will ask for your favorite color.</p>\n\n<h2 id=\"when-is-eval-good\">When is <code>eval</code> Good?</h2>\n\n<p>The program with &ldquo;tell the person next to you&rdquo; above uses <code>eval</code> in a bad way. The task could just as well be performed by the person reading the instructions, instead of getting another nearby person involved.</p>\n\n<p>Some other uses <code>eval</code> are both good and necessary. For example, consider the following program:</p>\n\n<blockquote>\n <p>Ask the construction manager for instructions. Walk to the building  site and convey those instructions to the construction crew.</p></blockquote>\n\n<p>This program uses <code>eval</code> when it conveys instructions to the construction crew, but no quoted forms appear in the program. The absence of quoted code is one sign that <code>eval</code> may be appropriate. Note that the program could work no matter what language the manager and crew speak, although there is an implicit (and sometimes non-trivial) assumption that the manager and crew speak the same language.</p>\n\n<p>Here&rsquo;s another example:</p>\n\n<blockquote>\n <p>Go outside, and tell each member of the construction crew &ldquo;take a  lunch break, now.&rdquo;</p></blockquote>\n\n<p>There&rsquo;s a quoted program in this case, but it&rsquo;s crucial to ask other people to run the quoted program, instead of just taking the lunch break yourself. That is, <code>eval</code> is really necessary. The implementor of this program takes on the burden of making sure that the instructions are in a suitable language, however, and may need to parameterize the quoted program by an explicit action to translate it to a language understood by the construction crew.</p>\n\n<p>Here&rsquo;s one more reasonable example:</p>\n\n<blockquote>\n <p>Ask the construction manager for instructions. Follow them.</p></blockquote>\n\n<p>In this case, it&rsquo;s the construction manager&rsquo;s problem to give you instructions in a language that you understand.</p>\n\n<p>Here&rsquo;s a questionable example:</p>\n\n<blockquote>\n <p>Decide how long to work before lunch, say N hours, and write a note  to yourself to work N hours. Add to the note by telling yourself to  take a lunch break afterward.</p></blockquote>\n\n<p>If you could really write that program without quotes, then it&rsquo;s probably ok. The example is misleading, though, because languages don&rsquo;t usually support</p>\n\n<blockquote>\n <p>write a note to yourself to work N hours</p></blockquote>\n\n<p>You&rsquo;d have to write instead</p>\n\n<blockquote>\n <p>write a note to yourself that says &ldquo;work&rdquo; followed by the number N  and then &ldquo;hours&rdquo;</p></blockquote>\n\n<p>and the quote marks are where the problem comes in. If you translate the program to Chinese, then you have to be careful to somehow translate &ldquo;work&rdquo; and &ldquo;hours&rdquo; to Chinese, too.</p>\n\n<p>The point here is not that programs without quoted text are clearly good or that programs with quoted text are clearly bad. The real point is that a programmer has to be especially careful about passing around instructions and using quoted instructions. Using <code>eval</code> means accepting the burden of using instructions will make sense by the time they are delivered. That burdened is best avoided, which is why experienced programmers avoid <code>eval</code>, but some of the examples illustrate cases where the burden is not avoidable or where the actions enabled by <code>eval</code> make the burden worthwhile.</p>\n\n<h2 id=\"using-eval-in-racket\">Using <code>eval</code> in Racket</h2>\n\n<p>In the context of Racket, the multiple-language analogy is relatively accurate, because Racket is about having many programming languages work together and allowing programmers to define ever better languages and language constructs. In Racket, it&rsquo;s especially likely that a library written in one language is used in a context where another language is the default.</p>\n\n<p>Newcomers to Racket sometimes stumble over the fact that</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre> <span class=\"kn\">#lang </span><span class=\"nn\">racket</span>\n <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"n\">my-x</span> <span class=\"mi\">1</span><span class=\"p\">)</span>\n <span class=\"p\">(</span><span class=\"nb\">eval</span> <span class=\"o\">&#39;</span><span class=\"p\">(</span><span class=\"ss\">+</span> <span class=\"ss\">my-x</span> <span class=\"mi\">2</span><span class=\"p\">))</span>\n</pre></div>\n\n</div>\n\n<p>or even</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre> <span class=\"kn\">#lang </span><span class=\"nn\">racket</span>\n <span class=\"p\">(</span><span class=\"nb\">eval</span> <span class=\"o\">&#39;</span><span class=\"p\">(</span><span class=\"ss\">+</span> <span class=\"mi\">1</span> <span class=\"mi\">2</span><span class=\"p\">))</span>\n</pre></div>\n\n</div>\n\n<p>does not work at all, and yet if the program</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre> <span class=\"kn\">#lang </span><span class=\"nn\">racket</span>\n <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"n\">my-x</span> <span class=\"mi\">1</span><span class=\"p\">)</span>\n</pre></div>\n\n</div>\n\n<p>is loaded into a read-eval-print loop&mdash;for example, by clicking the &ldquo;Run&rdquo; button in DrRacket and then typing into the lower interactions panel&mdash;then</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre> <span class=\"p\">(</span><span class=\"nb\">eval</span> <span class=\"o\">&#39;</span><span class=\"p\">(</span><span class=\"ss\">+</span> <span class=\"ss\">my-x</span> <span class=\"mi\">2</span><span class=\"p\">))</span>\n</pre></div>\n\n</div>\n\n<p>works as expected.</p>\n\n<p>DrRacket&rsquo;s interactions window has to use <code>eval</code> in the sense that it reads an expression to evaluate and then passes it on to the interpreter for an answer. More generally, to make various pieces of the environment fit together, DrRacket sets <code>eval</code> globally to use the module&rsquo;s language while evaluating expressions in the interactions window. In Racket terminology, DrRacket sets the <code>current-namespace</code> parameter to the module&rsquo;s namespace when it initializes the interactions window. In contrast, while the module body is being evaluated, <code>eval</code> treats expressions as being in the language that is empty by default, which is why <code>eval</code> during the module evaluation produces a different result from <code>eval</code> during the interactions windows.</p>\n\n<p>You may wonder why DrRacket doesn&rsquo;t initialize the namespace of <code>eval</code> to be the module&rsquo;s namespace from the start, so that in-module uses of <code>eval</code> and the interactions window behave the same. In a program that is implemented by multiple modules, which module&rsquo;s language should be used? In particular, if the language it&rsquo;s always the main module&rsquo;s language, then a module may behave differently on its own than as part of a larger program. In the process of developing Racket and DrRacket, we&rsquo;ve seen many such problems, and so Racket now arranges for the default language to be empty (which is different from any useful language) to help programmers remember that there&rsquo;s a language issue to consider whenever <code>eval</code> is used.</p>\n\n<p>The Racket Guide&rsquo;s chapter 15 covers in more depth the issues and namespace tools of Racket for harnessing the power of <code>eval</code>:</p>\n\n<p> <a href=\"http://docs.racket-lang.org/guide/reflection.html\">http://docs.racket-lang.org/guide/reflection.html</a></p>\n\n<p>Think of <code>eval</code> as a power tool. For some tasks, there&rsquo;s no real substitute, and so we want <code>eval</code> around. At the same time, <code>eval</code> should be used with care. In dynamic languages generally, that means a reluctant and targeted use <code>eval</code>. In Racket specifically, it means knowing the namespace toolbox and being as explicit as possible about the intended context for dynamic evaluation.</p>\n<!-- more-->\n\n<hr />\n\n<p>Coming from a security analysis background, I appreciate the arguments about analyzability.</p>\n\n<p>You might be interested in my related response to &ldquo;What do you wish language designers paid attention to?&rdquo;. The bit excerpted below touches on the same points &mdash; quoting confusion is hard, eval can be bounded, the environment in which the evaled code should be run is often not the environment in which eval is invoked.</p>\n\n<p>\"\"\"</p>\n\n<p>Please make your language analyzable/auditable for computer security people.</p>\n\n<p>&hellip;</p>\n\n<p>Limit the authority of embedded scripting languages</p>\n\n<p>A lot of useful systems are organized as a static core that kicks off a lot of code written in dynamic (even functional) languages.</p>\n\n<p>And embedding scripting languages can make a system much more extensible.</p>\n\n<p>But a scripting language shouldn&rsquo;t have the full authority of the VM.</p>\n\n<p>If you choose to allow embedded scripting languages, make it easy for the invoker to limit what they can do. An object-capabilities model (see comment on Newspeak above) is very appropriate here ; so when evaluating code in a scripting language, the caller should pass in the code to execute and all the global variables for that code.</p>\n\n<p>Treat eval as a language embedding itself as a scripting language</p>\n\n<p>If your language can invoke its own compiler to turn a string into code, then allow it to be sandboxed the same as you would any embedded scripting language.</p>\n\n<p>&hellip;</p>\n\n<p>Don&rsquo;t encourage quoting confusion</p>\n\n<p>\"\"\"</p>\n\n<p>cheers</p>\n\n<p>— <em>Mike Samuel, 19 October 2011</em></p>\n\n<hr />\n\n<p>Typo:</p>\n\n<p>I think there&rsquo;s a problem with the following sentence:</p>\n\n<p>Using eval means accepting the burden of using instructions will make sense by the time they are delivered</p>\n\n<p>Perhaps the word &ldquo;that&rdquo; between &ldquo;instructions&rdquo; and &ldquo;will&rdquo;?</p>\n\n<p>— <em>Hendrik Boom, 27 April 2014</em></p>\n\n<hr />")) ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2007-12-19-your-security-hole-is-my-fun-hack-or-computing-factorial-in-drscheme-with-a-click-powered-loop.md" . unix) f post (u . "Your security hole is my fun hack, or: computing factorial in DrScheme with a click-powered loop.") (? . 25) 1467223812 (p+ #"/Users/MB/git/racket-lang-org/blog/2007/12/your-security-hole-is-my-fun-hack-or-computing-factorial-in-drscheme-with-a-click-powered-loop.html" . unix) "/2007/12/your-security-hole-is-my-fun-hack-or-computing-factorial-in-drscheme-with-a-click-powered-loop.html" (u . "2007-12-19T17:11:00.000-05:00") (? . 24) (? . 6) (c (u . "")) (u . "\n<p><em>posted by Robby Findler</em></p>\n\n<p>One of the many changes in v4.0 is to close a security hole in DrScheme. Specifically, DrScheme v371 lets the program in the definitions window get a hold of the editor containing said program and manipulate it programmatically. There are lots of bad things one might do with this fact, like circumventing DrScheme&rsquo;s protections and cause it to crash, or even spontaneously exit.</p>\n\n<p>But, we can do something even more fun. Put the following program into a DrScheme window (in v371) and set the language to the mzscheme/textual language. Change &ldquo;input&rdquo; to whatever number you wish to compute the factorial of and then hit the Run button until your program transforms itself into the final result.</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"n\">input</span> <span class=\"mi\">10</span><span class=\"p\">)</span>\n<span class=\"p\">(</span><span class=\"k\">require</span> <span class=\"p\">(</span><span class=\"k\">lib</span> <span class=\"s2\">\"mred.ss\"</span> <span class=\"s2\">\"mred\"</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"k\">lib</span> <span class=\"s2\">\"class.ss\"</span><span class=\"p\">))</span>\n<span class=\"p\">(</span><span class=\"k\">let*</span> <span class=\"p\">([</span><span class=\"n\">ed</span> <span class=\"p\">(</span><span class=\"k\">let-syntax</span> <span class=\"p\">([</span><span class=\"n\">m</span> <span class=\"p\">(</span><span class=\"k\">λ</span> <span class=\"p\">(</span><span class=\"n\">stx</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"k\">with-syntax</span> <span class=\"p\">([</span><span class=\"n\">x</span> <span class=\"p\">(</span><span class=\"nb\">syntax-source</span> <span class=\"n\">stx</span><span class=\"p\">)])</span> <span class=\"o\">#&#39;</span><span class=\"n\">x</span><span class=\"p\">))])</span>\n             <span class=\"p\">(</span><span class=\"n\">m</span><span class=\"p\">))]</span>\n       <span class=\"p\">[</span><span class=\"n\">mth</span> <span class=\"p\">(</span><span class=\"nb\">regexp-match</span> \n             <span class=\"sr\">#rx\"^; ([0-9]+) ([0-9]+)\"</span> \n             <span class=\"p\">(</span><span class=\"k\">send</span> <span class=\"n\">ed</span> <span class=\"n\">get-text</span> <span class=\"mi\">0</span> \n                   <span class=\"p\">(</span><span class=\"k\">send</span> <span class=\"n\">ed</span> <span class=\"n\">paragraph-end-position</span> <span class=\"mi\">0</span><span class=\"p\">)))]</span>\n       <span class=\"p\">[</span><span class=\"n\">lckd</span> <span class=\"p\">(</span><span class=\"k\">send</span> <span class=\"n\">ed</span> <span class=\"n\">is-locked?</span><span class=\"p\">)])</span>\n  <span class=\"p\">(</span><span class=\"k\">send</span> <span class=\"n\">ed</span> <span class=\"n\">begin-edit-sequence</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"k\">send</span> <span class=\"n\">ed</span> <span class=\"n\">lock</span> <span class=\"no\">#f</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"k\">if</span> <span class=\"n\">mth</span>\n      <span class=\"p\">(</span><span class=\"k\">let</span> <span class=\"p\">([</span><span class=\"n\">n</span> <span class=\"p\">(</span><span class=\"nb\">string-&gt;number</span> <span class=\"p\">(</span><span class=\"nb\">list-ref</span> <span class=\"n\">mth</span> <span class=\"mi\">1</span><span class=\"p\">))]</span>\n            <span class=\"p\">[</span><span class=\"n\">acc</span> <span class=\"p\">(</span><span class=\"nb\">string-&gt;number</span> <span class=\"p\">(</span><span class=\"nb\">list-ref</span> <span class=\"n\">mth</span> <span class=\"mi\">2</span><span class=\"p\">))])</span>\n        <span class=\"p\">(</span><span class=\"k\">send</span> <span class=\"n\">ed</span> <span class=\"n\">delete</span> <span class=\"mi\">0</span> <span class=\"p\">(</span><span class=\"k\">send</span> <span class=\"n\">ed</span> <span class=\"n\">paragraph-end-position</span> <span class=\"mi\">0</span><span class=\"p\">))</span>\n        <span class=\"p\">(</span><span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"nb\">=</span> <span class=\"n\">n</span> <span class=\"mi\">1</span><span class=\"p\">)</span>\n            <span class=\"p\">(</span><span class=\"k\">begin</span> <span class=\"p\">(</span><span class=\"k\">send</span> <span class=\"n\">ed</span> <span class=\"n\">delete</span> <span class=\"mi\">0</span> <span class=\"p\">(</span><span class=\"k\">send</span> <span class=\"n\">ed</span> <span class=\"n\">paragraph-end-position</span> <span class=\"mi\">0</span><span class=\"p\">))</span>\n                   <span class=\"p\">(</span><span class=\"k\">send</span> <span class=\"n\">ed</span> <span class=\"n\">insert</span> <span class=\"p\">(</span><span class=\"nb\">format</span> <span class=\"s2\">\"~a</span><span class=\"se\">\\n</span><span class=\"s2\">#|\"</span> <span class=\"n\">acc</span><span class=\"p\">)</span> <span class=\"mi\">0</span><span class=\"p\">)</span>\n                   <span class=\"p\">(</span><span class=\"k\">send</span> <span class=\"n\">ed</span> <span class=\"n\">insert</span> <span class=\"s2\">\"</span><span class=\"se\">\\n</span><span class=\"s2\">|#\"</span> <span class=\"p\">(</span><span class=\"k\">send</span> <span class=\"n\">ed</span> <span class=\"n\">last-position</span><span class=\"p\">)))</span>\n            <span class=\"p\">(</span><span class=\"k\">begin</span> <span class=\"p\">(</span><span class=\"k\">send</span> <span class=\"n\">ed</span> <span class=\"n\">delete</span> <span class=\"mi\">0</span> <span class=\"p\">(</span><span class=\"k\">send</span> <span class=\"n\">ed</span> <span class=\"n\">paragraph-end-position</span> <span class=\"mi\">0</span><span class=\"p\">))</span>\n                   <span class=\"p\">(</span><span class=\"k\">send</span> <span class=\"n\">ed</span> <span class=\"n\">insert</span> <span class=\"p\">(</span><span class=\"nb\">format</span> <span class=\"s2\">\"; ~a ~a\"</span> <span class=\"p\">(</span><span class=\"nb\">-</span> <span class=\"n\">n</span> <span class=\"mi\">1</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"nb\">*</span> <span class=\"n\">n</span> <span class=\"n\">acc</span><span class=\"p\">))</span> <span class=\"mi\">0</span> <span class=\"mi\">0</span><span class=\"p\">))))</span>\n      <span class=\"p\">(</span><span class=\"k\">send</span> <span class=\"n\">ed</span> <span class=\"n\">insert</span> <span class=\"p\">(</span><span class=\"nb\">format</span> <span class=\"s2\">\"; ~a 1</span><span class=\"se\">\\n</span><span class=\"s2\">\"</span> <span class=\"n\">input</span><span class=\"p\">)</span> <span class=\"mi\">0</span><span class=\"p\">))</span>\n  <span class=\"p\">(</span><span class=\"k\">send</span> <span class=\"n\">ed</span> <span class=\"n\">lock</span> <span class=\"n\">lckd</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"k\">send</span> <span class=\"n\">ed</span> <span class=\"n\">end-edit-sequence</span><span class=\"p\">))</span>\n</pre></div>\n\n</div>") #t (u . "\n<p><em>posted by Robby Findler</em></p>\n\n<p>One of the many changes in v4.0 is to close a security hole in DrScheme. Specifically, DrScheme v371 lets the program in the definitions window get a hold of the editor containing said program and manipulate it programmatically. There are lots of bad things one might do with this fact, like circumventing DrScheme&rsquo;s protections and cause it to crash, or even spontaneously exit.</p>\n\n<p>But, we can do something even more fun. Put the following program into a DrScheme window (in v371) and set the language to the mzscheme/textual language. Change &ldquo;input&rdquo; to whatever number you wish to compute the factorial of and then hit the Run button until your program transforms itself into the final result.</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"n\">input</span> <span class=\"mi\">10</span><span class=\"p\">)</span>\n<span class=\"p\">(</span><span class=\"k\">require</span> <span class=\"p\">(</span><span class=\"k\">lib</span> <span class=\"s2\">\"mred.ss\"</span> <span class=\"s2\">\"mred\"</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"k\">lib</span> <span class=\"s2\">\"class.ss\"</span><span class=\"p\">))</span>\n<span class=\"p\">(</span><span class=\"k\">let*</span> <span class=\"p\">([</span><span class=\"n\">ed</span> <span class=\"p\">(</span><span class=\"k\">let-syntax</span> <span class=\"p\">([</span><span class=\"n\">m</span> <span class=\"p\">(</span><span class=\"k\">λ</span> <span class=\"p\">(</span><span class=\"n\">stx</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"k\">with-syntax</span> <span class=\"p\">([</span><span class=\"n\">x</span> <span class=\"p\">(</span><span class=\"nb\">syntax-source</span> <span class=\"n\">stx</span><span class=\"p\">)])</span> <span class=\"o\">#&#39;</span><span class=\"n\">x</span><span class=\"p\">))])</span>\n             <span class=\"p\">(</span><span class=\"n\">m</span><span class=\"p\">))]</span>\n       <span class=\"p\">[</span><span class=\"n\">mth</span> <span class=\"p\">(</span><span class=\"nb\">regexp-match</span> \n             <span class=\"sr\">#rx\"^; ([0-9]+) ([0-9]+)\"</span> \n             <span class=\"p\">(</span><span class=\"k\">send</span> <span class=\"n\">ed</span> <span class=\"n\">get-text</span> <span class=\"mi\">0</span> \n                   <span class=\"p\">(</span><span class=\"k\">send</span> <span class=\"n\">ed</span> <span class=\"n\">paragraph-end-position</span> <span class=\"mi\">0</span><span class=\"p\">)))]</span>\n       <span class=\"p\">[</span><span class=\"n\">lckd</span> <span class=\"p\">(</span><span class=\"k\">send</span> <span class=\"n\">ed</span> <span class=\"n\">is-locked?</span><span class=\"p\">)])</span>\n  <span class=\"p\">(</span><span class=\"k\">send</span> <span class=\"n\">ed</span> <span class=\"n\">begin-edit-sequence</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"k\">send</span> <span class=\"n\">ed</span> <span class=\"n\">lock</span> <span class=\"no\">#f</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"k\">if</span> <span class=\"n\">mth</span>\n      <span class=\"p\">(</span><span class=\"k\">let</span> <span class=\"p\">([</span><span class=\"n\">n</span> <span class=\"p\">(</span><span class=\"nb\">string-&gt;number</span> <span class=\"p\">(</span><span class=\"nb\">list-ref</span> <span class=\"n\">mth</span> <span class=\"mi\">1</span><span class=\"p\">))]</span>\n            <span class=\"p\">[</span><span class=\"n\">acc</span> <span class=\"p\">(</span><span class=\"nb\">string-&gt;number</span> <span class=\"p\">(</span><span class=\"nb\">list-ref</span> <span class=\"n\">mth</span> <span class=\"mi\">2</span><span class=\"p\">))])</span>\n        <span class=\"p\">(</span><span class=\"k\">send</span> <span class=\"n\">ed</span> <span class=\"n\">delete</span> <span class=\"mi\">0</span> <span class=\"p\">(</span><span class=\"k\">send</span> <span class=\"n\">ed</span> <span class=\"n\">paragraph-end-position</span> <span class=\"mi\">0</span><span class=\"p\">))</span>\n        <span class=\"p\">(</span><span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"nb\">=</span> <span class=\"n\">n</span> <span class=\"mi\">1</span><span class=\"p\">)</span>\n            <span class=\"p\">(</span><span class=\"k\">begin</span> <span class=\"p\">(</span><span class=\"k\">send</span> <span class=\"n\">ed</span> <span class=\"n\">delete</span> <span class=\"mi\">0</span> <span class=\"p\">(</span><span class=\"k\">send</span> <span class=\"n\">ed</span> <span class=\"n\">paragraph-end-position</span> <span class=\"mi\">0</span><span class=\"p\">))</span>\n                   <span class=\"p\">(</span><span class=\"k\">send</span> <span class=\"n\">ed</span> <span class=\"n\">insert</span> <span class=\"p\">(</span><span class=\"nb\">format</span> <span class=\"s2\">\"~a</span><span class=\"se\">\\n</span><span class=\"s2\">#|\"</span> <span class=\"n\">acc</span><span class=\"p\">)</span> <span class=\"mi\">0</span><span class=\"p\">)</span>\n                   <span class=\"p\">(</span><span class=\"k\">send</span> <span class=\"n\">ed</span> <span class=\"n\">insert</span> <span class=\"s2\">\"</span><span class=\"se\">\\n</span><span class=\"s2\">|#\"</span> <span class=\"p\">(</span><span class=\"k\">send</span> <span class=\"n\">ed</span> <span class=\"n\">last-position</span><span class=\"p\">)))</span>\n            <span class=\"p\">(</span><span class=\"k\">begin</span> <span class=\"p\">(</span><span class=\"k\">send</span> <span class=\"n\">ed</span> <span class=\"n\">delete</span> <span class=\"mi\">0</span> <span class=\"p\">(</span><span class=\"k\">send</span> <span class=\"n\">ed</span> <span class=\"n\">paragraph-end-position</span> <span class=\"mi\">0</span><span class=\"p\">))</span>\n                   <span class=\"p\">(</span><span class=\"k\">send</span> <span class=\"n\">ed</span> <span class=\"n\">insert</span> <span class=\"p\">(</span><span class=\"nb\">format</span> <span class=\"s2\">\"; ~a ~a\"</span> <span class=\"p\">(</span><span class=\"nb\">-</span> <span class=\"n\">n</span> <span class=\"mi\">1</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"nb\">*</span> <span class=\"n\">n</span> <span class=\"n\">acc</span><span class=\"p\">))</span> <span class=\"mi\">0</span> <span class=\"mi\">0</span><span class=\"p\">))))</span>\n      <span class=\"p\">(</span><span class=\"k\">send</span> <span class=\"n\">ed</span> <span class=\"n\">insert</span> <span class=\"p\">(</span><span class=\"nb\">format</span> <span class=\"s2\">\"; ~a 1</span><span class=\"se\">\\n</span><span class=\"s2\">\"</span> <span class=\"n\">input</span><span class=\"p\">)</span> <span class=\"mi\">0</span><span class=\"p\">))</span>\n  <span class=\"p\">(</span><span class=\"k\">send</span> <span class=\"n\">ed</span> <span class=\"n\">lock</span> <span class=\"n\">lckd</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"k\">send</span> <span class=\"n\">ed</span> <span class=\"n\">end-edit-sequence</span><span class=\"p\">))</span>\n</pre></div>\n\n</div>\n<!-- more-->\n\n<hr />\n\n<p>Some folks would call that a feature!</p>\n\n<p>— <em>Griff, 20 December 2007</em></p>\n\n<hr />\n\n<p>Oh, indeed! Virus authors consider C&rsquo;s lack of array bounds checking a feature, no doubt. :)</p>\n\n<p>— <em>Robby, 20 December 2007</em></p>\n\n<hr />")) ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2009-06-23-serializable-closures-in-plt-scheme.md" . unix) f post (u . "Serializable Closures in PLT Scheme") (? . 72) 1467223812 (p+ #"/Users/MB/git/racket-lang-org/blog/2009/06/serializable-closures-in-plt-scheme.html" . unix) "/2009/06/serializable-closures-in-plt-scheme.html" (u . "2009-06-23T12:02:00.003-04:00") (? . 73) (? . 71) (c (u . "")) (u . "\n<p><em>posted by Jay McCarthy</em></p>\n\n<p>PLT Scheme supports an extensible <a href=\"http://docs.plt-scheme.org/reference/serialization.html\">serialization</a> system for structures. A structure is serializable if it has a <code>prop:serializable</code> property. There are many <a href=\"http://docs.plt-scheme.org/search/index.html?q=prop%3A\">properties</a> in PLT Scheme for other extensions, such as <a href=\"http://docs.plt-scheme.org/reference/procedures.html#(def._((lib._scheme/base..ss)._prop~3aprocedure))\">applicable structures</a> and <a href=\"http://docs.plt-scheme.org/reference/booleans.html#(def._((quote._~23~25kernel)._prop~3aequal+hash))\">custom equality predicates</a>.</p>\n\n<p>The <a href=\"http://docs.plt-scheme.org/web-server/index.html\">PLT Web</a> application development framework uses these features to provide <a href=\"http://docs.plt-scheme.org/web-server/stateless.html#(part._.Serializable_.Continuations)\">serializable continuations</a> through a number of source transformations and a serializable closure structure.</p>\n\n<p><em>Warning: This remainder post refers to features only available in the latest SVN revision of PLT Scheme.</em></p>\n\n<p>I&rsquo;ve recently made these closures more accessible to non-Web programs through <code>web-server/lang/serial-lambda</code>. Here&rsquo;s a demo:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"kn\">#lang </span><span class=\"nn\">scheme</span>\n<span class=\"p\">(</span><span class=\"k\">require</span> <span class=\"n\">web-server/lang/serial-lambda</span>\n         <span class=\"n\">scheme/serialize</span><span class=\"p\">)</span>\n\n<span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"n\">f</span>\n  <span class=\"p\">(</span><span class=\"k\">let</span> <span class=\"p\">([</span><span class=\"n\">z</span> <span class=\"mi\">5</span><span class=\"p\">])</span>\n    <span class=\"p\">(</span><span class=\"n\">serial-lambda</span>\n     <span class=\"p\">(</span><span class=\"n\">x</span> <span class=\"n\">y</span><span class=\"p\">)</span>\n     <span class=\"p\">(</span><span class=\"nb\">+</span> <span class=\"n\">x</span> <span class=\"n\">y</span> <span class=\"n\">z</span><span class=\"p\">))))</span>\n\n<span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">test-it</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"nb\">printf</span> <span class=\"s2\">\"~S~n\"</span> <span class=\"p\">(</span><span class=\"n\">f</span> <span class=\"mi\">1</span> <span class=\"mi\">2</span><span class=\"p\">))</span>\n  <span class=\"p\">(</span><span class=\"k\">let</span> <span class=\"p\">([</span><span class=\"n\">fs</span> <span class=\"p\">(</span><span class=\"n\">serialize</span> <span class=\"n\">f</span><span class=\"p\">)])</span>\n    <span class=\"p\">(</span><span class=\"nb\">printf</span> <span class=\"s2\">\"~S~n\"</span> <span class=\"n\">fs</span><span class=\"p\">)</span>\n    <span class=\"p\">(</span><span class=\"k\">let</span> <span class=\"p\">([</span><span class=\"n\">df</span> <span class=\"p\">(</span><span class=\"n\">deserialize</span> <span class=\"n\">fs</span><span class=\"p\">)])</span>\n      <span class=\"p\">(</span><span class=\"nb\">printf</span> <span class=\"s2\">\"~S~n\"</span> <span class=\"n\">df</span><span class=\"p\">)</span>\n      <span class=\"p\">(</span><span class=\"nb\">printf</span> <span class=\"s2\">\"~S~n\"</span> <span class=\"p\">(</span><span class=\"n\">df</span> <span class=\"mi\">1</span> <span class=\"mi\">2</span><span class=\"p\">)))))</span>\n\n<span class=\"nb\">&gt;</span> <span class=\"p\">(</span><span class=\"n\">test-it</span><span class=\"p\">)</span>\n<span class=\"mi\">8</span>\n<span class=\"p\">((</span><span class=\"mi\">2</span><span class=\"p\">)</span> <span class=\"mi\">1</span> <span class=\"p\">((</span><span class=\"s2\">#\"/Users/jay/Dev/svn/plt/collects/web-server/exp/test-serial.ss\"</span> <span class=\"o\">.</span> <span class=\"s2\">\"lifted.6\"</span><span class=\"p\">))</span> <span class=\"mi\">0</span> <span class=\"p\">()</span> <span class=\"p\">()</span> <span class=\"p\">(</span><span class=\"mi\">0</span> <span class=\"mi\">5</span><span class=\"p\">))</span>\n<span class=\"o\">#</span><span class=\"p\">(</span><span class=\"ss\">struct:7a410aca70b31e88b4c2f0fe77fa7ffe:0</span> <span class=\"ss\">#</span><span class=\"p\">)</span>\n<span class=\"mi\">8</span>\n</pre></div>\n\n</div>\n\n<p>Now, let&rsquo;s see how it is implemented. <a href=\"http://svn.plt-scheme.org/plt/trunk/collects/web-server/lang/serial-lambda.ss\"><code>web-server/lang/serial-lambda</code></a> is thin wrapper around <a href=\"http://svn.plt-scheme.org/plt/trunk/collects/web-server/lang/closure.ss\"><code>web-server/lang/closure</code></a>, which has two syntax transformer functions: <code>define-closure!</code> which defines the closure structure and <code>make-closure</code> which instantiates the closure. (The two tasks are separated to easily provide a user top-level definition syntax for named closures with different free identifires, rather than simply anonymous lambdas with fixed free identifiers.)</p>\n\n<p><code>make-closure</code> does the following:</p>\n\n<ol>\n <li>\n  <p>Expands the procedure syntax using <a href=\"http://docs.plt-scheme.org/reference/stxtrans.html#(def._((quote._~23~25kernel)._local-expand))\"><code>local-expand</code></a>, so it can use <a href=\"http://docs.plt-scheme.org/syntax/syntax-helpers.html#(def._((lib._syntax/free-vars..ss)._free-vars))\"><code>free-vars</code></a> to compute the free identifires.</p></li>\n <li>\n  <p>Uses <code>define-closure!</code> to define the structure and get the name for the constructor.</p></li>\n <li>\n  <p>Instantiates the closure with the current values of the free identifiers.</p></li></ol>\n\n<p>The more interesting work is done by <code>define-closure!</code>. At a high-level, it needs to do the following:</p>\n\n<ol>\n <li>\n  <p>Create a deserialization function.</p></li>\n <li>\n  <p>Create a serialization function that references the deserializer.</p></li>\n <li>\n  <p>Define the closure structure type that references the serializer.</p></li>\n <li>\n  <p>Provide the deserializer from the current module so that arbitrary code can deserialize instances of this closure type.</p></li></ol>\n\n<p>These tasks are complicated in a few ways:</p>\n\n<ul>\n <li>\n  <p>The deserializer needs the closure structure type definition to create instances and the serializer needs the closure structure type to access their fields.</p></li>\n <li>\n  <p>The serializer needs the syntactic identifier of the deserializer so that <code>scheme/serialize</code> can <a href=\"http://docs.plt-scheme.org/reference/Module_Names_and_Loading.html#(def._((quote._~23~25kernel)._dynamic-require))\"><code>dynamic-require</code></a> it during deserialization.</p></li>\n <li>\n  <p>The deserializer must be defined at the top-level, so it may be provided.</p></li>\n <li>\n  <p>All this may occur in a syntactic expression context.</p></li></ul>\n\n<p>Thankfully, the PLT Scheme <a href=\"http://docs.plt-scheme.org/reference/Macros.html\">macro system</a> is powerful to support all this.</p>\n\n<ul>\n <li>\n  <p><a href=\"http://docs.plt-scheme.org/reference/stxtrans.html#(def._((quote._~23~25kernel)._syntax-local-lift-expression))\"><code>syntax-local-lift-expression</code></a> allows a syntax transformer to lift an expression to the top-level of a module and returns the identifier it is bound to.</p></li>\n <li>\n  <p><a href=\"http://docs.plt-scheme.org/search/index.html?q=syntax-local-lift-values-expression\"><code>syntax-local-lift-values-expression</code></a> (added in 4.2.0.3) provides the same for expressions that return multiple values, such as <a href=\"http://docs.plt-scheme.org/reference/creatingmorestructs.html#(def._((quote._~23~25kernel)._make-struct-type))\"><code>make-struct-type</code></a>, which is used to define structures.</p></li>\n <li>\n  <p><a href=\"http://docs.plt-scheme.org/search/index.html?q=syntax-local-lift-provide\"><code>syntax-local-lift-provide</code></a> (added in 4.2.0.4) allows a syntax transformer to lift a provide to the top-level.</p></li></ul>\n\n<p>The only complicated piece is allowing the deserializer and serializer to refer to the closure structure constructor and accessors. This is easily accomplished by first defining lifting boxes that will hold these values and initializing them when the structure type is defined. This is safe because all accesses to the boxes are under lambdas that are guaranteed not to be run before the structure type is defined.</p>\n\n<p><strong>An aside on the closure representation.</strong> The closure is represented as a structure with one field: the environment. The environment is represented as a thunk that returns <em>n</em> values, one for each of the free identifiers. This ensures that references that were under lambdas in the original syntax, remain under lambdas in the closure construction, so the serializable closures work correctly inside <code>letrec</code>. This thunk is applied by the serializer and the free values are stored in a vector. The closure also uses the <code>prop:procedure</code> structure property to provide an application function that simply invokes the environment thunk and binds its names, then <code>apply</code>s the original procedure syntax to the arguments.</p>\n\n<p><strong>An aside on the serializer.</strong> The deserializer is bound to lifted identifier which is represented in PLT Scheme as an unreadable symbol. Version 4.2.0.5 added support for (de)serializing these.</p>") #t (u . "\n<p><em>posted by Jay McCarthy</em></p>\n\n<p>PLT Scheme supports an extensible <a href=\"http://docs.plt-scheme.org/reference/serialization.html\">serialization</a> system for structures. A structure is serializable if it has a <code>prop:serializable</code> property. There are many <a href=\"http://docs.plt-scheme.org/search/index.html?q=prop%3A\">properties</a> in PLT Scheme for other extensions, such as <a href=\"http://docs.plt-scheme.org/reference/procedures.html#(def._((lib._scheme/base..ss)._prop~3aprocedure))\">applicable structures</a> and <a href=\"http://docs.plt-scheme.org/reference/booleans.html#(def._((quote._~23~25kernel)._prop~3aequal+hash))\">custom equality predicates</a>.</p>\n\n<p>The <a href=\"http://docs.plt-scheme.org/web-server/index.html\">PLT Web</a> application development framework uses these features to provide <a href=\"http://docs.plt-scheme.org/web-server/stateless.html#(part._.Serializable_.Continuations)\">serializable continuations</a> through a number of source transformations and a serializable closure structure.</p>\n\n<p><em>Warning: This remainder post refers to features only available in the latest SVN revision of PLT Scheme.</em></p>\n\n<p>I&rsquo;ve recently made these closures more accessible to non-Web programs through <code>web-server/lang/serial-lambda</code>. Here&rsquo;s a demo:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"kn\">#lang </span><span class=\"nn\">scheme</span>\n<span class=\"p\">(</span><span class=\"k\">require</span> <span class=\"n\">web-server/lang/serial-lambda</span>\n         <span class=\"n\">scheme/serialize</span><span class=\"p\">)</span>\n\n<span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"n\">f</span>\n  <span class=\"p\">(</span><span class=\"k\">let</span> <span class=\"p\">([</span><span class=\"n\">z</span> <span class=\"mi\">5</span><span class=\"p\">])</span>\n    <span class=\"p\">(</span><span class=\"n\">serial-lambda</span>\n     <span class=\"p\">(</span><span class=\"n\">x</span> <span class=\"n\">y</span><span class=\"p\">)</span>\n     <span class=\"p\">(</span><span class=\"nb\">+</span> <span class=\"n\">x</span> <span class=\"n\">y</span> <span class=\"n\">z</span><span class=\"p\">))))</span>\n\n<span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">test-it</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"nb\">printf</span> <span class=\"s2\">\"~S~n\"</span> <span class=\"p\">(</span><span class=\"n\">f</span> <span class=\"mi\">1</span> <span class=\"mi\">2</span><span class=\"p\">))</span>\n  <span class=\"p\">(</span><span class=\"k\">let</span> <span class=\"p\">([</span><span class=\"n\">fs</span> <span class=\"p\">(</span><span class=\"n\">serialize</span> <span class=\"n\">f</span><span class=\"p\">)])</span>\n    <span class=\"p\">(</span><span class=\"nb\">printf</span> <span class=\"s2\">\"~S~n\"</span> <span class=\"n\">fs</span><span class=\"p\">)</span>\n    <span class=\"p\">(</span><span class=\"k\">let</span> <span class=\"p\">([</span><span class=\"n\">df</span> <span class=\"p\">(</span><span class=\"n\">deserialize</span> <span class=\"n\">fs</span><span class=\"p\">)])</span>\n      <span class=\"p\">(</span><span class=\"nb\">printf</span> <span class=\"s2\">\"~S~n\"</span> <span class=\"n\">df</span><span class=\"p\">)</span>\n      <span class=\"p\">(</span><span class=\"nb\">printf</span> <span class=\"s2\">\"~S~n\"</span> <span class=\"p\">(</span><span class=\"n\">df</span> <span class=\"mi\">1</span> <span class=\"mi\">2</span><span class=\"p\">)))))</span>\n\n<span class=\"nb\">&gt;</span> <span class=\"p\">(</span><span class=\"n\">test-it</span><span class=\"p\">)</span>\n<span class=\"mi\">8</span>\n<span class=\"p\">((</span><span class=\"mi\">2</span><span class=\"p\">)</span> <span class=\"mi\">1</span> <span class=\"p\">((</span><span class=\"s2\">#\"/Users/jay/Dev/svn/plt/collects/web-server/exp/test-serial.ss\"</span> <span class=\"o\">.</span> <span class=\"s2\">\"lifted.6\"</span><span class=\"p\">))</span> <span class=\"mi\">0</span> <span class=\"p\">()</span> <span class=\"p\">()</span> <span class=\"p\">(</span><span class=\"mi\">0</span> <span class=\"mi\">5</span><span class=\"p\">))</span>\n<span class=\"o\">#</span><span class=\"p\">(</span><span class=\"ss\">struct:7a410aca70b31e88b4c2f0fe77fa7ffe:0</span> <span class=\"ss\">#</span><span class=\"p\">)</span>\n<span class=\"mi\">8</span>\n</pre></div>\n\n</div>\n\n<p>Now, let&rsquo;s see how it is implemented. <a href=\"http://svn.plt-scheme.org/plt/trunk/collects/web-server/lang/serial-lambda.ss\"><code>web-server/lang/serial-lambda</code></a> is thin wrapper around <a href=\"http://svn.plt-scheme.org/plt/trunk/collects/web-server/lang/closure.ss\"><code>web-server/lang/closure</code></a>, which has two syntax transformer functions: <code>define-closure!</code> which defines the closure structure and <code>make-closure</code> which instantiates the closure. (The two tasks are separated to easily provide a user top-level definition syntax for named closures with different free identifires, rather than simply anonymous lambdas with fixed free identifiers.)</p>\n\n<p><code>make-closure</code> does the following:</p>\n\n<ol>\n <li>\n  <p>Expands the procedure syntax using <a href=\"http://docs.plt-scheme.org/reference/stxtrans.html#(def._((quote._~23~25kernel)._local-expand))\"><code>local-expand</code></a>, so it can use <a href=\"http://docs.plt-scheme.org/syntax/syntax-helpers.html#(def._((lib._syntax/free-vars..ss)._free-vars))\"><code>free-vars</code></a> to compute the free identifires.</p></li>\n <li>\n  <p>Uses <code>define-closure!</code> to define the structure and get the name for the constructor.</p></li>\n <li>\n  <p>Instantiates the closure with the current values of the free identifiers.</p></li></ol>\n\n<p>The more interesting work is done by <code>define-closure!</code>. At a high-level, it needs to do the following:</p>\n\n<ol>\n <li>\n  <p>Create a deserialization function.</p></li>\n <li>\n  <p>Create a serialization function that references the deserializer.</p></li>\n <li>\n  <p>Define the closure structure type that references the serializer.</p></li>\n <li>\n  <p>Provide the deserializer from the current module so that arbitrary code can deserialize instances of this closure type.</p></li></ol>\n\n<p>These tasks are complicated in a few ways:</p>\n\n<ul>\n <li>\n  <p>The deserializer needs the closure structure type definition to create instances and the serializer needs the closure structure type to access their fields.</p></li>\n <li>\n  <p>The serializer needs the syntactic identifier of the deserializer so that <code>scheme/serialize</code> can <a href=\"http://docs.plt-scheme.org/reference/Module_Names_and_Loading.html#(def._((quote._~23~25kernel)._dynamic-require))\"><code>dynamic-require</code></a> it during deserialization.</p></li>\n <li>\n  <p>The deserializer must be defined at the top-level, so it may be provided.</p></li>\n <li>\n  <p>All this may occur in a syntactic expression context.</p></li></ul>\n\n<p>Thankfully, the PLT Scheme <a href=\"http://docs.plt-scheme.org/reference/Macros.html\">macro system</a> is powerful to support all this.</p>\n\n<ul>\n <li>\n  <p><a href=\"http://docs.plt-scheme.org/reference/stxtrans.html#(def._((quote._~23~25kernel)._syntax-local-lift-expression))\"><code>syntax-local-lift-expression</code></a> allows a syntax transformer to lift an expression to the top-level of a module and returns the identifier it is bound to.</p></li>\n <li>\n  <p><a href=\"http://docs.plt-scheme.org/search/index.html?q=syntax-local-lift-values-expression\"><code>syntax-local-lift-values-expression</code></a> (added in 4.2.0.3) provides the same for expressions that return multiple values, such as <a href=\"http://docs.plt-scheme.org/reference/creatingmorestructs.html#(def._((quote._~23~25kernel)._make-struct-type))\"><code>make-struct-type</code></a>, which is used to define structures.</p></li>\n <li>\n  <p><a href=\"http://docs.plt-scheme.org/search/index.html?q=syntax-local-lift-provide\"><code>syntax-local-lift-provide</code></a> (added in 4.2.0.4) allows a syntax transformer to lift a provide to the top-level.</p></li></ul>\n\n<p>The only complicated piece is allowing the deserializer and serializer to refer to the closure structure constructor and accessors. This is easily accomplished by first defining lifting boxes that will hold these values and initializing them when the structure type is defined. This is safe because all accesses to the boxes are under lambdas that are guaranteed not to be run before the structure type is defined.</p>\n\n<p><strong>An aside on the closure representation.</strong> The closure is represented as a structure with one field: the environment. The environment is represented as a thunk that returns <em>n</em> values, one for each of the free identifiers. This ensures that references that were under lambdas in the original syntax, remain under lambdas in the closure construction, so the serializable closures work correctly inside <code>letrec</code>. This thunk is applied by the serializer and the free values are stored in a vector. The closure also uses the <code>prop:procedure</code> structure property to provide an application function that simply invokes the environment thunk and binds its names, then <code>apply</code>s the original procedure syntax to the arguments.</p>\n\n<p><strong>An aside on the serializer.</strong> The deserializer is bound to lifted identifier which is represented in PLT Scheme as an unreadable symbol. Version 4.2.0.5 added support for (de)serializing these.</p>\n<!-- more-->\n\n<hr />\n\n<p>Awesome. Serialization is one of the things I&rsquo;m looking for right now, so I&rsquo;m glad my favorite distro is making it easier.</p>\n\n<p>— <em>Zachary, 3 January 2010</em></p>\n\n<hr />\n\n<p>This is very, very, shiny. I might use this in my master&rsquo;s thesis.</p>\n\n<p>— <em>Alex, 12 February 2010</em></p>\n\n<hr />")) ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2014-11-23-800.md" . unix) f post (u . "800!") (? . 80) 1467223812 (p+ #"/Users/MB/git/racket-lang-org/blog/2014/11/800.html" . unix) "/2014/11/800.html" (u . "2014-11-23T10:40:00.000-05:00") (? . 89) (? . 79) (c (u . "")) (u . "\n<p><em>posted by Tim Brown</em></p>\n\n<p> 800 (Racket Tasks On Rosetta Code)</p>\n\n<p> Since (and even before) Asumu Takikawa&rsquo;s post &ldquo;200!&rdquo; at the beginning of March 2013, folk have been beavering away, implementing tasks on <a href=\"http://rosettacode.org\">Rosetta Code</a>. And on November 15th 2014:</p>\n\n<p> <strong>800 tasks have now been Implemented1 in Racket on the Rosetta Code website!</strong></p>\n\n<p> Before I go any further it must be said that, without a doubt… this is awesome! This achievement represents a lot of work, and a lot of code. And everyone who has participated should be thanked and congratulated for getting this far.</p>\n\n<p> So thank you. And <em>well done!</em></p>\n\n<p> What is Rosetta Code?: Rosetta Code (RC) describes itself as:</p>\n\n<blockquote>\n <p>&hellip; a <a href=\"http://en.wikipedia.org/wiki/Chrestomathy\">programming chrestomathy</a> site. The idea is to present solutions to the same task in as many different languages as possible, to demonstrate how languages are similar and different, and to aid a person with a grounding in one approach to a problem in learning another. Rosetta Code currently has 758 tasks, 134 draft tasks, and is aware of 560 languages, though we do not (and cannot) have solutions to every task in every language.\"2</p></blockquote>\n\n<p> Of these tasks, 800 have been implemented in Racket… some tasks, like <a href=\"http://rosettacode.org/wiki/Hello_world/Text\">Hello World/Text</a>, have been implemented in hundreds of languages. Some, however, like <a href=\"rosettacode.org/wiki/Time-based_One-time_Password_Algorithm\">Time-based One-time Password Algorithm</a>, have only been implemented in 3 (including Racket).</p>\n\n<p> If you haven&rsquo;t already, I suggest you take a quick look about the site to get a feel of what that means in practice.</p>\n\n<p> <strong>WARNING:</strong> Rosetta Code is a wiki. Like any wiki it will steal your time from you as you browse tasks, algorithms, languages and the occasional link to Wikipedia. Don&rsquo;t say I didn&rsquo;t warn you.</p>\n\n<p> What Can You Do With Rosetta Code?  &mdash;</p>\n\n<p> <strong>Learn From It</strong>  Rosetta Code is a valuable resource with plenty of material to absorb and ideas to be had from. If you&rsquo;re new to Racket, there are tasks like <a href=\"http://rosettacode.org/wiki/Loops/For\">Loops/For</a> which will get you on your way with fundamental programming tasks.</p>\n\n<p> If you want something juicier there are other tasks (like <a href=\"http://rosettacode.org/wiki/Nonogram_solver\">Nonogram solver</a> which runs to over 400 lines of Racket) for you to pick over.</p>\n\n<p> And there&rsquo;s everything in between.</p>\n\n<p> <strong>Write Code!</strong></p>\n\n<p>Each task gives you a chance to think, &ldquo;Is this how I would do this?&rdquo;</p>\n\n<p>Even if I don&rsquo;t submit something, I find it&rsquo;s fun to write some code around the task. In fact, I don&rsquo;t even have to type code into a REPL, the thought exercise is often fun enough!</p>\n\n<p>Some tasks, like (&ldquo;Chess Player&rdquo;), are shall we say, very challenging. But don&rsquo;t let even that put you off thinking of, tinkering around or coding a solution to them.</p>\n\n<p><strong>If there isn&rsquo;t a Racket implementation for a task you like the looks of, have a go.</strong></p>\n\n<p> Someone might have a better idea of how to do it in Racket later. But if there isn&rsquo;t an implementation now &mdash; change that now!</p>\n\n<p> Remember that others will be reading your code to understand Racket all the better. So please try to adhere to the <a href=\"http://docs.racket-lang.org/style/index.html\">Racket Style Guide</a> as best you can3. Again, don&rsquo;t worry about getting that perfect. Like anything, learning Racket style takes practice, and nobody expects perfection. And the experienced contributors/documentors are always at hand to <a href=\"http://permalink.gmane.org/gmane.comp.lang.racket.user/18248\">help correct style</a>.</p>\n\n<p> <em>Hints:</em></p>\n\n<ul>\n <li>\n  <p>I always have a <a href=\"https://en.wikipedia.org/wiki/Help:Cheatsheet\">Wikimedia Cheatsheet</a> to hand. I can never remember its markdown syntax (which unfortunately doesn&rsquo;t really support <code>&lt;code/&gt;</code>, either)</p></li>\n <li>\n  <p>Pick whatever task you want… but it would be good to clear all the &ldquo;Complete Tasks&rdquo; (as opposed to &ldquo;Draft Tasks&rdquo;) if you have a choice.</p></li>\n <li>\n  <p>Don&rsquo;t add code until it&rsquo;s running and producing the output you expect. This isn&rsquo;t Project Euler, you don&rsquo;t have to guess the answer in most cases &mdash; it&rsquo;s likely someone has some sample output to compare to.4</p></li>\n <li>\n  <p>If you can&rsquo;t get your head around the algorithm in the task description then try to translate another language into Racket. You&rsquo;ll learn Racket, you&rsquo;ll learn the other language, and in working it through for yourself you&rsquo;ll also see how the algorithm takes shape and works.</p></li>\n <li>\n  <p>My workflow for posting a new solution is this: Once I have something to submit, I add a &ldquo;Stub&rdquo; Racket implementation. I edit the whole Task page (because that is all that is available to edit at that point), find whatever is after Racket alphabetically, and insert boilerplate code. I check this template code as a &ldquo;minor edit&rdquo; described as &ldquo;Racket stub added &mdash; implementation later&rdquo;. This then allows is for me to be able to edit the Racket section in isolation and keeps the rest of the task (everyone else&rsquo;s hard work) safe from any, er, silliness. <code>{{header|Racket}}\n&lt;lang racket&gt;\n&lt;/lang racket&gt;\n{{out}}\n&lt;pre&gt;\n&lt;/pre&gt;</code></p></li>\n <li>\n  <p>I have started to make it my habit (especially when showcasing one or two functions) to use <code>#lang racket/base</code> and <code>require</code>ing the salient individual functions.</p></li>\n <li>\n  <p>It is often not appropriate to fully document the functionality of Racket functions in the RC task implementation. You can, however, point to the canonical documentation on the Racket website. So I also include a link to <code>http://docs.racket-lang.org/reference/...</code> when I need to.</p></li>\n <li>\n  <p>The RC administrators have switched off image uploading (or I, at least, cannot find out how). Even though Racket can produce images as results, think hard about whether you want the hassle of trying to present images to the reader. If you find out a method that works for you <em>please tell me</em>, I&rsquo;d love to know. I suppose you could also extend all of the above to coding in another language &mdash; if you really have to.</p></li></ul>\n\n<h2 id=\"improve-whats-already-there\">Improve What&rsquo;s Already There</h2>\n\n<p> Rosetta Code is a wiki.</p>\n\n<p>It is open to anyone to edit.</p>\n\n<p> Don&rsquo;t be afraid to. If you see something that could be implemented, styled or documented better &mdash; work to improve it.</p>\n\n<p> Once you have your improved entry together, show it to the author of the original post. Besides being courteous, he or she might have an opinion on what else you might do. Often, there is something bugging them, and you are scratching an itch of theirs!</p>\n\n<p> I have never had anyone react badly to a change request. Everyone appreciates that you have made an effort to produce your change (and that you&rsquo;re not just standing in the aisles complaining that it doesn&rsquo;t look right).</p>\n\n<p> Teach Through It  &mdash;</p>\n\n<p>If there is an aspect of Racket, algorithm or other &ldquo;CS task&rdquo; (in the broadest sense) that you want to share: see to it that it is adequately illustrated on Rosetta Code. If it is not, then create a task to demonstrate it. Not only will you show how something is done properly (i.e. in Racket), but you will also be inviting others to implement the task in their own favourite languages.</p>\n\n<h2 id=\"the-competition\">The Competition</h2>\n\n<p> Back at <em>200</em>, Racket was the 54th most popular language. But for some time now, it has been sitting at #2 in the popularity1 ranking for quite some time now. For a while, it has been placed a long way behind TCL, and being hotly pursued by Python (never more than 10 tasks behind).</p>\n\n<p> One of <em>my</em> motivators is that having seen Racket get to #2 &mdash; I don&rsquo;t want to see it any lower in the rankings. I&rsquo;m sure there&rsquo;s something in the Python lot that wants to overtake us! This healthy competition has kept both of the communities pushing ahead with implementing the tasks.</p>\n\n<p> The <a href=\"https://github.com/plt/racket/wiki/Intro-Projects\"><em>Intro Projects</em></a> page of the racket wiki has &ldquo;Implement a Rosetta code task&rdquo; as a &ldquo;Small Project&rdquo;. I think of it as slightly more of a &ldquo;Recreational&rdquo; project (this at least justifies to myself the element of competition that has crept in.)</p>\n\n<p> The Rallying Call  &mdash;</p>\n\n<p> or <strong>&ldquo;What Specifically Would Help Racket on Rosetta Code?&rdquo;</strong></p>\n\n<p> RC is a good way to present Racket as a most general programming language. So as a tool for Racket advocacy, as well as for the purposes of RC, we need to:</p>\n\n<ul>\n <li>\n  <p><strong>Implement more tasks in Racket to keep a high profile:</strong> 800 tasks, #2 in the popularity stakes. This keeps Racket visible; and proves it capable of (almost) anything. I would <em>so</em> love to give TCL a run for its money &mdash; so there&rsquo;s 41 tasks to go before we can even think of taking a breather!</p></li>\n <li>\n  <p>We have implemented 800 tasks in Racket. The quote above says there are 892 (758+134) tasks in total. That means that there are 92 more tasks to get to grips with.</p></li>\n <li>\n  <p><strong>Suggest new tasks:</strong> Especially tasks that will demonstrate the latest shiny feature of the latest shiny versions of Racket!</p></li></ul>\n\n<p> Personally I can&rsquo;t believe that there are less than 900 things that you would want to do with a programming language. If you think of a task, add it. Even impossible tasks provoke thought and imagination &mdash; and interesting solutions!</p>\n\n<ul>\n <li>\n  <p><strong>Improve those tasks that have been implemented in Racket:</strong> We want to maintain a body of good, useful code, to allow us to teach and demonstrate Racket. There are a number of reasons why existent tasks need revisiting:</p></li>\n <li>\n  <p>Racket technology has moved on (and moves on) apace. What was unavailable and experimental even 18 months ago is now available and reliable. This new technology needs to be demonstrated.</p></li>\n <li>\n  <p>Code that is even older is very &ldquo;schemey&rdquo; (I have in some cases simply copied the Scheme implementation and stuck a <code>#lang racket</code> tag on the front). Although compatible, Racket has moved quite a way on from Scheme.</p></li>\n <li>\n  <p>Some implementors (not a million miles from where I&rsquo;m standing, for example), were not as <em>au fait</em> with the language and/or style guide as they might be now. It&rsquo;s a housekeeping job, I know, but giving the examples as consistent a style as possible will help satisfy this aspiration from the Racket Style Guide:</p></li></ul>\n\n<p> &ldquo;Doing so will help us … and our users, who use the open source code … as an implicit guide to Racket programming.&rdquo;</p>\n\n<ul>\n <li>\n  <p><strong>Document tasks:</strong> see my hint about documentation and links above for what I now think is good practice. If some code seems utterly heiroglyphic, see if it can be made clearer. Remember this is Racket, not APL.</p></li>\n <li>\n  <p>General tidying up never goes amiss.</p></li>\n <li>\n  <p>RC is run by someone outside the Racket community. At the bottom of the &ldquo;Small Projects&rdquo; section of the Racket wiki is a suggestion to collect the RC examples into something &ldquo;owned&rdquo; by the Racket community. I&rsquo;ve been thinking about this… if anyone has suggestions, let me know. There are limits to what we can put on RC (defined by the purpose of RC itself). It would be good to remove those limits by implementing something along RC&rsquo;s lines oursleves.</p></li>\n <li>\n  <p>Very specifically… anyone with a joystick, drivers and some spare time - please could you do &ldquo;Joystick Position&rdquo;. The possession of a joystick puts you in a position of <em>great power</em> with respect to that task. Exercise your responsibility. And Finally…: Well done everyone again! Keep up the good work. And see you at 1000!</p></li>\n <li>\n  <p>You can track Racket (and everyone else&rsquo;s) progress on the <a href=\"http://timb.net/popular-languages.html\">Popular Programming Languages</a> report, which is updated hourly or so.<a href=\"#g76184-footnote-1-return\">↩</a></p></li>\n <li>\n  <p>Rosetta Code&rsquo;s Front Page<a href=\"#g76184-footnote-2-return\">↩</a></p></li>\n <li>\n  <p>The style guide is actually the chapter called &ldquo;How to Program Racket&rdquo; in the main Racket documentation. One of the RC &ldquo;style&rdquo; rules is that code should be 80 characters wide. Personally, I ignore that in favour of Racket&rsquo;s more generous 102. Sometimes someone on RC objects. Sometimes I then care enough to put the required newlines in.<a href=\"#g76184-footnote-3-return\">↩</a></p></li>\n <li>\n  <p>Even if there are example results don&rsquo;t necessarily trust them. e.g. in <a href=\"http://rosettacode.org/wiki/The_ISAAC_Cipher\">The ISAAC Cipher</a>, the cypher engine isn&rsquo;t reset between test runs in the Pascal implementation. That error is propagated through all other implementations. Mine (Racket) conforms to show that I&rsquo;m doing the same thing as everyone else; but I also do what I think to be a more correct test later.<a href=\"#g76184-footnote-4-return\">↩</a></p></li>\n <li>\n  <p>Hold on a mo… this is meant to be a pedagogical exercise, not a competition<a href=\"#g76184-footnote-5-return\">↩</a></p></li></ul>") #t (u . "\n<p><em>posted by Tim Brown</em></p>\n\n<p> 800 (Racket Tasks On Rosetta Code)</p>\n\n<p> Since (and even before) Asumu Takikawa&rsquo;s post &ldquo;200!&rdquo; at the beginning of March 2013, folk have been beavering away, implementing tasks on <a href=\"http://rosettacode.org\">Rosetta Code</a>. And on November 15th 2014:</p>\n\n<p> <strong>800 tasks have now been Implemented1 in Racket on the Rosetta Code website!</strong></p>\n\n<p> Before I go any further it must be said that, without a doubt… this is awesome! This achievement represents a lot of work, and a lot of code. And everyone who has participated should be thanked and congratulated for getting this far.</p>\n\n<p> So thank you. And <em>well done!</em></p>\n\n<p> What is Rosetta Code?: Rosetta Code (RC) describes itself as:</p>\n\n<blockquote>\n <p>&hellip; a <a href=\"http://en.wikipedia.org/wiki/Chrestomathy\">programming chrestomathy</a> site. The idea is to present solutions to the same task in as many different languages as possible, to demonstrate how languages are similar and different, and to aid a person with a grounding in one approach to a problem in learning another. Rosetta Code currently has 758 tasks, 134 draft tasks, and is aware of 560 languages, though we do not (and cannot) have solutions to every task in every language.\"2</p></blockquote>\n\n<p> Of these tasks, 800 have been implemented in Racket… some tasks, like <a href=\"http://rosettacode.org/wiki/Hello_world/Text\">Hello World/Text</a>, have been implemented in hundreds of languages. Some, however, like <a href=\"rosettacode.org/wiki/Time-based_One-time_Password_Algorithm\">Time-based One-time Password Algorithm</a>, have only been implemented in 3 (including Racket).</p>\n\n<p> If you haven&rsquo;t already, I suggest you take a quick look about the site to get a feel of what that means in practice.</p>\n\n<p> <strong>WARNING:</strong> Rosetta Code is a wiki. Like any wiki it will steal your time from you as you browse tasks, algorithms, languages and the occasional link to Wikipedia. Don&rsquo;t say I didn&rsquo;t warn you.</p>\n\n<p> What Can You Do With Rosetta Code?  &mdash;</p>\n\n<p> <strong>Learn From It</strong>  Rosetta Code is a valuable resource with plenty of material to absorb and ideas to be had from. If you&rsquo;re new to Racket, there are tasks like <a href=\"http://rosettacode.org/wiki/Loops/For\">Loops/For</a> which will get you on your way with fundamental programming tasks.</p>\n\n<p> If you want something juicier there are other tasks (like <a href=\"http://rosettacode.org/wiki/Nonogram_solver\">Nonogram solver</a> which runs to over 400 lines of Racket) for you to pick over.</p>\n\n<p> And there&rsquo;s everything in between.</p>\n\n<p> <strong>Write Code!</strong></p>\n\n<p>Each task gives you a chance to think, &ldquo;Is this how I would do this?&rdquo;</p>\n\n<p>Even if I don&rsquo;t submit something, I find it&rsquo;s fun to write some code around the task. In fact, I don&rsquo;t even have to type code into a REPL, the thought exercise is often fun enough!</p>\n\n<p>Some tasks, like (&ldquo;Chess Player&rdquo;), are shall we say, very challenging. But don&rsquo;t let even that put you off thinking of, tinkering around or coding a solution to them.</p>\n\n<p><strong>If there isn&rsquo;t a Racket implementation for a task you like the looks of, have a go.</strong></p>\n\n<p> Someone might have a better idea of how to do it in Racket later. But if there isn&rsquo;t an implementation now &mdash; change that now!</p>\n\n<p> Remember that others will be reading your code to understand Racket all the better. So please try to adhere to the <a href=\"http://docs.racket-lang.org/style/index.html\">Racket Style Guide</a> as best you can3. Again, don&rsquo;t worry about getting that perfect. Like anything, learning Racket style takes practice, and nobody expects perfection. And the experienced contributors/documentors are always at hand to <a href=\"http://permalink.gmane.org/gmane.comp.lang.racket.user/18248\">help correct style</a>.</p>\n\n<p> <em>Hints:</em></p>\n\n<ul>\n <li>\n  <p>I always have a <a href=\"https://en.wikipedia.org/wiki/Help:Cheatsheet\">Wikimedia Cheatsheet</a> to hand. I can never remember its markdown syntax (which unfortunately doesn&rsquo;t really support <code>&lt;code/&gt;</code>, either)</p></li>\n <li>\n  <p>Pick whatever task you want… but it would be good to clear all the &ldquo;Complete Tasks&rdquo; (as opposed to &ldquo;Draft Tasks&rdquo;) if you have a choice.</p></li>\n <li>\n  <p>Don&rsquo;t add code until it&rsquo;s running and producing the output you expect. This isn&rsquo;t Project Euler, you don&rsquo;t have to guess the answer in most cases &mdash; it&rsquo;s likely someone has some sample output to compare to.4</p></li>\n <li>\n  <p>If you can&rsquo;t get your head around the algorithm in the task description then try to translate another language into Racket. You&rsquo;ll learn Racket, you&rsquo;ll learn the other language, and in working it through for yourself you&rsquo;ll also see how the algorithm takes shape and works.</p></li>\n <li>\n  <p>My workflow for posting a new solution is this: Once I have something to submit, I add a &ldquo;Stub&rdquo; Racket implementation. I edit the whole Task page (because that is all that is available to edit at that point), find whatever is after Racket alphabetically, and insert boilerplate code. I check this template code as a &ldquo;minor edit&rdquo; described as &ldquo;Racket stub added &mdash; implementation later&rdquo;. This then allows is for me to be able to edit the Racket section in isolation and keeps the rest of the task (everyone else&rsquo;s hard work) safe from any, er, silliness. <code>{{header|Racket}}\n&lt;lang racket&gt;\n&lt;/lang racket&gt;\n{{out}}\n&lt;pre&gt;\n&lt;/pre&gt;</code></p></li>\n <li>\n  <p>I have started to make it my habit (especially when showcasing one or two functions) to use <code>#lang racket/base</code> and <code>require</code>ing the salient individual functions.</p></li>\n <li>\n  <p>It is often not appropriate to fully document the functionality of Racket functions in the RC task implementation. You can, however, point to the canonical documentation on the Racket website. So I also include a link to <code>http://docs.racket-lang.org/reference/...</code> when I need to.</p></li>\n <li>\n  <p>The RC administrators have switched off image uploading (or I, at least, cannot find out how). Even though Racket can produce images as results, think hard about whether you want the hassle of trying to present images to the reader. If you find out a method that works for you <em>please tell me</em>, I&rsquo;d love to know. I suppose you could also extend all of the above to coding in another language &mdash; if you really have to.</p></li></ul>\n\n<h2 id=\"improve-whats-already-there\">Improve What&rsquo;s Already There</h2>\n\n<p> Rosetta Code is a wiki.</p>\n\n<p>It is open to anyone to edit.</p>\n\n<p> Don&rsquo;t be afraid to. If you see something that could be implemented, styled or documented better &mdash; work to improve it.</p>\n\n<p> Once you have your improved entry together, show it to the author of the original post. Besides being courteous, he or she might have an opinion on what else you might do. Often, there is something bugging them, and you are scratching an itch of theirs!</p>\n\n<p> I have never had anyone react badly to a change request. Everyone appreciates that you have made an effort to produce your change (and that you&rsquo;re not just standing in the aisles complaining that it doesn&rsquo;t look right).</p>\n\n<p> Teach Through It  &mdash;</p>\n\n<p>If there is an aspect of Racket, algorithm or other &ldquo;CS task&rdquo; (in the broadest sense) that you want to share: see to it that it is adequately illustrated on Rosetta Code. If it is not, then create a task to demonstrate it. Not only will you show how something is done properly (i.e. in Racket), but you will also be inviting others to implement the task in their own favourite languages.</p>\n\n<h2 id=\"the-competition\">The Competition</h2>\n\n<p> Back at <em>200</em>, Racket was the 54th most popular language. But for some time now, it has been sitting at #2 in the popularity1 ranking for quite some time now. For a while, it has been placed a long way behind TCL, and being hotly pursued by Python (never more than 10 tasks behind).</p>\n\n<p> One of <em>my</em> motivators is that having seen Racket get to #2 &mdash; I don&rsquo;t want to see it any lower in the rankings. I&rsquo;m sure there&rsquo;s something in the Python lot that wants to overtake us! This healthy competition has kept both of the communities pushing ahead with implementing the tasks.</p>\n\n<p> The <a href=\"https://github.com/plt/racket/wiki/Intro-Projects\"><em>Intro Projects</em></a> page of the racket wiki has &ldquo;Implement a Rosetta code task&rdquo; as a &ldquo;Small Project&rdquo;. I think of it as slightly more of a &ldquo;Recreational&rdquo; project (this at least justifies to myself the element of competition that has crept in.)</p>\n\n<p> The Rallying Call  &mdash;</p>\n\n<p> or <strong>&ldquo;What Specifically Would Help Racket on Rosetta Code?&rdquo;</strong></p>\n\n<p> RC is a good way to present Racket as a most general programming language. So as a tool for Racket advocacy, as well as for the purposes of RC, we need to:</p>\n\n<ul>\n <li>\n  <p><strong>Implement more tasks in Racket to keep a high profile:</strong> 800 tasks, #2 in the popularity stakes. This keeps Racket visible; and proves it capable of (almost) anything. I would <em>so</em> love to give TCL a run for its money &mdash; so there&rsquo;s 41 tasks to go before we can even think of taking a breather!</p></li>\n <li>\n  <p>We have implemented 800 tasks in Racket. The quote above says there are 892 (758+134) tasks in total. That means that there are 92 more tasks to get to grips with.</p></li>\n <li>\n  <p><strong>Suggest new tasks:</strong> Especially tasks that will demonstrate the latest shiny feature of the latest shiny versions of Racket!</p></li></ul>\n\n<p> Personally I can&rsquo;t believe that there are less than 900 things that you would want to do with a programming language. If you think of a task, add it. Even impossible tasks provoke thought and imagination &mdash; and interesting solutions!</p>\n\n<ul>\n <li>\n  <p><strong>Improve those tasks that have been implemented in Racket:</strong> We want to maintain a body of good, useful code, to allow us to teach and demonstrate Racket. There are a number of reasons why existent tasks need revisiting:</p></li>\n <li>\n  <p>Racket technology has moved on (and moves on) apace. What was unavailable and experimental even 18 months ago is now available and reliable. This new technology needs to be demonstrated.</p></li>\n <li>\n  <p>Code that is even older is very &ldquo;schemey&rdquo; (I have in some cases simply copied the Scheme implementation and stuck a <code>#lang racket</code> tag on the front). Although compatible, Racket has moved quite a way on from Scheme.</p></li>\n <li>\n  <p>Some implementors (not a million miles from where I&rsquo;m standing, for example), were not as <em>au fait</em> with the language and/or style guide as they might be now. It&rsquo;s a housekeeping job, I know, but giving the examples as consistent a style as possible will help satisfy this aspiration from the Racket Style Guide:</p></li></ul>\n\n<p> &ldquo;Doing so will help us … and our users, who use the open source code … as an implicit guide to Racket programming.&rdquo;</p>\n\n<ul>\n <li>\n  <p><strong>Document tasks:</strong> see my hint about documentation and links above for what I now think is good practice. If some code seems utterly heiroglyphic, see if it can be made clearer. Remember this is Racket, not APL.</p></li>\n <li>\n  <p>General tidying up never goes amiss.</p></li>\n <li>\n  <p>RC is run by someone outside the Racket community. At the bottom of the &ldquo;Small Projects&rdquo; section of the Racket wiki is a suggestion to collect the RC examples into something &ldquo;owned&rdquo; by the Racket community. I&rsquo;ve been thinking about this… if anyone has suggestions, let me know. There are limits to what we can put on RC (defined by the purpose of RC itself). It would be good to remove those limits by implementing something along RC&rsquo;s lines oursleves.</p></li>\n <li>\n  <p>Very specifically… anyone with a joystick, drivers and some spare time - please could you do &ldquo;Joystick Position&rdquo;. The possession of a joystick puts you in a position of <em>great power</em> with respect to that task. Exercise your responsibility. And Finally…: Well done everyone again! Keep up the good work. And see you at 1000!</p></li>\n <li>\n  <p>You can track Racket (and everyone else&rsquo;s) progress on the <a href=\"http://timb.net/popular-languages.html\">Popular Programming Languages</a> report, which is updated hourly or so.<a href=\"#g76184-footnote-1-return\">↩</a></p></li>\n <li>\n  <p>Rosetta Code&rsquo;s Front Page<a href=\"#g76184-footnote-2-return\">↩</a></p></li>\n <li>\n  <p>The style guide is actually the chapter called &ldquo;How to Program Racket&rdquo; in the main Racket documentation. One of the RC &ldquo;style&rdquo; rules is that code should be 80 characters wide. Personally, I ignore that in favour of Racket&rsquo;s more generous 102. Sometimes someone on RC objects. Sometimes I then care enough to put the required newlines in.<a href=\"#g76184-footnote-3-return\">↩</a></p></li>\n <li>\n  <p>Even if there are example results don&rsquo;t necessarily trust them. e.g. in <a href=\"http://rosettacode.org/wiki/The_ISAAC_Cipher\">The ISAAC Cipher</a>, the cypher engine isn&rsquo;t reset between test runs in the Pascal implementation. That error is propagated through all other implementations. Mine (Racket) conforms to show that I&rsquo;m doing the same thing as everyone else; but I also do what I think to be a more correct test later.<a href=\"#g76184-footnote-4-return\">↩</a></p></li>\n <li>\n  <p>Hold on a mo… this is meant to be a pedagogical exercise, not a competition<a href=\"#g76184-footnote-5-return\">↩</a></p></li></ul>\n<!-- more-->\n\n<hr />\n\n<p>That&rsquo;s good! But, it&rsquo;s also interesting what real projects use Racket. Is this information available?</p>\n\n<p>— <em>Роман Николаевич, 24 November 2014</em></p>\n\n<hr />\n\n<p>Hi Роман. You can look at the videos from the third and fourth RacketCons which have several talks from industrial users of Racket: https://www.youtube.com/user/racketlang/playlists</p>\n\n<p>— <em>Racket Lang, 24 November 2014</em></p>\n\n<hr />\n\n<p>Congrats guys.</p>\n\n<p>— <em>Paddy3118, 16 December 2014</em></p>\n\n<hr />")) ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2007-08-07-plt-modules-and-separate-compilation.md" . unix) f post (u . "PLT Modules and Separate Compilation") (? . 65) 1467223812 (p+ #"/Users/MB/git/racket-lang-org/blog/2007/08/plt-modules-and-separate-compilation.html" . unix) "/2007/08/plt-modules-and-separate-compilation.html" (u . "2007-08-07T20:41:00.001-04:00") (? . 64) (? . 105) (c (u . "")) (u . "\n<p><em>posted by Richard Cobbe</em></p>\n\n<p>For my summer job this year, I&rsquo;m programming in Common Lisp; this is the first time I&rsquo;ve used the language for anything more than toy examples. The experience has given me new appreciation for the PLT module system and how it enables separate compilation.</p>\n\n<p>Lisp has a package system, of course, but it&rsquo;s not the same thing. It&rsquo;s primarily a tool to make sure that the symbols in one part of the program don&rsquo;t collide with the symbols in another part (unless you ask them to). Packages aren&rsquo;t about abstraction: while you can specify which symbols are exported from the package and which aren&rsquo;t, that&rsquo;s just a suggestion that&rsquo;s not enforced by the language.</p>\n\n<p>(You&rsquo;ll notice, by the way, that I used the word &ldquo;symbol&rdquo; and not &ldquo;identifier,&rdquo; which is the more common term in the study of programming languages, in the previous paragraph. That&rsquo;s deliberate: the Lisp package system works on symbols, not identifiers, so it also affects quoted, literal symbols. In my experience, this is sometimes helpful, sometimes a real pain, and usually completely unexpected. But that&rsquo;s a topic for another post.)</p>\n\n<p>Also, there&rsquo;s no real relationship between Lisp packages and files. One package can be spread across multiple files, and one file can contain code in several different packages.</p>\n\n<p>All this means that separate compilation in Lisp is a real problem. There is a system, ASDF, that attempts to address this need. (For more details, consult <a href=\"http://www.cliki.net/asdf\">the closest thing to a homepage</a> that I could find for ASDF.) I&rsquo;m no expert on ASDF, but essentially the programmer specifies the dependencies between source files, in a set of files that exist parallel to the Lisp source. (ASDF does support grouping source files into larger chunks and specifying dependencies between those chunks, but as far as I can tell that&rsquo;s largely a convenience thing.)</p>\n\n<p>The key thing for separate compilation, of course, is the dependencies. With ASDF, the programmer specifies those manually, and then ASDF basically does a topological sort such that if file a depends on file b, then ASDF ensures that a is compiled and loaded before b is compiled, and again before B is loaded. (This should start sounding a little familiar to folks who&rsquo;ve worked in the area where PLT&rsquo;s modules and macros intersect.)</p>\n\n<p>So far, so good. Unfortunately, there are a couple of problems with this setup. First, the dependencies between files are specified outside the language. This means that, if you happen to forget one, the results are not well-defined. If ASDF happens to choose an order that&rsquo;s consistent with the dependency you left out, everything will just work, and you won&rsquo;t have any indication that there&rsquo;s a problem. If, however, it doesn&rsquo;t, then you&rsquo;ll get random &ldquo;undefined function&rdquo; and &ldquo;undefined symbol&rdquo; errors&mdash;if you&rsquo;re lucky (at least in SBCL, the implementation of Common Lisp that I use at my job). In PLT, by contrast, inter-module dependencies are part of the language, so the compiler will always give you an undefined-identifier error when it tries to compile a module in which you&rsquo;ve forgotten a require form. Big win, in my opinion (although we could argue about whether this should be an error or a warning, and whether the compiler should report lots of errors or just one before giving up completely).</p>\n\n<p>Second, because ASDF lives outside the compiler, it can&rsquo;t be very smart about how macros affect separate compilation. I don&rsquo;t fully understand this, perhaps because the folks who&rsquo;ve been mentoring me at my job haven&rsquo;t thought it worth the time to explain it to me fully. But it appears that, if you change a macro that&rsquo;s used in other files, or change a function that&rsquo;s called by a macro at expansion time, you have to do the effect of a make clean in a distressingly large number of cases. This is a real problem when you&rsquo;ve got a large source base (~200K LOC, I think) and you&rsquo;re trying to speed up builds, as we are, and it&rsquo;s especially problematic if you&rsquo;re trying to run unrelated parts of the build in parallel.</p>\n\n<p>I&rsquo;ve certainly griped about the complexity of the interaction between PLT&rsquo;s modules and macros in the past. But after this summer, I have to say it&rsquo;s awfully nice to have a module system that Just Works for separate compilation. Nicely done, Matthew.</p>\n\n<p>(I&rsquo;ve pointed the folks at work at Matthew&rsquo;s <a href=\"http://www.cs.utah.edu/plt/publications/macromod.pdf\">ICFP 02 paper</a>, but as that technique requires a lot of support from the compiler, and we don&rsquo;t have the resources to add the necessary support to SBCL ourselves, I don&rsquo;t know that it&rsquo;ll be more than a &ldquo;wouldn&rsquo;t it be nice if we could do that?&rdquo;)</p>\n\n<p>(Answer to rhetorical question in preceding paragraph: Yes. Yes it would.)</p>") #t (u . "\n<p><em>posted by Richard Cobbe</em></p>\n\n<p>For my summer job this year, I&rsquo;m programming in Common Lisp; this is the first time I&rsquo;ve used the language for anything more than toy examples. The experience has given me new appreciation for the PLT module system and how it enables separate compilation.</p>\n\n<p>Lisp has a package system, of course, but it&rsquo;s not the same thing. It&rsquo;s primarily a tool to make sure that the symbols in one part of the program don&rsquo;t collide with the symbols in another part (unless you ask them to). Packages aren&rsquo;t about abstraction: while you can specify which symbols are exported from the package and which aren&rsquo;t, that&rsquo;s just a suggestion that&rsquo;s not enforced by the language.</p>\n\n<p>(You&rsquo;ll notice, by the way, that I used the word &ldquo;symbol&rdquo; and not &ldquo;identifier,&rdquo; which is the more common term in the study of programming languages, in the previous paragraph. That&rsquo;s deliberate: the Lisp package system works on symbols, not identifiers, so it also affects quoted, literal symbols. In my experience, this is sometimes helpful, sometimes a real pain, and usually completely unexpected. But that&rsquo;s a topic for another post.)</p>\n\n<p>Also, there&rsquo;s no real relationship between Lisp packages and files. One package can be spread across multiple files, and one file can contain code in several different packages.</p>\n\n<p>All this means that separate compilation in Lisp is a real problem. There is a system, ASDF, that attempts to address this need. (For more details, consult <a href=\"http://www.cliki.net/asdf\">the closest thing to a homepage</a> that I could find for ASDF.) I&rsquo;m no expert on ASDF, but essentially the programmer specifies the dependencies between source files, in a set of files that exist parallel to the Lisp source. (ASDF does support grouping source files into larger chunks and specifying dependencies between those chunks, but as far as I can tell that&rsquo;s largely a convenience thing.)</p>\n\n<p>The key thing for separate compilation, of course, is the dependencies. With ASDF, the programmer specifies those manually, and then ASDF basically does a topological sort such that if file a depends on file b, then ASDF ensures that a is compiled and loaded before b is compiled, and again before B is loaded. (This should start sounding a little familiar to folks who&rsquo;ve worked in the area where PLT&rsquo;s modules and macros intersect.)</p>\n\n<p>So far, so good. Unfortunately, there are a couple of problems with this setup. First, the dependencies between files are specified outside the language. This means that, if you happen to forget one, the results are not well-defined. If ASDF happens to choose an order that&rsquo;s consistent with the dependency you left out, everything will just work, and you won&rsquo;t have any indication that there&rsquo;s a problem. If, however, it doesn&rsquo;t, then you&rsquo;ll get random &ldquo;undefined function&rdquo; and &ldquo;undefined symbol&rdquo; errors&mdash;if you&rsquo;re lucky (at least in SBCL, the implementation of Common Lisp that I use at my job). In PLT, by contrast, inter-module dependencies are part of the language, so the compiler will always give you an undefined-identifier error when it tries to compile a module in which you&rsquo;ve forgotten a require form. Big win, in my opinion (although we could argue about whether this should be an error or a warning, and whether the compiler should report lots of errors or just one before giving up completely).</p>\n\n<p>Second, because ASDF lives outside the compiler, it can&rsquo;t be very smart about how macros affect separate compilation. I don&rsquo;t fully understand this, perhaps because the folks who&rsquo;ve been mentoring me at my job haven&rsquo;t thought it worth the time to explain it to me fully. But it appears that, if you change a macro that&rsquo;s used in other files, or change a function that&rsquo;s called by a macro at expansion time, you have to do the effect of a make clean in a distressingly large number of cases. This is a real problem when you&rsquo;ve got a large source base (~200K LOC, I think) and you&rsquo;re trying to speed up builds, as we are, and it&rsquo;s especially problematic if you&rsquo;re trying to run unrelated parts of the build in parallel.</p>\n\n<p>I&rsquo;ve certainly griped about the complexity of the interaction between PLT&rsquo;s modules and macros in the past. But after this summer, I have to say it&rsquo;s awfully nice to have a module system that Just Works for separate compilation. Nicely done, Matthew.</p>\n\n<p>(I&rsquo;ve pointed the folks at work at Matthew&rsquo;s <a href=\"http://www.cs.utah.edu/plt/publications/macromod.pdf\">ICFP 02 paper</a>, but as that technique requires a lot of support from the compiler, and we don&rsquo;t have the resources to add the necessary support to SBCL ourselves, I don&rsquo;t know that it&rsquo;ll be more than a &ldquo;wouldn&rsquo;t it be nice if we could do that?&rdquo;)</p>\n\n<p>(Answer to rhetorical question in preceding paragraph: Yes. Yes it would.)</p>\n<!-- more-->\n\n<hr />\n\n<p>What exactly do you mean by random errors? If you get a &ldquo;undefined function FOO&rdquo; error that&rsquo;s a pretty clear indication that whatever file defines FOO should be defined as a dependency.</p>\n\n<p>Also, if you wish to speed up compilation by determining precise dependencies between files in your system asdf-dependency-grovel might be a useful little tool.</p>\n\n<p>— <em>Luís, 7 August 2007</em></p>\n\n<hr />\n\n<p>I agree about the issue of macros &mdash; ASDF does not allow you to say &ldquo;this system exports a macro, and if the macro has changed, all downstream systems should be recompiled.&rdquo; This is left as an exercise to the reader, and I have certainly been caused severe pain by that.</p>\n\n<p>WRT &ldquo;compiler support,&rdquo; I don&rsquo;t really agree with you. This is Common Lisp, after all, and I like the fact that ASDF works on SBCL and Allegro Common Lisp, etc.</p>\n\n<p>— <em>Robert, 16 August 2007</em></p>\n\n<hr />\n\n<p>Hellow. Could you please advice something like PLT but for SBCL. Sorry for the oftopic.</p>\n\n<p>— <em>Dmitrenko Evgenij, 23 December 2009</em></p>\n\n<hr />")) ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2016-02-08-racket-web-server-security-vulnerability.md" . unix) f post (u . "Racket Web Server Security Vulnerability") (? . 2) 1467223812 (p+ #"/Users/MB/git/racket-lang-org/blog/2016/02/racket-web-server-security-vulnerability.html" . unix) "/2016/02/racket-web-server-security-vulnerability.html" (u . "2016-02-08T14:05:00.000-05:00") (? . 3) (? . 21) (c (u . "")) (u . "\n<p><em>posted by Sam Tobin-Hochstadt</em></p>\n\n<p>We recently discovered a serious security vulnerability in the Racket web server, which can lead to unintended disclosure of files on the machine running the web server. This vulnerability is fixed in <a href=\"../../2016/02/racket-v64.html\">Racket version 6.4</a>, just released, and we encourage people to upgrade to that version.</p>\n\n<p>The vulnerability affects web servers that serve static files using the <code>#:extra-files-paths</code> option, including the default value of this option. If you do not use the Racket web serve to serve static files, or you do so via a mechanism that does not use the <code>make-url-&gt;path</code> function, then you are likely not vulnerable. Affected web serves will allow specially-crafted URLs to access files outside of the specified paths, potentially exposing any file that the web server process is able to read.</p>\n\n<p>If you cannot immediately upgrade to version 6.4, we have provided a package catalog with updated versions of the &ldquo;web-server-lib&rdquo; package for versions of Racket back to 6.0. That catalog is located at</p>\n\n<p><a href=\"http://download.racket-lang.org/patches/web-server-1/\">http://download.racket-lang.org/patches/web-server&ndash;1/</a></p>\n\n<p>To use it to upgrade your Racket installation, add it as a catalog using <code>raco pkg config</code>. To make this process easier, you can download the Racket script available <a href=\"https://gist.github.com/samth/c81e1e2fabc744759970\">here</a>. Then run:</p>\n\n<div class=\"brush: bash\">\n <div class=\"pygments\">\n  <pre><span class=\"nv\">$ </span>racket add-catalog.rkt\n<span class=\"nv\">$ </span>raco pkg update -i web-server-lib\n</pre></div>\n\n</div>\n\n<p>If you need advice on updating Racket installations older than version 6.0, please let us know and we will provide them.</p>\n\n<p>To test that your Racket installation is fixed, you can run <a href=\"https://gist.github.com/samth/740cc39eb6c0d9bd7bc3\">the program here</a>. It will print whether your installation is out of date.</p>") #f (u . "\n<p><em>posted by Sam Tobin-Hochstadt</em></p>\n\n<p>We recently discovered a serious security vulnerability in the Racket web server, which can lead to unintended disclosure of files on the machine running the web server. This vulnerability is fixed in <a href=\"../../2016/02/racket-v64.html\">Racket version 6.4</a>, just released, and we encourage people to upgrade to that version.</p>\n\n<p>The vulnerability affects web servers that serve static files using the <code>#:extra-files-paths</code> option, including the default value of this option. If you do not use the Racket web serve to serve static files, or you do so via a mechanism that does not use the <code>make-url-&gt;path</code> function, then you are likely not vulnerable. Affected web serves will allow specially-crafted URLs to access files outside of the specified paths, potentially exposing any file that the web server process is able to read.</p>\n\n<p>If you cannot immediately upgrade to version 6.4, we have provided a package catalog with updated versions of the &ldquo;web-server-lib&rdquo; package for versions of Racket back to 6.0. That catalog is located at</p>\n\n<p><a href=\"http://download.racket-lang.org/patches/web-server-1/\">http://download.racket-lang.org/patches/web-server&ndash;1/</a></p>\n\n<p>To use it to upgrade your Racket installation, add it as a catalog using <code>raco pkg config</code>. To make this process easier, you can download the Racket script available <a href=\"https://gist.github.com/samth/c81e1e2fabc744759970\">here</a>. Then run:</p>\n\n<div class=\"brush: bash\">\n <div class=\"pygments\">\n  <pre><span class=\"nv\">$ </span>racket add-catalog.rkt\n<span class=\"nv\">$ </span>raco pkg update -i web-server-lib\n</pre></div>\n\n</div>\n\n<p>If you need advice on updating Racket installations older than version 6.0, please let us know and we will provide them.</p>\n\n<p>To test that your Racket installation is fixed, you can run <a href=\"https://gist.github.com/samth/740cc39eb6c0d9bd7bc3\">the program here</a>. It will print whether your installation is out of date.</p>")) ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2007-05-10-xml-transformation-in-scheme.md" . unix) f post (u . "XML Transformation in Scheme") (? . 102) 1467223812 (p+ #"/Users/MB/git/racket-lang-org/blog/2007/05/xml-transformation-in-scheme.html" . unix) "/2007/05/xml-transformation-in-scheme.html" (u . "2007-05-10T12:04:00.000-04:00") (? . 130) (? . 101) (c (u . "")) (u . "\n<p><em>posted by Noel</em></p>\n\n<p><a href=\"http://www.openqa.org/selenium/\">Selenium</a> is a tool for testing web applications, the core of which is a Javascript library that controls a web browser. With the <a href=\"http://www.openqa.org/selenium-ide/\">Selenium IDE</a> you can convert your actions in a web browser into tests, and with the <a href=\"http://www.openqa.org/selenium-rc/\">Selenium Remote Control</a> you can control a web browser from code. I&rsquo;ve recently been working on adding Selenium Remote Control bindings to PLT Scheme, which has resulted in a nice and hopefully instructional demonstration of XML transformation in PLT Scheme</p>\n\n<p>The Selenium Remote Control is controlled by sending simple messages over HTTP. The format of the messages isn&rsquo;t important. What is, is that there are a lot of them, and the API is specified in a file called <code>iedoc.xml</code> that comes with Selenium. The Java/Python/Ruby bindings are generated using <a href=\"http://www.w3.org/Style/XSL/\">XSL</a>. If I was to use XSL I&rsquo;d have a processing pipeline that uses three languages (XSL, Java, Scheme) which is two more than I&rsquo;d like. Hence I turned to <a href=\"http://planet.plt-scheme.org/display.ss?package=webit.plt&amp;owner=jim\">WebIt!</a>, an XML transformation DSL written in Scheme, to create an all Scheme pipeline. The rest of this post wshows the steps I used to transform the Selenium API into Scheme code using WebIt! I think this is interesting in its own right, but also serves as a nice demonstration of the power of macros, which WebIt! makes extensive use of.</p>\n\n<p>My first step is to get an idea of the structure of the XML. The bits I&rsquo;m interested in look like this:</p>\n\n<div class=\"brush: html\">\n <div class=\"pygments\">\n  <pre><span class=\"nt\">&lt;function</span> <span class=\"na\">name=</span><span class=\"s\">\"click\"</span><span class=\"nt\">&gt;</span>\n  <span class=\"nt\">&lt;param</span> <span class=\"na\">name=</span><span class=\"s\">\"locator\"</span><span class=\"nt\">&gt;</span>an element locator<span class=\"nt\">&lt;/param&gt;</span>\n  <span class=\"nt\">&lt;comment&gt;</span>Clicks on a link, button, checkbox or radio button.\n  If the click action causes a new page to load (like a link usually\n  does), call waitForPageToLoad.<span class=\"nt\">&lt;/comment&gt;</span>\n<span class=\"nt\">&lt;/function&gt;</span>\n</pre></div>\n\n</div>\n\n<p>Let&rsquo;s read in the XML file and extract all the <code>function</code> elements. For this I&rsquo;ll use SSAX and SXPath:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">require</span>\n <span class=\"p\">(</span><span class=\"k\">planet</span> <span class=\"s2\">\"ssax.ss\"</span> <span class=\"p\">(</span><span class=\"s2\">\"lizorkin\"</span> <span class=\"s2\">\"ssax.plt\"</span> <span class=\"mi\">1</span><span class=\"p\">))</span>\n <span class=\"p\">(</span><span class=\"k\">only</span> <span class=\"p\">(</span><span class=\"k\">planet</span> <span class=\"s2\">\"sxml.ss\"</span> <span class=\"p\">(</span><span class=\"s2\">\"lizorkin\"</span> <span class=\"s2\">\"sxml.plt\"</span> <span class=\"mi\">1</span><span class=\"p\">))</span> <span class=\"n\">sxpath</span><span class=\"p\">))</span>\n\n<span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"n\">api</span>\n  <span class=\"p\">(</span><span class=\"nb\">with-input-from-file</span> <span class=\"s2\">\"iedoc.xml\"</span>\n    <span class=\"p\">(</span><span class=\"k\">lambda</span> <span class=\"p\">()</span> <span class=\"p\">(</span><span class=\"n\">ssax:xml-&gt;sxml</span> <span class=\"p\">(</span><span class=\"nb\">current-input-port</span><span class=\"p\">)</span> <span class=\"o\">&#39;</span><span class=\"p\">()))))</span>\n\n<span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"n\">functions</span>\n  <span class=\"p\">((</span><span class=\"n\">sxpath</span> <span class=\"o\">&#39;</span><span class=\"p\">(</span><span class=\"ss\">//</span> <span class=\"ss\">function</span><span class=\"p\">))</span> <span class=\"n\">api</span><span class=\"p\">))</span>\n</pre></div>\n\n</div>\n\n<p>Ok, so we have all the functions. Now let&rsquo;s parse them into a more useful datastructure. Here&rsquo;s my first attempt:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">require</span> <span class=\"p\">(</span><span class=\"k\">planet</span> <span class=\"s2\">\"xml.ss\"</span> <span class=\"p\">(</span><span class=\"s2\">\"jim\"</span> <span class=\"s2\">\"webit.plt\"</span> <span class=\"mi\">1</span> <span class=\"mi\">5</span><span class=\"p\">)))</span>\n\n<span class=\"c1\">;; struct function : string (listof string)</span>\n<span class=\"p\">(</span><span class=\"k\">define-struct</span> <span class=\"n\">function</span> <span class=\"p\">(</span><span class=\"n\">name</span> <span class=\"n\">params</span><span class=\"p\">))</span>\n\n<span class=\"c1\">;; parse-function : sxml -&gt; function</span>\n<span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">parse-function</span> <span class=\"n\">fn</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"n\">xml-match</span> <span class=\"n\">fn</span>\n    <span class=\"p\">[(</span><span class=\"n\">function</span> <span class=\"n\">name:</span> <span class=\"o\">,</span><span class=\"n\">name</span>\n               <span class=\"p\">(</span><span class=\"n\">param</span> <span class=\"n\">name:</span> <span class=\"o\">,</span><span class=\"n\">param-name</span> <span class=\"o\">,</span><span class=\"n\">desc</span><span class=\"p\">)</span> <span class=\"k\">...</span>\n               <span class=\"p\">(</span><span class=\"n\">comment</span> <span class=\"o\">,</span><span class=\"k\">_</span> <span class=\"k\">...</span><span class=\"p\">))</span>\n     <span class=\"p\">(</span><span class=\"n\">make-function</span> <span class=\"n\">name</span> <span class=\"p\">(</span><span class=\"nb\">list</span> <span class=\"n\">param-name</span> <span class=\"k\">...</span><span class=\"p\">))]))</span>\n\n<span class=\"p\">(</span><span class=\"nb\">map</span> <span class=\"n\">parse-function</span> <span class=\"n\">functions</span><span class=\"p\">)</span>\n</pre></div>\n\n</div>\n\n<p>The <code>xml-match</code> macro is a pattern matcher for SXML. You specify the &ldquo;shape&rdquo; of the SXML, and if the input matches the pattern the following expressions are evaluated:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"n\">xml-match</span> <span class=\"n\">value</span>\n  <span class=\"p\">[(</span><span class=\"n\">pattern</span> <span class=\"n\">expression</span> <span class=\"n\">_..._</span><span class=\"p\">)]</span><span class=\"n\">_..._</span><span class=\"p\">)</span>\n</pre></div>\n\n</div>\n\n<p>The simplified form of a pattern is:</p>\n\n<ul>\n <li>\n  <p><code>(element _..._)</code> matches an element with the given name.</p></li>\n <li>\n  <p><code>name: value</code> matches an attribute with the given name and value.</p></li>\n <li>\n  <p><code>,binding</code> binds the value of <code>binding</code> to the given name in the scope of the following expressions.</p></li>\n <li>\n  <p><code>...</code> matches zero or more of the preceeding patterns.</p></li></ul>\n\n<p>In our example the pattern is:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre>     <span class=\"p\">(</span><span class=\"n\">function</span> <span class=\"n\">name:</span> <span class=\"o\">,</span><span class=\"n\">name</span>\n               <span class=\"p\">(</span><span class=\"n\">param</span> <span class=\"n\">name:</span> <span class=\"o\">,</span><span class=\"n\">param-name</span> <span class=\"o\">,</span><span class=\"n\">desc</span><span class=\"p\">)</span> <span class=\"k\">...</span>\n               <span class=\"p\">(</span><span class=\"n\">comment</span> <span class=\"o\">,</span><span class=\"k\">_</span> <span class=\"k\">...</span><span class=\"p\">))</span>\n</pre></div>\n\n</div>\n\n<p>So we&rsquo;re looking for an element called <code>function</code> with an attribute called <code>name</code> the value of which is bound to <code>name</code>. Then follows zero or more <code>param</code> elements, with attribute <code>name</code>, the value of which is bound to <code>param-name</code>. Finally we expect a <code>comment</code> element which can contain any amount of data. The use of <code>_</code> as the binding name is a common convention to indicate data we don&rsquo;t care about but must still match to make our pattern complete.</p>\n\n<p>I run the code in DrScheme and see the result:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"n\">_xml-match:</span> <span class=\"n\">no</span> <span class=\"n\">matching</span> <span class=\"n\">clause</span> <span class=\"n\">found_</span>\n</pre></div>\n\n</div>\n\n<p>Oops. So our pattern isn&rsquo;t complete. We&rsquo;ve also seen one flaw of WebIt!: it doesn&rsquo;t give very good error messages. However we can easily fix this by adding a catch all pattern that raises an error telling us what we failed to match. The code follows. Notice that I&rsquo;ve also added pretty printing to make the unmatched SXML easier to read.</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">require</span> <span class=\"p\">(</span><span class=\"k\">lib</span> <span class=\"s2\">\"pretty.ss\"</span><span class=\"p\">))</span>\n\n<span class=\"c1\">;; parse-function : sxml -&gt; function</span>\n<span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">parse-function</span> <span class=\"n\">fn</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"n\">xml-match</span> <span class=\"n\">fn</span>\n    <span class=\"p\">[(</span><span class=\"n\">function</span> <span class=\"n\">name:</span> <span class=\"o\">,</span><span class=\"n\">name</span>\n               <span class=\"p\">(</span><span class=\"n\">param</span> <span class=\"n\">name:</span> <span class=\"o\">,</span><span class=\"n\">param-name</span> <span class=\"o\">,</span><span class=\"n\">desc</span><span class=\"p\">)</span> <span class=\"k\">...</span>\n               <span class=\"p\">(</span><span class=\"n\">comment</span> <span class=\"o\">,</span><span class=\"k\">_</span> <span class=\"k\">...</span><span class=\"p\">))</span>\n     <span class=\"p\">(</span><span class=\"n\">make-function</span> <span class=\"n\">name</span> <span class=\"p\">(</span><span class=\"nb\">list</span> <span class=\"n\">param-name</span> <span class=\"k\">...</span><span class=\"p\">))]</span>\n    <span class=\"p\">[</span><span class=\"o\">,</span><span class=\"n\">err</span> <span class=\"p\">(</span><span class=\"k\">let</span> <span class=\"p\">([</span><span class=\"n\">op</span> <span class=\"p\">(</span><span class=\"nb\">open-output-string</span><span class=\"p\">)])</span>\n            <span class=\"p\">(</span><span class=\"nb\">pretty-print</span> <span class=\"n\">err</span> <span class=\"n\">op</span><span class=\"p\">)</span>\n            <span class=\"p\">(</span><span class=\"nb\">error</span> <span class=\"p\">(</span><span class=\"nb\">format</span> <span class=\"s2\">\"Didn&#39;t match ~n~a~n\"</span> <span class=\"p\">(</span><span class=\"nb\">get-output-string</span> <span class=\"n\">op</span><span class=\"p\">))))]))</span>\n</pre></div>\n\n</div>\n\n<p>Run this code and you&rsquo;ll see the error occurs as we don&rsquo;t allow the description to contain more than one element. This is easily fixed by extending the pattern to <code>,desc ...</code>. The next error is more interesting. The <code>function</code> element contains a <code>return</code> element. The WebIt! pattern language doesn&rsquo;t allows us to express optional patterns, so we have to duplicate our pattern and include the case of <code>return</code>. This also requires we extend the defintion of the <code>function</code> structure.</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"c1\">;; struct function : string string (listof string)</span>\n<span class=\"p\">(</span><span class=\"k\">define-struct</span> <span class=\"n\">function</span> <span class=\"p\">(</span><span class=\"n\">name</span> <span class=\"n\">return</span> <span class=\"n\">params</span><span class=\"p\">))</span>\n\n<span class=\"c1\">;; parse-function : sxml -&gt; function</span>\n<span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">parse-function</span> <span class=\"n\">fn</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"n\">xml-match</span> <span class=\"n\">fn</span>\n    <span class=\"p\">[(</span><span class=\"n\">function</span> <span class=\"n\">name:</span> <span class=\"o\">,</span><span class=\"n\">name</span>\n               <span class=\"p\">(</span><span class=\"n\">param</span> <span class=\"n\">name:</span> <span class=\"o\">,</span><span class=\"n\">param-name</span> <span class=\"o\">,</span><span class=\"n\">desc</span> <span class=\"k\">...</span><span class=\"p\">)</span> <span class=\"k\">...</span>\n               <span class=\"p\">(</span><span class=\"n\">comment</span> <span class=\"o\">,</span><span class=\"k\">_</span> <span class=\"k\">...</span><span class=\"p\">))</span>\n     <span class=\"p\">(</span><span class=\"n\">make-function</span> <span class=\"n\">name</span> <span class=\"s2\">\"void\"</span> <span class=\"p\">(</span><span class=\"nb\">list</span> <span class=\"n\">param-name</span> <span class=\"k\">...</span><span class=\"p\">))]</span>\n    <span class=\"p\">[(</span><span class=\"n\">function</span> <span class=\"n\">name:</span> <span class=\"o\">,</span><span class=\"n\">name</span>\n               <span class=\"p\">(</span><span class=\"n\">return</span> <span class=\"n\">type:</span> <span class=\"o\">,</span><span class=\"n\">type</span> <span class=\"o\">,</span><span class=\"n\">return-desc</span> <span class=\"k\">...</span><span class=\"p\">)</span>\n               <span class=\"p\">(</span><span class=\"n\">param</span> <span class=\"n\">name:</span> <span class=\"o\">,</span><span class=\"n\">param-name</span> <span class=\"o\">,</span><span class=\"n\">desc</span> <span class=\"k\">...</span><span class=\"p\">)</span> <span class=\"k\">...</span>\n               <span class=\"p\">(</span><span class=\"n\">comment</span> <span class=\"o\">,</span><span class=\"k\">_</span> <span class=\"k\">...</span><span class=\"p\">))</span>\n     <span class=\"p\">(</span><span class=\"n\">make-function</span> <span class=\"n\">name</span> <span class=\"n\">type</span> <span class=\"p\">(</span><span class=\"nb\">list</span> <span class=\"n\">param-name</span> <span class=\"k\">...</span><span class=\"p\">))]</span>\n    <span class=\"p\">[</span><span class=\"o\">,</span><span class=\"n\">err</span> <span class=\"p\">(</span><span class=\"k\">let</span> <span class=\"p\">([</span><span class=\"n\">op</span> <span class=\"p\">(</span><span class=\"nb\">open-output-string</span><span class=\"p\">)])</span>\n            <span class=\"p\">(</span><span class=\"nb\">pretty-print</span> <span class=\"n\">err</span> <span class=\"n\">op</span><span class=\"p\">)</span>\n            <span class=\"p\">(</span><span class=\"nb\">error</span> <span class=\"p\">(</span><span class=\"nb\">format</span> <span class=\"s2\">\"Didn&#39;t match ~n~a~n\"</span> <span class=\"p\">(</span><span class=\"nb\">get-output-string</span> <span class=\"n\">op</span><span class=\"p\">))))]))</span>\n</pre></div>\n\n</div>\n\n<p>This works! This is as far as I want to go in this article. We&rsquo;ve seen how we can use SSAX. SXPath, and WebIt! to create XML transforms in pure Scheme. There is a lot more to all of these packages but what we&rsquo;ve used is sufficient for many uses. The rest of the code to create Scheme from the API is quite straightforward and specific to Selenium. If you&rsquo;re curious read the source of the Selenium PLaneT package, which will be released soon.</p>\n\n<p><em>This post also appears on <a href=\"http://www.untyped.com/untyping\">Untyping</a></em></p>") #t (u . "\n<p><em>posted by Noel</em></p>\n\n<p><a href=\"http://www.openqa.org/selenium/\">Selenium</a> is a tool for testing web applications, the core of which is a Javascript library that controls a web browser. With the <a href=\"http://www.openqa.org/selenium-ide/\">Selenium IDE</a> you can convert your actions in a web browser into tests, and with the <a href=\"http://www.openqa.org/selenium-rc/\">Selenium Remote Control</a> you can control a web browser from code. I&rsquo;ve recently been working on adding Selenium Remote Control bindings to PLT Scheme, which has resulted in a nice and hopefully instructional demonstration of XML transformation in PLT Scheme</p>\n\n<p>The Selenium Remote Control is controlled by sending simple messages over HTTP. The format of the messages isn&rsquo;t important. What is, is that there are a lot of them, and the API is specified in a file called <code>iedoc.xml</code> that comes with Selenium. The Java/Python/Ruby bindings are generated using <a href=\"http://www.w3.org/Style/XSL/\">XSL</a>. If I was to use XSL I&rsquo;d have a processing pipeline that uses three languages (XSL, Java, Scheme) which is two more than I&rsquo;d like. Hence I turned to <a href=\"http://planet.plt-scheme.org/display.ss?package=webit.plt&amp;owner=jim\">WebIt!</a>, an XML transformation DSL written in Scheme, to create an all Scheme pipeline. The rest of this post wshows the steps I used to transform the Selenium API into Scheme code using WebIt! I think this is interesting in its own right, but also serves as a nice demonstration of the power of macros, which WebIt! makes extensive use of.</p>\n\n<p>My first step is to get an idea of the structure of the XML. The bits I&rsquo;m interested in look like this:</p>\n\n<div class=\"brush: html\">\n <div class=\"pygments\">\n  <pre><span class=\"nt\">&lt;function</span> <span class=\"na\">name=</span><span class=\"s\">\"click\"</span><span class=\"nt\">&gt;</span>\n  <span class=\"nt\">&lt;param</span> <span class=\"na\">name=</span><span class=\"s\">\"locator\"</span><span class=\"nt\">&gt;</span>an element locator<span class=\"nt\">&lt;/param&gt;</span>\n  <span class=\"nt\">&lt;comment&gt;</span>Clicks on a link, button, checkbox or radio button.\n  If the click action causes a new page to load (like a link usually\n  does), call waitForPageToLoad.<span class=\"nt\">&lt;/comment&gt;</span>\n<span class=\"nt\">&lt;/function&gt;</span>\n</pre></div>\n\n</div>\n\n<p>Let&rsquo;s read in the XML file and extract all the <code>function</code> elements. For this I&rsquo;ll use SSAX and SXPath:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">require</span>\n <span class=\"p\">(</span><span class=\"k\">planet</span> <span class=\"s2\">\"ssax.ss\"</span> <span class=\"p\">(</span><span class=\"s2\">\"lizorkin\"</span> <span class=\"s2\">\"ssax.plt\"</span> <span class=\"mi\">1</span><span class=\"p\">))</span>\n <span class=\"p\">(</span><span class=\"k\">only</span> <span class=\"p\">(</span><span class=\"k\">planet</span> <span class=\"s2\">\"sxml.ss\"</span> <span class=\"p\">(</span><span class=\"s2\">\"lizorkin\"</span> <span class=\"s2\">\"sxml.plt\"</span> <span class=\"mi\">1</span><span class=\"p\">))</span> <span class=\"n\">sxpath</span><span class=\"p\">))</span>\n\n<span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"n\">api</span>\n  <span class=\"p\">(</span><span class=\"nb\">with-input-from-file</span> <span class=\"s2\">\"iedoc.xml\"</span>\n    <span class=\"p\">(</span><span class=\"k\">lambda</span> <span class=\"p\">()</span> <span class=\"p\">(</span><span class=\"n\">ssax:xml-&gt;sxml</span> <span class=\"p\">(</span><span class=\"nb\">current-input-port</span><span class=\"p\">)</span> <span class=\"o\">&#39;</span><span class=\"p\">()))))</span>\n\n<span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"n\">functions</span>\n  <span class=\"p\">((</span><span class=\"n\">sxpath</span> <span class=\"o\">&#39;</span><span class=\"p\">(</span><span class=\"ss\">//</span> <span class=\"ss\">function</span><span class=\"p\">))</span> <span class=\"n\">api</span><span class=\"p\">))</span>\n</pre></div>\n\n</div>\n\n<p>Ok, so we have all the functions. Now let&rsquo;s parse them into a more useful datastructure. Here&rsquo;s my first attempt:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">require</span> <span class=\"p\">(</span><span class=\"k\">planet</span> <span class=\"s2\">\"xml.ss\"</span> <span class=\"p\">(</span><span class=\"s2\">\"jim\"</span> <span class=\"s2\">\"webit.plt\"</span> <span class=\"mi\">1</span> <span class=\"mi\">5</span><span class=\"p\">)))</span>\n\n<span class=\"c1\">;; struct function : string (listof string)</span>\n<span class=\"p\">(</span><span class=\"k\">define-struct</span> <span class=\"n\">function</span> <span class=\"p\">(</span><span class=\"n\">name</span> <span class=\"n\">params</span><span class=\"p\">))</span>\n\n<span class=\"c1\">;; parse-function : sxml -&gt; function</span>\n<span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">parse-function</span> <span class=\"n\">fn</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"n\">xml-match</span> <span class=\"n\">fn</span>\n    <span class=\"p\">[(</span><span class=\"n\">function</span> <span class=\"n\">name:</span> <span class=\"o\">,</span><span class=\"n\">name</span>\n               <span class=\"p\">(</span><span class=\"n\">param</span> <span class=\"n\">name:</span> <span class=\"o\">,</span><span class=\"n\">param-name</span> <span class=\"o\">,</span><span class=\"n\">desc</span><span class=\"p\">)</span> <span class=\"k\">...</span>\n               <span class=\"p\">(</span><span class=\"n\">comment</span> <span class=\"o\">,</span><span class=\"k\">_</span> <span class=\"k\">...</span><span class=\"p\">))</span>\n     <span class=\"p\">(</span><span class=\"n\">make-function</span> <span class=\"n\">name</span> <span class=\"p\">(</span><span class=\"nb\">list</span> <span class=\"n\">param-name</span> <span class=\"k\">...</span><span class=\"p\">))]))</span>\n\n<span class=\"p\">(</span><span class=\"nb\">map</span> <span class=\"n\">parse-function</span> <span class=\"n\">functions</span><span class=\"p\">)</span>\n</pre></div>\n\n</div>\n\n<p>The <code>xml-match</code> macro is a pattern matcher for SXML. You specify the &ldquo;shape&rdquo; of the SXML, and if the input matches the pattern the following expressions are evaluated:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"n\">xml-match</span> <span class=\"n\">value</span>\n  <span class=\"p\">[(</span><span class=\"n\">pattern</span> <span class=\"n\">expression</span> <span class=\"n\">_..._</span><span class=\"p\">)]</span><span class=\"n\">_..._</span><span class=\"p\">)</span>\n</pre></div>\n\n</div>\n\n<p>The simplified form of a pattern is:</p>\n\n<ul>\n <li>\n  <p><code>(element _..._)</code> matches an element with the given name.</p></li>\n <li>\n  <p><code>name: value</code> matches an attribute with the given name and value.</p></li>\n <li>\n  <p><code>,binding</code> binds the value of <code>binding</code> to the given name in the scope of the following expressions.</p></li>\n <li>\n  <p><code>...</code> matches zero or more of the preceeding patterns.</p></li></ul>\n\n<p>In our example the pattern is:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre>     <span class=\"p\">(</span><span class=\"n\">function</span> <span class=\"n\">name:</span> <span class=\"o\">,</span><span class=\"n\">name</span>\n               <span class=\"p\">(</span><span class=\"n\">param</span> <span class=\"n\">name:</span> <span class=\"o\">,</span><span class=\"n\">param-name</span> <span class=\"o\">,</span><span class=\"n\">desc</span><span class=\"p\">)</span> <span class=\"k\">...</span>\n               <span class=\"p\">(</span><span class=\"n\">comment</span> <span class=\"o\">,</span><span class=\"k\">_</span> <span class=\"k\">...</span><span class=\"p\">))</span>\n</pre></div>\n\n</div>\n\n<p>So we&rsquo;re looking for an element called <code>function</code> with an attribute called <code>name</code> the value of which is bound to <code>name</code>. Then follows zero or more <code>param</code> elements, with attribute <code>name</code>, the value of which is bound to <code>param-name</code>. Finally we expect a <code>comment</code> element which can contain any amount of data. The use of <code>_</code> as the binding name is a common convention to indicate data we don&rsquo;t care about but must still match to make our pattern complete.</p>\n\n<p>I run the code in DrScheme and see the result:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"n\">_xml-match:</span> <span class=\"n\">no</span> <span class=\"n\">matching</span> <span class=\"n\">clause</span> <span class=\"n\">found_</span>\n</pre></div>\n\n</div>\n\n<p>Oops. So our pattern isn&rsquo;t complete. We&rsquo;ve also seen one flaw of WebIt!: it doesn&rsquo;t give very good error messages. However we can easily fix this by adding a catch all pattern that raises an error telling us what we failed to match. The code follows. Notice that I&rsquo;ve also added pretty printing to make the unmatched SXML easier to read.</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">require</span> <span class=\"p\">(</span><span class=\"k\">lib</span> <span class=\"s2\">\"pretty.ss\"</span><span class=\"p\">))</span>\n\n<span class=\"c1\">;; parse-function : sxml -&gt; function</span>\n<span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">parse-function</span> <span class=\"n\">fn</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"n\">xml-match</span> <span class=\"n\">fn</span>\n    <span class=\"p\">[(</span><span class=\"n\">function</span> <span class=\"n\">name:</span> <span class=\"o\">,</span><span class=\"n\">name</span>\n               <span class=\"p\">(</span><span class=\"n\">param</span> <span class=\"n\">name:</span> <span class=\"o\">,</span><span class=\"n\">param-name</span> <span class=\"o\">,</span><span class=\"n\">desc</span><span class=\"p\">)</span> <span class=\"k\">...</span>\n               <span class=\"p\">(</span><span class=\"n\">comment</span> <span class=\"o\">,</span><span class=\"k\">_</span> <span class=\"k\">...</span><span class=\"p\">))</span>\n     <span class=\"p\">(</span><span class=\"n\">make-function</span> <span class=\"n\">name</span> <span class=\"p\">(</span><span class=\"nb\">list</span> <span class=\"n\">param-name</span> <span class=\"k\">...</span><span class=\"p\">))]</span>\n    <span class=\"p\">[</span><span class=\"o\">,</span><span class=\"n\">err</span> <span class=\"p\">(</span><span class=\"k\">let</span> <span class=\"p\">([</span><span class=\"n\">op</span> <span class=\"p\">(</span><span class=\"nb\">open-output-string</span><span class=\"p\">)])</span>\n            <span class=\"p\">(</span><span class=\"nb\">pretty-print</span> <span class=\"n\">err</span> <span class=\"n\">op</span><span class=\"p\">)</span>\n            <span class=\"p\">(</span><span class=\"nb\">error</span> <span class=\"p\">(</span><span class=\"nb\">format</span> <span class=\"s2\">\"Didn&#39;t match ~n~a~n\"</span> <span class=\"p\">(</span><span class=\"nb\">get-output-string</span> <span class=\"n\">op</span><span class=\"p\">))))]))</span>\n</pre></div>\n\n</div>\n\n<p>Run this code and you&rsquo;ll see the error occurs as we don&rsquo;t allow the description to contain more than one element. This is easily fixed by extending the pattern to <code>,desc ...</code>. The next error is more interesting. The <code>function</code> element contains a <code>return</code> element. The WebIt! pattern language doesn&rsquo;t allows us to express optional patterns, so we have to duplicate our pattern and include the case of <code>return</code>. This also requires we extend the defintion of the <code>function</code> structure.</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"c1\">;; struct function : string string (listof string)</span>\n<span class=\"p\">(</span><span class=\"k\">define-struct</span> <span class=\"n\">function</span> <span class=\"p\">(</span><span class=\"n\">name</span> <span class=\"n\">return</span> <span class=\"n\">params</span><span class=\"p\">))</span>\n\n<span class=\"c1\">;; parse-function : sxml -&gt; function</span>\n<span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">parse-function</span> <span class=\"n\">fn</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"n\">xml-match</span> <span class=\"n\">fn</span>\n    <span class=\"p\">[(</span><span class=\"n\">function</span> <span class=\"n\">name:</span> <span class=\"o\">,</span><span class=\"n\">name</span>\n               <span class=\"p\">(</span><span class=\"n\">param</span> <span class=\"n\">name:</span> <span class=\"o\">,</span><span class=\"n\">param-name</span> <span class=\"o\">,</span><span class=\"n\">desc</span> <span class=\"k\">...</span><span class=\"p\">)</span> <span class=\"k\">...</span>\n               <span class=\"p\">(</span><span class=\"n\">comment</span> <span class=\"o\">,</span><span class=\"k\">_</span> <span class=\"k\">...</span><span class=\"p\">))</span>\n     <span class=\"p\">(</span><span class=\"n\">make-function</span> <span class=\"n\">name</span> <span class=\"s2\">\"void\"</span> <span class=\"p\">(</span><span class=\"nb\">list</span> <span class=\"n\">param-name</span> <span class=\"k\">...</span><span class=\"p\">))]</span>\n    <span class=\"p\">[(</span><span class=\"n\">function</span> <span class=\"n\">name:</span> <span class=\"o\">,</span><span class=\"n\">name</span>\n               <span class=\"p\">(</span><span class=\"n\">return</span> <span class=\"n\">type:</span> <span class=\"o\">,</span><span class=\"n\">type</span> <span class=\"o\">,</span><span class=\"n\">return-desc</span> <span class=\"k\">...</span><span class=\"p\">)</span>\n               <span class=\"p\">(</span><span class=\"n\">param</span> <span class=\"n\">name:</span> <span class=\"o\">,</span><span class=\"n\">param-name</span> <span class=\"o\">,</span><span class=\"n\">desc</span> <span class=\"k\">...</span><span class=\"p\">)</span> <span class=\"k\">...</span>\n               <span class=\"p\">(</span><span class=\"n\">comment</span> <span class=\"o\">,</span><span class=\"k\">_</span> <span class=\"k\">...</span><span class=\"p\">))</span>\n     <span class=\"p\">(</span><span class=\"n\">make-function</span> <span class=\"n\">name</span> <span class=\"n\">type</span> <span class=\"p\">(</span><span class=\"nb\">list</span> <span class=\"n\">param-name</span> <span class=\"k\">...</span><span class=\"p\">))]</span>\n    <span class=\"p\">[</span><span class=\"o\">,</span><span class=\"n\">err</span> <span class=\"p\">(</span><span class=\"k\">let</span> <span class=\"p\">([</span><span class=\"n\">op</span> <span class=\"p\">(</span><span class=\"nb\">open-output-string</span><span class=\"p\">)])</span>\n            <span class=\"p\">(</span><span class=\"nb\">pretty-print</span> <span class=\"n\">err</span> <span class=\"n\">op</span><span class=\"p\">)</span>\n            <span class=\"p\">(</span><span class=\"nb\">error</span> <span class=\"p\">(</span><span class=\"nb\">format</span> <span class=\"s2\">\"Didn&#39;t match ~n~a~n\"</span> <span class=\"p\">(</span><span class=\"nb\">get-output-string</span> <span class=\"n\">op</span><span class=\"p\">))))]))</span>\n</pre></div>\n\n</div>\n\n<p>This works! This is as far as I want to go in this article. We&rsquo;ve seen how we can use SSAX. SXPath, and WebIt! to create XML transforms in pure Scheme. There is a lot more to all of these packages but what we&rsquo;ve used is sufficient for many uses. The rest of the code to create Scheme from the API is quite straightforward and specific to Selenium. If you&rsquo;re curious read the source of the Selenium PLaneT package, which will be released soon.</p>\n\n<p><em>This post also appears on <a href=\"http://www.untyped.com/untyping\">Untyping</a></em></p>\n<!-- more-->\n\n<hr />\n\n<p>Very good article. This comment is regarding the actual layout of the blog. First, I would like it very much if the author of the post were placed at the top of the posting. Second, on my browser code listing that do not wrap are visually clipped by the sidebar on the right. This is an unfortunate combination with the fixed width format of the overall page, because it results in text that cannot be viewed even by resizing.</p>\n\n<p>— <em>skub, 10 May 2007</em></p>\n\n<hr />\n\n<p>Thanks for the suggestions.</p>\n\n<p>We moved the author to the top.</p>\n\n<p>And as an experiment, we have made the main column a little wider.</p>\n\n<p>Leave a comment, if you think it is too wide.</p>\n\n<p>— <em>Jens Axel Søgaard, 10 May 2007</em></p>\n\n<hr />\n\n<p>I found the easiest way to deal with code being too wide on my blog was to set the CSS attribute for overflow to auto.</p>\n\n<p>So I have CSS like:</p>\n\n<p>.post pre {  line-height: 14px;  background-color: #EFEFD1;  padding: 8px;  border: 2px solid #CFCFA8;  overflow: auto; }</p>\n\n<p>You can check out this example.</p>\n\n<p>Naturally, horizontal scrolling is annoying. But, it&rsquo;s the best I could come up with.</p>\n\n<p>— <em>Ben Simon, 11 May 2007</em></p>\n\n<hr />")) ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2010-01-02-scheme-videos-lectures-and-talks.md" . unix) f post (u . "Scheme Videos (Lectures and Talks)") (? . 4) 1467223812 (p+ #"/Users/MB/git/racket-lang-org/blog/2010/01/scheme-videos-lectures-and-talks.html" . unix) "/2010/01/scheme-videos-lectures-and-talks.html" (u . "2010-01-02T11:40:00.007-05:00") (? . 5) (? . 63) (c (u . "")) (u . "\n<p><em>posted by John Clements</em></p>\n\n<p>Scheme Videos (Lectures and Talks)(thanks to Geoffrey Knauth and Hari)Following a mailing-list request, it turns out that there are quite a lot of Scheme-related lectures and talks floating around out there in video format. The following list was compiled by Geoffrey Knauth, with contributions from Hari and Michael Sperber, and at least one insertion from me, right at the front.</p>\n\n<ul>\n <li>\n  <p>My sequence of <a href=\"http://www.youtube.com/playlist?list=PLD0EB7BC8D7CF739A\">introductory videos on YouTube</a>, recorded long after this post was made.</p></li>\n <li>\n  <p>There&rsquo;s the SICP course Abelson &amp; Sussman gave to [HP, I think] in the mid&ndash;1980s: http://groups.csail.mit.edu/mac/classes/6.001/abelson-sussman-lectures/</p></li>\n <li>\n  <p>MIT OCW / 6.001 using SICP, Spring 2005: http://ocw.mit.edu/OcwWeb/Electrical-Engineering-and-Computer-Science/6&ndash;001Spring&ndash;2005/VideoLectures/index.htm</p></li>\n <li>\n  <p>All the ICFP 2009 videos (man this made my day!!): http://vidiowiki.com/feature/list/fnu/ICFP_2009</p></li>\n <li>\n  <p>Daniel P Friedman - A Celebration (this too!): http://www.cs.indiana.edu/dfried_celebration.html</p></li>\n <li>\n  <p>DrScheme v4.0 Tour: http://www.youtube.com/watch?v=vgQO_kHl39g&amp;fmt=18</p></li>\n <li>\n  <p>Similar, if you understand Russian:</p></li>\n <li>\n  <p>http://www.youtube.com/watch?v=wECY7s9k-V0</p></li>\n <li>\n  <p>http://www.youtube.com/watch?v=2CVJjqOT6WM</p></li>\n <li>\n  <p>Matthias Felleisen - Programming at Northeastern: http://www.savevid.com/video/matthias-felleisen-programming-at-northeastern-university.html</p></li>\n <li>\n  <p>Matthew Flatt - Processes without Partitions: http://www.researchchannel.org/prog/displayevent.aspx?rID=3892</p></li>\n <li>\n  <p>Shriram Krishnamurthi on WeScheme: http://vidiowiki.com/watch/cydr9yk/</p></li>\n <li>\n  <p>Robby Findler - Macros Matter: http://www.mefeedia.com/video/26348171</p></li>\n <li>\n  <p>Using PLT Scheme in the Game Industry: http://www.youtube.com/watch?v=2CVJjqOT6WM</p></li>\n <li>\n  <p>Stanford Lecture (Kawa): http://www.youtube.com/watch?v=_cV8NWQCxnE</p></li>\n <li>\n  <p>Bluetooth communication using PLT Scheme: http://www.youtube.com/watch?v=pmR_dIXm6sY</p></li>\n <li>SICP at UCB: http://webcast.berkeley.edu/course_details.php?seriesid=1906978454</li>\n <li>\n  <p><a href=\"http://www.aduni.org/courses/sicp/\">http://www.aduni.org/courses/sicp/</a> from ADUni by Holly Yanco. It comes with pretty good lecture notes and problem sets.</p></li>\n <li>\n  <p>Michael Sperber&rsquo;s DMdA lectures (in German, natch): <a href=\"http://timms.uni-tuebingen.de/List/List01.aspx?rpattern=UT_200[89]_____00[12]_info1_000_\">http://timms.uni-tuebingen.de/List/List01.aspx?rpattern=UT_200[89]_____00[12]<em>info1_000</em></a></p></li></ul>") #t (u . "\n<p><em>posted by John Clements</em></p>\n\n<p>Scheme Videos (Lectures and Talks)(thanks to Geoffrey Knauth and Hari)Following a mailing-list request, it turns out that there are quite a lot of Scheme-related lectures and talks floating around out there in video format. The following list was compiled by Geoffrey Knauth, with contributions from Hari and Michael Sperber, and at least one insertion from me, right at the front.</p>\n\n<ul>\n <li>\n  <p>My sequence of <a href=\"http://www.youtube.com/playlist?list=PLD0EB7BC8D7CF739A\">introductory videos on YouTube</a>, recorded long after this post was made.</p></li>\n <li>\n  <p>There&rsquo;s the SICP course Abelson &amp; Sussman gave to [HP, I think] in the mid&ndash;1980s: http://groups.csail.mit.edu/mac/classes/6.001/abelson-sussman-lectures/</p></li>\n <li>\n  <p>MIT OCW / 6.001 using SICP, Spring 2005: http://ocw.mit.edu/OcwWeb/Electrical-Engineering-and-Computer-Science/6&ndash;001Spring&ndash;2005/VideoLectures/index.htm</p></li>\n <li>\n  <p>All the ICFP 2009 videos (man this made my day!!): http://vidiowiki.com/feature/list/fnu/ICFP_2009</p></li>\n <li>\n  <p>Daniel P Friedman - A Celebration (this too!): http://www.cs.indiana.edu/dfried_celebration.html</p></li>\n <li>\n  <p>DrScheme v4.0 Tour: http://www.youtube.com/watch?v=vgQO_kHl39g&amp;fmt=18</p></li>\n <li>\n  <p>Similar, if you understand Russian:</p></li>\n <li>\n  <p>http://www.youtube.com/watch?v=wECY7s9k-V0</p></li>\n <li>\n  <p>http://www.youtube.com/watch?v=2CVJjqOT6WM</p></li>\n <li>\n  <p>Matthias Felleisen - Programming at Northeastern: http://www.savevid.com/video/matthias-felleisen-programming-at-northeastern-university.html</p></li>\n <li>\n  <p>Matthew Flatt - Processes without Partitions: http://www.researchchannel.org/prog/displayevent.aspx?rID=3892</p></li>\n <li>\n  <p>Shriram Krishnamurthi on WeScheme: http://vidiowiki.com/watch/cydr9yk/</p></li>\n <li>\n  <p>Robby Findler - Macros Matter: http://www.mefeedia.com/video/26348171</p></li>\n <li>\n  <p>Using PLT Scheme in the Game Industry: http://www.youtube.com/watch?v=2CVJjqOT6WM</p></li>\n <li>\n  <p>Stanford Lecture (Kawa): http://www.youtube.com/watch?v=_cV8NWQCxnE</p></li>\n <li>\n  <p>Bluetooth communication using PLT Scheme: http://www.youtube.com/watch?v=pmR_dIXm6sY</p></li>\n <li>SICP at UCB: http://webcast.berkeley.edu/course_details.php?seriesid=1906978454</li>\n <li>\n  <p><a href=\"http://www.aduni.org/courses/sicp/\">http://www.aduni.org/courses/sicp/</a> from ADUni by Holly Yanco. It comes with pretty good lecture notes and problem sets.</p></li>\n <li>\n  <p>Michael Sperber&rsquo;s DMdA lectures (in German, natch): <a href=\"http://timms.uni-tuebingen.de/List/List01.aspx?rpattern=UT_200[89]_____00[12]_info1_000_\">http://timms.uni-tuebingen.de/List/List01.aspx?rpattern=UT_200[89]_____00[12]<em>info1_000</em></a></p></li></ul>\n<!-- more-->\n\n<hr />\n\n<p>You can also find the (german) course from Tübingen (uses DrScheme) online.</p>\n\n<p>— <em>Roger Braun, 2 January 2010</em></p>\n\n<hr />\n\n<p>The Using PLT Scheme in the Game Industry: link seems to be all in russian is that right?</p>\n\n<p>//olme</p>\n\n<p>— <em>Anders, 3 January 2010</em></p>\n\n<hr />")) ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2007-12-29-the-design-of-extended-exercises.md" . unix) f post (u . "The Design of Extended Exercises") (? . 16) 1467223812 (p+ #"/Users/MB/git/racket-lang-org/blog/2007/12/the-design-of-extended-exercises.html" . unix) "/2007/12/the-design-of-extended-exercises.html" (u . "2007-12-29T15:49:00.000-05:00") (? . 6) (? . 15) (c (u . "")) (u . "\n<p><em>posted by Shriram Krishnamurthi</em></p>\n\n<p>One of the highlights of the TeachScheme! method is to create Extended Exercises. Several of these pepper <em>How to Design Programs</em>, and even more have been created since to deal with a variety of interesting problem scenarios (e.g., illustrating graphics via t-shirt design, explaining networking by having machines play roles in a theatrical play, demonstrating communication with foreign sites by processing data from a microfinance institution, etc). Through an Extended Exercise a student learns about how computer science connects to domains, develops practice building programs incrementally, learns to build earlier assignments that later assignments can depend on, and so forth.</p>\n\n<p>Here is a preliminary articulation of some principles that I think govern a good Extended Exercise, with an emphasis on their &ldquo;form factor&rdquo;.</p>\n\n<ul>\n <li>\n  <p>Pick a domain. Whether the domain looks inward (a computing activity such as networking) or outward (such as social networking) doesn&rsquo;t matter. If it does look inward, try to make it more applicable through the judicious use of data (the same exercise can look very dry or very applied depending on what data you choose). For instance, our networking exercises is presented in terms of Shakespeare&rsquo;s Hamlet.</p></li>\n <li>\n  <p>If necessary, write a Teachpack. A domain almost certainly needs a Teachpack to reduce the programming burden on students. For instance, the microfinance exercise uses a Teachpack to hide the ugly details of screen-scraping (which in turn need to be constantly updated by a vigilant maintainer).</p></li>\n <li>\n  <p>Try to provide a non-trivial dataset in the Teachpack. Good data can make an assignment more enjoyable&mdash;e.g., our networking example provides an excerpt from Act 2, Scene 2 of Hamlet (&ldquo;What a piece of work is man!&rdquo;)&mdash;and in cases where the exercise depends on connecting to an external site (e.g., the microfinance example), the data may be essential.</p></li>\n <li>\n  <p>Structure the assignment to have five to eight questions: not much fewer (too few steps) nor much more (too much to grasp).</p></li>\n <li>\n  <p>Try to decompose the problem using good principles of stepwise refinement, using your own wisdom in these matters. By showing students several such examples, we hope for them to build up an intuition for the process. Your decomposition may not be strictly linear; that&rsquo;s okay. But it should be progressive.</p></li>\n <li>\n  <p>Perhaps the most important point: At every step, try to have a full, working application. That means the Teachpack may need to export several interfaces, each one taking more parameters and accepting more functionality than the previous one. Otherwise the student needs to have all the parts working before they can understand whether even one works in context, leading to a frustrating learning experience and encouraging wanton hacking as they try (and invariably fail) to quickly get to a working system.</p></li>\n <li>\n  <p>Design interfaces carefully to make judicious use of first-class functions. It is inevitable that students will need to provide functions (not just flat data) to what your Teachpack exports. Show them the invocations of your Teachpack in terms of named functions (that they define).</p></li>\n <li>\n  <p>Try to provide a few extra-credit routes for ambitious students. Options include letting students peel back even more of the Teachpack, or adding interesting features.</p></li></ul>") #t (u . "\n<p><em>posted by Shriram Krishnamurthi</em></p>\n\n<p>One of the highlights of the TeachScheme! method is to create Extended Exercises. Several of these pepper <em>How to Design Programs</em>, and even more have been created since to deal with a variety of interesting problem scenarios (e.g., illustrating graphics via t-shirt design, explaining networking by having machines play roles in a theatrical play, demonstrating communication with foreign sites by processing data from a microfinance institution, etc). Through an Extended Exercise a student learns about how computer science connects to domains, develops practice building programs incrementally, learns to build earlier assignments that later assignments can depend on, and so forth.</p>\n\n<p>Here is a preliminary articulation of some principles that I think govern a good Extended Exercise, with an emphasis on their &ldquo;form factor&rdquo;.</p>\n\n<ul>\n <li>\n  <p>Pick a domain. Whether the domain looks inward (a computing activity such as networking) or outward (such as social networking) doesn&rsquo;t matter. If it does look inward, try to make it more applicable through the judicious use of data (the same exercise can look very dry or very applied depending on what data you choose). For instance, our networking exercises is presented in terms of Shakespeare&rsquo;s Hamlet.</p></li>\n <li>\n  <p>If necessary, write a Teachpack. A domain almost certainly needs a Teachpack to reduce the programming burden on students. For instance, the microfinance exercise uses a Teachpack to hide the ugly details of screen-scraping (which in turn need to be constantly updated by a vigilant maintainer).</p></li>\n <li>\n  <p>Try to provide a non-trivial dataset in the Teachpack. Good data can make an assignment more enjoyable&mdash;e.g., our networking example provides an excerpt from Act 2, Scene 2 of Hamlet (&ldquo;What a piece of work is man!&rdquo;)&mdash;and in cases where the exercise depends on connecting to an external site (e.g., the microfinance example), the data may be essential.</p></li>\n <li>\n  <p>Structure the assignment to have five to eight questions: not much fewer (too few steps) nor much more (too much to grasp).</p></li>\n <li>\n  <p>Try to decompose the problem using good principles of stepwise refinement, using your own wisdom in these matters. By showing students several such examples, we hope for them to build up an intuition for the process. Your decomposition may not be strictly linear; that&rsquo;s okay. But it should be progressive.</p></li>\n <li>\n  <p>Perhaps the most important point: At every step, try to have a full, working application. That means the Teachpack may need to export several interfaces, each one taking more parameters and accepting more functionality than the previous one. Otherwise the student needs to have all the parts working before they can understand whether even one works in context, leading to a frustrating learning experience and encouraging wanton hacking as they try (and invariably fail) to quickly get to a working system.</p></li>\n <li>\n  <p>Design interfaces carefully to make judicious use of first-class functions. It is inevitable that students will need to provide functions (not just flat data) to what your Teachpack exports. Show them the invocations of your Teachpack in terms of named functions (that they define).</p></li>\n <li>\n  <p>Try to provide a few extra-credit routes for ambitious students. Options include letting students peel back even more of the Teachpack, or adding interesting features.</p></li></ul>\n<!-- more-->\n\n<hr />\n\n<p>So &hellip; which of the existing teachpacks seem closest to your ideal?</p>\n\n<p>— <em>offby1, 29 December 2007</em></p>\n\n<hr />")) ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2015-08-10-racket-v621.md" . unix) f post (u . "Racket v6.2.1") (? . 14) 1467223812 (p+ #"/Users/MB/git/racket-lang-org/blog/2015/08/racket-v621.html" . unix) "/2015/08/racket-v621.html" (u . "2015-08-10T17:48:00.000-04:00") (? . 13) (? . 29) (c (u . "")) (u . "\n<p><em>posted by Ryan Culpepper</em></p>\n\n<p>Racket v6.2.1 is now available from <a href=\"http://racket-lang.org/\">http://racket-lang.org/</a></p>\n\n<p>Version 6.2.1 patches the recent v6.2 release in three small ways:</p>\n\n<ul>\n <li>\n  <p>For the How to Design Programs teaching languages, DrRacket offers an option to use the old style for printing the constants <code>true</code>, <code>false</code>, and <code>empty</code> instead of <code>#true</code>, <code>#false</code>, and <code>'()</code>.</p></li>\n <li>\n  <p>The teaching languages come with some additional functions to match the August 2015 <a href=\"http://www.ccs.neu.edu/home/matthias/HtDP2e/index.html\">stable release of HtDP 2nd edition</a>.</p></li>\n <li>\n  <p>A repair to the compiler avoids an infinite loop at compile time for certain expressions that should loop forever at run time.</p></li></ul>\n\n<p>Feedback Welcome</p>") #t (u . "\n<p><em>posted by Ryan Culpepper</em></p>\n\n<p>Racket v6.2.1 is now available from <a href=\"http://racket-lang.org/\">http://racket-lang.org/</a></p>\n\n<p>Version 6.2.1 patches the recent v6.2 release in three small ways:</p>\n\n<ul>\n <li>\n  <p>For the How to Design Programs teaching languages, DrRacket offers an option to use the old style for printing the constants <code>true</code>, <code>false</code>, and <code>empty</code> instead of <code>#true</code>, <code>#false</code>, and <code>'()</code>.</p></li>\n <li>\n  <p>The teaching languages come with some additional functions to match the August 2015 <a href=\"http://www.ccs.neu.edu/home/matthias/HtDP2e/index.html\">stable release of HtDP 2nd edition</a>.</p></li>\n <li>\n  <p>A repair to the compiler avoids an infinite loop at compile time for certain expressions that should loop forever at run time.</p></li></ul>\n\n<p>Feedback Welcome</p>\n<!-- more-->\n\n<hr />\n\n<p>did anyone notice that the download page is broken?</p>\n\n<p>when i click download on the home page, it gives a 403 forbidden error with message:</p>\n\n<p>Request forbidden by administrative rules.</p>\n\n<p>— <em>Ke Kevin, 7 September 2015</em></p>\n\n<hr />\n\n<p>Are you still seeing that error? I can&rsquo;t reproduce it on my end.</p>\n\n<p>— <em>Vincent St-Amour, 7 September 2015</em></p>\n\n<hr />\n\n<p>it&rsquo;s ok now.</p>\n\n<p>cheers</p>\n\n<p>— <em>Ke Kevin, 10 September 2015</em></p>\n\n<hr />")) ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2010-12-08-rebuilding-rackets-graphics-layer.md" . unix) f post (u . "Rebuilding Racket’s Graphics Layer") (? . 46) 1467223812 (p+ #"/Users/MB/git/racket-lang-org/blog/2010/12/rebuilding-rackets-graphics-layer.html" . unix) "/2010/12/rebuilding-rackets-graphics-layer.html" (u . "2010-12-08T10:59:00.005-05:00") (? . 107) (? . 17) (c (u . "")) (u . "\n<p><em>posted by Matthew Flatt</em></p>\n\n<p>Racket version 5.1, which is scheduled for release in early February, will look a little different on the outside. Unix/X users will see the biggest difference: DrRacket and all Racket GUI programs will take on the desktop theme for menus, buttons, and other GUI widgets. Text handling is also better than before on Unix/X, especially when printing. Windows and Mac OS X users will see smaller changes, such as better printing, better handling of mouse-wheel events, and support for 64-bit Windows and Mac OS X.</p>\n\n<p>On the inside, version 5.1 is the biggest single change in Racket (or PLT Scheme) history. We’ve reimplemented the GUI layer, which meant throwing out about 200,000 lines of C++ code that built on Xt, Win32, and Carbon. We’ve replaced that C++ code with about 30,000 lines of Racket code that builds on Gtk, Win32, Cocoa, Cairo, and Pango. This change modernizes Racket&rsquo;s graphics support while significantly reducing the cost of maintaining the GUI and drawing libraries.</p>\n\n<p>In the space between the GUI implementation and the surface, there are many API improvements:</p>\n\n<ul>\n <li>\n  <p>You can run GUI programs with just <code>racket</code>, instead of having to use <code>gracket</code>. Depending on how much your platform distinguishes between GUI and console applications, there may still be an advantage to using <code>gracket</code> (i.e., to tell the OS that you mean to start a GUI application or that you want a single instance of the application), but the difference is minor.</p></li>\n <li>\n  <p>Most of the drawing library has moved to <code>racket/draw</code>, which you can use without the rest of the GUI library – and, in the case of Unix platforms, without an X-server connection. After detangling the graphics and GUIs libraries, the graphics library is now integrated in more places, such as adding pict support for Scribble documents.</p></li>\n <li>\n  <p>The drawing library includes some new capabilities, such as rotation, affine transformations, and bitmaps with alpha channels.</p></li></ul>\n\n<p>Replacing hundreds of thousands of lines of C++ code with tens of thousands of lines of Racket code sounds like a no-brainer. The old library was implemented in C++ because we started in 1995 by gluing together a Scheme interpreter with a portable GUI library. Then the GUI code stayed in C++, because the interpreter wasn’t fast enough and the foreign interface was too clumsy. Racket is now plenty fast and its foreign interface has improved a lot since then.</p>\n\n<p>Still, the reimplementation took about 18 months. Smoothly integrating cross-platform GUI support with a programming language can be more difficult than it sounds, and mating new libraries with a legacy API creates additional challenges. Finally, many Racket tools depend Racket’s “eventspaces,” which are multiple process-like entities in the same virtual machine, each with its own GUI event loop. Implementing eventspaces on top of modern GUI toolkits turns out to be tricky, because the toolkits insist on a single event-loop per process and they cannot tolerate event-loop actions during certain callbacks. Fortunately, delimited continuations can help work around those limitations.</p>\n\n<p>Cairo and Pango are the two big enablers of the Racket graphics rewrite. The old Racket graphics library depended on many toolkits (X11, Win32, QuickDraw, Quartz, PostScript, and more), and it had poor font handling. Again, the problem was that we chose the previous technology in 1995. Cairo and Pango have since solved the portable-graphics problem, and we were able to trade in 80,000 lines of C++ glue for about 8,000 lines of Racket glue. The code could be much less if we didn’t have to match most of the old drawing API, but we&rsquo;re still very happy with the result.</p>\n\n<p>On the GUI side, the remaining 22,000 lines of Racket code replace similar C++ code that binds to three different toolkits. The set of underlying toolkits has changed, and a few eventspace tricks are new, but the approach is essentially the same as before. The code is nevertheless much more compact, because (no surprise) Racket is better than C++. Interestingly, the amount of toolkit-specific code is right around 6,500 lines for each toolkit, even though the way that a C programmer uses the different toolkits seems very different: Objective-C classes (Cocoa) versus signal callbacks with explicit wiring (Gtk) versus a single callback function for message handling (Win32). Maybe they&rsquo;re the same because we built a Racket mini-language for each toolkit that makes them all about equally convenient.</p>\n\n<p>The rewrite is not perfectly compatible with old code, and no doubt we have many bugs to find before the release. The process is well on track, though, and the new library implementations give a us a solid foundation to keep making Racket better.</p>\n\n<p>To try out the current development version, visit</p>\n\n<p><a href=\"http://pre.racket-lang.org/installers\">http://pre.racket-lang.org/installers</a></p>") #t (u . "\n<p><em>posted by Matthew Flatt</em></p>\n\n<p>Racket version 5.1, which is scheduled for release in early February, will look a little different on the outside. Unix/X users will see the biggest difference: DrRacket and all Racket GUI programs will take on the desktop theme for menus, buttons, and other GUI widgets. Text handling is also better than before on Unix/X, especially when printing. Windows and Mac OS X users will see smaller changes, such as better printing, better handling of mouse-wheel events, and support for 64-bit Windows and Mac OS X.</p>\n\n<p>On the inside, version 5.1 is the biggest single change in Racket (or PLT Scheme) history. We’ve reimplemented the GUI layer, which meant throwing out about 200,000 lines of C++ code that built on Xt, Win32, and Carbon. We’ve replaced that C++ code with about 30,000 lines of Racket code that builds on Gtk, Win32, Cocoa, Cairo, and Pango. This change modernizes Racket&rsquo;s graphics support while significantly reducing the cost of maintaining the GUI and drawing libraries.</p>\n\n<p>In the space between the GUI implementation and the surface, there are many API improvements:</p>\n\n<ul>\n <li>\n  <p>You can run GUI programs with just <code>racket</code>, instead of having to use <code>gracket</code>. Depending on how much your platform distinguishes between GUI and console applications, there may still be an advantage to using <code>gracket</code> (i.e., to tell the OS that you mean to start a GUI application or that you want a single instance of the application), but the difference is minor.</p></li>\n <li>\n  <p>Most of the drawing library has moved to <code>racket/draw</code>, which you can use without the rest of the GUI library – and, in the case of Unix platforms, without an X-server connection. After detangling the graphics and GUIs libraries, the graphics library is now integrated in more places, such as adding pict support for Scribble documents.</p></li>\n <li>\n  <p>The drawing library includes some new capabilities, such as rotation, affine transformations, and bitmaps with alpha channels.</p></li></ul>\n\n<p>Replacing hundreds of thousands of lines of C++ code with tens of thousands of lines of Racket code sounds like a no-brainer. The old library was implemented in C++ because we started in 1995 by gluing together a Scheme interpreter with a portable GUI library. Then the GUI code stayed in C++, because the interpreter wasn’t fast enough and the foreign interface was too clumsy. Racket is now plenty fast and its foreign interface has improved a lot since then.</p>\n\n<p>Still, the reimplementation took about 18 months. Smoothly integrating cross-platform GUI support with a programming language can be more difficult than it sounds, and mating new libraries with a legacy API creates additional challenges. Finally, many Racket tools depend Racket’s “eventspaces,” which are multiple process-like entities in the same virtual machine, each with its own GUI event loop. Implementing eventspaces on top of modern GUI toolkits turns out to be tricky, because the toolkits insist on a single event-loop per process and they cannot tolerate event-loop actions during certain callbacks. Fortunately, delimited continuations can help work around those limitations.</p>\n\n<p>Cairo and Pango are the two big enablers of the Racket graphics rewrite. The old Racket graphics library depended on many toolkits (X11, Win32, QuickDraw, Quartz, PostScript, and more), and it had poor font handling. Again, the problem was that we chose the previous technology in 1995. Cairo and Pango have since solved the portable-graphics problem, and we were able to trade in 80,000 lines of C++ glue for about 8,000 lines of Racket glue. The code could be much less if we didn’t have to match most of the old drawing API, but we&rsquo;re still very happy with the result.</p>\n\n<p>On the GUI side, the remaining 22,000 lines of Racket code replace similar C++ code that binds to three different toolkits. The set of underlying toolkits has changed, and a few eventspace tricks are new, but the approach is essentially the same as before. The code is nevertheless much more compact, because (no surprise) Racket is better than C++. Interestingly, the amount of toolkit-specific code is right around 6,500 lines for each toolkit, even though the way that a C programmer uses the different toolkits seems very different: Objective-C classes (Cocoa) versus signal callbacks with explicit wiring (Gtk) versus a single callback function for message handling (Win32). Maybe they&rsquo;re the same because we built a Racket mini-language for each toolkit that makes them all about equally convenient.</p>\n\n<p>The rewrite is not perfectly compatible with old code, and no doubt we have many bugs to find before the release. The process is well on track, though, and the new library implementations give a us a solid foundation to keep making Racket better.</p>\n\n<p>To try out the current development version, visit</p>\n\n<p><a href=\"http://pre.racket-lang.org/installers\">http://pre.racket-lang.org/installers</a></p>\n<!-- more-->\n\n<hr />\n\n<p>This is fantastic! Good show!</p>\n\n<p>— <em>steck, 8 December 2010</em></p>\n\n<hr />\n\n<p>There is a problem on Windows Vista Professional x64:</p>\n\n<p>ffi-obj: couldn&rsquo;t get &ldquo;GetWindowLongPtrW&rdquo; from &ldquo;user32.dll&rdquo; (The specified proce dure could not be found.; errno=127)</p>\n\n<p> === context === D:\\p\\racket\\collects\\ffi\\unsafe.rkt:176:2: get-ffi-obj* D:\\p\\racket\\collects\\mred\\private\\wx\\win32\\utils.rkt: [running body] D:\\p\\racket\\collects\\mred\\private\\wx\\win32\\sound.rkt: [traversing imports] D:\\p\\racket\\collects\\mred\\private\\wx\\win32\\procs.rkt: [traversing imports] D:\\p\\racket\\collects\\mred\\private\\wx\\common\\cursor.rkt: [traversing imports] D:\\p\\racket\\collects\\mred\\private\\kernel.rkt: [traversing imports] D:\\p\\racket\\collects\\mred\\private\\check.rkt: [traversing imports] D:\\p\\racket\\collects\\mred\\mred.rkt: [traversing imports] D:\\p\\racket\\collects\\mred\\main.rkt: [traversing imports] D:\\p\\racket\\collects\\racket\\gui\\base.rkt: [traversing imports] D:\\p\\racket\\collects\\drracket\\drracket.rkt: [traversing imports]</p>\n\n<p>[Exited. Close box or Ctrl-C closes the console.]</p>\n\n<p>— <em>malkia, 8 December 2010</em></p>\n\n<hr />\n\n<p>malkia &mdash; thanks for the report. I really should have checked whether our latest build was in good shape before posting. It turns out that this bug has been fixed, but machine-configuration issues have prevented a new build from completing since Sunday. We&rsquo;ll get a working Windows build up soon.</p>\n\n<p>— <em>Matthew Flatt, 8 December 2010</em></p>\n\n<hr />\n\n<p>How did &ldquo;delimited continuations [] help work around those limitations&rdquo;?</p>\n\n<p>— <em>grant rettke, 8 December 2010</em></p>\n\n<hr />\n\n<p>When you said that event loop were insisting on there only being one per process, were you thinking of GTK or only Mac/Win? AFAIK you can have multiple glib event loops without issue. You typically have one per thread, but that&rsquo;s not the same thing as one per process.</p>\n\n<p>— <em>joseph, 9 December 2010</em></p>\n\n<hr />\n\n<p>Delimited continuations help when a particular callback must be executed before further events are handled. For example, while you drag a scroll thumb on some platforms, the toolbox is in charge of the event loop; if handling a scroll-changed event calls code that takes forever, then the whole GUI system becomes stuck. Delimited continuations let Racket call arbitrary code to handle the scroll event, and if it doesn&rsquo;t complete fast enough, a continuation is captured and resumed sometime later, allowing the GUI to partially respond meanwhile. This use of delimited continuations is similar to a use to implement threads, but without facets of threads (such as thread-specific data) that would get in the way.</p>\n\n<p>— <em>Matthew Flatt, 9 December 2010</em></p>\n\n<hr />\n\n<p>On one event loop per process: I was thinking of Cocoa and Gtk. Maybe I&rsquo;m wrong about Gtk. I know that glib supports multiple event loops, but my impression was that the generality isn&rsquo;t preserved through the Gtk layer. I couldn&rsquo;t get multiple event loops to work in Gtk, and I got the impression from the docs and web searches that it couldn&rsquo;t work, but I&rsquo;d welcome a pointer to a little example showing a program with multiple Gtk event loops.</p>\n\n<p>— <em>Matthew Flatt, 9 December 2010</em></p>\n\n<hr />\n\n<p>Great! Is there any plan to include/use the gtk tree store or add multiple columns to the actual list-box?</p>\n\n<p>I was planning to create a simple gui with the typical database access showing the contents in a table grid.</p>\n\n<p>— <em>aleix, 10 December 2010</em></p>\n\n<hr />\n\n<p>What is the best book to learn &ldquo;Racket&rdquo; and Scheme with? Doese the HtDP still hold?</p>\n\n<p>— <em>Robert, 10 December 2010</em></p>\n\n<hr />\n\n<p>Yes, there are plans to enable multi-column list boxes and other new things. I&rsquo;m not sure how soon those will be available, but probably soon.</p>\n\n<p>— <em>Matthew Flatt, 10 December 2010</em></p>\n\n<hr />\n\n<p>To get started with Racket, see http://docs.racket-lang.org/getting-started/ . HtDP is still a good starting point.</p>\n\n<p>— <em>Matthew Flatt, 10 December 2010</em></p>\n\n<hr />\n\n<p>For anyone that tried the Windows build and ran into problems &mdash; there is now a new build that should work: http://pre.racket-lang.org/installers</p>\n\n<p>— <em>Eli Barzilay, 10 December 2010</em></p>\n\n<hr />\n\n<p>Great! Thanks for all the hard work.</p>\n\n<p>— <em>Sunny, 21 December 2010</em></p>\n\n<hr />")) ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2011-07-29-racketcon-recap.md" . unix) f post (u . "RacketCon Recap") (? . 11) 1467223812 (p+ #"/Users/MB/git/racket-lang-org/blog/2011/07/racketcon-recap.html" . unix) "/2011/07/racketcon-recap.html" (u . "2011-07-29T02:36:00.002-04:00") (? . 9) (? . 112) (c (u . "")) (u . "\n<p><em>posted by Sam Tobin-Hochstadt</em></p>\n\n<p>We held <a href=\"http://con.racket-lang.org/\">RacketCon</a> here at <a href=\"http://www.ccis.neu.edu/2011/\">Northeastern</a> over the past weekend, and it was a great time! Matthew Flatt consulted his magic 8-ball about the future of Racket (it involves Hawaiian shirts); Matthias Felleisen announced the upcoming Realm of Racket book; Robby Findler demoed DrRacket with online syntax checking; Ryan Culpepper taught us how to make Rackety libraries; Prabhakar Ragde explained how the University of Waterloo teaches Racket and Program by Design to 1500 students a year (and how to embed math into Scribble documents).</p>\n\n<p>Danny Yoo has already <a href=\"http://blog.hashcollision.org/?p=162\">blogged</a> about his talk about his <a href=\"http://hashcollision.org/whalesong/\">Whalesong</a> Racket-&gt;JavaScript compiler. Hopefully other people will write more about some of the individual talks; I&rsquo;ll update this post to link to any that I see.</p>\n\n<p>As promised, the talks were videotaped by Jeff Dlouhy of the <a href=\"http://acm.ccs.neu.edu/\">NUACM</a>; the videos are in post-production and should be up within a few weeks. We&rsquo;ll announce their availability on this blog. Slides from the individual talks will be up on the <a href=\"http://con.racket-lang.org/2011/\">RacketCon webpage</a> soon.</p>") #t (u . "\n<p><em>posted by Sam Tobin-Hochstadt</em></p>\n\n<p>We held <a href=\"http://con.racket-lang.org/\">RacketCon</a> here at <a href=\"http://www.ccis.neu.edu/2011/\">Northeastern</a> over the past weekend, and it was a great time! Matthew Flatt consulted his magic 8-ball about the future of Racket (it involves Hawaiian shirts); Matthias Felleisen announced the upcoming Realm of Racket book; Robby Findler demoed DrRacket with online syntax checking; Ryan Culpepper taught us how to make Rackety libraries; Prabhakar Ragde explained how the University of Waterloo teaches Racket and Program by Design to 1500 students a year (and how to embed math into Scribble documents).</p>\n\n<p>Danny Yoo has already <a href=\"http://blog.hashcollision.org/?p=162\">blogged</a> about his talk about his <a href=\"http://hashcollision.org/whalesong/\">Whalesong</a> Racket-&gt;JavaScript compiler. Hopefully other people will write more about some of the individual talks; I&rsquo;ll update this post to link to any that I see.</p>\n\n<p>As promised, the talks were videotaped by Jeff Dlouhy of the <a href=\"http://acm.ccs.neu.edu/\">NUACM</a>; the videos are in post-production and should be up within a few weeks. We&rsquo;ll announce their availability on this blog. Slides from the individual talks will be up on the <a href=\"http://con.racket-lang.org/2011/\">RacketCon webpage</a> soon.</p>\n<!-- more-->\n\n<hr />\n\n<p>can&rsquo;t wait for the videos!</p>\n\n<p>— <em>Ramakrishnan VU3RDD, 29 July 2011</em></p>\n\n<hr />\n\n<p>Great! thanks for making these available</p>\n\n<p>— <em>therac25, 29 July 2011</em></p>\n\n<hr />\n\n<p>How is the progress on the videos?</p>\n\n<p>— <em>numbertheory, 13 September 2011</em></p>\n\n<hr />\n\n<p>Having missed the event, I very much look forward to any videos. Is there an ETA?</p>\n\n<p>— <em>jcgsample, 23 September 2011</em></p>\n\n<hr />\n\n<p>When will the videos be out?</p>\n\n<p>— <em>dwayne, 12 November 2011</em></p>\n\n<hr />\n\n<p>will the videos ever come out of post-production ?</p>\n\n<p>— <em>therac25, 24 November 2011</em></p>\n\n<hr />")) ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2010-09-15-extending-typed-racket-part-1.md" . unix) f post (u . "Extending Typed Racket, Part 1") (? . 51) 1467223812 (p+ #"/Users/MB/git/racket-lang-org/blog/2010/09/extending-typed-racket-part-1.html" . unix) "/2010/09/extending-typed-racket-part-1.html" (u . "2010-09-15T15:34:00.001-04:00") (? . 49) (? . 108) (c (u . "")) (u . "\n<p><em>posted by Sam Tobin-Hochstadt</em></p>\n\n<p>The Typed Racket team is pleased to announce a number of new additions to our system. We&rsquo;ll be writing a few blog posts about them, all of which you can read here.</p>\n\n<p>This post begins with the core of the Typed Racket type system. The fundamental idea at the heart of Typed Racket is called occurrence typing. This is the technique that allows us to typecheck existing Racket programs without requiring rewrites. Here&rsquo;s a simple example:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"nb\">number?</span> <span class=\"n\">x</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"nb\">add1</span> <span class=\"n\">x</span><span class=\"p\">)</span> <span class=\"mi\">0</span><span class=\"p\">)</span>\n</pre></div>\n\n</div>\n\n<p>The typechecker can figure out from the use of <code>number?</code> that the second occurrence of <code>x</code> is always going to be a number. This simple form of occurrence typing is enough to take Typed Racket a long way. But because we want to be able to handle all the sophisticated reasoning that programmers are already using to write their Racket programs, we have been working on extending the system further.</p>\n\n<p>The new design of our system is described in a paper, <a href=\"http://www.ccs.neu.edu/scheme/pubs/#icfp10-thf\">Logical Types for Untyped Languages</a>, in the upcoming International Conference on Functional Programming. The introduction provides an overview that&rsquo;s acessible to any Racket programmer, but here&rsquo;s the key example:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">cond</span>\n  <span class=\"p\">[(</span><span class=\"k\">and</span> <span class=\"p\">(</span><span class=\"nb\">number?</span> <span class=\"n\">x</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"nb\">string?</span> <span class=\"n\">y</span><span class=\"p\">))</span> <span class=\"n\">—</span> <span class=\"mi\">1</span> <span class=\"n\">—</span><span class=\"p\">]</span>\n  <span class=\"p\">[(</span><span class=\"nb\">number?</span> <span class=\"n\">x</span><span class=\"p\">)</span>                   <span class=\"n\">—</span> <span class=\"mi\">2</span> <span class=\"n\">—</span><span class=\"p\">]</span>\n  <span class=\"p\">[</span><span class=\"k\">else</span>                          <span class=\"n\">—</span> <span class=\"mi\">3</span> <span class=\"n\">—</span><span class=\"p\">])</span>\n</pre></div>\n\n</div>\n\n<p>In expression 1, we know that <code>x</code> is a number and <code>y</code> is a string. In 2, we know that <code>x</code> is a number and <code>y</code> is not a string, by the logical properties of <code>and</code> and <code>cond</code>. This form of logical reasoning is enabled by the new foundation of the system, and makes the entire system significantly more expressive.</p>\n\n<p>All of these improvements are available in the current version of Racket.</p>") #t (u . "\n<p><em>posted by Sam Tobin-Hochstadt</em></p>\n\n<p>The Typed Racket team is pleased to announce a number of new additions to our system. We&rsquo;ll be writing a few blog posts about them, all of which you can read here.</p>\n\n<p>This post begins with the core of the Typed Racket type system. The fundamental idea at the heart of Typed Racket is called occurrence typing. This is the technique that allows us to typecheck existing Racket programs without requiring rewrites. Here&rsquo;s a simple example:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"nb\">number?</span> <span class=\"n\">x</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"nb\">add1</span> <span class=\"n\">x</span><span class=\"p\">)</span> <span class=\"mi\">0</span><span class=\"p\">)</span>\n</pre></div>\n\n</div>\n\n<p>The typechecker can figure out from the use of <code>number?</code> that the second occurrence of <code>x</code> is always going to be a number. This simple form of occurrence typing is enough to take Typed Racket a long way. But because we want to be able to handle all the sophisticated reasoning that programmers are already using to write their Racket programs, we have been working on extending the system further.</p>\n\n<p>The new design of our system is described in a paper, <a href=\"http://www.ccs.neu.edu/scheme/pubs/#icfp10-thf\">Logical Types for Untyped Languages</a>, in the upcoming International Conference on Functional Programming. The introduction provides an overview that&rsquo;s acessible to any Racket programmer, but here&rsquo;s the key example:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">cond</span>\n  <span class=\"p\">[(</span><span class=\"k\">and</span> <span class=\"p\">(</span><span class=\"nb\">number?</span> <span class=\"n\">x</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"nb\">string?</span> <span class=\"n\">y</span><span class=\"p\">))</span> <span class=\"n\">—</span> <span class=\"mi\">1</span> <span class=\"n\">—</span><span class=\"p\">]</span>\n  <span class=\"p\">[(</span><span class=\"nb\">number?</span> <span class=\"n\">x</span><span class=\"p\">)</span>                   <span class=\"n\">—</span> <span class=\"mi\">2</span> <span class=\"n\">—</span><span class=\"p\">]</span>\n  <span class=\"p\">[</span><span class=\"k\">else</span>                          <span class=\"n\">—</span> <span class=\"mi\">3</span> <span class=\"n\">—</span><span class=\"p\">])</span>\n</pre></div>\n\n</div>\n\n<p>In expression 1, we know that <code>x</code> is a number and <code>y</code> is a string. In 2, we know that <code>x</code> is a number and <code>y</code> is not a string, by the logical properties of <code>and</code> and <code>cond</code>. This form of logical reasoning is enabled by the new foundation of the system, and makes the entire system significantly more expressive.</p>\n\n<p>All of these improvements are available in the current version of Racket.</p>\n<!-- more-->\n\n<hr />\n\n<blockquote>\n <p>The typechecker can figure out from the use of number? that the occurrence of x is always going to be a number.</p></blockquote>\n\n<p>Presumably that should be &ldquo;the second occurrence of x&rdquo;?</p>\n\n<p>— <em>alexey-rom, 15 September 2010</em></p>\n\n<hr />")) ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2009-01-29-cfp-scheme-workshop-2009.md" . unix) f post (u . "CfP: Scheme Workshop 2009!") (? . 8) 1467223812 (p+ #"/Users/MB/git/racket-lang-org/blog/2009/01/cfp-scheme-workshop-2009.html" . unix) "/2009/01/cfp-scheme-workshop-2009.html" (u . "2009-01-29T01:58:00.003-05:00") (? . 7) (? . 26) (c (u . "")) (u . "\n<p><em>posted by John Clements</em></p>\n\n<p>SCHEME AND FUNCTIONAL PROGRAMMING WORKSHOP 2009:  Cambridge, Massachusetts:   August 22, 2009:  call for papers:  <a href=\"http://www.schemeworkshop.org/2009/\">http://www.schemeworkshop.org/2009/</a>:</p>\n\n<p>The Scheme and Functional Programming Workshop showcases research and experience related to Scheme, and more broadly to all aspects of functional programming.</p>\n\n<p>Areas of interest include:</p>\n\n<ul>\n <li>\n  <p>Language Design, Type Systems, Theory</p></li>\n <li>\n  <p>Program Development Environments, Education</p></li>\n <li>\n  <p>Agile Methodologies, Lightweight Software Engineering</p></li>\n <li>\n  <p>Applications, Implementation, and Experience</p></li>\n <li>\n  <p>SRFIs!</p></li></ul>\n\n<p>In addition to technical papers on matters of programming-language research, we encourage submissions that present experience or innovation with a particular project. The key criterion for any paper&mdash;technical or not&mdash;is that it makes a contribution from which other practitioners can benefit.</p>\n\n<p>Dates::</p>\n\n<p>Dates are firm, and will not be extended. Please plan accordingly.</p>\n\n<ul>\n <li>\n  <p>Submission Deadline: June 5, 2009 (FIRM)</p></li>\n <li>\n  <p>Author Notification: June 26, 2009</p></li>\n <li>\n  <p>Final Papers Due: July 24, 2009</p></li>\n <li>\n  <p>Workshop: August 22, 2009</p></li></ul>\n\n<p>Program Committee::</p>\n\n<ul>\n <li>\n  <p>John Clements, Cal Poly State University (organizer &amp; chair)</p></li>\n <li>\n  <p>Dominique Boucher, Nu Echo</p></li>\n <li>\n  <p>Abdulaziz Ghuloum, Indiana University</p></li>\n <li>\n  <p>David Herman, Northeastern University</p></li>\n <li>\n  <p>Shriram Krishnamurthi, Brown University</p></li>\n <li>\n  <p>Matthew Might, University of Utah</p></li>\n <li>\n  <p>David Van Horn, Northeastern University</p></li></ul>\n\n<p>Publication Policy::</p>\n\n<p>Submitted papers must have content that has not previously been published in other conferences or refereed venues, and simultaneous submission to other conferences or refereed venues is unacceptable.</p>\n\n<p>Publication of a paper at this workshop is not intended to replace conference or journal publication, and does not preclude re-publication of a more complete or finished version of the paper at some later conference or in a journal.</p>\n\n<p>Submission Instructions::</p>\n\n<p>Your submissions should be no longer than 12 pages, including bibliography and appendices. Papers may be shorter than this limit, and the Program Committee encourages authors to submit shorter papers where appropriate.</p>\n\n<p>The conference web page (URL above) contains detailed formatting instructions and LaTeX support files.</p>\n\n<p>Submit your papers using the Continue 2.0 submission server, at the URL:</p>\n\n<p><a href=\"http://continue2.cs.brown.edu/scheme2009/\">http://continue2.cs.brown.edu/scheme2009/</a></p>\n\n<p>We look forward to reading your papers!</p>") #f (u . "\n<p><em>posted by John Clements</em></p>\n\n<p>SCHEME AND FUNCTIONAL PROGRAMMING WORKSHOP 2009:  Cambridge, Massachusetts:   August 22, 2009:  call for papers:  <a href=\"http://www.schemeworkshop.org/2009/\">http://www.schemeworkshop.org/2009/</a>:</p>\n\n<p>The Scheme and Functional Programming Workshop showcases research and experience related to Scheme, and more broadly to all aspects of functional programming.</p>\n\n<p>Areas of interest include:</p>\n\n<ul>\n <li>\n  <p>Language Design, Type Systems, Theory</p></li>\n <li>\n  <p>Program Development Environments, Education</p></li>\n <li>\n  <p>Agile Methodologies, Lightweight Software Engineering</p></li>\n <li>\n  <p>Applications, Implementation, and Experience</p></li>\n <li>\n  <p>SRFIs!</p></li></ul>\n\n<p>In addition to technical papers on matters of programming-language research, we encourage submissions that present experience or innovation with a particular project. The key criterion for any paper&mdash;technical or not&mdash;is that it makes a contribution from which other practitioners can benefit.</p>\n\n<p>Dates::</p>\n\n<p>Dates are firm, and will not be extended. Please plan accordingly.</p>\n\n<ul>\n <li>\n  <p>Submission Deadline: June 5, 2009 (FIRM)</p></li>\n <li>\n  <p>Author Notification: June 26, 2009</p></li>\n <li>\n  <p>Final Papers Due: July 24, 2009</p></li>\n <li>\n  <p>Workshop: August 22, 2009</p></li></ul>\n\n<p>Program Committee::</p>\n\n<ul>\n <li>\n  <p>John Clements, Cal Poly State University (organizer &amp; chair)</p></li>\n <li>\n  <p>Dominique Boucher, Nu Echo</p></li>\n <li>\n  <p>Abdulaziz Ghuloum, Indiana University</p></li>\n <li>\n  <p>David Herman, Northeastern University</p></li>\n <li>\n  <p>Shriram Krishnamurthi, Brown University</p></li>\n <li>\n  <p>Matthew Might, University of Utah</p></li>\n <li>\n  <p>David Van Horn, Northeastern University</p></li></ul>\n\n<p>Publication Policy::</p>\n\n<p>Submitted papers must have content that has not previously been published in other conferences or refereed venues, and simultaneous submission to other conferences or refereed venues is unacceptable.</p>\n\n<p>Publication of a paper at this workshop is not intended to replace conference or journal publication, and does not preclude re-publication of a more complete or finished version of the paper at some later conference or in a journal.</p>\n\n<p>Submission Instructions::</p>\n\n<p>Your submissions should be no longer than 12 pages, including bibliography and appendices. Papers may be shorter than this limit, and the Program Committee encourages authors to submit shorter papers where appropriate.</p>\n\n<p>The conference web page (URL above) contains detailed formatting instructions and LaTeX support files.</p>\n\n<p>Submit your papers using the Continue 2.0 submission server, at the URL:</p>\n\n<p><a href=\"http://continue2.cs.brown.edu/scheme2009/\">http://continue2.cs.brown.edu/scheme2009/</a></p>\n\n<p>We look forward to reading your papers!</p>")) ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2009-01-21-plt-scheme-v414.md" . unix) f post (u . "PLT Scheme v4.1.4") (? . 7) 1467223812 (p+ #"/Users/MB/git/racket-lang-org/blog/2009/01/plt-scheme-v414.html" . unix) "/2009/01/plt-scheme-v414.html" (u . "2009-01-21T02:20:00.000-05:00") (? . 109) (? . 8) (c (u . "")) (u . "\n<p><em>posted by Eli Barzilay</em></p>\n\n<p>PLT Scheme version 4.1.4 is now available from  <a href=\"http://plt-scheme.org/\">http://plt-scheme.org/</a></p>\n\n<ul>\n <li>\n  <p>New libraries include <code>scheme/package' (for nestable static modules) and</code>ffi/objc&rsquo; (support for Objective-C).</p></li>\n <li>\n  <p>New teaching support includes a &ldquo;universe.ss&rdquo; teachpack for connecting &ldquo;worlds&rdquo; over a network.</p></li>\n <li>\n  <p>Redex now supports automatic test-case generation. Specify a predicate that should hold of your reduction system, and Redex will attempt to falsify it. See &lsquo;redex-check&rsquo; in the manual for more details.</p></li>\n <li>\n  <p>Improvements to the run-time system include better and more reliable memory-limit tracking, function contracts that preserve tail recursion in many cases, native debugging backtraces on x86_64, and performance improvements.</p></li>\n <li>\n  <p>Improved libraries include enhancements to <code>scheme/sandbox', better handling of zero-sized matches by</code>regexp-split&rsquo; and friends, an <code>equal&gt;' interface for specifying equality on class instances (and more general support for attaching properties to interfaces), equality (via</code>equal&gt;&rsquo;) for image objects, and refinements to `scheme/foreign&rsquo; to support atomic operations and function-pointer conversions.</p></li></ul>\n\n<p>[Note that mirror sites can take a while to catch up with the new downloads.]</p>\n\n<p>Feedback Welcome.</p>") #t (u . "\n<p><em>posted by Eli Barzilay</em></p>\n\n<p>PLT Scheme version 4.1.4 is now available from  <a href=\"http://plt-scheme.org/\">http://plt-scheme.org/</a></p>\n\n<ul>\n <li>\n  <p>New libraries include <code>scheme/package' (for nestable static modules) and</code>ffi/objc&rsquo; (support for Objective-C).</p></li>\n <li>\n  <p>New teaching support includes a &ldquo;universe.ss&rdquo; teachpack for connecting &ldquo;worlds&rdquo; over a network.</p></li>\n <li>\n  <p>Redex now supports automatic test-case generation. Specify a predicate that should hold of your reduction system, and Redex will attempt to falsify it. See &lsquo;redex-check&rsquo; in the manual for more details.</p></li>\n <li>\n  <p>Improvements to the run-time system include better and more reliable memory-limit tracking, function contracts that preserve tail recursion in many cases, native debugging backtraces on x86_64, and performance improvements.</p></li>\n <li>\n  <p>Improved libraries include enhancements to <code>scheme/sandbox', better handling of zero-sized matches by</code>regexp-split&rsquo; and friends, an <code>equal&gt;' interface for specifying equality on class instances (and more general support for attaching properties to interfaces), equality (via</code>equal&gt;&rsquo;) for image objects, and refinements to `scheme/foreign&rsquo; to support atomic operations and function-pointer conversions.</p></li></ul>\n\n<p>[Note that mirror sites can take a while to catch up with the new downloads.]</p>\n\n<p>Feedback Welcome.</p>\n<!-- more-->\n\n<hr />\n\n<p>Hello,</p>\n\n<p>Let me notify you that the current version of MzScheme does not start on my old win98 machine.</p>\n\n<p>I&rsquo;ve been using 4.1.1. for some time and it&rsquo;s been working all fine. To my dismay, however, when I tried to run the newly installed one, it just caused crash and I had to reboot the PC. The same thing happned with mzc.exe, too.</p>\n\n<p>I can&rsquo;t figure out where the problem is, but I hope it will be solved anyway. (Or will the support of win95 family be discontinued?)</p>\n\n<p>— <em>Madoka, 21 January 2009</em></p>\n\n<hr />\n\n<p>Win95 family should be discontinued. End of story.</p>\n\n<p>— <em>Bob, 23 January 2009</em></p>\n\n<hr />\n\n<p>Greetings Fellows.</p>\n\n<p>Im getting this error on XP/OSX in about DrScheme -&gt; our software license</p>\n\n<p>procedure send-main-page: expects 0 arguments plus optional arguments with keywords #:fragment, #:notify, #:query, and #:sub, given 1: &ldquo;license/index.html&rdquo;</p>\n\n<p> === context === /Applications/PLTScheme/collects/scheme/private/more-scheme.ss:155:2: call-with-break-parameterization /Applications/PLTScheme/collects/scheme/private/more-scheme.ss:271:2: call-with-exception-handler</p>\n\n<p>Best Regards</p>\n\n<p>— <em>Jesus Boadas, 26 January 2009</em></p>\n\n<hr />\n\n<p>The &ldquo;software license&rdquo; problem is fixed for the next version. As for the Windows98 problem, we still didn&rsquo;t find what the problem is&hellip;</p>\n\n<p>— <em>Eli Barzilay, 27 January 2009</em></p>\n\n<hr />\n\n<p>Madoka: thanks for letting us know. We have restored pre-XP compatibility for the next version. If you&rsquo;d like to try the 4.1.4.2 snapshot, see http://pre.plt-scheme.org/installers/</p>\n\n<p>— <em>Matthew Flatt, 27 January 2009</em></p>\n\n<hr />")) ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2011-06-29-come-to-racketcon.md" . unix) f post (u . "Come to RacketCon!") (? . 9) 1467223812 (p+ #"/Users/MB/git/racket-lang-org/blog/2011/06/come-to-racketcon.html" . unix) "/2011/06/come-to-racketcon.html" (u . "2011-06-29T17:25:00.003-04:00") (? . 10) (? . 11) (c (u . "")) (u . "\n<p><em>posted by Sam Tobin-Hochstadt</em></p>\n\n<p>Calling All Racketeers!</p>\n\n<p>Join us at RacketCon, 23 &amp; 24 July 2011. <a href=\"http://con.racket-lang.org/\">http://con.racket-lang.org/</a></p>\n\n<p>The schedule for RacketCon is now available, and includes presentations by key members of the Racket team, including Matthew Flatt on the future of Racket and Matthias Felleisen on the Program By Design curriculum, as well as tutorials on building web applications and accessing low-level libraries.</p>\n\n<p>The meeting will take place at Northeastern University in Boston, MA. It will be an opportunity for developers, researchers, and educators using Racket, DrRacket, Program By Design, and related technologies to come together to share plans, ideas, and enthusiasm. To make it accessible, we will not charge any registration fees; we&rsquo;ll also serve you breakfast and lunch.</p>\n\n<p>We&rsquo;re excited about RacketCon, and hope you&rsquo;ll join us there. To register for RacketCon, please send an email with your name and affiliation to <a href=\"mailto:racketcon@racket-lang.org\">racketcon@racket-lang.org</a>.</p>\n\n<p>Additional information, including registration, transportation and hotel information, can be found on the web page: <a href=\"http://con.racket-lang.org\">http://con.racket-lang.org</a></p>") #t (u . "\n<p><em>posted by Sam Tobin-Hochstadt</em></p>\n\n<p>Calling All Racketeers!</p>\n\n<p>Join us at RacketCon, 23 &amp; 24 July 2011. <a href=\"http://con.racket-lang.org/\">http://con.racket-lang.org/</a></p>\n\n<p>The schedule for RacketCon is now available, and includes presentations by key members of the Racket team, including Matthew Flatt on the future of Racket and Matthias Felleisen on the Program By Design curriculum, as well as tutorials on building web applications and accessing low-level libraries.</p>\n\n<p>The meeting will take place at Northeastern University in Boston, MA. It will be an opportunity for developers, researchers, and educators using Racket, DrRacket, Program By Design, and related technologies to come together to share plans, ideas, and enthusiasm. To make it accessible, we will not charge any registration fees; we&rsquo;ll also serve you breakfast and lunch.</p>\n\n<p>We&rsquo;re excited about RacketCon, and hope you&rsquo;ll join us there. To register for RacketCon, please send an email with your name and affiliation to <a href=\"mailto:racketcon@racket-lang.org\">racketcon@racket-lang.org</a>.</p>\n\n<p>Additional information, including registration, transportation and hotel information, can be found on the web page: <a href=\"http://con.racket-lang.org\">http://con.racket-lang.org</a></p>\n<!-- more-->\n\n<hr />\n\n<p>a lambda calculus symbol in firefox markup</p>\n\n<p>https://markup.mozilla.org/fr/#/linear/LNgc?playback=true&amp;be_grateful=true</p>\n\n<p>— <em>stber, 4 July 2011</em></p>\n\n<hr />\n\n<p>When will the conference videos be available ?</p>\n\n<p>— <em>therac25, 28 July 2011</em></p>\n\n<hr />")) ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2008-10-28-plt-scheme-v412.md" . unix) f post (u . "PLT Scheme v4.1.2") (? . 117) 1467223812 (p+ #"/Users/MB/git/racket-lang-org/blog/2008/10/plt-scheme-v412.html" . unix) "/2008/10/plt-scheme-v412.html" (u . "2008-10-28T14:29:00.001-04:00") (? . 12) (? . 110) (c (u . "")) (u . "\n<p><em>posted by Eli Barzilay</em></p>\n\n<p>PLT Scheme version 4.1.2 is now available from  <a href=\"http://plt-scheme.org/\">http://plt-scheme.org/</a> This is a bug-fix release.</p>\n\n<p>[Note that mirror sites can take a while to catch up with the new downloads.]</p>\n\n<p>Feedback Welcome.</p>") #f (u . "\n<p><em>posted by Eli Barzilay</em></p>\n\n<p>PLT Scheme version 4.1.2 is now available from  <a href=\"http://plt-scheme.org/\">http://plt-scheme.org/</a> This is a bug-fix release.</p>\n\n<p>[Note that mirror sites can take a while to catch up with the new downloads.]</p>\n\n<p>Feedback Welcome.</p>")) ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2008-06-12-plt-scheme-v40.md" . unix) f post (u . "PLT Scheme v4.0") (? . 23) 1467223812 (p+ #"/Users/MB/git/racket-lang-org/blog/2008/06/plt-scheme-v40.html" . unix) "/2008/06/plt-scheme-v40.html" (u . "2008-06-12T02:11:00.002-04:00") (? . 41) (? . 22) (c (u . "")) (u . "\n<p><em>posted by Eli Barzilay</em></p>\n\n<p>PLT Scheme version 4.0 is now available from <code>[http://plt-scheme.org/](http://plt-scheme.org/)</code> This major new release offers many improvements over version 372, and we encourage everyone to upgrade.</p>\n\n<ul>\n <li>\n  <p>The PLT Scheme language now provides better syntax for modules, better support for optional and keyword arguments to functions, a more complete syntax for structure types, new syntax for list comprehensions and iterations, a more complete and consistent set of list operations, a more complete set of string operations, and streamlined hash-table operations.</p></li>\n <li>\n  <p>The documentation has been re-organized and re-written. New tutorials and overviews offer a clearer introduction to Scheme and PLT Scheme.</p></li>\n <li>\n  <p>New documentation tools help programmers create and install documentation for libraries and Planet packages. All installed documentation can be read though the user&rsquo;s web browser, and even searching within the browser works on local files. The language for writing documentation is an extension of Scheme, and document sources are linked to implementations through the module system. The module connection allows, for example, reliable automatic hyperlinking of identifiers mentioned in documentation to their specifications in other documentation.</p></li>\n <li>\n  <p>R6RS programs are supported in two ways: though the <code>plt-r6rs</code> executable and through the <code>#!r6rs</code> prefix. The latter allows an R6RS library or program to serve as a PLT Scheme module.</p></li>\n <li>\n  <p>Legacy R5RS support is improved, partly through a separate <code>plt-r5rs</code> executable.</p></li>\n <li>\n  <p>Pairs are immutable within the PLT Scheme language; mutable pairs (which are the same as R6RS and R5RS pairs) are provided as a separate datatype. For more information, see &ldquo;Getting rid of <code>set-car!</code> and <code>set-cdr!</code>&rdquo;</p></li>\n <li>\n  <p>ProfessorJ uses a new and improved parser, it evaluates programs faster, and it includes a Java-specific indenter.</p></li>\n <li>\n  <p>Testing frameworks for the HtDP and HtDC (ProfessorJ) teaching languages have been unified. Both support systematic unit testing in a comprehensive fashion. When programs lack tests, students are asked to add test cases. When all tests succeed, a simple message says so; otherwise, a pop-up window (dockable) displays URLs to the failed test cases and explains why the cases failed.</p></li>\n <li>\n  <p>Typed Scheme, a statically typed dialect of Scheme, is now included with PLT Scheme. While Typed Scheme is still in its early stages of development, it supports modular programming with types and full interaction with existing untyped code. Safe interactions between typed and untyped modules are enforced via contracts. Typed Scheme also features a novel type system designed to accommodate Scheme programming idioms. For more information, see the <a href=\"http://www.ccs.neu.edu/~samth/typed-scheme/\">Typed Scheme</a> page.</p></li></ul>\n\n<p>Feedback Welcome.</p>") #t (u . "\n<p><em>posted by Eli Barzilay</em></p>\n\n<p>PLT Scheme version 4.0 is now available from <code>[http://plt-scheme.org/](http://plt-scheme.org/)</code> This major new release offers many improvements over version 372, and we encourage everyone to upgrade.</p>\n\n<ul>\n <li>\n  <p>The PLT Scheme language now provides better syntax for modules, better support for optional and keyword arguments to functions, a more complete syntax for structure types, new syntax for list comprehensions and iterations, a more complete and consistent set of list operations, a more complete set of string operations, and streamlined hash-table operations.</p></li>\n <li>\n  <p>The documentation has been re-organized and re-written. New tutorials and overviews offer a clearer introduction to Scheme and PLT Scheme.</p></li>\n <li>\n  <p>New documentation tools help programmers create and install documentation for libraries and Planet packages. All installed documentation can be read though the user&rsquo;s web browser, and even searching within the browser works on local files. The language for writing documentation is an extension of Scheme, and document sources are linked to implementations through the module system. The module connection allows, for example, reliable automatic hyperlinking of identifiers mentioned in documentation to their specifications in other documentation.</p></li>\n <li>\n  <p>R6RS programs are supported in two ways: though the <code>plt-r6rs</code> executable and through the <code>#!r6rs</code> prefix. The latter allows an R6RS library or program to serve as a PLT Scheme module.</p></li>\n <li>\n  <p>Legacy R5RS support is improved, partly through a separate <code>plt-r5rs</code> executable.</p></li>\n <li>\n  <p>Pairs are immutable within the PLT Scheme language; mutable pairs (which are the same as R6RS and R5RS pairs) are provided as a separate datatype. For more information, see &ldquo;Getting rid of <code>set-car!</code> and <code>set-cdr!</code>&rdquo;</p></li>\n <li>\n  <p>ProfessorJ uses a new and improved parser, it evaluates programs faster, and it includes a Java-specific indenter.</p></li>\n <li>\n  <p>Testing frameworks for the HtDP and HtDC (ProfessorJ) teaching languages have been unified. Both support systematic unit testing in a comprehensive fashion. When programs lack tests, students are asked to add test cases. When all tests succeed, a simple message says so; otherwise, a pop-up window (dockable) displays URLs to the failed test cases and explains why the cases failed.</p></li>\n <li>\n  <p>Typed Scheme, a statically typed dialect of Scheme, is now included with PLT Scheme. While Typed Scheme is still in its early stages of development, it supports modular programming with types and full interaction with existing untyped code. Safe interactions between typed and untyped modules are enforced via contracts. Typed Scheme also features a novel type system designed to accommodate Scheme programming idioms. For more information, see the <a href=\"http://www.ccs.neu.edu/~samth/typed-scheme/\">Typed Scheme</a> page.</p></li></ul>\n\n<p>Feedback Welcome.</p>\n<!-- more-->\n\n<hr />\n\n<p>I just downloaded PLT Scheme 4.0, and I haven&rsquo;t used Scheme in a long time. Was a long time CL user. How do I set the language to be the complete scheme language with R6RS? I tried the documentation online and asking in IRC, but no dice. Any suggestions?</p>\n\n<p>— <em>Eric, 12 June 2008</em></p>\n\n<hr />\n\n<p>Use the module language and put</p>\n\n<p> #!r6rs</p>\n\n<p>as the first line in your file.</p>\n\n<p>(Or, with that line, you can use mzscheme from the commandline too, ie &ldquo;mzscheme file.ss&rdquo;)</p>\n\n<p>— <em>Robby, 12 June 2008</em></p>\n\n<hr />\n\n<p>I chose Module, clicked Run and then put #!r6rs at the REPL, didn&rsquo;t like it. So I put #!r6rs in the definitions area (above the repl). Then followed it by a factorial function. It doesn&rsquo;t complain about the #!r6rs anymore, but now it complains about &ldquo;expected an import declaration&rdquo;. If I choose Pretty Big or R5RS, everything is hunky doory. Why can&rsquo;t there just be a R6RS mode?</p>\n\n<p>I guess I better read up on this &lsquo;module&rsquo; language. I really just wanted to try this out. I must be missing something.</p>\n\n<p>— <em>Eric, 12 June 2008</em></p>\n\n<hr />\n\n<p>Isn&rsquo;t your question about r6rs rather than module?</p>\n\n<p>— <em>matthias, 12 June 2008</em></p>\n\n<hr />\n\n<p>All I want is to start up PLT Scheme and be able to write code which conforms to R6RS. Nothing else.</p>\n\n<p>— <em>Eric, 12 June 2008</em></p>\n\n<hr />\n\n<p>Code that conforms to R6RS starts with <code>(import ...)' at a minimum. Your other alternative is to start with</code>(library &hellip; (export &hellip;) (import &hellip;) &hellip;)&rsquo;.</p>\n\n<p>To run R6RS programs/libraries in DrScheme, you also have to start with `#!r6rs&rsquo;, even though R6RS itself doesn&rsquo;t require that. Yes, in the Module language. Experience so far has convinced us that it&rsquo;s better to declare a program&rsquo;s language in the source, instead of having a zillion language choices in a GUI dialog; that&rsquo;s why we&rsquo;ve avoided adding an &ldquo;R6RS&rdquo; option in DrScheme&rsquo;s langauge dialog (and why we&rsquo;ve removed several PLT-specific options at the same time).</p>\n\n<p>Meanwhile, maybe you can help us improve the documentation. Using the online docs, I would have guessed that you&rsquo;d go to http://docs.plt-scheme.org/, follow the &ldquo;R6RS&rdquo; link, and then read the first chapter on running R6RS programs. Can you tell us more about the path you took and how it failed you?</p>\n\n<p>Thanks!</p>\n\n<p>— <em>Matthew Flatt, 12 June 2008</em></p>\n\n<hr />\n\n<p>RE: &ldquo;Meanwhile, maybe you can help us improve the documentation. Using the online docs, I would have guessed that you&rsquo;d go to http://docs.plt-scheme.org/, follow the \"R6RS&rdquo; link, and then read the first chapter on running R6RS programs. Can you tell us more about the path you took and how it failed you?\"</p>\n\n<hr />\n\n<p>There was no real method to my madness. I fired up PLT Scheme. I saw no language was selected. I haven&rsquo;t used scheme in a long time, but when I did I would usually just select R5RS or Pretty Big and then just start coding. So, I thought I would go and do the same thing, except now that R6RS is implemented, I might was well switch to that by default. So I went to select a language. I didn&rsquo;t see R6RS. So I read all the descriptions of the others, none of which really means anything to me. The small blurb at the bottom doesn&rsquo;t really say enough to convey the differences. All I knew is that I wanted R6RS. I couldn&rsquo;t find it or make heads or tails of any of it, so I decided to go to plt-scheme website and look at docs. On the docs page I did a search for &lsquo;language&rsquo;. As I was looking for documentation on the differences of the particular languages. I saw the R6RS link but I thought that was a spec, or description of the language itself. I was just interested in how to get the language setup so I could work in PLT Scheme. (ie. I was viewing that as the first step before I would read in detail about R6RS). So failing to find anything there, my next step was to google it, which of course comes up with overwhelming results which I scanned a few and then stopped and asked on this blog. And so here we stand.</p>\n\n<p>Basically I was just looking for a quick canvas to &lsquo;go&rsquo;. I just wanted to try it, I didn&rsquo;t really want to think about it. (never had to before, so maybe thats why)</p>\n\n<p>— <em>Eric, 12 June 2008</em></p>\n\n<hr />\n\n<p>What about having an R6RS option and just dumping the \"#!r6rs (import (rnrs)) ;put code here\" directly into the definition pane when its selected. You could even follow it with a modal window explaining that with r6rs, you must precede all files with this syntax blah blah and have a &ldquo;do not show again&rdquo; checkbox. Even have a link to the online documentation for more details. I would have figured that out pretty quick :).</p>\n\n<p>— <em>Eric, 12 June 2008</em></p>\n\n<hr />\n\n<p>That&rsquo;s an interesting idea. It sounds similar to the way that Visual Studio or XCode will create a project based on a template &mdash; except that instead of a pile of project settings, DrScheme would just give you a few starting lines of text.</p>\n\n<p>— <em>Matthew Flatt, 12 June 2008</em></p>\n\n<hr />\n\n<p>Horay! Thanks so much to everyone working on PLT Scheme. I&rsquo;m really enjoying it.</p>\n\n<p>I especially enjoy the amazing support and patience from PLT members.</p>\n\n<p>I like the new plt-scheme.org look as well. I think it&rsquo;s much simpler to navigate.</p>\n\n<p>Again, thank you!</p>\n\n<p>— <em>David Vanderson, 12 June 2008</em></p>\n\n<hr />\n\n<p>i love it so far, but..</p>\n\n<p>and you&rsquo;ve probably heard this a lot before&hellip;</p>\n\n<p>&hellip; when are we going to see a plt sql database abstraction for recent plt-schemes?</p>\n\n<p>— <em>Jon Philpott, 13 June 2008</em></p>\n\n<hr />\n\n<p>man, this is great. plt definitely rocks!</p>\n\n<p>— <em>bolognese, 19 June 2008</em></p>\n\n<hr />\n\n<p>This comment has been removed by the author.</p>\n\n<p>— <em>hyperlogic, 29 June 2008</em></p>\n\n<hr />\n\n<p>hi, i am working with dr scheme 3.72. can someone please tell me how to read and write data to a file in scheme code??? i need this quick as i am stuck in a project because of the same problem&hellip;..help!!!!!</p>\n\n<p>— <em>Maverick, 10 December 2008</em></p>\n\n<hr />\n\n<p>1) google for &ldquo;PLT scheme read from file&rdquo; 2) use DrScheme&rsquo;s built-in Help Desk. 3) write to the PLT Mailing list.</p>\n\n<p>— <em>John Clements, 10 December 2008</em></p>\n\n<hr />\n\n<p>you really need r6rs option OR simplify docs. its counter-intuitive with having r5rs. nobody would think to put language to module.  even though called r6rs module language.</p>\n\n<p>for documentation recommend something like this ditto-  point zero : demo on r6rs START DRSCHEME PUT LANGUAGE TO MODULE PUT THIS INTO DEFINITION WINDOW  #!r6rs  (library (examples hello)  (export greet)  (import (rnrs))</p>\n\n<pre><code>(define (greet)\n  (display \"hello\\n\")))</code></pre>\n\n<p>CLICK RUN</p>\n\n<p>— <em>terry, 3 March 2009</em></p>\n\n<hr />")) ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2009-03-22-plt-scheme-v415.md" . unix) f post (u . "PLT Scheme v4.1.5") (? . 57) 1467223812 (p+ #"/Users/MB/git/racket-lang-org/blog/2009/03/plt-scheme-v415.html" . unix) "/2009/03/plt-scheme-v415.html" (u . "2009-03-22T01:29:00.001-04:00") (? . 68) (? . 56) (c (u . "")) (u . "\n<p><em>posted by Eli Barzilay</em></p>\n\n<p>PLT Scheme version 4.1.5 is now available from  <a href=\"http://plt-scheme.org/\">http://plt-scheme.org/</a></p>\n\n<ul>\n <li>Web Server:\n  <ul>\n   <li>new URL-based dispatching library <code>web-server/dispatch</code>,</li>\n   <li>customizable continuation serialization policies for the stateless web language <code>web-server/stuffers</code>,</li>\n   <li>abstraction of serve/servlet to build simpler dispatchers <code>web-server/servlet-env</code>,</li>\n   <li>HTTP Digest authentication support <code>web-server/http/digest-auth</code>,</li>\n   <li>built-in cookie support in <code>web-server/http/cookie</code> and <code>web-server/http/cookie-parse</code>,</li>\n   <li>highlighting and pretty-printing of errors in Xexpr constructions,</li>\n   <li>load control dispatcher for limit concurrent sessions <code>web-server/dispatchers/limit</code>.</li></ul></li>\n <li>Scribble:\n  <ul>\n   <li>Literate programming is now available using the new <code>scribble/lp</code> language.</li>\n   <li>A new <code>at-exp</code> language makes it convenient to use the scribble reader&rsquo;s @-expressions for general code.</li>\n   <li>The <code>scribble/text</code> preprocessor language has been extended to deal with indentation and other formatting issues.</li>\n   <li>The &ldquo;scribble&rdquo; command-line tool accepts a <code>--pdf</code> flag to render PDFs (via pdflatex).</li></ul></li>\n <li>\n  <p>DrScheme now provides feedback when PLaneT downloads and installs new packages.</p></li>\n <li>Units &amp; Contracts:\n  <ul>\n   <li>Elements of unit signatures can now be associated with contracts via the <code>contracted</code> signature form.</li>\n   <li>A contract combinator for units, <code>unit/c</code>, has been added.</li>\n   <li>The new <code>with-contract</code> form provides a nestable submodule contract boundary, protecting a group of definitions from the surrounding code with contracts.</li>\n   <li>The <code>define/contract</code> form has been reworked and new define forms have been added: <code>define-struct/contract</code> and <code>define-unit/contract</code>.</li></ul></li>\n <li>\n  <p>Language levels and teachpacks from the DeinProgramm project for the German textbook &ldquo;Die Macht der Abstraktion&rdquo; by Herbert Klaeren and Michael Sperber have been added.</p></li>\n <li>Misc:\n  <ul>\n   <li>Typed Scheme now comes with several more pre-wrapped libraries, found in the <code>typed</code> collection.</li>\n   <li>The <code>xml</code> and <code>html</code> collections are now contracted.</li>\n   <li>Binding parsing in net/cgi now interacts with <code>net/uri-codec</code>&rsquo;s configuration parameters.</li>\n   <li>DrScheme captures logging output.</li>\n   <li>Check syntax: it is now possible to tack arrows crossing the currently selected text.</li>\n   <li>New <code>bitwise-bit-field</code> function.</li></ul></li>\n <li>The usual pile of bugfixes. (Notable: <code>scheme/package</code> works, <code>deflate</code> compression fixed, DrScheme language dialog issue resolved, <code>match</code> fixes, Windows networking, and much more.)</li></ul>\n\n<p>[Note that mirror sites can take a while to catch up with the new downloads.]</p>\n\n<p>Feedback Welcome.</p>") #t (u . "\n<p><em>posted by Eli Barzilay</em></p>\n\n<p>PLT Scheme version 4.1.5 is now available from  <a href=\"http://plt-scheme.org/\">http://plt-scheme.org/</a></p>\n\n<ul>\n <li>Web Server:\n  <ul>\n   <li>new URL-based dispatching library <code>web-server/dispatch</code>,</li>\n   <li>customizable continuation serialization policies for the stateless web language <code>web-server/stuffers</code>,</li>\n   <li>abstraction of serve/servlet to build simpler dispatchers <code>web-server/servlet-env</code>,</li>\n   <li>HTTP Digest authentication support <code>web-server/http/digest-auth</code>,</li>\n   <li>built-in cookie support in <code>web-server/http/cookie</code> and <code>web-server/http/cookie-parse</code>,</li>\n   <li>highlighting and pretty-printing of errors in Xexpr constructions,</li>\n   <li>load control dispatcher for limit concurrent sessions <code>web-server/dispatchers/limit</code>.</li></ul></li>\n <li>Scribble:\n  <ul>\n   <li>Literate programming is now available using the new <code>scribble/lp</code> language.</li>\n   <li>A new <code>at-exp</code> language makes it convenient to use the scribble reader&rsquo;s @-expressions for general code.</li>\n   <li>The <code>scribble/text</code> preprocessor language has been extended to deal with indentation and other formatting issues.</li>\n   <li>The &ldquo;scribble&rdquo; command-line tool accepts a <code>--pdf</code> flag to render PDFs (via pdflatex).</li></ul></li>\n <li>\n  <p>DrScheme now provides feedback when PLaneT downloads and installs new packages.</p></li>\n <li>Units &amp; Contracts:\n  <ul>\n   <li>Elements of unit signatures can now be associated with contracts via the <code>contracted</code> signature form.</li>\n   <li>A contract combinator for units, <code>unit/c</code>, has been added.</li>\n   <li>The new <code>with-contract</code> form provides a nestable submodule contract boundary, protecting a group of definitions from the surrounding code with contracts.</li>\n   <li>The <code>define/contract</code> form has been reworked and new define forms have been added: <code>define-struct/contract</code> and <code>define-unit/contract</code>.</li></ul></li>\n <li>\n  <p>Language levels and teachpacks from the DeinProgramm project for the German textbook &ldquo;Die Macht der Abstraktion&rdquo; by Herbert Klaeren and Michael Sperber have been added.</p></li>\n <li>Misc:\n  <ul>\n   <li>Typed Scheme now comes with several more pre-wrapped libraries, found in the <code>typed</code> collection.</li>\n   <li>The <code>xml</code> and <code>html</code> collections are now contracted.</li>\n   <li>Binding parsing in net/cgi now interacts with <code>net/uri-codec</code>&rsquo;s configuration parameters.</li>\n   <li>DrScheme captures logging output.</li>\n   <li>Check syntax: it is now possible to tack arrows crossing the currently selected text.</li>\n   <li>New <code>bitwise-bit-field</code> function.</li></ul></li>\n <li>The usual pile of bugfixes. (Notable: <code>scheme/package</code> works, <code>deflate</code> compression fixed, DrScheme language dialog issue resolved, <code>match</code> fixes, Windows networking, and much more.)</li></ul>\n\n<p>[Note that mirror sites can take a while to catch up with the new downloads.]</p>\n\n<p>Feedback Welcome.</p>\n<!-- more-->\n\n<hr />\n\n<p>nice. I&rsquo;m new to scheme and using plt scheme to build a web prototype&hellip;</p>\n\n<p>After years of C++, I must say I love the language and environment.</p>\n\n<p>I really appreciate the work you guys put into this - will be nice to have the url aliasing of this release.</p>\n\n<p>— <em>gord, 22 March 2009</em></p>\n\n<hr />\n\n<p>We&rsquo;re glad you like it! I&rsquo;d be very interested to know any of the problems you do have with the Web framework, because I might be able to make it even better.</p>\n\n<p>— <em>Jay McCarthy, 22 March 2009</em></p>\n\n<hr />\n\n<p>Pretty cool stuff dude!</p>\n\n<p>RT www.Privacy-Center.net</p>\n\n<p>— <em>Harold Fowler, 22 March 2009</em></p>\n\n<hr />")) ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2015-06-19-racket-v62.md" . unix) f post (u . "Racket v6.2") (? . 13) 1467223812 (p+ #"/Users/MB/git/racket-lang-org/blog/2015/06/racket-v62.html" . unix) "/2015/06/racket-v62.html" (u . "2015-06-19T23:14:00.000-04:00") (? . 19) (? . 14) (c (u . "")) (u . "\n<p><em>posted by Ryan Culpepper</em></p>\n\n<p>Racket version 6.2 is now available from <a href=\"http://racket-lang.org/\">http://racket-lang.org/</a></p>\n\n<p>With this release we are taking a major step forward to get our user community even more involved than in the past. Over the past six months, we have re-organized the Racket code base into a small core code repo and many other package repos, all found on GitHub. If you have time and if you wish to get involved, please take a look at the GitHub repos and find your favorite places to learn, fix, and enhance our world.</p>\n\n<p>The core repo is at <a href=\"https://github.com/plt/racket\">https://github.com/plt/racket</a>, and the package repos are listed at <a href=\"https://github.com/racket/\">https://github.com/racket/</a>.</p>\n\n<p><a href=\"https://github.com/plt/racket\">core repo</a></p>\n\n<ul>\n <li>\n  <p>The package manager supports a direct references to Git repositories via &ldquo;git://[&hellip;]&rdquo;, &ldquo;http://[&hellip;].git&rdquo;, and &ldquo;https://[&hellip;].git&rdquo; URLs. (Previously, only references to GitHub were supported.)</p></li>\n <li>\n  <p>A <code>--clone</code> option for <code>raco pkg install</code> or <code>raco pkg update</code> facilitates Git-based package development. If a package X has a Git repository source, installing and updating the package pulls from the repository in a read-only mode. Using <code>raco pkg update --clone X</code> switches the local installation to a repository checkout that is suitable for modifying the package implementation, issuing pull requests, pushing changes, and so on.</p></li></ul>\n\n<p>Using <code>raco pkg update --lookup X</code> switches the package back to the default installation mode.</p>\n\n<p><a href=\"https://github.com/racket/drracket\">drracket</a></p>\n\n<ul>\n <li>\n  <p>Its on-line check syntax works with graphical content.</p></li>\n <li>\n  <p>Increased availability of DrRacket&rsquo;s blueboxes, including method and constructor information.</p></li>\n <li>\n  <p>The &ldquo;Open Require Path&rdquo; menu item supports \"..\" in relative pathnames.</p></li></ul>\n\n<p><a href=\"https://github.com/racket/data\">data</a></p>\n\n<ul>\n <li>Added <code>data/enumerate</code>, a library that supports efficient enumeration of data structures</li></ul>\n\n<p><a href=\"https://github.com/racket/redex\">redex</a></p>\n\n<ul>\n <li>\n  <p>Its <code>redex-check</code> facility uses data (in addition to random) enumeration to try to find counter-examples.</p></li>\n <li>\n  <p>Its <code>generate-term</code> function accepts additional arguments to return the &ldquo;i&rdquo;-th member of a pattern using <code>data/enumerate</code> (meaning it efficiently supports very large values of &ldquo;i&rdquo;).</p></li>\n <li>\n  <p>The examples collection includes Launchbury&rsquo;s 1993 big-step lazy semantics.</p></li></ul>\n\n<p><a href=\"https://github.com/racket/htdp\">htdp</a></p>\n\n<ul>\n <li>\n  <p><code>2htdp/image</code>&rsquo;s polygon may be built out of bezier curves instead of just straight lines (see the docs for <code>pulled-point</code>).</p></li>\n <li>\n  <p><code>2htdp/abstraction</code> is a teachpack for instructors and students who wish to use <code>for/*</code> loops, <code>match</code>, <code>define-type</code> and <code>type-cases</code> in ISL and ISL+.</p></li>\n <li>\n  <p><code>2htdp/universe</code> programs can be exported using DrRacket&rsquo;s executable creation mechanism and they behave properly when run independently.</p></li></ul>\n\n<p><a href=\"https://github.com/racket/typed-racket\">typed-racket</a></p>\n\n<ul>\n <li>\n  <p>Typed Racket in DrRacket displays tooltips that show the types of expressions. Tooltips are also displayed for type errors.</p></li>\n <li>\n  <p>Typed Racket loads generated contracts only when needed. This reduces memory use and startup time for Typed Racket programs.</p></li>\n <li>\n  <p>Typed Racket has improved support for prefab structures, future semaphores, and async channels.</p></li>\n <li>\n  <p>Typed Racket understands when two different variables refer to the same thing, and updates types accordingly. This particularly improves the type checking of macros such as <code>match</code>.</p></li></ul>\n\n<p>Feedback Welcome</p>") #f (u . "\n<p><em>posted by Ryan Culpepper</em></p>\n\n<p>Racket version 6.2 is now available from <a href=\"http://racket-lang.org/\">http://racket-lang.org/</a></p>\n\n<p>With this release we are taking a major step forward to get our user community even more involved than in the past. Over the past six months, we have re-organized the Racket code base into a small core code repo and many other package repos, all found on GitHub. If you have time and if you wish to get involved, please take a look at the GitHub repos and find your favorite places to learn, fix, and enhance our world.</p>\n\n<p>The core repo is at <a href=\"https://github.com/plt/racket\">https://github.com/plt/racket</a>, and the package repos are listed at <a href=\"https://github.com/racket/\">https://github.com/racket/</a>.</p>\n\n<p><a href=\"https://github.com/plt/racket\">core repo</a></p>\n\n<ul>\n <li>\n  <p>The package manager supports a direct references to Git repositories via &ldquo;git://[&hellip;]&rdquo;, &ldquo;http://[&hellip;].git&rdquo;, and &ldquo;https://[&hellip;].git&rdquo; URLs. (Previously, only references to GitHub were supported.)</p></li>\n <li>\n  <p>A <code>--clone</code> option for <code>raco pkg install</code> or <code>raco pkg update</code> facilitates Git-based package development. If a package X has a Git repository source, installing and updating the package pulls from the repository in a read-only mode. Using <code>raco pkg update --clone X</code> switches the local installation to a repository checkout that is suitable for modifying the package implementation, issuing pull requests, pushing changes, and so on.</p></li></ul>\n\n<p>Using <code>raco pkg update --lookup X</code> switches the package back to the default installation mode.</p>\n\n<p><a href=\"https://github.com/racket/drracket\">drracket</a></p>\n\n<ul>\n <li>\n  <p>Its on-line check syntax works with graphical content.</p></li>\n <li>\n  <p>Increased availability of DrRacket&rsquo;s blueboxes, including method and constructor information.</p></li>\n <li>\n  <p>The &ldquo;Open Require Path&rdquo; menu item supports \"..\" in relative pathnames.</p></li></ul>\n\n<p><a href=\"https://github.com/racket/data\">data</a></p>\n\n<ul>\n <li>Added <code>data/enumerate</code>, a library that supports efficient enumeration of data structures</li></ul>\n\n<p><a href=\"https://github.com/racket/redex\">redex</a></p>\n\n<ul>\n <li>\n  <p>Its <code>redex-check</code> facility uses data (in addition to random) enumeration to try to find counter-examples.</p></li>\n <li>\n  <p>Its <code>generate-term</code> function accepts additional arguments to return the &ldquo;i&rdquo;-th member of a pattern using <code>data/enumerate</code> (meaning it efficiently supports very large values of &ldquo;i&rdquo;).</p></li>\n <li>\n  <p>The examples collection includes Launchbury&rsquo;s 1993 big-step lazy semantics.</p></li></ul>\n\n<p><a href=\"https://github.com/racket/htdp\">htdp</a></p>\n\n<ul>\n <li>\n  <p><code>2htdp/image</code>&rsquo;s polygon may be built out of bezier curves instead of just straight lines (see the docs for <code>pulled-point</code>).</p></li>\n <li>\n  <p><code>2htdp/abstraction</code> is a teachpack for instructors and students who wish to use <code>for/*</code> loops, <code>match</code>, <code>define-type</code> and <code>type-cases</code> in ISL and ISL+.</p></li>\n <li>\n  <p><code>2htdp/universe</code> programs can be exported using DrRacket&rsquo;s executable creation mechanism and they behave properly when run independently.</p></li></ul>\n\n<p><a href=\"https://github.com/racket/typed-racket\">typed-racket</a></p>\n\n<ul>\n <li>\n  <p>Typed Racket in DrRacket displays tooltips that show the types of expressions. Tooltips are also displayed for type errors.</p></li>\n <li>\n  <p>Typed Racket loads generated contracts only when needed. This reduces memory use and startup time for Typed Racket programs.</p></li>\n <li>\n  <p>Typed Racket has improved support for prefab structures, future semaphores, and async channels.</p></li>\n <li>\n  <p>Typed Racket understands when two different variables refer to the same thing, and updates types accordingly. This particularly improves the type checking of macros such as <code>match</code>.</p></li></ul>\n\n<p>Feedback Welcome</p>")) ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2008-01-14-a-privacy-flaw-thwarted.md" . unix) f post (u . "A Privacy Flaw, Thwarted") (? . 15) 1467223812 (p+ #"/Users/MB/git/racket-lang-org/blog/2008/01/a-privacy-flaw-thwarted.html" . unix) "/2008/01/a-privacy-flaw-thwarted.html" (u . "2008-01-14T15:21:00.001-05:00") (? . 16) (? . 40) (c (u . "")) (u . "\n<p><em>posted by Shriram Krishnamurthi</em></p>\n\n<p>My student Brendan Hickey recently identified the following security hole.</p>\n\n<p>A university (let&rsquo;s call it Orange University) wants to let its graduating students vote on their graduation speaker. They used to do it by paper; catching up with the times, they now do it on the Web.</p>\n\n<p>They used to have a box into which you could type the name of your nominee. But that is surely problematic: people misspell names, you have to argue about how to count ambiguous votes, someone will vote for their pet bonobo, etc. Better (perhaps) to give them the names of all the students and let them choose. [Alert: if Orange U adopts a simple naming scheme for email addresses, a student can immediately screen-scrape a pretty plum list to sell a spammer. Brendan and I noticed this in a femtosecond; I don&rsquo;t know why this didn&rsquo;t occur to the university.]</p>\n\n<p>Anyway, now you have a Web page where people are going to choose, and the software that processes the responses must distinguish between these choices. You have to associate a key with each student. You&rsquo;ve already got a key for each candidate: their student ID number. So you use that as your key. Now anyone viewing the page source can immediately see which student ID number goes with which student name. So much for confidentiality.</p>\n\n<p>Whoops.</p>\n\n<p>I&rsquo;d like to point out that Pete Hopkins&rsquo;s <code>send/suspend/dispatch</code>, and the improved version of it by Jay McCarthy, identify and solve just this code structuring problem in a way that the privacy leak can never occur. For the most up-to-date presentation of it, read section 3.2 and section 4 of <a href=\"http://www.cs.brown.edu/~sk/Publications/Papers/Published/khmgpf-impl-use-plt-web-server-journal/\">our paper</a>.</p>\n\n<p>Maybe Orange U should be using Scheme.</p>") #t (u . "\n<p><em>posted by Shriram Krishnamurthi</em></p>\n\n<p>My student Brendan Hickey recently identified the following security hole.</p>\n\n<p>A university (let&rsquo;s call it Orange University) wants to let its graduating students vote on their graduation speaker. They used to do it by paper; catching up with the times, they now do it on the Web.</p>\n\n<p>They used to have a box into which you could type the name of your nominee. But that is surely problematic: people misspell names, you have to argue about how to count ambiguous votes, someone will vote for their pet bonobo, etc. Better (perhaps) to give them the names of all the students and let them choose. [Alert: if Orange U adopts a simple naming scheme for email addresses, a student can immediately screen-scrape a pretty plum list to sell a spammer. Brendan and I noticed this in a femtosecond; I don&rsquo;t know why this didn&rsquo;t occur to the university.]</p>\n\n<p>Anyway, now you have a Web page where people are going to choose, and the software that processes the responses must distinguish between these choices. You have to associate a key with each student. You&rsquo;ve already got a key for each candidate: their student ID number. So you use that as your key. Now anyone viewing the page source can immediately see which student ID number goes with which student name. So much for confidentiality.</p>\n\n<p>Whoops.</p>\n\n<p>I&rsquo;d like to point out that Pete Hopkins&rsquo;s <code>send/suspend/dispatch</code>, and the improved version of it by Jay McCarthy, identify and solve just this code structuring problem in a way that the privacy leak can never occur. For the most up-to-date presentation of it, read section 3.2 and section 4 of <a href=\"http://www.cs.brown.edu/~sk/Publications/Papers/Published/khmgpf-impl-use-plt-web-server-journal/\">our paper</a>.</p>\n\n<p>Maybe Orange U should be using Scheme.</p>\n<!-- more-->\n\n<hr />\n\n<p>Salting and hashing the student ids before publishing them would protect identity as well, without depending on program-flow strategies, no?</p>\n\n<p>— <em>fawcett, 22 January 2008</em></p>\n\n<hr />\n\n<p>Salting and hashing ids was a thought I had too. But I think the paper&rsquo;s Continue web server has control flow constructs and error recovery capabilities built-in that would have to be added to other web-based approaches.</p>\n\n<p>— <em>Geoff Knauth, 22 February 2008</em></p>\n\n<hr />")) ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2011-03-19-languages-as-libraries-pldi-2011.md" . unix) f post (u . "Languages as Libraries, PLDI 2011") (? . 47) 1467223812 (p+ #"/Users/MB/git/racket-lang-org/blog/2011/03/languages-as-libraries-pldi-2011.html" . unix) "/2011/03/languages-as-libraries-pldi-2011.html" (u . "2011-03-19T10:58:00.001-04:00") (? . 17) (? . 18) (c (u . "")) (u . "\n<p><em>posted by Sam Tobin-Hochstadt</em></p>\n\n<p>We&rsquo;ve just finished up the <a href=\"http://bit.ly/langlib\">final version</a> of our <a href=\"http://pldi11.cs.utah.edu/\">PLDI 2011</a> paper on language extension in Racket. The paper describes how the module system and the syntax system work together to support new languages with new static semantics, such as Typed Racket. Here&rsquo;s the abstract:</p>\n\n<blockquote>\n <p>Programming language design benefits from constructs for extending the syntax and semantics of a host language. While C&rsquo;s string-based macros empower programmers to introduce notational shorthands, the parser-level macros of Lisp encourage experimentation with domain-specific languages. The Scheme programming language improves on Lisp with macros that respect lexical scope.</p></blockquote>\n\n<blockquote>\n <p>The design of Racket—a descendant of Scheme—goes even further with the introduction of a full-fledged interface to the static semantics of the language. A Racket extension programmer can thus add constructs that are indistinguishable from “native” notation, large and complex embedded domain-specific languages, and even optimizing transformations for the compiler backend. This power to experiment with language design has been used to create a series of sub-languages for programming with first-class classes and modules, numerous languages for implementing the Racket system, and the creation of a complete and fully integrated typed sister language to Racket&rsquo;s untyped base language.</p></blockquote>\n\n<blockquote>\n <p>This paper explains Racket&rsquo;s language extension API via an implementation of a small typed sister language. The new language provides a rich type system that accommodates the idioms of untyped Racket. Furthermore, modules in this typed language can safely exchange values with untyped modules. Last but not least, the implementation includes a type-based optimizer that achieves promising speedups. Although these extensions are complex, their Racket implementation is just a library, like any other library, requiring no changes to the Racket implementation.</p></blockquote>\n\n<p>To learn how to implement your own new language in Racket, start with <a href=\"http://docs.racket-lang.org/guide/languages.html\">this documentation</a>.</p>") #t (u . "\n<p><em>posted by Sam Tobin-Hochstadt</em></p>\n\n<p>We&rsquo;ve just finished up the <a href=\"http://bit.ly/langlib\">final version</a> of our <a href=\"http://pldi11.cs.utah.edu/\">PLDI 2011</a> paper on language extension in Racket. The paper describes how the module system and the syntax system work together to support new languages with new static semantics, such as Typed Racket. Here&rsquo;s the abstract:</p>\n\n<blockquote>\n <p>Programming language design benefits from constructs for extending the syntax and semantics of a host language. While C&rsquo;s string-based macros empower programmers to introduce notational shorthands, the parser-level macros of Lisp encourage experimentation with domain-specific languages. The Scheme programming language improves on Lisp with macros that respect lexical scope.</p></blockquote>\n\n<blockquote>\n <p>The design of Racket—a descendant of Scheme—goes even further with the introduction of a full-fledged interface to the static semantics of the language. A Racket extension programmer can thus add constructs that are indistinguishable from “native” notation, large and complex embedded domain-specific languages, and even optimizing transformations for the compiler backend. This power to experiment with language design has been used to create a series of sub-languages for programming with first-class classes and modules, numerous languages for implementing the Racket system, and the creation of a complete and fully integrated typed sister language to Racket&rsquo;s untyped base language.</p></blockquote>\n\n<blockquote>\n <p>This paper explains Racket&rsquo;s language extension API via an implementation of a small typed sister language. The new language provides a rich type system that accommodates the idioms of untyped Racket. Furthermore, modules in this typed language can safely exchange values with untyped modules. Last but not least, the implementation includes a type-based optimizer that achieves promising speedups. Although these extensions are complex, their Racket implementation is just a library, like any other library, requiring no changes to the Racket implementation.</p></blockquote>\n\n<p>To learn how to implement your own new language in Racket, start with <a href=\"http://docs.racket-lang.org/guide/languages.html\">this documentation</a>.</p>\n<!-- more-->\n\n<hr />\n\n<p>It would be a good idea if the programmer can write very documentation comments for variables and functions (as in java / ** * /). And in the IDE climbs tips with documentation to functions. And to add intelligent code insertion, and auto completion of the input string.</p>\n\n<p>— <em>Алексей, 22 March 2011</em></p>\n\n<hr />\n\n<p>Probably the best way to add documentation strings to Racket would be to add a keyword option to the &ldquo;define&rdquo; form:</p>\n\n<p>(define (foobar . args) #:doc &ldquo;Blah blah blah&rdquo; . body)</p>\n\n<p>(define myvar myvalue #:doc &ldquo;My value&rdquo;)</p>\n\n<p>(define myvar #:doc &ldquo;It&rsquo;s mine&rdquo; myvalue)</p>\n\n<p>— <em>Blog User, 6 April 2011</em></p>\n\n<hr />\n\n<p>Are the Typed Racket versions of the benchmarks mentioned in section 7, available anywhere ?  Thanks</p>\n\n<p>— <em>therac25, 24 June 2011</em></p>\n\n<hr />")) ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2015-05-03-king-of-the-hill-on-rosetta-code.md" . unix) f post (u . "King of the Hill on Rosetta Code") (? . 19) 1467223812 (p+ #"/Users/MB/git/racket-lang-org/blog/2015/05/king-of-the-hill-on-rosetta-code.html" . unix) "/2015/05/king-of-the-hill-on-rosetta-code.html" (u . "2015-05-03T08:30:00.001-04:00") (? . 81) (? . 13) (c (u . "")) (u . "\n<p><em>posted by Tim Brown</em></p>\n\n<p>Racket is <em>&ldquo;King of the Hill&rdquo;</em> on Rosetta Code: <strong>This announcement is a follow up to &ldquo;800!&rdquo;.</strong></p>\n\n<p>In it I said we&rsquo;d <em>\"[S]ee you at 1000!\"</em>; but you&rsquo;ll understand why we stopped at this milestone.</p>\n\n<p>Please read that article if you need an introduction to Rosetta Code, and the efforts being made to implement Racket tasks there, and more detail on how you can help. It is more instructive and less braggart than this post.</p>\n\n<p>On Rosetta Code (RC), early in the morning on April 29th, Racket drew level with Tcl in the number of tasks that had been implemented for it. Shortly after that we could announce that:</p>\n\n<p><strong>Racket has the Most Tasks Implemented in Any Language on Rosetta Code!</strong></p>\n\n<p>Before I go into too much detail, it must be said that this is another amazing achievement. I, and I&rsquo;m sure the rest of the Racket community, want to thank and congratulate everyone who has contributed to this effort.</p>\n\n<h2 id=\"how-did-this-happen\">How Did This Happen?</h2>\n\n<p> On the front page of RC&rsquo;s site, it states its goal as:</p>\n\n<blockquote>\n <p>&hellip; to present solutions to the same task in as many different languages as possible, to demonstrate how languages are similar and different, and to aid a person with a grounding in one approach to a problem in learning another.</p></blockquote>\n\n<p> As well as achieving these comparative goals, implementing tasks also provides a useful library of tools, applications and examples for Racket users themselves. Therefore, doing so is a laudable activity in its own right. The persistent effort and progress have been made by Racketeers on RC, both before and since the &ldquo;800!&rdquo; tasks post has been (mostly) performed in that spirit. And that should be plenty enough incentive for <em>you</em> to do so, too.</p>\n\n<p> But I admit, there is a competitive element that creeps in (affecting some more than others). After having passed the 800 task mark after spending so much time in second place to get past the current leader, Tcl to stay <a href=\"Python,\">ahead of Python</a> these, too, provide plenty of motivation to implement tasks. And if winning isn&rsquo;t important, why, then, do we keep score?</p>\n\n<p> And in <em>that</em> spirit, early in the morning on April 29th, I was busily [cherry-picking] [2] tasks on Rosetta Code to help close the gap with Tcl; when I thought I would take a quick check on Tcl&rsquo;s and Racket&rsquo;s [task counts][3]. From what I could see, both had a task count of 845! Racket had drawn level with, Tcl as the <em>Joint Most Popular Programming Language</em> on RC.</p>\n\n<p> I got the independent verification of this from the #racket [IRC Channel][4]. It was true! But Racket was <em>only joint first.</em> This point was not lost on the denizens of IRC (<code>zedoary</code> being one); who posted two more tasks in very quick succession, bringing Racket up to 847 &mdash; two clear of the previous leader!</p>\n\n<p> How does this Help Racket?  &mdash;</p>\n\n<p> <strong>Plenty of Examples</strong>  Look back at the intentions of Rosetta Code itself. It is expected that users of other languages can come and compare what they know with what Racket provides. Strictly speaking, of course, in a lot of cases they won&rsquo;t be able to compare since the other language won&rsquo;t be represented whereas Racket will.</p>\n\n<p> There is also, now, a large collection of Racket examples, which Racketeers themselves can use to improve their understanding of Racket. Strangely, this is not actually one of the stated objectives of RC; it is a welcome side-effect of the work.</p>\n\n<p> <strong>A Tool for Advocacy</strong>  Advocates of Racket can use this position on Rosetta Code to show that Racket is as, if not more, capable than any language. Especially for general purpose computing.</p>\n\n<p> &ldquo;Racket is Number One on Rosetta Code&rdquo; isn&rsquo;t a bad place to start with, I guess.</p>\n\n<p> Additionally, I would like to point out that whatever any of the other languages (or tasks) seem to throw at it, there is something in Racket that allows it to take it in its stride. Sometimes the implementations have had high [line counts][5]; but they rarely, if ever, seem contrived.</p>\n\n<p> If you need to provide reasons for tasks not being implemented in Racket, here are a few you can use:</p>\n\n<ul>\n <li>\n  <p><em>Nobody has implemented them &ldquo;yet&rdquo;:</em> let it be known that we&rsquo;ve done the best part of 850 tasks, and there are only so many hours in the day.</p></li>\n <li>\n  <p><em>Someone has written an FFI for Tcl to an obscure library:</em> The task for Tcl has then simply been to load the FFI. The task for Racket is either to a) implement the library, which is much more effort than Tcl put in or b) to produce FFI bindings itself, which after the first time doesn&rsquo;t bring much to the party. The same holds true for tasks written <em>for</em> languages which are basically DSLs, showing off how they work in domain for which they are specific.</p></li>\n <li>\n  <p><em>The task is written and documented entirely in Russian:</em> This makes translating it an &ldquo;exercise.&rdquo;</p></li></ul>\n\n<h2 id=\"is-it-time-to-rest-on-our-laurels\">Is it Time to Rest on our Laurels?</h2>\n\n<p> That was a rhetorical question.</p>\n\n<p>Please ignore it.</p>\n\n<p>There are many reasons to continue to work on Rosetta Code.</p>\n\n<h2 id=\"we-havent-finished\">We Haven&rsquo;t Finished</h2>\n\n<p><strong>Implement Some Outstanding Tasks!</strong></p>\n\n<p>There are 922 tasks on Rosetta Code. 849 are implemented in Racket (more have been added as we speak)! Even excluding the impossible and Russian tasks, that&rsquo;s still many more tasks to implement.</p>\n\n<p><strong>Improve Existing Tasks!</strong></p>\n\n<p>Some tasks are old, and lack style. Some may even be re-branded Scheme tasks. Anyone can edit these tasks. Add style to them. Tasks can then not only be an example of how to use the syntax and features of Racket, but also exemplars of well-written code.</p>\n\n<p><strong>Propose New Tasks!</strong></p>\n\n<p>There are things that Racket and other Lisps do well that haven&rsquo;t been illustrated on RC. How about the fancier macro facilities that Racket provides?</p>\n\n<p>I&rsquo;m sure you can think of something. Might you suggest something involving <em>anaphoric macros</em>?</p>\n\n<p>Oh, and if you <em>do</em> suggest something, maybe you can implement it, too!</p>\n\n<h2 id=\"they-havent-finished\">They Haven&rsquo;t Finished</h2>\n\n<p><strong>New Tasks are Being Invented!</strong></p>\n\n<p>Tasks are being added to Rosetta Code constantly. Keep an eye out, some of these are really quite interesting.</p>\n\n<p><strong>Tasks are Being Implemented!</strong></p>\n\n<p> Tcl and Python (and maybe others in the future) will want what we have earned here, and they are going to continue to propose and implement tasks. <em>&ldquo;King of the Hill&rdquo;</em> is a precarious place. The more clear blue water between us and them Just do it! Buy glucose sports drinks</p>\n\n<p> Maybe I <em>am</em> getting too competitive.</p>\n\n<p> Finally  &mdash;</p>\n\n<p> Once again, many thanks to the people who have contributed to Racket on Rosetta Code. Including those who have answered questions on the mailing list or IRC. Your help has been invaluable even if the questions made you wonder &ldquo;why on earth does he or she want to do <em>that?</em>&rdquo;</p>\n\n<p> Finally, but certainly not least: Thanks to the folk at Rosetta Code. They&rsquo;ve provided a site and experience which have been instructive, educational and fun; and without whom none of this would have been possible.</p>\n\n<p>is also doing magnificently well, to be sure. It even had the audacity to draw level with Racket according to the FUPPLR a couple of times.</p>\n\n<p>[2] A good way to start on Rosetta Code is to find tasks that are <em>easy</em> to implement. In order to find <em>easy</em> tasks you will need to browse the unimplemented tasks (and maybe some implemented ones, too) and decide what you could either implement and/or translate without breaking too much of a sweat. In the process you will also develop a sense of what tasks are out there ready to be implemented. A good example of an <em>easy</em> task would have been <a href=\"http://www.rosettacode.org/wiki/Pentagram\">Pentagram</a>.</p>\n\n<p>[3] There is a <a href=\"http://timb.net/popular-languages.html\">Frequently Updated Popular Programming Languages Report</a>, which I refer to but recently it has been miscounting tasks, and needs a bit of a look at.</p>\n\n<p>[4] The <code>#racket</code> IRC channel is a fantastic community if you need support with your Racket issues</p>\n\n<p>[5] Remember that Rosetta Code is not a <em>Golf</em> site. If it were, J&rsquo;s weird 20-character-strings-that-do-anything (if only you could remember what they do 30 seconds after you&rsquo;ve written them) would win hands down. Keep to the <a href=\"http://www.ccs.neu.edu/home/matthias/Style/style/\">Style Guide</a> as best you can. And since RC is a wiki, if you&rsquo;re not perfect, others can improve the style of your code.</p>") #t (u . "\n<p><em>posted by Tim Brown</em></p>\n\n<p>Racket is <em>&ldquo;King of the Hill&rdquo;</em> on Rosetta Code: <strong>This announcement is a follow up to &ldquo;800!&rdquo;.</strong></p>\n\n<p>In it I said we&rsquo;d <em>\"[S]ee you at 1000!\"</em>; but you&rsquo;ll understand why we stopped at this milestone.</p>\n\n<p>Please read that article if you need an introduction to Rosetta Code, and the efforts being made to implement Racket tasks there, and more detail on how you can help. It is more instructive and less braggart than this post.</p>\n\n<p>On Rosetta Code (RC), early in the morning on April 29th, Racket drew level with Tcl in the number of tasks that had been implemented for it. Shortly after that we could announce that:</p>\n\n<p><strong>Racket has the Most Tasks Implemented in Any Language on Rosetta Code!</strong></p>\n\n<p>Before I go into too much detail, it must be said that this is another amazing achievement. I, and I&rsquo;m sure the rest of the Racket community, want to thank and congratulate everyone who has contributed to this effort.</p>\n\n<h2 id=\"how-did-this-happen\">How Did This Happen?</h2>\n\n<p> On the front page of RC&rsquo;s site, it states its goal as:</p>\n\n<blockquote>\n <p>&hellip; to present solutions to the same task in as many different languages as possible, to demonstrate how languages are similar and different, and to aid a person with a grounding in one approach to a problem in learning another.</p></blockquote>\n\n<p> As well as achieving these comparative goals, implementing tasks also provides a useful library of tools, applications and examples for Racket users themselves. Therefore, doing so is a laudable activity in its own right. The persistent effort and progress have been made by Racketeers on RC, both before and since the &ldquo;800!&rdquo; tasks post has been (mostly) performed in that spirit. And that should be plenty enough incentive for <em>you</em> to do so, too.</p>\n\n<p> But I admit, there is a competitive element that creeps in (affecting some more than others). After having passed the 800 task mark after spending so much time in second place to get past the current leader, Tcl to stay <a href=\"Python,\">ahead of Python</a> these, too, provide plenty of motivation to implement tasks. And if winning isn&rsquo;t important, why, then, do we keep score?</p>\n\n<p> And in <em>that</em> spirit, early in the morning on April 29th, I was busily [cherry-picking] [2] tasks on Rosetta Code to help close the gap with Tcl; when I thought I would take a quick check on Tcl&rsquo;s and Racket&rsquo;s [task counts][3]. From what I could see, both had a task count of 845! Racket had drawn level with, Tcl as the <em>Joint Most Popular Programming Language</em> on RC.</p>\n\n<p> I got the independent verification of this from the #racket [IRC Channel][4]. It was true! But Racket was <em>only joint first.</em> This point was not lost on the denizens of IRC (<code>zedoary</code> being one); who posted two more tasks in very quick succession, bringing Racket up to 847 &mdash; two clear of the previous leader!</p>\n\n<p> How does this Help Racket?  &mdash;</p>\n\n<p> <strong>Plenty of Examples</strong>  Look back at the intentions of Rosetta Code itself. It is expected that users of other languages can come and compare what they know with what Racket provides. Strictly speaking, of course, in a lot of cases they won&rsquo;t be able to compare since the other language won&rsquo;t be represented whereas Racket will.</p>\n\n<p> There is also, now, a large collection of Racket examples, which Racketeers themselves can use to improve their understanding of Racket. Strangely, this is not actually one of the stated objectives of RC; it is a welcome side-effect of the work.</p>\n\n<p> <strong>A Tool for Advocacy</strong>  Advocates of Racket can use this position on Rosetta Code to show that Racket is as, if not more, capable than any language. Especially for general purpose computing.</p>\n\n<p> &ldquo;Racket is Number One on Rosetta Code&rdquo; isn&rsquo;t a bad place to start with, I guess.</p>\n\n<p> Additionally, I would like to point out that whatever any of the other languages (or tasks) seem to throw at it, there is something in Racket that allows it to take it in its stride. Sometimes the implementations have had high [line counts][5]; but they rarely, if ever, seem contrived.</p>\n\n<p> If you need to provide reasons for tasks not being implemented in Racket, here are a few you can use:</p>\n\n<ul>\n <li>\n  <p><em>Nobody has implemented them &ldquo;yet&rdquo;:</em> let it be known that we&rsquo;ve done the best part of 850 tasks, and there are only so many hours in the day.</p></li>\n <li>\n  <p><em>Someone has written an FFI for Tcl to an obscure library:</em> The task for Tcl has then simply been to load the FFI. The task for Racket is either to a) implement the library, which is much more effort than Tcl put in or b) to produce FFI bindings itself, which after the first time doesn&rsquo;t bring much to the party. The same holds true for tasks written <em>for</em> languages which are basically DSLs, showing off how they work in domain for which they are specific.</p></li>\n <li>\n  <p><em>The task is written and documented entirely in Russian:</em> This makes translating it an &ldquo;exercise.&rdquo;</p></li></ul>\n\n<h2 id=\"is-it-time-to-rest-on-our-laurels\">Is it Time to Rest on our Laurels?</h2>\n\n<p> That was a rhetorical question.</p>\n\n<p>Please ignore it.</p>\n\n<p>There are many reasons to continue to work on Rosetta Code.</p>\n\n<h2 id=\"we-havent-finished\">We Haven&rsquo;t Finished</h2>\n\n<p><strong>Implement Some Outstanding Tasks!</strong></p>\n\n<p>There are 922 tasks on Rosetta Code. 849 are implemented in Racket (more have been added as we speak)! Even excluding the impossible and Russian tasks, that&rsquo;s still many more tasks to implement.</p>\n\n<p><strong>Improve Existing Tasks!</strong></p>\n\n<p>Some tasks are old, and lack style. Some may even be re-branded Scheme tasks. Anyone can edit these tasks. Add style to them. Tasks can then not only be an example of how to use the syntax and features of Racket, but also exemplars of well-written code.</p>\n\n<p><strong>Propose New Tasks!</strong></p>\n\n<p>There are things that Racket and other Lisps do well that haven&rsquo;t been illustrated on RC. How about the fancier macro facilities that Racket provides?</p>\n\n<p>I&rsquo;m sure you can think of something. Might you suggest something involving <em>anaphoric macros</em>?</p>\n\n<p>Oh, and if you <em>do</em> suggest something, maybe you can implement it, too!</p>\n\n<h2 id=\"they-havent-finished\">They Haven&rsquo;t Finished</h2>\n\n<p><strong>New Tasks are Being Invented!</strong></p>\n\n<p>Tasks are being added to Rosetta Code constantly. Keep an eye out, some of these are really quite interesting.</p>\n\n<p><strong>Tasks are Being Implemented!</strong></p>\n\n<p> Tcl and Python (and maybe others in the future) will want what we have earned here, and they are going to continue to propose and implement tasks. <em>&ldquo;King of the Hill&rdquo;</em> is a precarious place. The more clear blue water between us and them Just do it! Buy glucose sports drinks</p>\n\n<p> Maybe I <em>am</em> getting too competitive.</p>\n\n<p> Finally  &mdash;</p>\n\n<p> Once again, many thanks to the people who have contributed to Racket on Rosetta Code. Including those who have answered questions on the mailing list or IRC. Your help has been invaluable even if the questions made you wonder &ldquo;why on earth does he or she want to do <em>that?</em>&rdquo;</p>\n\n<p> Finally, but certainly not least: Thanks to the folk at Rosetta Code. They&rsquo;ve provided a site and experience which have been instructive, educational and fun; and without whom none of this would have been possible.</p>\n\n<p>is also doing magnificently well, to be sure. It even had the audacity to draw level with Racket according to the FUPPLR a couple of times.</p>\n\n<p>[2] A good way to start on Rosetta Code is to find tasks that are <em>easy</em> to implement. In order to find <em>easy</em> tasks you will need to browse the unimplemented tasks (and maybe some implemented ones, too) and decide what you could either implement and/or translate without breaking too much of a sweat. In the process you will also develop a sense of what tasks are out there ready to be implemented. A good example of an <em>easy</em> task would have been <a href=\"http://www.rosettacode.org/wiki/Pentagram\">Pentagram</a>.</p>\n\n<p>[3] There is a <a href=\"http://timb.net/popular-languages.html\">Frequently Updated Popular Programming Languages Report</a>, which I refer to but recently it has been miscounting tasks, and needs a bit of a look at.</p>\n\n<p>[4] The <code>#racket</code> IRC channel is a fantastic community if you need support with your Racket issues</p>\n\n<p>[5] Remember that Rosetta Code is not a <em>Golf</em> site. If it were, J&rsquo;s weird 20-character-strings-that-do-anything (if only you could remember what they do 30 seconds after you&rsquo;ve written them) would win hands down. Keep to the <a href=\"http://www.ccs.neu.edu/home/matthias/Style/style/\">Style Guide</a> as best you can. And since RC is a wiki, if you&rsquo;re not perfect, others can improve the style of your code.</p>\n<!-- more-->\n\n<hr />\n\n<p>Where is the list of unsolved task? I would think this would be in one place.</p>\n\n<p>— <em>L.A., 6 May 2015</em></p>\n\n<hr />\n\n<p>The list of unsolved tasks is here: http://rosettacode.org/wiki/Reports:Tasks_not_implemented_in_Racket</p>\n\n<p>— <em>Jens Axel Søgaard, 6 May 2015</em></p>\n\n<hr />")) ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2011-05-26-multi-file-code-coverage-viewing-tool.md" . unix) f post (u . "Multi-file code coverage viewing tool") (? . 10) 1467223812 (p+ #"/Users/MB/git/racket-lang-org/blog/2011/05/multi-file-code-coverage-viewing-tool.html" . unix) "/2011/05/multi-file-code-coverage-viewing-tool.html" (u . "2011-05-26T13:46:00.008-04:00") (? . 0) (? . 9) (c (u . "")) (u . "\n<p><em>posted by John Clements</em></p>\n\n<p>I&rsquo;m very pleased to announce the availability of a multi-file code coverage viewer, written by Jonathan Walsh.</p>\n\n<p>Torn between separating your test cases into another file and actually seeing the coverage? Well, go ahead and pull them apart, because the multi-file coverage tool displays coverage information for the files required by the present one, including both percentage covered (on a line-by-line basis) and optionally a list of uncovered lines (no more inching through your code, looking for the red highlighting.</p>\n\n<p><a href=\"http://3.bp.blogspot.com/-d4j23yei4rc/Td6l0wv3UCI/AAAAAAAAAF8/ptD2u9KwevE/s1600/coverage-button.png\"></a> Back End:</p>\n\n<p>One reason I expect this tool to be long-term robust is that it makes absolutely no changes to the back-end; that is, it just uses the existing code coverage framework. The only thing going on here is that the tool provides a way to store, load, and display this information. This means that the tool displays coverage for un-compiled files only. We thought about fiddling with this, but finally decided that the existing behavior was probably about as useful as anything else we&rsquo;d come up with, and a lot more robust.</p>\n\n<p>URL for docs:</p>\n\n<p><a href=\"http://planet.racket-lang.org/package-source/jowalsh/code-coverage.plt/1/3/planet-docs/code-coverage/index.html\">http://planet.racket-lang.org/package-source/jowalsh/code-coverage.plt/1/3/planet-docs/code-coverage/index.html</a></p>\n\n<p>As you might expect, it&rsquo;s a one-line install:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"kn\">#lang </span><span class=\"nn\">racket</span>\n\n<span class=\"p\">(</span><span class=\"k\">require</span> <span class=\"p\">(</span><span class=\"k\">planet</span> <span class=\"n\">jowalsh/code-coverage</span><span class=\"p\">))</span>\n</pre></div>\n\n</div>\n\n<p>Please let us know about bugs you discover!</p>") #f (u . "\n<p><em>posted by John Clements</em></p>\n\n<p>I&rsquo;m very pleased to announce the availability of a multi-file code coverage viewer, written by Jonathan Walsh.</p>\n\n<p>Torn between separating your test cases into another file and actually seeing the coverage? Well, go ahead and pull them apart, because the multi-file coverage tool displays coverage information for the files required by the present one, including both percentage covered (on a line-by-line basis) and optionally a list of uncovered lines (no more inching through your code, looking for the red highlighting.</p>\n\n<p><a href=\"http://3.bp.blogspot.com/-d4j23yei4rc/Td6l0wv3UCI/AAAAAAAAAF8/ptD2u9KwevE/s1600/coverage-button.png\"></a> Back End:</p>\n\n<p>One reason I expect this tool to be long-term robust is that it makes absolutely no changes to the back-end; that is, it just uses the existing code coverage framework. The only thing going on here is that the tool provides a way to store, load, and display this information. This means that the tool displays coverage for un-compiled files only. We thought about fiddling with this, but finally decided that the existing behavior was probably about as useful as anything else we&rsquo;d come up with, and a lot more robust.</p>\n\n<p>URL for docs:</p>\n\n<p><a href=\"http://planet.racket-lang.org/package-source/jowalsh/code-coverage.plt/1/3/planet-docs/code-coverage/index.html\">http://planet.racket-lang.org/package-source/jowalsh/code-coverage.plt/1/3/planet-docs/code-coverage/index.html</a></p>\n\n<p>As you might expect, it&rsquo;s a one-line install:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"kn\">#lang </span><span class=\"nn\">racket</span>\n\n<span class=\"p\">(</span><span class=\"k\">require</span> <span class=\"p\">(</span><span class=\"k\">planet</span> <span class=\"n\">jowalsh/code-coverage</span><span class=\"p\">))</span>\n</pre></div>\n\n</div>\n\n<p>Please let us know about bugs you discover!</p>")) ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2012-02-01-zack-gallers-experience-with-stateful-vs-stateless-web-apps.md" . unix) f post (u . "Zack Galler's Experience with Stateful vs Stateless Web Apps") (? . 44) 1467223812 (p+ #"/Users/MB/git/racket-lang-org/blog/2012/02/zack-gallers-experience-with-stateful-vs-stateless-web-apps.html" . unix) "/2012/02/zack-gallers-experience-with-stateful-vs-stateless-web-apps.html" (u . "2012-02-01T19:25:00.000-05:00") (? . 20) (? . 36) (c (u . "")) (u . "\n<p><em>posted by Jay McCarthy</em></p>\n\n<p>Communication using HTTP between client and server is a simple problem of halted computation. A client computes a request, transmits and halts, waiting for a server response. On receipt, the server computes a response, transmits and halts, waiting for the next client request. This much is well known. Racket&rsquo;s magnificent <em>stateful</em> Web server does three things on the server side:</p>\n\n<ul>\n <li>\n  <p>it reifies a Racket continuation, capturing where the server computation has halted.</p></li>\n <li>\n  <p>it externalizes the continuation, creating a URL-representation that uniquely maps to the Racket continuation</p></li>\n <li>\n  <p>it disseminates the externalized continuation to interested clients, typically via HTTP response, but alternately via SMTP or any other protocol. Then, it waits. Later, when presented with an externalized continuation, a quick inverse mapping occurs, the underlying Racket continuation is invoked, and the server processes the new client request. Rinse and repeat. The problem with this approach is twofold</p></li>\n <li>\n  <p>the reified Racket continuations live in server memory. And there&rsquo;s no safe way to garbage collect, as the continuations could be invoked at any time. There are strategies to reclaim memory, but <em>some</em> load level will noticeably decrease the performance of your application. And its not possible to figure out what that load level is prior to finishing your application. This is a problem.</p></li>\n <li>\n  <p>Again, the reified Racket continuations live in server memory and cannot be moved. So there&rsquo;s no way to scale an application to more than one server. It&rsquo;s a necessarily one machine system. This makes problem #1 worse. Racket&rsquo;s yet more magnificent <em>stateless</em> Web server does exactly the same three things:</p></li>\n <li>\n  <p>to reify, it rewrites the entire call stack into a format known as <a href=\"https://en.wikipedia.org/wiki/Administrative_normal_form\">A-Normal Form</a> (ANF).</p></li>\n <li>\n  <p>to externalize, the ANF&rsquo;d stack is encoded for transmission over HTTP.</p></li>\n <li>\n  <p>and then it&rsquo;s sent over to the client (dissemination). Later, when presented with encoded stack, the stateless server performs an inverse transform to reconstruct the call stack, at which point the server keeps going. So we&rsquo;ve lost the invocation step and substituted a reconstruction. But in exchange, we&rsquo;ve eliminated continuations from server memory, and solved both enumerated problems above. Neat trick.</p></li></ul>\n\n<p>I provide a few lessons learned for the archives for the next person to attempt porting <code>#lang racket</code> to <code>#lang web-server</code> code. First, the predicate <code>serializable?</code> from <code>racket/serialize</code> is invaluable. The <code>#lang web-server</code> code will not transform if there are non-serializable constructs in the dynamic extent of the invocation of <code>send/suspend</code>, such as a local binding or argument. Second, invocations of native continuations reified with <code>call/cc</code> frequently throw errors related to continuation prompts, such as “attempt to cross a continuation barrier” or “no corresponding prompt tag in continuation”. In all cases, I was able to remedy the situation by enclosing the invocation in <code>call-with-continuation-prompt</code>. This may be an error in the system, but it is unclear at this time. Third, the transformation does not allow parameters or <code>dynamic-wind</code>, because the internal data-structures representing them are not serializable, but continuation-marks can be used to reimplement the piece of the functionality you need.</p>\n\n<p>Finally, thank you to the Racket team. I think the stateless Web language is important technology and must have required an enormous amount of work to implement. Anecdotally, application speed seems at or better than the stateful code. To learn more about the stateless Web application infrastructure, <a href=\"http://docs.racket-lang.org/web-server/stateless.html\">consult the manual</a> or post to the <a href=\"http://lists.racket-lang.org/\">mailing list</a>. (This post was written by Zack Galler with minor edits before posting by Jay McCarthy.)</p>") #t (u . "\n<p><em>posted by Jay McCarthy</em></p>\n\n<p>Communication using HTTP between client and server is a simple problem of halted computation. A client computes a request, transmits and halts, waiting for a server response. On receipt, the server computes a response, transmits and halts, waiting for the next client request. This much is well known. Racket&rsquo;s magnificent <em>stateful</em> Web server does three things on the server side:</p>\n\n<ul>\n <li>\n  <p>it reifies a Racket continuation, capturing where the server computation has halted.</p></li>\n <li>\n  <p>it externalizes the continuation, creating a URL-representation that uniquely maps to the Racket continuation</p></li>\n <li>\n  <p>it disseminates the externalized continuation to interested clients, typically via HTTP response, but alternately via SMTP or any other protocol. Then, it waits. Later, when presented with an externalized continuation, a quick inverse mapping occurs, the underlying Racket continuation is invoked, and the server processes the new client request. Rinse and repeat. The problem with this approach is twofold</p></li>\n <li>\n  <p>the reified Racket continuations live in server memory. And there&rsquo;s no safe way to garbage collect, as the continuations could be invoked at any time. There are strategies to reclaim memory, but <em>some</em> load level will noticeably decrease the performance of your application. And its not possible to figure out what that load level is prior to finishing your application. This is a problem.</p></li>\n <li>\n  <p>Again, the reified Racket continuations live in server memory and cannot be moved. So there&rsquo;s no way to scale an application to more than one server. It&rsquo;s a necessarily one machine system. This makes problem #1 worse. Racket&rsquo;s yet more magnificent <em>stateless</em> Web server does exactly the same three things:</p></li>\n <li>\n  <p>to reify, it rewrites the entire call stack into a format known as <a href=\"https://en.wikipedia.org/wiki/Administrative_normal_form\">A-Normal Form</a> (ANF).</p></li>\n <li>\n  <p>to externalize, the ANF&rsquo;d stack is encoded for transmission over HTTP.</p></li>\n <li>\n  <p>and then it&rsquo;s sent over to the client (dissemination). Later, when presented with encoded stack, the stateless server performs an inverse transform to reconstruct the call stack, at which point the server keeps going. So we&rsquo;ve lost the invocation step and substituted a reconstruction. But in exchange, we&rsquo;ve eliminated continuations from server memory, and solved both enumerated problems above. Neat trick.</p></li></ul>\n\n<p>I provide a few lessons learned for the archives for the next person to attempt porting <code>#lang racket</code> to <code>#lang web-server</code> code. First, the predicate <code>serializable?</code> from <code>racket/serialize</code> is invaluable. The <code>#lang web-server</code> code will not transform if there are non-serializable constructs in the dynamic extent of the invocation of <code>send/suspend</code>, such as a local binding or argument. Second, invocations of native continuations reified with <code>call/cc</code> frequently throw errors related to continuation prompts, such as “attempt to cross a continuation barrier” or “no corresponding prompt tag in continuation”. In all cases, I was able to remedy the situation by enclosing the invocation in <code>call-with-continuation-prompt</code>. This may be an error in the system, but it is unclear at this time. Third, the transformation does not allow parameters or <code>dynamic-wind</code>, because the internal data-structures representing them are not serializable, but continuation-marks can be used to reimplement the piece of the functionality you need.</p>\n\n<p>Finally, thank you to the Racket team. I think the stateless Web language is important technology and must have required an enormous amount of work to implement. Anecdotally, application speed seems at or better than the stateful code. To learn more about the stateless Web application infrastructure, <a href=\"http://docs.racket-lang.org/web-server/stateless.html\">consult the manual</a> or post to the <a href=\"http://lists.racket-lang.org/\">mailing list</a>. (This post was written by Zack Galler with minor edits before posting by Jay McCarthy.)</p>\n<!-- more-->\n\n<hr />\n\n<p>Please help me:</p>\n\n<p>My stateless servlet allways throw exception:</p>\n\n<div class=\"brush: bash\">\n <div class=\"pygments\">\n  <pre>D:<span class=\"se\">\\t</span>mpracket<span class=\"se\">\\R</span>acket<span class=\"se\">\\c</span>ollects<span class=\"se\">\\w</span>eb-server<span class=\"se\">\\d</span>ispatchers<span class=\"se\">\\d</span>ispatch-servlets.rkt:85:20: Servlet <span class=\"o\">(</span>@ /c.rkt<span class=\"p\">;</span><span class=\"o\">((</span>%22c%22%20.%20%220<span class=\"o\">((</span>3<span class=\"o\">)</span>%202%20<span class=\"o\">(((</span>lib%20%5C%22web-server%2Flang%2Fabort-resume.rkt%5C%22<span class=\"o\">)</span>%20.%20%5C%22lifted.6%5C%22<span class=\"o\">)</span>%20<span class=\"o\">((</span>lib%20%5C%22web-server%2Flang%2Fweb-cells.rkt%5C%22<span class=\"o\">)</span>%20.%20deserialize-info:frame-v0<span class=\"o\">))</span>%200%20<span class=\"o\">()</span>%20<span class=\"o\">()</span>%20<span class=\"o\">(</span>0%20<span class=\"o\">(</span>1%20<span class=\"o\">(</span>h%20-%20<span class=\"o\">()))</span>%20<span class=\"o\">()))</span>%22<span class=\"o\">)))</span> exception:\n<span class=\"nb\">set</span>-servlet-handler!: contract violation, expected: can-be-response?, given: <span class=\"c\">#</span>\n  contract from: \n    /web-server/private/servlet.rkt\n  blaming: \n    /web-server/servlet/setup.rkt\n  contract: \n    <span class=\"o\">(</span>-&gt;\n     servlet?\n     <span class=\"o\">(</span>-&gt; request? can-be-response?<span class=\"o\">)</span>\n     void?<span class=\"o\">)</span>\n  at: /web-server/private/servlet.rkt:8.15\n</pre></div>\n\n</div>\n\n<p>The stateless servlet:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">require</span> <span class=\"n\">web-server/http/xexpr</span>\n         <span class=\"n\">web-server/managers/lru</span>\n         <span class=\"n\">web-server/lang/web</span>\n         <span class=\"n\">web-server/lang/stuff-url</span><span class=\"p\">)</span>\n\n<span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">start</span> <span class=\"n\">req</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">render-home</span> <span class=\"n\">u</span><span class=\"p\">)</span>\n    <span class=\"p\">(</span><span class=\"n\">response/xexpr</span>\n     <span class=\"o\">`</span><span class=\"p\">(</span><span class=\"ss\">body</span> <span class=\"s2\">\"Hello World: Stateless\"</span>\n            <span class=\"p\">(</span><span class=\"ss\">a</span> <span class=\"p\">([</span><span class=\"ss\">href</span> <span class=\"o\">,</span><span class=\"n\">u</span><span class=\"p\">])</span> <span class=\"s2\">\" clickMe\"</span><span class=\"p\">))))</span>\n  <span class=\"p\">(</span><span class=\"n\">send/suspend</span> <span class=\"n\">render-home</span><span class=\"p\">)</span>\n\n  <span class=\"p\">(</span><span class=\"n\">response/xexpr</span>\n   <span class=\"o\">`</span><span class=\"p\">(</span><span class=\"ss\">body</span> <span class=\"s2\">\"OK, You clickedMe!\"</span><span class=\"p\">)))</span>\n\n<span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"n\">interface-version</span> <span class=\"o\">&#39;</span><span class=\"ss\">stateless</span><span class=\"p\">)</span>\n\n<span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"n\">stuffer</span> <span class=\"p\">(</span><span class=\"n\">make-default-stuffer</span> <span class=\"p\">(</span><span class=\"nb\">build-path</span> <span class=\"s2\">\"f:</span><span class=\"se\">\\\\</span><span class=\"s2\">lisp</span><span class=\"se\">\\\\</span><span class=\"s2\">scheme</span><span class=\"se\">\\\\</span><span class=\"s2\">racket</span><span class=\"se\">\\\\</span><span class=\"s2\">program</span><span class=\"se\">\\\\</span><span class=\"s2\">urls.urls\"</span><span class=\"p\">)))</span>\n\n<span class=\"p\">(</span><span class=\"k\">provide</span> <span class=\"n\">interface-version</span>\n         <span class=\"n\">stuffer</span>\n         <span class=\"n\">start</span><span class=\"p\">)</span>\n</pre></div>\n\n</div>\n\n<p>My main dispatcher is :</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"kn\">#lang </span><span class=\"nn\">racket</span>\n\n<span class=\"p\">(</span><span class=\"k\">require</span> <span class=\"n\">web-server/web-server</span>\n         <span class=\"n\">web-server/servlet-dispatch</span>\n         <span class=\"n\">web-server/servlet/setup</span>\n         <span class=\"p\">(</span><span class=\"k\">prefix-in</span> <span class=\"n\">files:</span> <span class=\"n\">web-server/dispatchers/filesystem-map</span><span class=\"p\">)</span>\n         <span class=\"p\">(</span><span class=\"k\">prefix-in</span> <span class=\"n\">servlets:</span> <span class=\"n\">web-server/dispatchers/dispatch-servlets</span><span class=\"p\">))</span>\n\n<span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"n\">p-&gt;s</span> <span class=\"p\">(</span><span class=\"n\">make-default-path-&gt;servlet</span><span class=\"p\">))</span>\n<span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"n\">u-&gt;p</span> <span class=\"p\">(</span><span class=\"n\">files:make-url-&gt;path</span> <span class=\"s2\">\"f:</span><span class=\"se\">\\\\</span><span class=\"s2\">lisp</span><span class=\"se\">\\\\</span><span class=\"s2\">scheme</span><span class=\"se\">\\\\</span><span class=\"s2\">racket</span><span class=\"se\">\\\\</span><span class=\"s2\">program</span><span class=\"se\">\\\\</span><span class=\"s2\">\"</span><span class=\"p\">))</span>\n\n<span class=\"p\">(</span><span class=\"k\">define-values</span> <span class=\"p\">(</span><span class=\"k\">_</span> <span class=\"n\">u-&gt;s</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"n\">servlets:make-cached-url-&gt;servlet</span> <span class=\"n\">u-&gt;p</span> <span class=\"n\">p-&gt;s</span><span class=\"p\">))</span>\n<span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"n\">dis</span> <span class=\"p\">(</span><span class=\"n\">servlets:make</span> <span class=\"n\">u-&gt;s</span><span class=\"p\">))</span>\n\n<span class=\"c1\">;; (serve</span>\n<span class=\"c1\">;;  #:dispatch dis</span>\n<span class=\"c1\">;;  #:port 9979</span>\n<span class=\"c1\">;;  )</span>\n\n\n<span class=\"p\">(</span><span class=\"n\">serve/launch/wait</span>\n <span class=\"p\">(</span><span class=\"k\">lambda</span> <span class=\"p\">(</span><span class=\"n\">sem</span><span class=\"p\">)</span>\n   <span class=\"n\">dis</span><span class=\"p\">)</span>\n <span class=\"kd\">#:port</span> <span class=\"mi\">9968</span><span class=\"p\">)</span>\n</pre></div>\n\n</div>\n\n<p>— <em>cnnzp, 9 March 2012</em></p>\n\n<hr />\n\n<p>@cnnzp, I copied exactly what you wrote in the comment (except I added #lang web-server) to the servlet and everything worked fine. If you&rsquo;d like to work through it more, I suggest you email the mailing list, as it is a better place to get support.</p>\n\n<p>Jay</p>\n\n<p>— <em>Jay McCarthy, 12 March 2012</em></p>\n\n<hr />\n\n<p>Interesting and useful&hellip; my initial wondering though is how easy would it be to forge an interesting continuation? I can think of ways to guard against that as needed.</p>\n\n<p>— <em>patrickdlogan, 7 August 2012</em></p>\n\n<hr />\n\n<p>@patrickdlogan, It is pretty easy to change the free variables, but basically impossible to change the control flow. There&rsquo;s a trivial option in the Web server to enable signing (so that you can detect forgery) or encryption (so that you can disable their ability to read the free vars)</p>\n\n<p>— <em>Jay McCarthy, 8 August 2012</em></p>\n\n<hr />")) ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2016-04-28-racket-v65.md" . unix) f post (u . "Racket v6.5") (? . 21) 1467223812 (p+ #"/Users/MB/git/racket-lang-org/blog/2016/04/racket-v65.html" . unix) "/2016/04/racket-v65.html" (u . "2016-04-28T11:04:00.000-05:00") (? . 2) #f (c (u . "")) (u . "\n<p><em>posted by Ryan Culpepper</em></p>\n\n<p>Racket version 6.5 is now available from <a href=\"http://racket-lang.org/\">http://racket-lang.org/</a></p>\n\n<p>Typed Racket and the <code>racket/contract</code> library generate code with lower overhead, speeding up typed/untyped interaction in a number of gradual typing programs we studied.</p>\n\n<p>Macros written using <code>syntax-parse</code> automatically emit more accurate error messages.</p>\n\n<p>The contract profiler captures costs from more contract combinators, including all those in the main distribution.</p>\n\n<p>Hash table and set iteration, via both existing and new non-generic sequences, performs better, up to twice as fast on microbenchmarks.</p>\n\n<p>The Racket optimizer detects many more optimization opportunities, including when variables always hold numbers.</p>\n\n<p>The db library supports single-result CALL statements in MySQL.</p>\n\n<p>The <code>net/dns</code> library supports SRV records.</p>\n\n<p>The <code>racket/unix-socket</code> library supports listen and accept operations.</p>\n\n<p>The following people contributed to this release:</p>\n\n<p>Adrien Tateno, Alex Knauth, Alexander Shopov, Alexis King, Andrew Kent, Asumu Takikawa, Ben Greenman, Chen Xiao, Chris Jester-Young, Daniel Feltey, Eric Dobson, Georges Dupéron, Gustavo Massaccesi, Ian Harris, Jay McCarthy, Jens Axel Søgaard, John Clements, Leandro Facchinetti, Lehi Toskin, Leif Andersen, Łukasz Dąbek, Marc Kaufmann, Matthew Flatt, Matthias Felleisen, Michael McConville, Mike Sperber, Paul Stansifer, Philippe Meunier, Robby Findler, Rodrigo Setti, Ryan Culpepper, Sam Caldwell, Sam Tobin-Hochstadt, Sorawee Porncharoenwase, Spencer Florence, Stephen Chang, Tony Garnock-Jones, Vincent St-Amour, WarGrey Gyoudmon Ju, and William J. Bowman.</p>\n\n<p>Feedback Welcome</p>") #t (u . "\n<p><em>posted by Ryan Culpepper</em></p>\n\n<p>Racket version 6.5 is now available from <a href=\"http://racket-lang.org/\">http://racket-lang.org/</a></p>\n\n<p>Typed Racket and the <code>racket/contract</code> library generate code with lower overhead, speeding up typed/untyped interaction in a number of gradual typing programs we studied.</p>\n\n<p>Macros written using <code>syntax-parse</code> automatically emit more accurate error messages.</p>\n\n<p>The contract profiler captures costs from more contract combinators, including all those in the main distribution.</p>\n\n<p>Hash table and set iteration, via both existing and new non-generic sequences, performs better, up to twice as fast on microbenchmarks.</p>\n\n<p>The Racket optimizer detects many more optimization opportunities, including when variables always hold numbers.</p>\n\n<p>The db library supports single-result CALL statements in MySQL.</p>\n\n<p>The <code>net/dns</code> library supports SRV records.</p>\n\n<p>The <code>racket/unix-socket</code> library supports listen and accept operations.</p>\n\n<p>The following people contributed to this release:</p>\n\n<p>Adrien Tateno, Alex Knauth, Alexander Shopov, Alexis King, Andrew Kent, Asumu Takikawa, Ben Greenman, Chen Xiao, Chris Jester-Young, Daniel Feltey, Eric Dobson, Georges Dupéron, Gustavo Massaccesi, Ian Harris, Jay McCarthy, Jens Axel Søgaard, John Clements, Leandro Facchinetti, Lehi Toskin, Leif Andersen, Łukasz Dąbek, Marc Kaufmann, Matthew Flatt, Matthias Felleisen, Michael McConville, Mike Sperber, Paul Stansifer, Philippe Meunier, Robby Findler, Rodrigo Setti, Ryan Culpepper, Sam Caldwell, Sam Tobin-Hochstadt, Sorawee Porncharoenwase, Spencer Florence, Stephen Chang, Tony Garnock-Jones, Vincent St-Amour, WarGrey Gyoudmon Ju, and William J. Bowman.</p>\n\n<p>Feedback Welcome</p>\n<!-- more-->")) ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2012-11-07-racket-v531.md" . unix) f post (u . "Racket v5.3.1") (? . 32) 1467223812 (p+ #"/Users/MB/git/racket-lang-org/blog/2012/11/racket-v531.html" . unix) "/2012/11/racket-v531.html" (u . "2012-11-07T17:17:00.001-05:00") (? . 113) (? . 31) (c (u . "")) (u . "\n<p><em>posted by Eli Barzilay</em></p>\n\n<p>Racket version 5.3.1 is now available from <a href=\"http://racket-lang.org/\">http://racket-lang.org/</a> Racket::</p>\n\n<ul>\n <li>\n  <p>The <code>case</code> form dispatches on characters, fixnums, symbols, and keywords in logarithmic time. (Thanks to Jon Zeppieri.)</p></li>\n <li>\n  <p>The new <code>racket/format</code> library provides new and improved string-formatting functions.</p></li>\n <li>\n  <p>Logging tools include improved filtering support based on the name of a logger. A new <code>define-logger</code> form simplifies the use of named loggers. Forms such as <code>log-debug</code> now support string formatting.</p></li>\n <li>\n  <p>The <code>for</code> forms now support <code>#:break</code> and <code>#:final</code> clauses.</p></li>\n <li>\n  <p>The new <code>PLTCOMPILEDROOTS</code> environment variable configures the search path for compiled bytecode.</p></li></ul>\n\n<p>DrRacket::</p>\n\n<ul>\n <li>\n  <p>Check Syntax now summarizes the documentation (i.e., the blue boxes) for the identifier at the insertion point in the top-right corner of the definitions window.</p></li>\n <li>\n  <p>Check Syntax now runs continuously for programs that declare their language within the source. This mode has been available for several of the past releases, but now enabled by default.</p></li>\n <li>\n  <p>DrRacket can spell-check string constants (enable this in the Edit menu).</p></li></ul>\n\n<p>Typed Racket::</p>\n\n<ul>\n <li>\n  <p>Typed Racket interprets the <code>Any</code> type as a different contract. This may signal dynamic errors in some existing mixed typed/untyped programs. The normal fix is to replace a use of <code>Any</code> with a more specific types.</p></li>\n <li>\n  <p>NaN is included in all of Typed Racket&rsquo;s floating-point types, which makes precise floating-point types easier to use.</p></li>\n <li>\n  <p>Typed Racket supports a <code>cast</code> operation with support for higher-order types.</p></li>\n <li>\n  <p>Typed Racket provides the <code>:query-type/args</code> and <code>:query-type/result</code> utilities to explore types at the REPL.</p></li></ul>\n\n<p>Miscellaneous::</p>\n\n<ul>\n <li>\n  <p>The <code>compatibility</code> collection provides features from Racket relatives, such as <code>defmacro</code> and mutable lists. These features are provided to ease porting code to Racket. Avoid them in modern Racket code.</p></li>\n <li>\n  <p>Screenshots of the widgets provided by the Racket GUI library are included in the documentation. (Thanks to Diogo F. S. Ramos.)</p></li>\n <li>\n  <p>FrTime was ported to racket <code>#lang</code>. (Thanks to Patrick Mahoney.)</p></li></ul>\n\n<p>Deprecation::  The following has been deprecated and will be removed in the January 2013 release:</p>\n\n<ul>\n <li>the <code>planet</code> command-line tool; use <code>raco planet</code> instead.</li></ul>\n\n<p>The following has been deprecated and will be removed in the August 2013 release:</p>\n\n<ul>\n <li>the <code>mzlib/class100</code> library; use <code>racket/class</code> instead.</li></ul>") #f (u . "\n<p><em>posted by Eli Barzilay</em></p>\n\n<p>Racket version 5.3.1 is now available from <a href=\"http://racket-lang.org/\">http://racket-lang.org/</a> Racket::</p>\n\n<ul>\n <li>\n  <p>The <code>case</code> form dispatches on characters, fixnums, symbols, and keywords in logarithmic time. (Thanks to Jon Zeppieri.)</p></li>\n <li>\n  <p>The new <code>racket/format</code> library provides new and improved string-formatting functions.</p></li>\n <li>\n  <p>Logging tools include improved filtering support based on the name of a logger. A new <code>define-logger</code> form simplifies the use of named loggers. Forms such as <code>log-debug</code> now support string formatting.</p></li>\n <li>\n  <p>The <code>for</code> forms now support <code>#:break</code> and <code>#:final</code> clauses.</p></li>\n <li>\n  <p>The new <code>PLTCOMPILEDROOTS</code> environment variable configures the search path for compiled bytecode.</p></li></ul>\n\n<p>DrRacket::</p>\n\n<ul>\n <li>\n  <p>Check Syntax now summarizes the documentation (i.e., the blue boxes) for the identifier at the insertion point in the top-right corner of the definitions window.</p></li>\n <li>\n  <p>Check Syntax now runs continuously for programs that declare their language within the source. This mode has been available for several of the past releases, but now enabled by default.</p></li>\n <li>\n  <p>DrRacket can spell-check string constants (enable this in the Edit menu).</p></li></ul>\n\n<p>Typed Racket::</p>\n\n<ul>\n <li>\n  <p>Typed Racket interprets the <code>Any</code> type as a different contract. This may signal dynamic errors in some existing mixed typed/untyped programs. The normal fix is to replace a use of <code>Any</code> with a more specific types.</p></li>\n <li>\n  <p>NaN is included in all of Typed Racket&rsquo;s floating-point types, which makes precise floating-point types easier to use.</p></li>\n <li>\n  <p>Typed Racket supports a <code>cast</code> operation with support for higher-order types.</p></li>\n <li>\n  <p>Typed Racket provides the <code>:query-type/args</code> and <code>:query-type/result</code> utilities to explore types at the REPL.</p></li></ul>\n\n<p>Miscellaneous::</p>\n\n<ul>\n <li>\n  <p>The <code>compatibility</code> collection provides features from Racket relatives, such as <code>defmacro</code> and mutable lists. These features are provided to ease porting code to Racket. Avoid them in modern Racket code.</p></li>\n <li>\n  <p>Screenshots of the widgets provided by the Racket GUI library are included in the documentation. (Thanks to Diogo F. S. Ramos.)</p></li>\n <li>\n  <p>FrTime was ported to racket <code>#lang</code>. (Thanks to Patrick Mahoney.)</p></li></ul>\n\n<p>Deprecation::  The following has been deprecated and will be removed in the January 2013 release:</p>\n\n<ul>\n <li>the <code>planet</code> command-line tool; use <code>raco planet</code> instead.</li></ul>\n\n<p>The following has been deprecated and will be removed in the August 2013 release:</p>\n\n<ul>\n <li>the <code>mzlib/class100</code> library; use <code>racket/class</code> instead.</li></ul>")) ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2008-06-22-plt-scheme-v401.md" . unix) f post (u . "PLT Scheme v4.0.1") (? . 22) 1467223812 (p+ #"/Users/MB/git/racket-lang-org/blog/2008/06/plt-scheme-v401.html" . unix) "/2008/06/plt-scheme-v401.html" (u . "2008-06-22T23:49:00.001-04:00") (? . 23) (? . 67) (c (u . "")) (u . "\n<p><em>posted by Eli Barzilay</em></p>\n\n<p>PLT Scheme version 4.0.1 is now available from</p>\n\n<p> <code>[http://plt-scheme.org/](http://plt-scheme.org/)</code></p>\n\n<p>This release fixes a number of bugs. Most noteworthy, the &ldquo;Internal Error&rdquo; message when requiring a PLaneT package has been fixed and user-defined teachpacks now work properly.</p>\n\n<p>Feedback Welcome.</p>") #t (u . "\n<p><em>posted by Eli Barzilay</em></p>\n\n<p>PLT Scheme version 4.0.1 is now available from</p>\n\n<p> <code>[http://plt-scheme.org/](http://plt-scheme.org/)</code></p>\n\n<p>This release fixes a number of bugs. Most noteworthy, the &ldquo;Internal Error&rdquo; message when requiring a PLaneT package has been fixed and user-defined teachpacks now work properly.</p>\n\n<p>Feedback Welcome.</p>\n<!-- more-->\n\n<hr />\n\n<p>If you are a user of the world.ss, its interface has changed:</p>\n\n<p>&mdash; end-of-time has been removed</p>\n\n<p>++ (stop-when last-world?) has been added</p>\n\n<p>— <em>matthias, 23 June 2008</em></p>\n\n<hr />")) ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2007-11-12-getting-rid-of-set-car-and-set-cdr.md" . unix) f post (u . "Getting rid of `set-car!` and `set-cdr!`") (? . 24) 1467223812 (p+ #"/Users/MB/git/racket-lang-org/blog/2007/11/getting-rid-of-set-car-and-set-cdr.html" . unix) "/2007/11/getting-rid-of-set-car-and-set-cdr.html" (u . "2007-11-12T07:53:00.000-05:00") (? . 39) (? . 25) (c (u . "")) (u . "\n<p><em>posted by Matthew Flatt</em></p>\n\n<h2 id=\"functional-is-beautiful\">Functional is Beautiful</h2>\n\n<p>Scheme is a “mostly functional” language. Although Schemers don’t hesitate to use <code>set!</code> when mutation solves a problem best, Scheme programmers prefer to think functionally. Purely functional programs are easier to test, they make better and more reliable APIs, and our environments, compilers, and run-time systems take advantage of functional style.</p>\n\n<p>A Schemer’s functional bias is especially strong when writing programs that process and produce lists. The <code>map</code> function, which does both, is a thing of beauty:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre>  <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"nb\">map</span> <span class=\"n\">f</span> <span class=\"n\">l</span><span class=\"p\">)</span>\n   <span class=\"p\">(</span><span class=\"k\">cond</span>\n     <span class=\"p\">[(</span><span class=\"nb\">null?</span> <span class=\"n\">l</span><span class=\"p\">)</span> <span class=\"o\">&#39;</span><span class=\"p\">()]</span>\n     <span class=\"p\">[</span><span class=\"k\">else</span> <span class=\"p\">(</span><span class=\"nb\">cons</span> <span class=\"p\">(</span><span class=\"n\">f</span> <span class=\"p\">(</span><span class=\"nb\">car</span> <span class=\"n\">l</span><span class=\"p\">))</span> <span class=\"p\">(</span><span class=\"nb\">map</span> <span class=\"n\">f</span> <span class=\"p\">(</span><span class=\"nb\">cdr</span> <span class=\"n\">l</span><span class=\"p\">)))]))</span>\n</pre></div>\n\n</div>\n\n<p>The <code>map</code> function is most beautiful when the given <code>f</code> is functional. If <code>f</code> has side-effects, the the above implementation over-specifies <code>map</code>, which is traditionally allowed to process the list in any order that it wants (though PLT Scheme guarantees left-to-right order, as above). Arguably, when some other Schemer provides a non-functional <code>f</code>, then it’s their problem; they have to deal with the consequences (which may well be minor compared to some benefits of using mutation).</p>\n\n<p>The <code>map</code> function might also receive a non-list, but the <code>map</code> implementor can guard against such misuse of <code>map</code> by wrapping it with a check,</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre>  <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">checked-map</span> <span class=\"n\">f</span> <span class=\"n\">l</span><span class=\"p\">)</span>\n    <span class=\"p\">(</span><span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"nb\">list?</span> <span class=\"n\">l</span><span class=\"p\">)</span>\n        <span class=\"p\">(</span><span class=\"nb\">map</span> <span class=\"n\">f</span> <span class=\"n\">l</span><span class=\"p\">)</span>\n        <span class=\"p\">(</span><span class=\"nb\">error</span> <span class=\"o\">&#39;</span><span class=\"ss\">map</span> <span class=\"s2\">\"not a list\"</span><span class=\"p\">)))</span>\n</pre></div>\n\n</div>\n\n<p>and then exporting <code>checked-map</code> instead of the raw <code>map</code>. This kind of checking gives nicer error messages, and it helps hide implementation details of <code>map</code>. We could further also imagine that the raw <code>map</code> is compiled without run-time checks on <code>car</code> and <code>cdr</code>.</p>\n\n<h2 id=\"the-problem-with-mutable-pairs\">The Problem with Mutable Pairs</h2>\n\n<p>What if someone calls <code>checked-map</code> like this?:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre>  <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"n\">l</span> <span class=\"p\">(</span><span class=\"nb\">list</span> <span class=\"mi\">1</span> <span class=\"mi\">2</span> <span class=\"mi\">3</span> <span class=\"mi\">4</span> <span class=\"mi\">5</span><span class=\"p\">))</span>\n  <span class=\"p\">(</span><span class=\"n\">checked-map</span> <span class=\"p\">(</span><span class=\"k\">lambda</span> <span class=\"p\">(</span><span class=\"n\">x</span><span class=\"p\">)</span>\n                 <span class=\"p\">(</span><span class=\"n\">set-cdr!</span> <span class=\"p\">(</span><span class=\"nb\">cddr</span> <span class=\"n\">l</span><span class=\"p\">)</span> <span class=\"mi\">5</span><span class=\"p\">))</span>\n               <span class=\"n\">l</span><span class=\"p\">)</span>\n</pre></div>\n\n</div>\n\n<p>The <code>f</code> provided to <code>map</code> in this case is not purely functional. Moreover, it uses mutation in a particularly unfortunate way: the <code>list?</code> test in <code>checked-map</code> succeeds, because the argument is initially a list, and the mutation is ultimately discovered by a call to <code>cdr</code> &mdash; but only if checks haven&rsquo;t been disabled.</p>\n\n<p>If you’re a Schemer, then unless you’ve seen this before, or unless you thought a bit about the title of this section, then you probably didn&rsquo;t think of the above test case for <code>map</code>. A Schemer’s view of lists is so deeply functional that it&rsquo;s hard to make this particular leap.</p>\n\n<p>Furthermore, this example is not contrived. If you have either Chez Scheme version 6.1 or a pre&ndash;200 MzScheme sitting around, calling <code>map</code> as above leads to a seg fault or an invalid memory access:</p>\n\n<div class=\"brush: bash\">\n <div class=\"pygments\">\n  <pre>  Chez Scheme Version 6.1\n  Copyright <span class=\"o\">(</span>c<span class=\"o\">)</span> <span class=\"m\">1998</span> Cadence Research Systems\n\n  &gt; <span class=\"o\">(</span>define l <span class=\"o\">(</span>list <span class=\"m\">1</span> <span class=\"m\">2</span> <span class=\"m\">3</span> <span class=\"m\">4</span> 5<span class=\"o\">))</span>\n  &gt; <span class=\"o\">(</span>map <span class=\"o\">(</span>lambda <span class=\"o\">(</span>x<span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"nb\">set</span>-cdr! <span class=\"o\">(</span>cddr l<span class=\"o\">)</span> 5<span class=\"o\">))</span> l<span class=\"o\">)</span>\n\n  Error: invalid memory reference.\n  Some debugging context may have been lost.\n</pre></div>\n\n</div>\n\n<p>The <code>map</code> example illustrates how mutable pairs can break a Schemer’s natural and ingrained model of programming. Of course, if optimizing and providing friendly error messages for <code>map</code> were the only issues with mutable pairs, then it wouldn’t matter; Scheme implementors are smart enough to (eventually) get this right. Unfortunately, the underlying problem is more pervasive.</p>\n\n<p>In the API for a typical Scheme library, lists can be used for many kinds of input and output. Flags for options might be provided in a list. A function might provide information about the current configuration (e.g., the current items in a GUI list box) in a list. Procedures or methods that deal gracefully with list mutation are few and far between. In most cases, the result of unexpected mutation is merely a bad error message; sometimes, however, unexpected mutation of a list can break the library’s internal invariants. In the worst case, the library whose internal invariants are broken plays some role in a system’s overall security.</p>\n\n<p>Mutable lists also interfere with the language’s extensibility. The PLT Scheme contract system, for example, offers a way to wrap an exported function with a contract that constrains its input and outputs, which are optionally (in principle) enforced by run-time checks. Higher-order contracts, such as “a list of functions that consume and produce numbers”, require wrappers on sub-pieces, and these wrappers can be installed only by copying the enclosing list. Copying a mutable list changes the semantics of a program, however, whereas contracts are supposed to enforce invariants without otherwise changing the program. Copying an immutable list creates no such problem.</p>\n\n<p>Finally, mutable lists make the language’s specification messy. The R6RS editors spent considerable energy trying to pin down the exception-raising guarantees of <code>map</code>; the possibility of mutable pairs made it difficult to provide much of a guarantee. The standard says that implementations should check that the lists provided to<code>map</code> are the same length, but it’s not worth much to require that check, since an argument’s length as a list can change via mutation to the list’s pairs.</p>\n\n<h2 id=\"switching-to-immutable-pairs\">Switching to Immutable Pairs</h2>\n\n<p>The designers of PLT Scheme long ago recognized the problems of mutable pairs, and we introduced functions like <code>cons-immutable</code> and<code>list-immutable</code> to support programming with immutable lists. These additions solved some problems &mdash; but only in the cases where we were careful to use immutable lists. The R6RS editors also recognized the problems of mutable pairs, so that <code>set-car!</code> and <code>set-cdr!</code> were banished to their own library &mdash; but programmers are still free to use that library.</p>\n\n<p>While these are worthwhile steps for many reasons, they do not solve the underlying problem. Library implementors who deal in lists must still either set up elaborate guards against mutation, pretend that the problem doesn&rsquo;t matter, or require the use of a special immutable-list datatype that is incompatible with libraries whose authors set up elaborate guards or ignore the problem.</p>\n\n<p>Why all this hassle? If most Scheme code really does use and expect pairs in a functional way, can&rsquo;t we just switch to immutable pair? Most Scheme code will still work, untold security holes will have been closed, specifications will become instantly tighter, and language extensions like contracts will work better.</p>\n\n<p>Schemers have been reluctant to make this leap, because it has never been clear just how much code relies on mutable pairs. We don’t know how much the switch will cost in porting time and long-term incompatibility, and we don’t really know how much we will gain. We won&rsquo;t know until we try it.</p>\n\n<p>For PLT Scheme v4.0, we’re going to try it. In our main dialects of Scheme (such as the <code>mzscheme</code> language), <code>cons</code> will create immutable pairs, and <code>pair?</code> and <code>list?</code> will recognize only immutable pairs and lists. The <code>set-car!</code> and <code>set-cdr</code> procedures will not exist. A new set of procedure <code>mcons</code>, <code>mcar</code>, <code>mcdr</code>, <code>set-mcar!</code>, and <code>set-mcdr!</code> will support mutable pairs. (A related v4.0 change is that <code>define-struct</code> by default creates immutable structure types.)</p>\n\n<p>Of course, PLT Scheme v4.0 will support an R5RS language where <code>cons</code> is <code>mcons</code>, and so on, so many old programs can still run easily in the new version. The difference is that interoperability between R5RS libraries and PLT Scheme libraries will be less direct than before.</p>\n\n<h2 id=\"experience-so-far\">Experience So Far</h2>\n\n<p>PLT Scheme v3.99.0.2 exists already in a branch of our SVN repository, and it will soon move to the SVN trunk. That is, we have already ported at least a half million lines of Scheme code to a dialect without <code>set-car!</code> and <code>set-cdr!</code>.</p>\n\n<p>The conversion took about eight hours. Obviously, relatively little code had to change. The following are the typical porting scenarios:</p>\n\n<ul>\n <li>\n  <p>The <code>reverse!</code> and <code>append!</code> functions were frequently used for “linear updates” by performance-conscious implementors. As our underlying Scheme implementation has improved, however, the performance benefits of these functions has become less. All uses could be replaced with <code>reverse</code> and <code>append</code>.</p></li>\n <li>\n  <p>The <code>set-cdr!</code> operation was often used to implement an internal queue. Such internal queues were easily changed to use <code>mcons</code>,<code>mcar</code>, <code>mcdr</code>, and <code>set-mcdr!</code>.</p></li>\n <li>\n  <p>An association-list mapping was sometimes updated with <code>set-cdr!</code> when a mapping was present, otherwise the list was extended. Since the extension case was supported, it was easy to just update the list functionally. (The relevant lists were short; if the lists were long, the right change would be to use a hash table instead of a list.)</p></li>\n <li>\n  <p>A pair was sometime used for an updatable mapping where a distinct structure type is better. The quick solution was to throw in a mutable box in place of the value.</p></li></ul>\n\n<p>The PLT Scheme code might be better positioned for the switch than arbitrary Scheme code. Most of it was written by a handful of people who understood the problems of mutable pairs, and who might therefore shy away from them. However, the PLT Scheme code base includes a lot of code that was not written specifically for PLT Scheme, including Slatex, Tex2page, and many SRFI reference implementations. With the exception of SRFI&ndash;9, which generalizes <code>set!</code> to work with pairs, the SRFI implementations were remarkably trouble free. (Thanks to Olin Shivers for making mutation optional in the “linear update” functions like <code>reverse!</code> from SRFIs 1 and 32.)</p>\n\n<p>In addition, we looked at a number of standard Scheme benchmarks, which can be found here:</p>\n\n<p><a href=\"http://svn.plt-scheme.org/plt/trunk/collects/tests/mzscheme/benchmarks/common/\"> http://svn.plt-scheme.org/plt/trunk/collects/tests/mzscheme/benchmarks/common/</a></p>\n\n<p>Of the 28 benchmarks, eight of them mutate pairs. Four of those are trivially converted to functional programs, along the lines of the scenarios above. One, <code>destruct</code>, is designed specifically to test mutation performance, so it makes no sense to port. Another, <code>sort1</code>, is a sorting algorithm that inherently relies on mutation; a functional sort is obviously possible, but that would be a different benchmark. The <code>conform</code> benchmark uses mutable pairs for tables in a relatively non-local way; as a modern Scheme program, it would probably be written with structures, but it’s not trivial to port. The <code>peval</code> benchmark uses pairs to represent Scheme programs, and it partially evaluates the program by mutating it, so it is not trivial to port. To summarize, out of 28 old, traditional benchmark programs, only two represent interesting programs that are not easily adapted to immutable pairs. (They run in PLT Scheme’s R5RS language, of course.)</p>\n\n<p>Finally, we selected a useful third-party library that is not included with PLT Scheme. We checked the generic SSAX implementation (not the PLT Scheme version), and we found a couple of uses of <code>set-car!</code> and <code>set-cdr!</code>. Again, they fall into the above queue and association-list categories that are easily and locally converted.</p>\n\n<p>Meanwhile, as we start to use v3.99 to run scripts in our day-to-day work, immutable pairs have so far created no difficulty at all. So far, then, our optimism in trying immutable pairs seems to be justified; it just might work.</p>\n\n<h2 id=\"but-its-lisp-tradition\">But It’s Lisp Tradition!</h2>\n\n<p>A typical response to news of the demise of mutable pairs is that it will create lot of trouble, because mutable pairs are Scheme tradition, and surely lots of useful old code exploits them in lots of places.</p>\n\n<p>We’re eager to hear whether anyone has such code. Our initial hypothesis is that practically all old code falls into one of two categories:</p>\n\n<ul>\n <li>\n  <p>The code is easily ported to immutable pairs, along the same lines as above (i.e., local queues and small association lists).</p></li>\n <li>\n  <p>The code so old and generic that it can be run as an R5RS program. It won’t call into the large PLT Scheme set of libraries that will expect immutable pairs, and it can easily be used as a library with wrappers that convert mutable pairs back and forth with immutable pairs.</p></li></ul>\n\n<p>Frankly, we’re not so eager to hear opinions based on guesswork about existing code and how it might get used. Download v3.99 from SVN or as a nightly build when it becomes available; let us know your guesses about how running your old code would go, but then let us know what actually happens.</p>\n\n<p>The immutable-pairs plan for v4.0 is not set in stone, but we won’t make the decision based on guesswork. More libraries (other than R5RS) to aid compatibility may be useful, but so far we don’t have a tangible need for them. In any case, we’ll revert to mutable pairs only if significant experience with the pre-release version demonstrates that it really won’t work.</p>") #t (u . "\n<p><em>posted by Matthew Flatt</em></p>\n\n<h2 id=\"functional-is-beautiful\">Functional is Beautiful</h2>\n\n<p>Scheme is a “mostly functional” language. Although Schemers don’t hesitate to use <code>set!</code> when mutation solves a problem best, Scheme programmers prefer to think functionally. Purely functional programs are easier to test, they make better and more reliable APIs, and our environments, compilers, and run-time systems take advantage of functional style.</p>\n\n<p>A Schemer’s functional bias is especially strong when writing programs that process and produce lists. The <code>map</code> function, which does both, is a thing of beauty:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre>  <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"nb\">map</span> <span class=\"n\">f</span> <span class=\"n\">l</span><span class=\"p\">)</span>\n   <span class=\"p\">(</span><span class=\"k\">cond</span>\n     <span class=\"p\">[(</span><span class=\"nb\">null?</span> <span class=\"n\">l</span><span class=\"p\">)</span> <span class=\"o\">&#39;</span><span class=\"p\">()]</span>\n     <span class=\"p\">[</span><span class=\"k\">else</span> <span class=\"p\">(</span><span class=\"nb\">cons</span> <span class=\"p\">(</span><span class=\"n\">f</span> <span class=\"p\">(</span><span class=\"nb\">car</span> <span class=\"n\">l</span><span class=\"p\">))</span> <span class=\"p\">(</span><span class=\"nb\">map</span> <span class=\"n\">f</span> <span class=\"p\">(</span><span class=\"nb\">cdr</span> <span class=\"n\">l</span><span class=\"p\">)))]))</span>\n</pre></div>\n\n</div>\n\n<p>The <code>map</code> function is most beautiful when the given <code>f</code> is functional. If <code>f</code> has side-effects, the the above implementation over-specifies <code>map</code>, which is traditionally allowed to process the list in any order that it wants (though PLT Scheme guarantees left-to-right order, as above). Arguably, when some other Schemer provides a non-functional <code>f</code>, then it’s their problem; they have to deal with the consequences (which may well be minor compared to some benefits of using mutation).</p>\n\n<p>The <code>map</code> function might also receive a non-list, but the <code>map</code> implementor can guard against such misuse of <code>map</code> by wrapping it with a check,</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre>  <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">checked-map</span> <span class=\"n\">f</span> <span class=\"n\">l</span><span class=\"p\">)</span>\n    <span class=\"p\">(</span><span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"nb\">list?</span> <span class=\"n\">l</span><span class=\"p\">)</span>\n        <span class=\"p\">(</span><span class=\"nb\">map</span> <span class=\"n\">f</span> <span class=\"n\">l</span><span class=\"p\">)</span>\n        <span class=\"p\">(</span><span class=\"nb\">error</span> <span class=\"o\">&#39;</span><span class=\"ss\">map</span> <span class=\"s2\">\"not a list\"</span><span class=\"p\">)))</span>\n</pre></div>\n\n</div>\n\n<p>and then exporting <code>checked-map</code> instead of the raw <code>map</code>. This kind of checking gives nicer error messages, and it helps hide implementation details of <code>map</code>. We could further also imagine that the raw <code>map</code> is compiled without run-time checks on <code>car</code> and <code>cdr</code>.</p>\n\n<h2 id=\"the-problem-with-mutable-pairs\">The Problem with Mutable Pairs</h2>\n\n<p>What if someone calls <code>checked-map</code> like this?:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre>  <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"n\">l</span> <span class=\"p\">(</span><span class=\"nb\">list</span> <span class=\"mi\">1</span> <span class=\"mi\">2</span> <span class=\"mi\">3</span> <span class=\"mi\">4</span> <span class=\"mi\">5</span><span class=\"p\">))</span>\n  <span class=\"p\">(</span><span class=\"n\">checked-map</span> <span class=\"p\">(</span><span class=\"k\">lambda</span> <span class=\"p\">(</span><span class=\"n\">x</span><span class=\"p\">)</span>\n                 <span class=\"p\">(</span><span class=\"n\">set-cdr!</span> <span class=\"p\">(</span><span class=\"nb\">cddr</span> <span class=\"n\">l</span><span class=\"p\">)</span> <span class=\"mi\">5</span><span class=\"p\">))</span>\n               <span class=\"n\">l</span><span class=\"p\">)</span>\n</pre></div>\n\n</div>\n\n<p>The <code>f</code> provided to <code>map</code> in this case is not purely functional. Moreover, it uses mutation in a particularly unfortunate way: the <code>list?</code> test in <code>checked-map</code> succeeds, because the argument is initially a list, and the mutation is ultimately discovered by a call to <code>cdr</code> &mdash; but only if checks haven&rsquo;t been disabled.</p>\n\n<p>If you’re a Schemer, then unless you’ve seen this before, or unless you thought a bit about the title of this section, then you probably didn&rsquo;t think of the above test case for <code>map</code>. A Schemer’s view of lists is so deeply functional that it&rsquo;s hard to make this particular leap.</p>\n\n<p>Furthermore, this example is not contrived. If you have either Chez Scheme version 6.1 or a pre&ndash;200 MzScheme sitting around, calling <code>map</code> as above leads to a seg fault or an invalid memory access:</p>\n\n<div class=\"brush: bash\">\n <div class=\"pygments\">\n  <pre>  Chez Scheme Version 6.1\n  Copyright <span class=\"o\">(</span>c<span class=\"o\">)</span> <span class=\"m\">1998</span> Cadence Research Systems\n\n  &gt; <span class=\"o\">(</span>define l <span class=\"o\">(</span>list <span class=\"m\">1</span> <span class=\"m\">2</span> <span class=\"m\">3</span> <span class=\"m\">4</span> 5<span class=\"o\">))</span>\n  &gt; <span class=\"o\">(</span>map <span class=\"o\">(</span>lambda <span class=\"o\">(</span>x<span class=\"o\">)</span> <span class=\"o\">(</span><span class=\"nb\">set</span>-cdr! <span class=\"o\">(</span>cddr l<span class=\"o\">)</span> 5<span class=\"o\">))</span> l<span class=\"o\">)</span>\n\n  Error: invalid memory reference.\n  Some debugging context may have been lost.\n</pre></div>\n\n</div>\n\n<p>The <code>map</code> example illustrates how mutable pairs can break a Schemer’s natural and ingrained model of programming. Of course, if optimizing and providing friendly error messages for <code>map</code> were the only issues with mutable pairs, then it wouldn’t matter; Scheme implementors are smart enough to (eventually) get this right. Unfortunately, the underlying problem is more pervasive.</p>\n\n<p>In the API for a typical Scheme library, lists can be used for many kinds of input and output. Flags for options might be provided in a list. A function might provide information about the current configuration (e.g., the current items in a GUI list box) in a list. Procedures or methods that deal gracefully with list mutation are few and far between. In most cases, the result of unexpected mutation is merely a bad error message; sometimes, however, unexpected mutation of a list can break the library’s internal invariants. In the worst case, the library whose internal invariants are broken plays some role in a system’s overall security.</p>\n\n<p>Mutable lists also interfere with the language’s extensibility. The PLT Scheme contract system, for example, offers a way to wrap an exported function with a contract that constrains its input and outputs, which are optionally (in principle) enforced by run-time checks. Higher-order contracts, such as “a list of functions that consume and produce numbers”, require wrappers on sub-pieces, and these wrappers can be installed only by copying the enclosing list. Copying a mutable list changes the semantics of a program, however, whereas contracts are supposed to enforce invariants without otherwise changing the program. Copying an immutable list creates no such problem.</p>\n\n<p>Finally, mutable lists make the language’s specification messy. The R6RS editors spent considerable energy trying to pin down the exception-raising guarantees of <code>map</code>; the possibility of mutable pairs made it difficult to provide much of a guarantee. The standard says that implementations should check that the lists provided to<code>map</code> are the same length, but it’s not worth much to require that check, since an argument’s length as a list can change via mutation to the list’s pairs.</p>\n\n<h2 id=\"switching-to-immutable-pairs\">Switching to Immutable Pairs</h2>\n\n<p>The designers of PLT Scheme long ago recognized the problems of mutable pairs, and we introduced functions like <code>cons-immutable</code> and<code>list-immutable</code> to support programming with immutable lists. These additions solved some problems &mdash; but only in the cases where we were careful to use immutable lists. The R6RS editors also recognized the problems of mutable pairs, so that <code>set-car!</code> and <code>set-cdr!</code> were banished to their own library &mdash; but programmers are still free to use that library.</p>\n\n<p>While these are worthwhile steps for many reasons, they do not solve the underlying problem. Library implementors who deal in lists must still either set up elaborate guards against mutation, pretend that the problem doesn&rsquo;t matter, or require the use of a special immutable-list datatype that is incompatible with libraries whose authors set up elaborate guards or ignore the problem.</p>\n\n<p>Why all this hassle? If most Scheme code really does use and expect pairs in a functional way, can&rsquo;t we just switch to immutable pair? Most Scheme code will still work, untold security holes will have been closed, specifications will become instantly tighter, and language extensions like contracts will work better.</p>\n\n<p>Schemers have been reluctant to make this leap, because it has never been clear just how much code relies on mutable pairs. We don’t know how much the switch will cost in porting time and long-term incompatibility, and we don’t really know how much we will gain. We won&rsquo;t know until we try it.</p>\n\n<p>For PLT Scheme v4.0, we’re going to try it. In our main dialects of Scheme (such as the <code>mzscheme</code> language), <code>cons</code> will create immutable pairs, and <code>pair?</code> and <code>list?</code> will recognize only immutable pairs and lists. The <code>set-car!</code> and <code>set-cdr</code> procedures will not exist. A new set of procedure <code>mcons</code>, <code>mcar</code>, <code>mcdr</code>, <code>set-mcar!</code>, and <code>set-mcdr!</code> will support mutable pairs. (A related v4.0 change is that <code>define-struct</code> by default creates immutable structure types.)</p>\n\n<p>Of course, PLT Scheme v4.0 will support an R5RS language where <code>cons</code> is <code>mcons</code>, and so on, so many old programs can still run easily in the new version. The difference is that interoperability between R5RS libraries and PLT Scheme libraries will be less direct than before.</p>\n\n<h2 id=\"experience-so-far\">Experience So Far</h2>\n\n<p>PLT Scheme v3.99.0.2 exists already in a branch of our SVN repository, and it will soon move to the SVN trunk. That is, we have already ported at least a half million lines of Scheme code to a dialect without <code>set-car!</code> and <code>set-cdr!</code>.</p>\n\n<p>The conversion took about eight hours. Obviously, relatively little code had to change. The following are the typical porting scenarios:</p>\n\n<ul>\n <li>\n  <p>The <code>reverse!</code> and <code>append!</code> functions were frequently used for “linear updates” by performance-conscious implementors. As our underlying Scheme implementation has improved, however, the performance benefits of these functions has become less. All uses could be replaced with <code>reverse</code> and <code>append</code>.</p></li>\n <li>\n  <p>The <code>set-cdr!</code> operation was often used to implement an internal queue. Such internal queues were easily changed to use <code>mcons</code>,<code>mcar</code>, <code>mcdr</code>, and <code>set-mcdr!</code>.</p></li>\n <li>\n  <p>An association-list mapping was sometimes updated with <code>set-cdr!</code> when a mapping was present, otherwise the list was extended. Since the extension case was supported, it was easy to just update the list functionally. (The relevant lists were short; if the lists were long, the right change would be to use a hash table instead of a list.)</p></li>\n <li>\n  <p>A pair was sometime used for an updatable mapping where a distinct structure type is better. The quick solution was to throw in a mutable box in place of the value.</p></li></ul>\n\n<p>The PLT Scheme code might be better positioned for the switch than arbitrary Scheme code. Most of it was written by a handful of people who understood the problems of mutable pairs, and who might therefore shy away from them. However, the PLT Scheme code base includes a lot of code that was not written specifically for PLT Scheme, including Slatex, Tex2page, and many SRFI reference implementations. With the exception of SRFI&ndash;9, which generalizes <code>set!</code> to work with pairs, the SRFI implementations were remarkably trouble free. (Thanks to Olin Shivers for making mutation optional in the “linear update” functions like <code>reverse!</code> from SRFIs 1 and 32.)</p>\n\n<p>In addition, we looked at a number of standard Scheme benchmarks, which can be found here:</p>\n\n<p><a href=\"http://svn.plt-scheme.org/plt/trunk/collects/tests/mzscheme/benchmarks/common/\"> http://svn.plt-scheme.org/plt/trunk/collects/tests/mzscheme/benchmarks/common/</a></p>\n\n<p>Of the 28 benchmarks, eight of them mutate pairs. Four of those are trivially converted to functional programs, along the lines of the scenarios above. One, <code>destruct</code>, is designed specifically to test mutation performance, so it makes no sense to port. Another, <code>sort1</code>, is a sorting algorithm that inherently relies on mutation; a functional sort is obviously possible, but that would be a different benchmark. The <code>conform</code> benchmark uses mutable pairs for tables in a relatively non-local way; as a modern Scheme program, it would probably be written with structures, but it’s not trivial to port. The <code>peval</code> benchmark uses pairs to represent Scheme programs, and it partially evaluates the program by mutating it, so it is not trivial to port. To summarize, out of 28 old, traditional benchmark programs, only two represent interesting programs that are not easily adapted to immutable pairs. (They run in PLT Scheme’s R5RS language, of course.)</p>\n\n<p>Finally, we selected a useful third-party library that is not included with PLT Scheme. We checked the generic SSAX implementation (not the PLT Scheme version), and we found a couple of uses of <code>set-car!</code> and <code>set-cdr!</code>. Again, they fall into the above queue and association-list categories that are easily and locally converted.</p>\n\n<p>Meanwhile, as we start to use v3.99 to run scripts in our day-to-day work, immutable pairs have so far created no difficulty at all. So far, then, our optimism in trying immutable pairs seems to be justified; it just might work.</p>\n\n<h2 id=\"but-its-lisp-tradition\">But It’s Lisp Tradition!</h2>\n\n<p>A typical response to news of the demise of mutable pairs is that it will create lot of trouble, because mutable pairs are Scheme tradition, and surely lots of useful old code exploits them in lots of places.</p>\n\n<p>We’re eager to hear whether anyone has such code. Our initial hypothesis is that practically all old code falls into one of two categories:</p>\n\n<ul>\n <li>\n  <p>The code is easily ported to immutable pairs, along the same lines as above (i.e., local queues and small association lists).</p></li>\n <li>\n  <p>The code so old and generic that it can be run as an R5RS program. It won’t call into the large PLT Scheme set of libraries that will expect immutable pairs, and it can easily be used as a library with wrappers that convert mutable pairs back and forth with immutable pairs.</p></li></ul>\n\n<p>Frankly, we’re not so eager to hear opinions based on guesswork about existing code and how it might get used. Download v3.99 from SVN or as a nightly build when it becomes available; let us know your guesses about how running your old code would go, but then let us know what actually happens.</p>\n\n<p>The immutable-pairs plan for v4.0 is not set in stone, but we won’t make the decision based on guesswork. More libraries (other than R5RS) to aid compatibility may be useful, but so far we don’t have a tangible need for them. In any case, we’ll revert to mutable pairs only if significant experience with the pre-release version demonstrates that it really won’t work.</p>\n<!-- more-->\n\n<hr />\n\n<p>A brave and commendable experiment!</p>\n\n<p>I think there are two distinct issues here: set-cdr! can mutate list structure (and creates problems for functions that assume that list structure is invariant) whereas set-car! mutates list contents but not structure (and prevents copying). I think the former is much more troublesome than the latter. Did you consider semi-mutable pairs, that is, pairs whose car is mutable but cdr is immutable? In the code you have converted, is set-cdr! more common than set-car!?</p>\n\n<p>— <em>Alan Watson, 12 November 2007</em></p>\n\n<hr />\n\n<p><code>set-car!</code> doesn&rsquo;t merely prevent copying (which is a big enough problem for the contract system); it can also break invariants, as in the example of reflecting a list-box&rsquo;s content.</p>\n\n<p>So, keeping <code>set-car!</code> leaves us with problems. Would keeping it solve any problems in practice? I did indeed see <code>set-cdr!</code> more than <code>set-car!</code>, and I can&rsquo;t think of an example that would have run if only we had kept <code>set-car!</code>. Thus, aside from tradition, I don&rsquo;t yet see any rationale for keeping <code>set-car!</code> &mdash; but I&rsquo;m eager to hear about other experience.</p>\n\n<p>— <em>Matthew Flatt, 12 November 2007</em></p>\n\n<hr />\n\n<p>The only situations where I find myself mutating pairs are, on first glance, generating lists front to back, which you discussed, using pairs to implement simple &lsquo;pairs of values&rsquo;, where structs/objects/vectors could be used instead, and for sorted insertion into lists, which is more fundamental, but I guess would be a good place to use mutable pairs.</p>\n\n<p>— <em>Marijn, 13 November 2007</em></p>\n\n<hr />\n\n<p>Perhaps all I am saying is that the arguments against set-car! are the standard arguments against mutation, whereas the arguments against set-cdr! are those plus the problems it creates for procedures like map. Thus, the justification for eliminating set-car! is similar to the justification for making records immutable (as you have done), whereas the justification for eliminating set-cdr! is this and more.</p>\n\n<p>— <em>Alan Watson, 13 November 2007</em></p>\n\n<hr />\n\n<p>Alan: I think that the arguments against set-cdr! are in fact the same arguments against any old mutation (ie, just like the anti-set-car! arguments). Even tho the core libraries of Scheme (things like map) suffer more due to set-cdr!, ordinary programs suffer equally in our experience (as Matthew has explained).</p>\n\n<p>Anyways, let me encourage you to put your theory to the test and find some non-trivial programs or libraries that back up your point!</p>\n\n<p>— <em>Robby, 13 November 2007</em></p>\n\n<hr />\n\n<p>My point is not that there are libraries or programs in which set-car! is a good idea. My point is an opinion, perhaps badly expressed, on why each creates problems and which is worse. Sorry for the noise.</p>\n\n<p>— <em>Alan Watson, 13 November 2007</em></p>\n\n<hr />\n\n<p>I tend to agree. I do use set-car! and set-cdr! time to time, but mostly from my laziness to use more appropriate data structures instead. Recently I also started to avoid the use of set-cdr! to create list from front to back, for it doesn&rsquo;t work well with call/cc.</p>\n\n<p>However, there&rsquo;s one more area that I see the mutable pairs are indispensable; circular lists. Though it has its own problems, it is sometimes very handy to express some kind of code concisely where I&rsquo;d use infinite lazy list in Haskell. It only needs mutation at construction time, and we can make it &ldquo;freeze&rdquo; so that it won&rsquo;t have the problem of &ldquo;the list changing during traversal&rdquo;.</p>\n\n<p>Do you have some plan to support circular structures specially (e.g. srfi&ndash;38 notation or srfi&ndash;1&rsquo;s circular-list procedure hides mutation &ldquo;under the hood&rdquo; so that the users only see immutable, already constructed structures)?</p>\n\n<p>— <em>Shiro Kawai, 13 November 2007</em></p>\n\n<hr />\n\n<p>Yes. Version 3.99.0.2 has <code>make-reader-graph</code> for creating cycles built from immutable pairs. We need a better name, but the current name reflects that <code>read</code> still supports the #n= and #n# graph notation. (We&rsquo;ve dropped support for cyclic syntax objects, though, so <code>read-syntax</code> no longer supports the graph notation).</p>\n\n<p>— <em>Matthew Flatt, 13 November 2007</em></p>\n\n<hr />\n\n<p>Well, I&rsquo;ve been online now for over 30 minutes, and AFAIK, I haven&rsquo;t been hacked. This is a banner day. Hi Matt; great article! Out of necessity, from a security standpoint, I have converted all my boxes to some flavor of *nix. As soon as I can download 3.99, I&rsquo;ll try to reproduce the flavor of the data from my flatten benchmark article. This time it will be different, simply because they&rsquo;ll be on a new OS. However, I have a bunch of varients of the flatten algorithm, using both muttable and immutable methods. As I recall from my earlier results, the biggest difference advantage to using mutation came about when a poor algorithm had been choosen to begin with, that required the reversal of the result list. These quite substantially improved their performance with the use of reverse! However, the more elegant functional solutions, under favorable conditions, actually out performed even the fastest mutable algorithms. Not typically, but definitely always in the race. The success of building functional solutions, which are also efficient is certainly achieved with other functional languages. I&rsquo;ll have to redesign my queue routine, as you mentioned, but it will be worth the effort. I&rsquo;m looking forward to getting a copy on my box as soon as possible.</p>\n\n<p>Take care.</p>\n\n<p>&mdash;kylr</p>\n\n<p>— <em>Kyle Smith, 18 November 2007</em></p>\n\n<hr />\n\n<p>Did not observe any problem beyond the typical usages noted in the article when I moved SSAX and SXML to R6RS libraries.</p>\n\n<p>Typical use is in implementing &ldquo;efficient&rdquo; queues. I expect an applicative queue such as found in Okasaki would work fine on modern hardware and scheme implementations.</p>\n\n<p>I doubt there is a systemic problem out there.</p>\n\n<p>— <em>GreyLensman, 18 November 2007</em></p>\n\n<hr />\n\n<p>How difficult would it be to replace set! with explicit boxes?</p>\n\n<p>— <em>Ethan Aubin, 21 November 2007</em></p>\n\n<hr />\n\n<p>Are you considering changing the behaviour of eq? or eqv? on (now immutable) pairs? Currently, two immutable pairs whose cars and cdrs are eq? can only be distinguished by eq? or eqv?. As such, should they really be considered to be distinct or is their apparent distinctiveness simply an artifact of the implementation that should be hidden from the programmer?</p>\n\n<p>— <em>Alan Watson, 26 November 2007</em></p>\n\n<hr />\n\n<p>Wow, did I make a mistake.</p>\n\n<p>Background. In PLT Redex, the stepper uses mutable lists to represent the currently visible portion of the reduction graph. When someone clicks the &ldquo;next&rdquo; button, it does a set-cdr! to add something to the end of that graph.</p>\n\n<p>The Mistake. When I converted the code to v4, I figured that I should preserve the mutation, so I went in and changed a few set-car!s to set-mcar!s and then changed about 15 or 20 uses of filter, for-each, ormap, list-ref, and friends to versions of those that worked on mutable pairs instead of immutable ones. This took about 2 hours.</p>\n\n<p>Not too bad, you might think. Two hours? Sometimes fixing one little bug can take longer than that, days even. Got away cheaply, you might think &hellip;</p>\n\n<p>What I Should Have Done. Today I decided that I wanted the code to work in both v4 and in earlier versions of PLT Scheme, since the code&rsquo;ll be on PLaneT, after all and not everyone is using v4 yet. Sigh. So now I need to go undo that work and copy the list instead of mutating its tail. So I did that.</p>\n\n<p>5 minutes. Done. Working code.</p>\n\n<p>10 more minutes: removing all of the now useless helper functions that dealt with the mutable-pair versions of filter, for-each, ormap, list-ref.</p>\n\n<p>Oh well. Lesson learned, I suppose.</p>\n\n<p>— <em>Robby, 27 November 2007</em></p>\n\n<hr />\n\n<p>On replacing set! with set-box!: in a sense, this is so easy that the compiler does it automatically. That is, mutable variables are already implemented via boxes. You always know statically whether a variable needs to be boxed and unboxed due to lexical scope plus rules on mutating module-defined identifiers. For essentially the same reason, <code>set!</code> doesn&rsquo;t really cause much trouble; programmers usually see <code>set!</code>s and know to treat the relevant variable with care &mdash; in contrast with <code>set-car!</code>s, which could be in a library that you don&rsquo;t see.</p>\n\n<p>— <em>Matthew Flatt, 27 November 2007</em></p>\n\n<hr />\n\n<p>We have so far not changed the interaction of <code>cons</code> with <code>eq?</code> or <code>eqv?</code>. Specifically, <code>cons</code>, <code>list</code>, etc. are guaranteed to create fresh cons cells, in the sense that <code>eq?</code> distinguishes them, even though the cons cells are immutable. I think we may want to remove this guarantee eventually, because it would make some constant-folding optimizations easier and enable hash-consing, but we&rsquo;ll take one step at a time.</p>\n\n<p>— <em>Matthew Flatt, 27 November 2007</em></p>\n\n<hr />\n\n<p>A little late, but &hellip;</p>\n\n<p>Once one acknowledges value of circular/recursive list data, it follows that there is likely value in the native runtime creation of such data as may be used for example to express arbitrarily recursively defined hierarchical information; which beyond the trivial, seems seems like a significant loss to the language to push such capability outside the baseline scope of the language by default.</p>\n\n<p>Yes, such capability may be defined and utilized as required although not as elegantly as if it were native; however it seems a shame to seriously consider alienating the previously native capability to dynamically formulate native list data from datum not known at program specification/compile time (i.e. the ability to formulate and manipulate such list datum from information extracted during run-time, as data bases typically are, can not be performed natively without set-car! set-cdr!, nor specified purely functionally); as the loss of such a potentially powerful and useful capability seems like a poor trade in exchange for the questionable value of default immutable lists, especially as the mutability of function argument can most typically be easily determined within a function, and optimizations applied accordingly, and in the few cases where it can&rsquo;t, so what, presume it may be mutated. (If the concern is limited to map, then simply specify that map&rsquo;s arguments are presumed to not be mutated until terminated, or generally forbidden).</p>\n\n<p>— <em>pschlie, 15 December 2007</em></p>\n\n<hr />\n\n<p>The entire purpose of this experiment was to avoid caveats like &ldquo;seems&rdquo;, &ldquo;likely&rdquo; and &ldquo;potentially&rdquo;. If you have real examples to show, that would be interesting. So far we have far better abstract arguments against mutation than for it, and no concrete experience suggesting it should be brought back.</p>\n\n<p>Also, I should remind you that mcons (and friends) exist, as do mutable structs. These are as &ldquo;native&rdquo; as it gets.</p>\n\n<p>— <em>Robby, 15 December 2007</em></p>\n\n<hr />\n\n<p>Somewhat more concrete:</p>\n\n<ul>\n <li>presume the run-time creation, storage and/or retrieval of arbitrarily recursive list structured data is useful (or please prove otherwise).</li></ul>\n\n<p> (Personally see no value in presenting any particular program utilizing such capabilities, as the potential usefulness of such data structures representing state transition graphs, or more generally arbitrarily self recursive data representations are self evident; just as I see no value in any example given of how list mutation may yield indeterminate behavior in the absents of the specification of evaluation order; as overall the less flexible and deterministic a language is, the less useful it tends to be. Thereby I view dropping native mutable lists in an effort to improve determinism, in effect an attempt to improve a deficiency by removing utility; as opposed to improving its utility, by removing a deficiency.)</p>\n\n<p>Implying:</p>\n\n<ul>\n <li>\n  <p>a facility to create/manipulate such data at run-time is required.</p></li>\n <li>\n  <p>mcons (and friends) are only rudimentarily facilitates, which exclusively operate on a now severely crippled data type because mutable lists have been alienated from the language (incompatible with car and friends) and thereby incompatible with the majority of all native list functions and thereby now require an entirely redundant and largely absent collection of functions to specified to operate on and utilize them (inclusive of their inability to be evaluated as code):</p></li>\n <li>\n  <p>a facility to store and retrieve such data at run-time is required.</p></li>\n <li>\n  <p>as there is no current reader support to denote mutable lists:</p>\n  <ul>\n   <li>\n    <p>(mcons &lsquo;a &rsquo;{b}) -&gt; {a . (b)} ; not {a b} as likely  (cons &lsquo;a &rsquo;(b)) -&gt; (a b) ; expected by analogy</p></li>\n   <li>\n    <p>(define x (mcons &rsquo;+ (mcons 1 (mcons 2 null)))) ; i.e. {+ 1 2}  (with-output-to-file &ldquo;f&rdquo; (lambda () (print x)) &rsquo;text &rsquo;replace)  (with-input-from-file &ldquo;f&rdquo; (lambda () (read)))  =&gt; (+ 1 2) ; wrong</p></li>\n   <li>\n    <p>(define x (mcons 1 null)) (set-mcdr! x x) ; i.e. #0={1 . #0}  (with-output-to-file &ldquo;f&rdquo; (lambda () (print x)) &rsquo;text &rsquo;replace)  (with-input-from-file &ldquo;f&rdquo; (lambda () (read)))  =&gt; #0=(1 . #0#) ; wrong</p></li></ul>\n  <p> [not to mention (define x &rsquo;#0=(1 . #0#)) isn&rsquo;t accepted anymore]</p></li></ul>\n\n<p>So overall, scheme absent mutable lists removes an entire class of capabilities which which was never proven to be useless, in fact arguably known to be otherwise, nor given analogous facilities of comparable utility.</p>\n\n<p>Yes, such facilities may be structured from non-native structured data types and a corresponding new set of support functions; just as in most languages; however scheme was previously unique in that such a capability was inherent. (while were at it, maybe list data types and functions should be removed entirely, as after all, they&rsquo;re not strictly necessary as evidenced by most all other languages).</p>\n\n<p>In hind sight, justifying mutable list removal because large classes of programs do not require them, or that the language&rsquo;s specification may be easier in their absents, or because the contract facility implementation isn&rsquo;t capable determining if list data is in fact potentially mutated; hardly seems reasonable. IMHO</p>\n\n<p>— <em>pschlie, 16 December 2007</em></p>\n\n<hr />\n\n<p>Paul, this is not what I meant by concrete. No one said (or attempted to prove) that mutable cons cells were useless. Indeed, we still support them, but we just do not use them by default anymore.</p>\n\n<p>The comment &ldquo;justifying mutable list removal because large classes of programs do not require them&rdquo; misses half of the problem with mutable lists. The first half of the problem, in fact. Matthew&rsquo;s post clearly explains why mutable lists cause problems in concrete ways and, if you permit me to say so, makes a far more convincing abstract case against mutable pairs than your abstract arguments for them.</p>\n\n<p>But, in any case, these abstract arguments (either way) ultimately need to be backed up with real programs. Let me encourage you once again to provide some to back up your arguments. We have found none in a large body of code. Have you investigated a body of code and found some?</p>\n\n<p>— <em>Robby, 16 December 2007</em></p>\n\n<hr />\n\n<p>The problems you describe with mutability remind me of type-theory where each kind of thing is separated into its own type. Then you can always use the types in conjunction with each other if you need the functionality of both.</p>\n\n<p>For example, if you had the types <code>list</code> and <code>mutable</code> you could distinguish between an immutable list of immutable elements, an immutable list of mutable elements, a mutable list of immutable elements, and so on, and put this in your &ldquo;contract system&rdquo; (whatever that is).</p>\n\n<p>This not only documents the usage of things like mutability, but also allows the compiler (in theory) to check such constraints on inputs and outputs.</p>\n\n<p>When a function like <code>map</code> expects an immutable list, it will simply use the <code>list</code> type without restricting the mutation of elements. But in places where that could be harmful, a different type can be used. The conventional Scheme way of allowing everything to be mutable prevents this separation of distinct properties of values.</p>\n\n<p>I&rsquo;m not too familiar with how Scheme implements things, but the general way this is done is to box things that are mutable.</p>\n\n<p>— <em>Jon T, 28 December 2007</em></p>\n\n<hr />\n\n<p>In another five years or so you&rsquo;ll be where ML was twenty years ago! Better late than never, I suppose, but, really, what is the point?</p>\n\n<p>— <em>Existential Type, 25 January 2008</em></p>\n\n<hr />\n\n<p>&ldquo;Existential Type&rdquo;: your comment begs the exact same reply with macros, except that five years is probably optimistic, and twenty years is an underestimate. Or type reflection that maybe some day will get ML some of the advantages of Scheme.</p>\n\n<p>(But this is, of course, a pointless flame, just like your comment. FWIW, the main issue is legacy code, and switching to Scheme with immutable lists is slightly easier than switching to ML. At least for us Scheme freaks.)</p>\n\n<p>— <em>Eli Barzilay, 25 January 2008</em></p>\n\n<hr />\n\n<p>The conversion of my code took less than a day (about 10000 lines, a guess, for I never counted the nr of lines) There are two types of instances in which I used set-cdr!: for assoclists and imperative queues. Assoclists now have become immutable lists of mutable pairs with a hybrid-assq procedure added. The imperative queues remain mutable lists, the cdr of the last pair being the only one being updated. My code did not contain anything like append! or reverse!. I found no trouble in swithing to v3.99.0.9. I say yes to the better conditions for optimization. Jos Koot</p>\n\n<p>— <em>jos koot, 26 January 2008</em></p>\n\n<hr />\n\n<p>Eli, you seem forget that all Scheme fits into tiny corner of ML, namely a single recursive datatype.</p>\n\n<p>— <em>Existential Type, 26 January 2008</em></p>\n\n<hr />\n\n<p>Eli, I agree with you about the pointlessness of an ML-vs-Scheme flame war. Can you be more explicit about what you mean by &ldquo;type reflection&rdquo;? That sounds interesting, but I have no idea what you&rsquo;re talking about.</p>\n\n<p>— <em>Michael, 26 January 2008</em></p>\n\n<hr />\n\n<p>Existential Type: From this side of the fence I can say that Scheme covers all of ML, with all types that were and will be written. But this is a second pointless flame, and still irrelevant to the context. I could just as well point at the many limitations of ML types (eg, what&rsquo;s the real type of map? sqrt? printf? collatz? GetFunction(&ldquo;foo&rdquo;,\"bar.dll\")?). But that&rsquo;s not going to do any good, so I&rsquo;ll stop replying. Feel free to continue on the PLT list, or email me.</p>\n\n<p>Michael: I&rsquo;m talking about several efforts that attempt to get the benefits of a dynamic language into a static language like ML. There was some work done on reflecting types (or reifying types) which makes it possible to sort of package a value together with a type object (in the run-time sense; it becomes a value). IIRC, there was also something related to universal types that goes in the same direction.</p>\n\n<p>Personally, I found that MLers who blindly bash Scheme for it&rsquo;s lack of types are just as bad as Schemers who blindly bash all static typing. IMO (and in the opinion of many other good people I&rsquo;ve talked to) there are very good advantages on both sides &mdash; and the real challenge is to get dynamic languages like Scheme to benefit from the advantages of statically typed languages like ML, and vice versa. Some people choose to work on just that (from either side), some people don&rsquo;t but appreciate those who do, and some people will inevitably continue to spit out useless comments even in a completely unrelated context, like the above anonymous poster.</p>\n\n<p>— <em>Eli Barzilay, 26 January 2008</em></p>\n\n<hr />\n\n<p>Don&rsquo;t you just love it when language maintainers drop a feature because someone, somewhere, might misuse it?</p>\n\n<p>What&rsquo;s next? Dropping the number zero, because it can cause a divide-by-zero error?</p>\n\n<p>I&rsquo;m de-installing PLT today and switching to an implementation which doesn&rsquo;t think I&rsquo;m an idiot.</p>\n\n<p>— <em>T., 24 June 2008</em></p>\n\n<hr />\n\n<p>T: In fact, <em>most</em> modern languages dropped the number zero as a pointer. Most languages also restrict you from using a ton of other features, so which implementation are you going to install: C? assembler? maybe you&rsquo;ll get a soldering iron?</p>\n\n<p>— <em>Eli Barzilay, 24 June 2008</em></p>\n\n<hr />\n\n<p>T: You do realize, don&rsquo;t you, that set-car! and set-cdr! are still available in PLT Scheme 4.0, only as a library instead of as a built-in feature? Given that, I don&rsquo;t see what you are so upset about. You&rsquo;re free to use set-car! and set-cdr! as much as you want.</p>\n\n<p>— <em>Michael Vanier, 24 June 2008</em></p>\n\n<hr />\n\n<p>I know this is an old, and probably dead thread, but I did want to respond to one post.</p>\n\n<p>&mdash;-Quote&mdash;- Robby said&hellip; &hellip;  But, in any case, these abstract arguments (either way) ultimately need to be backed up with real programs. Let me encourage you once again to provide some to back up your arguments. We have found none in a large body of code. Have you investigated a body of code and found some?  December 16, 2007 6:56 PM  &mdash;-End Quote&mdash;-</p>\n\n<p>Over 25 years ago, I used set-cdr! in a PC Scheme implementation of N-Queens for an AI class. Besides using set-cdr!, calls to move a queen were properly tail recursive. I noticed the PLT Scheme benchmark didn&rsquo;t use tail recursion for moves, so I modified my code to match the benchmark. The following times compare the improvements for just using set-cdr! and for using set-cdr! combined with tail recursion:</p>\n\n<p>PLT Scheme Benchmark: &gt; (begin (collect-garbage) (time (nqueens 15))) cpu time: 158899 real time: 158982 gc time: 16920 2279184 (execution time = cpu time - gc time = 142.0s)</p>\n\n<p>set-cdr! version: &gt; (begin (collect-garbage) (time (N-Queens 15))) cpu time: 138616 real time: 138787 gc time: 3286 2279184 (execution time = cpu time - gc time = 135.3s)</p>\n\n<p>set-cdr! plus properly tail recursive moves: &gt; (begin (collect-garbage) (time (N-Queens 15))) cpu time: 119845 real time: 120061 gc time: 3284 2279184 (execution time = cpu time - gc time = 116.5s)</p>\n\n<p>As you can see, using set-cdr! improved overall cpu time by about the same amount as using properly tail recursive moves. The major performance improvement for set-cdr! came from reduced garbage collection. N-Queens is just one example of back-tracking used to traverse a search space. Any time the search space can be pruned before the back-tracking call is made, and restored on return from the call, set-cdr! should yield improved performance. It&rsquo;s also very localized, as shown by the following code snippet:</p>\n\n<p>(else ..(set-mcdr! prior-column (mcdr column)) ..(begin0 &hellip;.(place&amp;move safe-columns &hellip;&hellip;&hellip;..(mcdr safe-columns) safe-columns &hellip;&hellip;&hellip;..(cons (mcar column) solution) count) &hellip;.(set-mcdr! prior-column column))))))</p>\n\n<p>In the above example, prior-column and column traverse the list, while safe-columns always points to it&rsquo;s beginning. The list is never copied, just manipulated with set-mcdr! as the search space is traversed. Also, the list goes from 0 to N to simplify handling prior-column.</p>\n\n<p>Gene Snider</p>\n\n<p>— <em>Gene Snider, 27 January 2010</em></p>\n\n<hr />\n\n<p>Way to go PLT Scheme 4.x. You&rsquo;ve just made it impossible for me to use your Scheme to work through the exercises in The Scheme Programming Language (4th edition) &mdash; see for example Exercise 2.9.3 on page 55.</p>\n\n<p>As if learning a language like Scheme isn&rsquo;t hard enough for us poor suckers trying to break out of the imperative/object world. Do you really have to add yet more beautiful impediments?</p>\n\n<p>— <em>Mike Taylor, 14 April 2010</em></p>\n\n<hr />\n\n<p>Mike, mcons, mcar, mcdr, set-mcar!, and set-mcdr! are provided by scheme already. Just add (require scheme/mpair) to your definitions to get more mutable pair functionality. You will need to use slightly different function names, e.g. mlist, mlength, etc. The /scheme/mpair module is well documented.</p>\n\n<p>When I first wrote N-Queens, returning the solutions was a requirement. So naturally I built the solutions with cons for later return. After my earlier post, I realized that two additional lines of code would eliminate all cons operations. Now, it doesn&rsquo;t garbage collect until N = 17:</p>\n\n<blockquote>\n <p>(begin (collect-garbage) (time (N-Queens 17))) cpu time: 6670485 real time: 6702624 gc time: 618 95815104 618ms time in gc while taking 1 hour and 51 minutes to determine 95,815,104 solutions isn&rsquo;t bad.</p></blockquote>\n\n<p>The key is: (else ..(set-mcdr! prior-column (mcdr column)) ..(set-mcdr! column solution) ..(begin0 &hellip;.(next-queen safe-columns column new-count) &hellip;.(set-mcdr! column (mcdr prior-column)) &hellip;.(set-mcdr! prior-column column)))</p>\n\n<p>Gene</p>\n\n<p>— <em>Gene Snider, 13 May 2010</em></p>\n\n<hr />")) ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2009-05-18-the-two-state-solution-native-and-serializable-continuations-in-the-plt-web-server.md" . unix) f post (u . "The Two State Solution: Native and Serializable Continuations in the PLT Web Server") (? . 28) 1467223812 (p+ #"/Users/MB/git/racket-lang-org/blog/2009/05/the-two-state-solution-native-and-serializable-continuations-in-the-plt-web-server.html" . unix) "/2009/05/the-two-state-solution-native-and-serializable-continuations-in-the-plt-web-server.html" (u . "2009-05-18T16:48:00.000-04:00") (? . 27) (? . 76) (c (u . "")) (u . "\n<p><em>posted by Jay McCarthy</em></p>\n\n<p>One of the annoyance of the <a href=\"http://docs.plt-scheme.org/web-server/stateless.html\">stateless Web application</a> language that comes with the PLT Web Server is that you can&rsquo;t call <em>third-party higher-order library procedures with arguments that try to capture serializable continuations</em>. (I know, you try to do that all the time.) For example:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"nb\">build-list</span>\n <span class=\"mi\">3</span>\n <span class=\"p\">(</span><span class=\"k\">lambda</span> <span class=\"p\">(</span><span class=\"n\">i</span><span class=\"p\">)</span>\n   <span class=\"p\">(</span><span class=\"n\">call-with-serializable-current-continuation</span>\n    <span class=\"p\">(</span><span class=\"k\">lambda</span> <span class=\"p\">(</span><span class=\"n\">k</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"n\">serialize</span> <span class=\"n\">k</span><span class=\"p\">)))))</span>\n</pre></div>\n\n</div>\n\n<p>The problem is that the stateless language performs a transformation on your program to extract the continuations into a serializable representation. If you really need to do this, we&rsquo;ve developed a compromise called &ldquo;The Two State Solution&rdquo;: one state on the client and the other on the server. Only the third-party parts of the continuation (in this case, the code inside <code>build-list</code>) are stored on the server; everything else is shipped to the client. You just need to annotate your code slightly to indicate where the transition is:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"n\">serial-&gt;native</span>\n <span class=\"p\">(</span><span class=\"nb\">build-list</span>\n  <span class=\"mi\">3</span>\n  <span class=\"p\">(</span><span class=\"k\">lambda</span> <span class=\"p\">(</span><span class=\"n\">i</span><span class=\"p\">)</span>\n    <span class=\"p\">(</span><span class=\"n\">native-&gt;serial</span>\n     <span class=\"p\">(</span><span class=\"n\">call-with-serializable-current-continuation</span>\n      <span class=\"p\">(</span><span class=\"k\">lambda</span> <span class=\"p\">(</span><span class=\"n\">k</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"n\">serialize</span> <span class=\"n\">k</span><span class=\"p\">)))))))</span>\n</pre></div>\n\n</div>\n\n<p><code>serial-&gt;native</code> signals the transition to the third-party and <code>native-&gt;serial</code> signals the transition back.</p>\n\n<p>It is still a little annoying to find when you&rsquo;ve called these <em>third-party higher-order library procedures with arguments that try to capture serializable continuations</em>, so there&rsquo;s a simple macro that provides a transitioning wrapper for you:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"n\">define-native</span> <span class=\"p\">(</span><span class=\"n\">build-list/native</span> <span class=\"k\">_</span> <span class=\"n\">ho</span><span class=\"p\">)</span> <span class=\"nb\">build-list</span><span class=\"p\">)</span>\n</pre></div>\n\n</div>\n\n<p>expands to:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">build-list/native</span> <span class=\"n\">fst</span> <span class=\"n\">snd</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"n\">serial-&gt;native</span>\n   <span class=\"p\">(</span><span class=\"nb\">build-list</span>\n    <span class=\"n\">fst</span>\n    <span class=\"p\">(</span><span class=\"k\">lambda</span> <span class=\"n\">args</span>\n      <span class=\"p\">(</span><span class=\"n\">native-&gt;serial</span>\n       <span class=\"p\">(</span><span class=\"nb\">apply</span> <span class=\"n\">snd</span> <span class=\"n\">args</span><span class=\"p\">))))))</span>\n</pre></div>\n\n</div>\n\n<p>This new feature is documented in the <a href=\"http://faculty.cs.byu.edu/~jay/plt-doc/web-server/stateless.html#(part._.Serializable_.Continuations)\">online manual</a>, of course.</p>") #f (u . "\n<p><em>posted by Jay McCarthy</em></p>\n\n<p>One of the annoyance of the <a href=\"http://docs.plt-scheme.org/web-server/stateless.html\">stateless Web application</a> language that comes with the PLT Web Server is that you can&rsquo;t call <em>third-party higher-order library procedures with arguments that try to capture serializable continuations</em>. (I know, you try to do that all the time.) For example:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"nb\">build-list</span>\n <span class=\"mi\">3</span>\n <span class=\"p\">(</span><span class=\"k\">lambda</span> <span class=\"p\">(</span><span class=\"n\">i</span><span class=\"p\">)</span>\n   <span class=\"p\">(</span><span class=\"n\">call-with-serializable-current-continuation</span>\n    <span class=\"p\">(</span><span class=\"k\">lambda</span> <span class=\"p\">(</span><span class=\"n\">k</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"n\">serialize</span> <span class=\"n\">k</span><span class=\"p\">)))))</span>\n</pre></div>\n\n</div>\n\n<p>The problem is that the stateless language performs a transformation on your program to extract the continuations into a serializable representation. If you really need to do this, we&rsquo;ve developed a compromise called &ldquo;The Two State Solution&rdquo;: one state on the client and the other on the server. Only the third-party parts of the continuation (in this case, the code inside <code>build-list</code>) are stored on the server; everything else is shipped to the client. You just need to annotate your code slightly to indicate where the transition is:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"n\">serial-&gt;native</span>\n <span class=\"p\">(</span><span class=\"nb\">build-list</span>\n  <span class=\"mi\">3</span>\n  <span class=\"p\">(</span><span class=\"k\">lambda</span> <span class=\"p\">(</span><span class=\"n\">i</span><span class=\"p\">)</span>\n    <span class=\"p\">(</span><span class=\"n\">native-&gt;serial</span>\n     <span class=\"p\">(</span><span class=\"n\">call-with-serializable-current-continuation</span>\n      <span class=\"p\">(</span><span class=\"k\">lambda</span> <span class=\"p\">(</span><span class=\"n\">k</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"n\">serialize</span> <span class=\"n\">k</span><span class=\"p\">)))))))</span>\n</pre></div>\n\n</div>\n\n<p><code>serial-&gt;native</code> signals the transition to the third-party and <code>native-&gt;serial</code> signals the transition back.</p>\n\n<p>It is still a little annoying to find when you&rsquo;ve called these <em>third-party higher-order library procedures with arguments that try to capture serializable continuations</em>, so there&rsquo;s a simple macro that provides a transitioning wrapper for you:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"n\">define-native</span> <span class=\"p\">(</span><span class=\"n\">build-list/native</span> <span class=\"k\">_</span> <span class=\"n\">ho</span><span class=\"p\">)</span> <span class=\"nb\">build-list</span><span class=\"p\">)</span>\n</pre></div>\n\n</div>\n\n<p>expands to:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">build-list/native</span> <span class=\"n\">fst</span> <span class=\"n\">snd</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"n\">serial-&gt;native</span>\n   <span class=\"p\">(</span><span class=\"nb\">build-list</span>\n    <span class=\"n\">fst</span>\n    <span class=\"p\">(</span><span class=\"k\">lambda</span> <span class=\"n\">args</span>\n      <span class=\"p\">(</span><span class=\"n\">native-&gt;serial</span>\n       <span class=\"p\">(</span><span class=\"nb\">apply</span> <span class=\"n\">snd</span> <span class=\"n\">args</span><span class=\"p\">))))))</span>\n</pre></div>\n\n</div>\n\n<p>This new feature is documented in the <a href=\"http://faculty.cs.byu.edu/~jay/plt-doc/web-server/stateless.html#(part._.Serializable_.Continuations)\">online manual</a>, of course.</p>")) ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2012-08-24-fully-inlined-merge-sort.md" . unix) f post (u . "Fully Inlined Merge Sort") (? . 115) 1467223812 (p+ #"/Users/MB/git/racket-lang-org/blog/2012/08/fully-inlined-merge-sort.html" . unix) "/2012/08/fully-inlined-merge-sort.html" (u . "2012-08-24T16:52:00.001-04:00") (? . 96) (? . 30) (c (u . "")) (u . "\n<p><em>posted by Neil Toronto</em></p>\n\n<p>While writing the code for the <a href=\"http://en.wikipedia.org/wiki/Triangular_distribution\">triangular distribution</a> in the upcoming math library, I found that I needed a function that sorts exactly three numbers. This kind of code is annoying to write and to get right. But it comes up rarely enough, and it seems simple enough, that I’ve never felt like making a library function for it.</p>\n\n<p>But what if I wrote a macro that generated code to sort n numbers very quickly, where n is known at expansion time, but the numbers themselves aren’t? I think I could justify putting that in a library.</p>\n\n<p>Here’s code that correctly sorts three numbers a, b and c:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"nb\">&lt;</span> <span class=\"n\">b</span> <span class=\"n\">c</span><span class=\"p\">)</span>\n    <span class=\"p\">(</span><span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"nb\">&lt;</span> <span class=\"n\">a</span> <span class=\"n\">b</span><span class=\"p\">)</span>\n        <span class=\"p\">(</span><span class=\"nb\">values</span> <span class=\"n\">a</span> <span class=\"n\">b</span> <span class=\"n\">c</span><span class=\"p\">)</span>\n        <span class=\"p\">(</span><span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"nb\">&lt;</span> <span class=\"n\">a</span> <span class=\"n\">c</span><span class=\"p\">)</span>\n            <span class=\"p\">(</span><span class=\"nb\">values</span> <span class=\"n\">b</span> <span class=\"n\">a</span> <span class=\"n\">c</span><span class=\"p\">)</span>\n            <span class=\"p\">(</span><span class=\"nb\">values</span> <span class=\"n\">b</span> <span class=\"n\">c</span> <span class=\"n\">a</span><span class=\"p\">)))</span>\n    <span class=\"p\">(</span><span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"nb\">&lt;</span> <span class=\"n\">a</span> <span class=\"n\">c</span><span class=\"p\">)</span>\n        <span class=\"p\">(</span><span class=\"nb\">values</span> <span class=\"n\">a</span> <span class=\"n\">c</span> <span class=\"n\">b</span><span class=\"p\">)</span>\n        <span class=\"p\">(</span><span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"nb\">&lt;</span> <span class=\"n\">a</span> <span class=\"n\">b</span><span class=\"p\">)</span>\n            <span class=\"p\">(</span><span class=\"nb\">values</span> <span class=\"n\">c</span> <span class=\"n\">a</span> <span class=\"n\">b</span><span class=\"p\">)</span>\n            <span class=\"p\">(</span><span class=\"nb\">values</span> <span class=\"n\">c</span> <span class=\"n\">b</span> <span class=\"n\">a</span><span class=\"p\">))))</span>\n</pre></div>\n\n</div>\n\n<p>It’s an if tree. Notice that there are 6 leaf expressions, for the 3! = 6 possible permutations. Also, it never compares more than it has to. It’s optimal.The optimality came from my reasoning about transitivity. For example, only two comparisons are needed before returning (values a b c). I knew that both (&lt; a b) and (&lt; b c), so (&lt; a b c) must be true by transitivity.</p>\n\n<p>It would be nice if the macro generated optimal code by explicitly reasoning about transitivity, or as an emergent property of the sorting algorithm it uses.</p>\n\n<p>We’ll write a macro that does the latter, by generating a fully inlined merge sort.</p>\n\n<p>[Edit: The final inline sort macro is <a href=\"https://gist.github.com/3456604\">here</a>.]</p>\n\n<h2 id=\"runtime-merge-sort\">Runtime Merge Sort</h2>\n\n<p>Start with a simple, runtime merge sort:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">merge</span> <span class=\"n\">as</span> <span class=\"n\">bs</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"k\">match*</span> <span class=\"p\">(</span><span class=\"n\">as</span> <span class=\"n\">bs</span><span class=\"p\">)</span>\n    <span class=\"p\">[((</span><span class=\"nb\">list</span><span class=\"p\">)</span> <span class=\"n\">bs</span><span class=\"p\">)</span>  <span class=\"n\">bs</span><span class=\"p\">]</span>\n    <span class=\"p\">[(</span><span class=\"n\">as</span> <span class=\"p\">(</span><span class=\"nb\">list</span><span class=\"p\">))</span>  <span class=\"n\">as</span><span class=\"p\">]</span>\n    <span class=\"p\">[((</span><span class=\"nb\">list</span> <span class=\"n\">a</span> <span class=\"n\">as</span> <span class=\"k\">...</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"nb\">list</span> <span class=\"n\">b</span> <span class=\"n\">bs</span> <span class=\"k\">...</span><span class=\"p\">))</span>\n     <span class=\"p\">(</span><span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"nb\">&lt;</span> <span class=\"n\">a</span> <span class=\"n\">b</span><span class=\"p\">)</span>\n         <span class=\"p\">(</span><span class=\"nb\">cons</span> <span class=\"n\">a</span> <span class=\"p\">(</span><span class=\"n\">merge</span> <span class=\"n\">as</span> <span class=\"p\">(</span><span class=\"nb\">cons</span> <span class=\"n\">b</span> <span class=\"n\">bs</span><span class=\"p\">)))</span>\n         <span class=\"p\">(</span><span class=\"nb\">cons</span> <span class=\"n\">b</span> <span class=\"p\">(</span><span class=\"n\">merge</span> <span class=\"p\">(</span><span class=\"nb\">cons</span> <span class=\"n\">a</span> <span class=\"n\">as</span><span class=\"p\">)</span> <span class=\"n\">bs</span><span class=\"p\">)))]))</span>\n \n<span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">merge-sort</span> <span class=\"n\">vs</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"k\">match</span> <span class=\"n\">vs</span>\n    <span class=\"p\">[(</span><span class=\"nb\">list</span><span class=\"p\">)</span>  <span class=\"n\">vs</span><span class=\"p\">]</span>\n    <span class=\"p\">[(</span><span class=\"nb\">list</span> <span class=\"n\">a</span><span class=\"p\">)</span>  <span class=\"n\">vs</span><span class=\"p\">]</span>\n    <span class=\"p\">[</span><span class=\"k\">_</span>  <span class=\"p\">(</span><span class=\"k\">define-values</span> <span class=\"p\">(</span><span class=\"n\">lvs</span> <span class=\"n\">rvs</span><span class=\"p\">)</span>\n          <span class=\"p\">(</span><span class=\"nb\">split-at</span> <span class=\"n\">vs</span> <span class=\"p\">(</span><span class=\"nb\">quotient</span> <span class=\"p\">(</span><span class=\"nb\">length</span> <span class=\"n\">vs</span><span class=\"p\">)</span> <span class=\"mi\">2</span><span class=\"p\">)))</span>\n        <span class=\"p\">(</span><span class=\"n\">merge</span> <span class=\"p\">(</span><span class=\"n\">merge-sort</span> <span class=\"n\">lvs</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"n\">merge-sort</span> <span class=\"n\">rvs</span><span class=\"p\">))]))</span>\n</pre></div>\n\n</div>\n\n<p>Example:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"nb\">&gt;</span> <span class=\"p\">(</span><span class=\"n\">merge-sort</span> <span class=\"o\">&#39;</span><span class=\"p\">(</span><span class=\"mi\">5</span> <span class=\"mi\">1</span> <span class=\"mi\">2</span> <span class=\"mi\">5</span> <span class=\"mi\">10</span><span class=\"p\">))</span>\n<span class=\"o\">&#39;</span><span class=\"p\">(</span><span class=\"mi\">1</span> <span class=\"mi\">2</span> <span class=\"mi\">5</span> <span class=\"mi\">5</span> <span class=\"mi\">10</span><span class=\"p\">)</span>\n</pre></div>\n\n</div>\n\n<p>To make a macro out of merge sort, we need to change two things. The most obvious is that it has to return syntax for an if instead of evaluating it. That’s easy for a novice macrologist: change the functions to operate on syntax, stick a syntax-quasiquote in front of the if, and unquote the bits inside that get evaluated at expansion time.</p>\n\n<p>But if we did only that, we’d end up with expanded code like this:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"nb\">&lt;</span> <span class=\"n\">a</span> <span class=\"n\">b</span><span class=\"p\">)</span>\n    <span class=\"p\">(</span><span class=\"nb\">cons</span> <span class=\"n\">a</span> <span class=\"p\">(</span><span class=\"k\">if</span> <span class=\"k\">...</span><span class=\"p\">))</span>\n    <span class=\"p\">(</span><span class=\"nb\">cons</span> <span class=\"n\">b</span> <span class=\"p\">(</span><span class=\"k\">if</span> <span class=\"k\">...</span><span class=\"p\">)))</span>\n</pre></div>\n\n</div>\n\n<p>It would be slow because cons allocates. We want the code to be fast.So the other change is to move the conses inside the ifs, and evaluate them at expansion time. We can then construct a values expression out of the resulting list.</p>\n\n<h2 id=\"accumulator-passing-style-wont-work\">Accumulator-Passing Style Won’t Work</h2>\n\n<p> Novice functional programmers should know that accumulator-passing style (APS) moves conses inward. For example, this “add 1 to each element” function:</p>\n\n<p> <code>racket\n (define (list-add1 vs)\n  (match vs\n    [(list)  (list)]\n    [(list v vs ...)\n     (cons (add1 v) (list-add1 vs))]))</code></p>\n\n<p>becomes this after conversion to APS:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">list-add1/acc</span> <span class=\"n\">vs</span> <span class=\"p\">[</span><span class=\"n\">acc</span> <span class=\"p\">(</span><span class=\"nb\">list</span><span class=\"p\">)])</span>\n  <span class=\"p\">(</span><span class=\"k\">match</span> <span class=\"n\">vs</span>\n    <span class=\"p\">[(</span><span class=\"nb\">list</span><span class=\"p\">)</span>  <span class=\"p\">(</span><span class=\"nb\">reverse</span> <span class=\"n\">acc</span><span class=\"p\">)]</span>\n    <span class=\"p\">[(</span><span class=\"nb\">list</span> <span class=\"n\">v</span> <span class=\"n\">vs</span> <span class=\"k\">...</span><span class=\"p\">)</span>\n     <span class=\"p\">(</span><span class=\"n\">list-add1/acc</span> <span class=\"n\">vs</span> <span class=\"p\">(</span><span class=\"nb\">cons</span> <span class=\"p\">(</span><span class=\"nb\">add1</span> <span class=\"n\">v</span><span class=\"p\">)</span> <span class=\"n\">acc</span><span class=\"p\">))]))</span>\n</pre></div>\n\n</div>\n\n<p>Now cons is where we want it: inside the recursive call, instead of in tail position. The problem is that APS doesn’t work on tree-shaped recursion.</p>\n\n<h2 id=\"continuation-passing-style-does-work\">Continuation-Passing Style Does Work</h2>\n\n<p>In continuation-passing style (CPS), we pass a continuation k—i.e. “what happens next”— instead of an accumulator. The functions call k instead of returning values. For example:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">list-add1/k</span> <span class=\"n\">vs</span> <span class=\"p\">[</span><span class=\"n\">k</span> <span class=\"nb\">identity</span><span class=\"p\">])</span>\n  <span class=\"p\">(</span><span class=\"k\">match</span> <span class=\"n\">vs</span>\n    <span class=\"p\">[(</span><span class=\"nb\">list</span><span class=\"p\">)</span>  <span class=\"p\">(</span><span class=\"n\">k</span> <span class=\"p\">(</span><span class=\"nb\">list</span><span class=\"p\">))]</span>\n    <span class=\"p\">[(</span><span class=\"nb\">list</span> <span class=\"n\">v</span> <span class=\"n\">vs</span> <span class=\"k\">...</span><span class=\"p\">)</span>\n     <span class=\"p\">(</span><span class=\"n\">list-add1/k</span> <span class=\"n\">vs</span> <span class=\"p\">(</span><span class=\"k\">λ</span> <span class=\"p\">(</span><span class=\"n\">vs</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"n\">k</span> <span class=\"p\">(</span><span class=\"nb\">cons</span> <span class=\"p\">(</span><span class=\"nb\">add1</span> <span class=\"n\">v</span><span class=\"p\">)</span> <span class=\"n\">vs</span><span class=\"p\">))))]))</span>\n</pre></div>\n\n</div>\n\n<p>If we want, we can pass something besides identity as the base-case continuation:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"nb\">&gt;</span> <span class=\"p\">(</span><span class=\"n\">list-add1/k</span> <span class=\"o\">&#39;</span><span class=\"p\">(</span><span class=\"mi\">1</span> <span class=\"mi\">2</span> <span class=\"mi\">3</span> <span class=\"mi\">4</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"k\">λ</span> <span class=\"p\">(</span><span class=\"n\">vs</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"nb\">apply</span> <span class=\"nb\">values</span> <span class=\"n\">vs</span><span class=\"p\">)))</span>\n<span class=\"mi\">2</span>\n<span class=\"mi\">3</span>\n<span class=\"mi\">4</span>\n<span class=\"mi\">5</span>\n</pre></div>\n\n</div>\n\n<p>CPS turns every call into a tail call, so it moves conses inward even with tree-shaped recursion. As a demonstration, here’s a CPSed merge sort:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">merge/k</span> <span class=\"n\">as</span> <span class=\"n\">bs</span> <span class=\"n\">k</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"k\">match*</span> <span class=\"p\">(</span><span class=\"n\">as</span> <span class=\"n\">bs</span><span class=\"p\">)</span>\n    <span class=\"p\">[((</span><span class=\"nb\">list</span><span class=\"p\">)</span> <span class=\"n\">bs</span><span class=\"p\">)</span>  <span class=\"p\">(</span><span class=\"n\">k</span> <span class=\"n\">bs</span><span class=\"p\">)]</span>\n    <span class=\"p\">[(</span><span class=\"n\">as</span> <span class=\"p\">(</span><span class=\"nb\">list</span><span class=\"p\">))</span>  <span class=\"p\">(</span><span class=\"n\">k</span> <span class=\"n\">as</span><span class=\"p\">)]</span>\n    <span class=\"p\">[((</span><span class=\"nb\">list</span> <span class=\"n\">a</span> <span class=\"n\">as</span> <span class=\"k\">...</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"nb\">list</span> <span class=\"n\">b</span> <span class=\"n\">bs</span> <span class=\"k\">...</span><span class=\"p\">))</span>\n     <span class=\"p\">(</span><span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"nb\">&lt;</span> <span class=\"n\">a</span> <span class=\"n\">b</span><span class=\"p\">)</span>\n         <span class=\"p\">(</span><span class=\"n\">merge/k</span> <span class=\"n\">as</span> <span class=\"p\">(</span><span class=\"nb\">cons</span> <span class=\"n\">b</span> <span class=\"n\">bs</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"k\">λ</span> <span class=\"p\">(</span><span class=\"n\">vs</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"n\">k</span> <span class=\"p\">(</span><span class=\"nb\">cons</span> <span class=\"n\">a</span> <span class=\"n\">vs</span><span class=\"p\">))))</span>\n         <span class=\"p\">(</span><span class=\"n\">merge/k</span> <span class=\"p\">(</span><span class=\"nb\">cons</span> <span class=\"n\">a</span> <span class=\"n\">as</span><span class=\"p\">)</span> <span class=\"n\">bs</span> <span class=\"p\">(</span><span class=\"k\">λ</span> <span class=\"p\">(</span><span class=\"n\">vs</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"n\">k</span> <span class=\"p\">(</span><span class=\"nb\">cons</span> <span class=\"n\">b</span> <span class=\"n\">vs</span><span class=\"p\">)))))]))</span>\n \n<span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">merge-sort/k</span> <span class=\"n\">vs</span> <span class=\"n\">k</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"k\">match</span> <span class=\"n\">vs</span>\n    <span class=\"p\">[(</span><span class=\"nb\">list</span><span class=\"p\">)</span>  <span class=\"p\">(</span><span class=\"n\">k</span> <span class=\"n\">vs</span><span class=\"p\">)]</span>\n    <span class=\"p\">[(</span><span class=\"nb\">list</span> <span class=\"n\">a</span><span class=\"p\">)</span>  <span class=\"p\">(</span><span class=\"n\">k</span> <span class=\"n\">vs</span><span class=\"p\">)]</span>\n    <span class=\"p\">[</span><span class=\"k\">_</span>  <span class=\"p\">(</span><span class=\"k\">define-values</span> <span class=\"p\">(</span><span class=\"n\">lvs</span> <span class=\"n\">rvs</span><span class=\"p\">)</span>\n          <span class=\"p\">(</span><span class=\"nb\">split-at</span> <span class=\"n\">vs</span> <span class=\"p\">(</span><span class=\"nb\">quotient</span> <span class=\"p\">(</span><span class=\"nb\">length</span> <span class=\"n\">vs</span><span class=\"p\">)</span> <span class=\"mi\">2</span><span class=\"p\">)))</span>\n        <span class=\"p\">(</span><span class=\"n\">merge-sort/k</span>\n         <span class=\"n\">lvs</span> <span class=\"p\">(</span><span class=\"k\">λ</span> <span class=\"p\">(</span><span class=\"n\">lvs</span><span class=\"p\">)</span>\n               <span class=\"p\">(</span><span class=\"n\">merge-sort/k</span>\n                <span class=\"n\">rvs</span> <span class=\"p\">(</span><span class=\"k\">λ</span> <span class=\"p\">(</span><span class=\"n\">rvs</span><span class=\"p\">)</span>\n                      <span class=\"p\">(</span><span class=\"n\">merge/k</span> <span class=\"n\">lvs</span> <span class=\"n\">rvs</span> <span class=\"n\">k</span><span class=\"p\">)))))]))</span>\n</pre></div>\n\n</div>\n\n<p>You can read the last expression in merge-sort/k as, “Sort lvs. Then, with the sorted lvs, sort rvs. Then, with the sorted rvs, merge lvs and rvs.” Example:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"nb\">&gt;</span> <span class=\"p\">(</span><span class=\"n\">merge-sort/k</span> <span class=\"o\">&#39;</span><span class=\"p\">(</span><span class=\"mi\">5</span> <span class=\"mi\">2</span> <span class=\"mi\">3</span> <span class=\"mi\">1</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"k\">λ</span> <span class=\"p\">(</span><span class=\"n\">vs</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"nb\">apply</span> <span class=\"nb\">values</span> <span class=\"n\">vs</span><span class=\"p\">)))</span>\n<span class=\"mi\">1</span>\n<span class=\"mi\">2</span>\n<span class=\"mi\">3</span>\n<span class=\"mi\">5</span>\n</pre></div>\n\n</div>\n\n<h2 id=\"the-inline-sort-macro\">The Inline Sort Macro</h2>\n\n<p>When we macro-ize the CPSed merge sort, we’ll turn the continuations into expansion-time functions. So not only will macro-ized CPS move conses inward, it’ll apply them all at expansion time!</p>\n\n<p>We’ll do it in three parts: the user-facing macro, the inline merge function, and the inline sort function.</p>\n\n<h2 id=\"the-user-facing-macro\">The User-Facing Macro</h2>\n\n<p>Let’s put a nice face on inline sorting:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">define-syntax</span> <span class=\"p\">(</span><span class=\"n\">inline-sort</span> <span class=\"n\">stx</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"k\">syntax-case</span> <span class=\"n\">stx</span> <span class=\"p\">()</span>\n    <span class=\"p\">[(</span><span class=\"k\">_</span> <span class=\"n\">lst</span> <span class=\"k\">...</span><span class=\"p\">)</span>\n     <span class=\"p\">(</span><span class=\"k\">with-syntax</span> <span class=\"p\">([(</span><span class=\"n\">vs</span> <span class=\"k\">...</span><span class=\"p\">)</span>\n                    <span class=\"p\">(</span><span class=\"nb\">generate-temporaries</span> <span class=\"o\">#&#39;</span><span class=\"p\">(</span><span class=\"n\">lst</span> <span class=\"k\">...</span><span class=\"p\">))])</span>\n       <span class=\"o\">#`</span><span class=\"p\">(</span><span class=\"k\">let</span> <span class=\"p\">([</span><span class=\"n\">vs</span> <span class=\"n\">lst</span><span class=\"p\">]</span> <span class=\"k\">...</span><span class=\"p\">)</span>\n           <span class=\"o\">#,</span><span class=\"p\">(</span><span class=\"n\">inline-sort/k</span> <span class=\"o\">#&#39;</span><span class=\"p\">(</span><span class=\"n\">vs</span> <span class=\"k\">...</span><span class=\"p\">)</span>\n                            <span class=\"p\">(</span><span class=\"k\">λ</span> <span class=\"p\">(</span><span class=\"n\">vs</span><span class=\"p\">)</span> <span class=\"o\">#`</span><span class=\"p\">(</span><span class=\"nb\">values</span> <span class=\"o\">#,@</span><span class=\"n\">vs</span><span class=\"p\">)))))]))</span>\n</pre></div>\n\n</div>\n\n<p>This macro does two things. First, it names the values to be sorted, so they don’t get re-evaluated every time they’re compared. Second, it calls inline-sort/k with a base-case continuation that converts syntax lists to values expressions.Note that the call #,(inline-sort/k &hellip;) happens at expansion time, and that the continuation (λ (vs) &hellip;) it passes is an expansion-time value.</p>\n\n<h2 id=\"the-inline-merge-function\">The Inline Merge Function</h2>\n\n<p>Changing merge/k to operate on syntax at expansion time is as straightforward as possible:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">define-for-syntax</span> <span class=\"p\">(</span><span class=\"n\">inline-merge/k</span> <span class=\"n\">as</span> <span class=\"n\">bs</span> <span class=\"n\">k</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"k\">syntax-case</span> <span class=\"p\">(</span><span class=\"nb\">list</span> <span class=\"n\">as</span> <span class=\"n\">bs</span><span class=\"p\">)</span> <span class=\"p\">()</span>\n    <span class=\"p\">[(()</span> <span class=\"n\">bs</span><span class=\"p\">)</span>  <span class=\"p\">(</span><span class=\"n\">k</span> <span class=\"o\">#&#39;</span><span class=\"n\">bs</span><span class=\"p\">)]</span>\n    <span class=\"p\">[(</span><span class=\"n\">as</span> <span class=\"p\">())</span>  <span class=\"p\">(</span><span class=\"n\">k</span> <span class=\"o\">#&#39;</span><span class=\"n\">as</span><span class=\"p\">)]</span>\n    <span class=\"p\">[((</span><span class=\"n\">a</span> <span class=\"n\">as</span> <span class=\"k\">...</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"n\">b</span> <span class=\"n\">bs</span> <span class=\"k\">...</span><span class=\"p\">))</span>\n     <span class=\"o\">#`</span><span class=\"p\">(</span><span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"nb\">&lt;</span> <span class=\"n\">a</span> <span class=\"n\">b</span><span class=\"p\">)</span>\n           <span class=\"o\">#,</span><span class=\"p\">(</span><span class=\"n\">inline-merge/k</span> <span class=\"o\">#&#39;</span><span class=\"p\">(</span><span class=\"n\">as</span> <span class=\"k\">...</span><span class=\"p\">)</span> <span class=\"o\">#&#39;</span><span class=\"p\">(</span><span class=\"n\">b</span> <span class=\"n\">bs</span> <span class=\"k\">...</span><span class=\"p\">)</span>\n                             <span class=\"p\">(</span><span class=\"k\">λ</span> <span class=\"p\">(</span><span class=\"n\">vs</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"n\">k</span> <span class=\"p\">(</span><span class=\"nb\">cons</span> <span class=\"o\">#&#39;</span><span class=\"n\">a</span> <span class=\"n\">vs</span><span class=\"p\">))))</span>\n           <span class=\"o\">#,</span><span class=\"p\">(</span><span class=\"n\">inline-merge/k</span> <span class=\"o\">#&#39;</span><span class=\"p\">(</span><span class=\"n\">a</span> <span class=\"n\">as</span> <span class=\"k\">...</span><span class=\"p\">)</span> <span class=\"o\">#&#39;</span><span class=\"p\">(</span><span class=\"n\">bs</span> <span class=\"k\">...</span><span class=\"p\">)</span>\n                             <span class=\"p\">(</span><span class=\"k\">λ</span> <span class=\"p\">(</span><span class=\"n\">vs</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"n\">k</span> <span class=\"p\">(</span><span class=\"nb\">cons</span> <span class=\"o\">#&#39;</span><span class=\"n\">b</span> <span class=\"n\">vs</span><span class=\"p\">)))))]))</span>\n</pre></div>\n\n</div>\n\n<p>The only substantial changes are the quasiquotes and unquotes, and using syntax-case to destructure syntax lists instead of using match to destructure lists. Again, note that the recursive calls #,(inline-merge/k &hellip;) in each if branch happen at expansion time, and that their continuations are expansion-time values.We can see what kind of code merge/k returns by applying it at expansion time:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"nb\">&gt;</span> <span class=\"p\">(</span><span class=\"k\">begin-for-syntax</span>\n    <span class=\"p\">(</span><span class=\"nb\">print</span>\n     <span class=\"p\">(</span><span class=\"nb\">syntax-&gt;datum</span>\n      <span class=\"p\">(</span><span class=\"n\">inline-merge/k</span> <span class=\"o\">#&#39;</span><span class=\"p\">(</span><span class=\"n\">a</span><span class=\"p\">)</span> <span class=\"o\">#&#39;</span><span class=\"p\">(</span><span class=\"n\">b</span> <span class=\"n\">c</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"k\">λ</span> <span class=\"p\">(</span><span class=\"n\">vs</span><span class=\"p\">)</span> <span class=\"n\">vs</span><span class=\"p\">)))))</span>\n<span class=\"o\">&#39;</span><span class=\"p\">(</span><span class=\"ss\">if</span> <span class=\"p\">(</span><span class=\"ss\">&lt;</span> <span class=\"ss\">a</span> <span class=\"ss\">b</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"ss\">a</span> <span class=\"ss\">b</span> <span class=\"ss\">c</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"ss\">if</span> <span class=\"p\">(</span><span class=\"ss\">&lt;</span> <span class=\"ss\">a</span> <span class=\"ss\">c</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"ss\">b</span> <span class=\"ss\">a</span> <span class=\"ss\">c</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"ss\">b</span> <span class=\"ss\">c</span> <span class=\"ss\">a</span><span class=\"p\">)))</span>\n</pre></div>\n\n</div>\n\n<p>The syntax list #&rsquo;(b c) is assumed already sorted, meaning (&lt; b c) at runtime. Therefore, if (&lt; a b) at runtime, by transitivity, (&lt; a b c) at runtime, so the merge generates #&rsquo;(a b c). In other words, inline-merge/k’s assumption that its arguments are sorted is equivalent to reasoning about transitivity.</p>\n\n<h2 id=\"the-inline-sort-function\">The Inline Sort Function</h2>\n\n<p>Lastly, the divide-and-conquer part:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">require</span> <span class=\"p\">(</span><span class=\"k\">for-syntax</span> <span class=\"n\">racket/list</span><span class=\"p\">))</span>  <span class=\"c1\">; for list functions</span>\n \n<span class=\"p\">(</span><span class=\"k\">define-for-syntax</span> <span class=\"p\">(</span><span class=\"n\">inline-sort/k</span> <span class=\"n\">vs</span> <span class=\"n\">k</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"k\">syntax-case</span> <span class=\"n\">vs</span> <span class=\"p\">()</span>\n    <span class=\"p\">[()</span>  <span class=\"p\">(</span><span class=\"n\">k</span> <span class=\"n\">vs</span><span class=\"p\">)]</span>\n    <span class=\"p\">[(</span><span class=\"n\">a</span><span class=\"p\">)</span>  <span class=\"p\">(</span><span class=\"n\">k</span> <span class=\"n\">vs</span><span class=\"p\">)]</span>\n    <span class=\"p\">[</span><span class=\"k\">_</span>  <span class=\"p\">(</span><span class=\"k\">let</span> <span class=\"p\">([</span><span class=\"n\">vs</span>  <span class=\"p\">(</span><span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"nb\">list?</span> <span class=\"n\">vs</span><span class=\"p\">)</span> <span class=\"n\">vs</span> <span class=\"p\">(</span><span class=\"nb\">syntax-&gt;list</span> <span class=\"n\">vs</span><span class=\"p\">))])</span>\n          <span class=\"p\">(</span><span class=\"k\">define-values</span> <span class=\"p\">(</span><span class=\"n\">lvs</span> <span class=\"n\">rvs</span><span class=\"p\">)</span>\n            <span class=\"p\">(</span><span class=\"nb\">split-at</span> <span class=\"n\">vs</span> <span class=\"p\">(</span><span class=\"nb\">quotient</span> <span class=\"p\">(</span><span class=\"nb\">length</span> <span class=\"n\">vs</span><span class=\"p\">)</span> <span class=\"mi\">2</span><span class=\"p\">)))</span>\n          <span class=\"p\">(</span><span class=\"n\">inline-sort/k</span>\n           <span class=\"n\">lvs</span> <span class=\"p\">(</span><span class=\"k\">λ</span> <span class=\"p\">(</span><span class=\"n\">lvs</span><span class=\"p\">)</span>\n                 <span class=\"p\">(</span><span class=\"n\">inline-sort/k</span>\n                  <span class=\"n\">rvs</span> <span class=\"p\">(</span><span class=\"k\">λ</span> <span class=\"p\">(</span><span class=\"n\">rvs</span><span class=\"p\">)</span>\n                        <span class=\"p\">(</span><span class=\"n\">inline-merge/k</span> <span class=\"n\">lvs</span> <span class=\"n\">rvs</span> <span class=\"n\">k</span><span class=\"p\">))))))]))</span>\n</pre></div>\n\n</div>\n\n<p>This is changed similarly to merge/k. The only new change is using syntax-&gt;list to convert syntax to lists so we can use the functions length and split-at. Example:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"nb\">&gt;</span> <span class=\"p\">(</span><span class=\"n\">inline-sort</span> <span class=\"mi\">5</span> <span class=\"mi\">2</span> <span class=\"mi\">3</span> <span class=\"mi\">1</span><span class=\"p\">)</span>\n<span class=\"mi\">1</span>\n<span class=\"mi\">2</span>\n<span class=\"mi\">3</span>\n<span class=\"mi\">5</span>\n</pre></div>\n\n</div>\n\n<p>Of course, the result of evaluating an inline-sort doesn’t tell the whole story. Let’s fire up the macro stepper and see what (inline-sort 5 2 3) expands to. Copying from the macro stepper window and renaming temp variables, we get</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">let</span> <span class=\"p\">([</span><span class=\"n\">a</span> <span class=\"mi\">5</span><span class=\"p\">]</span> <span class=\"p\">[</span><span class=\"n\">b</span> <span class=\"mi\">2</span><span class=\"p\">]</span> <span class=\"p\">[</span><span class=\"n\">c</span> <span class=\"mi\">3</span><span class=\"p\">])</span>\n  <span class=\"p\">(</span><span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"nb\">&lt;</span> <span class=\"n\">b</span> <span class=\"n\">c</span><span class=\"p\">)</span>\n      <span class=\"p\">(</span><span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"nb\">&lt;</span> <span class=\"n\">a</span> <span class=\"n\">b</span><span class=\"p\">)</span>\n          <span class=\"p\">(</span><span class=\"nb\">values</span> <span class=\"n\">a</span> <span class=\"n\">b</span> <span class=\"n\">c</span><span class=\"p\">)</span>\n          <span class=\"p\">(</span><span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"nb\">&lt;</span> <span class=\"n\">a</span> <span class=\"n\">c</span><span class=\"p\">)</span>\n              <span class=\"p\">(</span><span class=\"nb\">values</span> <span class=\"n\">b</span> <span class=\"n\">a</span> <span class=\"n\">c</span><span class=\"p\">)</span>\n              <span class=\"p\">(</span><span class=\"nb\">values</span> <span class=\"n\">b</span> <span class=\"n\">c</span> <span class=\"n\">a</span><span class=\"p\">)))</span>\n      <span class=\"p\">(</span><span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"nb\">&lt;</span> <span class=\"n\">a</span> <span class=\"n\">c</span><span class=\"p\">)</span>\n          <span class=\"p\">(</span><span class=\"nb\">values</span> <span class=\"n\">a</span> <span class=\"n\">c</span> <span class=\"n\">b</span><span class=\"p\">)</span>\n          <span class=\"p\">(</span><span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"nb\">&lt;</span> <span class=\"n\">a</span> <span class=\"n\">b</span><span class=\"p\">)</span>\n              <span class=\"p\">(</span><span class=\"nb\">values</span> <span class=\"n\">c</span> <span class=\"n\">a</span> <span class=\"n\">b</span><span class=\"p\">)</span>\n              <span class=\"p\">(</span><span class=\"nb\">values</span> <span class=\"n\">c</span> <span class=\"n\">b</span> <span class=\"n\">a</span><span class=\"p\">)))))</span>\n</pre></div>\n\n</div>\n\n<p>It’s an if tree. Notice that there are 6 leaf expressions, for the 3! = 6 possible permutations. Also, it never compares more than it has to. It’s optimal.</p>\n\n<h2 id=\"inline-sort-properties\">Inline Sort Properties</h2>\n\n<p>Inherited from the merge sort, the inline sort has the following properties (assuming a length-n list):</p>\n\n<ul>\n <li>\n  <p>Time optimality: The depth of the if tree is O(n log(n)).</p></li>\n <li>\n  <p>Size optimality: The number of leaves is exactly n!. The term “size optimality” is misleading, because that’s still a lot of code. I’ve seriously considered requiring any user of this macro to state how many permutations there are for the number of values they’re sorting. They’d have to prove to the macro that they know how much code they’re asking it to generate.Inline sort is wicked fast, as we should expect:</p></li></ul>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"nb\">&gt;</span> <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"n\">vs</span> <span class=\"o\">&#39;</span><span class=\"p\">(</span><span class=\"mi\">5</span> <span class=\"mi\">2</span> <span class=\"mi\">3</span> <span class=\"mi\">1</span><span class=\"p\">))</span>\n<span class=\"nb\">&gt;</span> <span class=\"p\">(</span><span class=\"k\">match-define</span> <span class=\"p\">(</span><span class=\"nb\">list</span> <span class=\"n\">a</span> <span class=\"n\">b</span> <span class=\"n\">c</span> <span class=\"n\">d</span><span class=\"p\">)</span> <span class=\"n\">vs</span><span class=\"p\">)</span>\n<span class=\"nb\">&gt;</span> <span class=\"p\">(</span><span class=\"k\">for</span> <span class=\"p\">([</span><span class=\"k\">_</span>  <span class=\"p\">(</span><span class=\"nb\">in-range</span> <span class=\"mi\">5</span><span class=\"p\">)])</span>\n    <span class=\"p\">(</span><span class=\"k\">time</span> <span class=\"p\">(</span><span class=\"k\">for</span> <span class=\"p\">([</span><span class=\"k\">_</span>  <span class=\"p\">(</span><span class=\"nb\">in-range</span> <span class=\"mi\">1000000</span><span class=\"p\">)])</span>\n            <span class=\"p\">(</span><span class=\"k\">match-let</span> <span class=\"p\">([(</span><span class=\"nb\">list</span> <span class=\"n\">a</span> <span class=\"n\">b</span> <span class=\"n\">c</span> <span class=\"n\">d</span><span class=\"p\">)</span>  <span class=\"p\">(</span><span class=\"nb\">sort</span> <span class=\"n\">vs</span> <span class=\"nb\">&lt;</span><span class=\"p\">)])</span>\n              <span class=\"p\">(</span><span class=\"nb\">void</span><span class=\"p\">)))))</span>\n<span class=\"n\">cpu</span> <span class=\"n\">time:</span> <span class=\"mi\">550</span> <span class=\"n\">real</span> <span class=\"n\">time:</span> <span class=\"mi\">540</span> <span class=\"n\">gc</span> <span class=\"n\">time:</span> <span class=\"mi\">30</span>\n<span class=\"n\">cpu</span> <span class=\"n\">time:</span> <span class=\"mi\">510</span> <span class=\"n\">real</span> <span class=\"n\">time:</span> <span class=\"mi\">518</span> <span class=\"n\">gc</span> <span class=\"n\">time:</span> <span class=\"mi\">0</span>\n<span class=\"n\">cpu</span> <span class=\"n\">time:</span> <span class=\"mi\">520</span> <span class=\"n\">real</span> <span class=\"n\">time:</span> <span class=\"mi\">517</span> <span class=\"n\">gc</span> <span class=\"n\">time:</span> <span class=\"mi\">20</span>\n<span class=\"n\">cpu</span> <span class=\"n\">time:</span> <span class=\"mi\">520</span> <span class=\"n\">real</span> <span class=\"n\">time:</span> <span class=\"mi\">517</span> <span class=\"n\">gc</span> <span class=\"n\">time:</span> <span class=\"mi\">0</span>\n<span class=\"n\">cpu</span> <span class=\"n\">time:</span> <span class=\"mi\">510</span> <span class=\"n\">real</span> <span class=\"n\">time:</span> <span class=\"mi\">516</span> <span class=\"n\">gc</span> <span class=\"n\">time:</span> <span class=\"mi\">10</span>\n<span class=\"nb\">&gt;</span> <span class=\"p\">(</span><span class=\"k\">for</span> <span class=\"p\">([</span><span class=\"k\">_</span>  <span class=\"p\">(</span><span class=\"nb\">in-range</span> <span class=\"mi\">5</span><span class=\"p\">)])</span>\n    <span class=\"p\">(</span><span class=\"k\">time</span> <span class=\"p\">(</span><span class=\"k\">for</span> <span class=\"p\">([</span><span class=\"k\">_</span>  <span class=\"p\">(</span><span class=\"nb\">in-range</span> <span class=\"mi\">1000000</span><span class=\"p\">)])</span>\n            <span class=\"p\">(</span><span class=\"k\">let-values</span> <span class=\"p\">([(</span><span class=\"n\">a</span> <span class=\"n\">b</span> <span class=\"n\">c</span> <span class=\"n\">d</span><span class=\"p\">)</span>  <span class=\"p\">(</span><span class=\"n\">inline-sort</span> <span class=\"n\">a</span> <span class=\"n\">b</span> <span class=\"n\">c</span> <span class=\"n\">d</span><span class=\"p\">)])</span>\n              <span class=\"p\">(</span><span class=\"nb\">void</span><span class=\"p\">)))))</span>\n<span class=\"n\">cpu</span> <span class=\"n\">time:</span> <span class=\"mi\">20</span> <span class=\"n\">real</span> <span class=\"n\">time:</span> <span class=\"mi\">28</span> <span class=\"n\">gc</span> <span class=\"n\">time:</span> <span class=\"mi\">0</span>\n<span class=\"n\">cpu</span> <span class=\"n\">time:</span> <span class=\"mi\">30</span> <span class=\"n\">real</span> <span class=\"n\">time:</span> <span class=\"mi\">27</span> <span class=\"n\">gc</span> <span class=\"n\">time:</span> <span class=\"mi\">0</span>\n<span class=\"n\">cpu</span> <span class=\"n\">time:</span> <span class=\"mi\">30</span> <span class=\"n\">real</span> <span class=\"n\">time:</span> <span class=\"mi\">27</span> <span class=\"n\">gc</span> <span class=\"n\">time:</span> <span class=\"mi\">0</span>\n<span class=\"n\">cpu</span> <span class=\"n\">time:</span> <span class=\"mi\">30</span> <span class=\"n\">real</span> <span class=\"n\">time:</span> <span class=\"mi\">27</span> <span class=\"n\">gc</span> <span class=\"n\">time:</span> <span class=\"mi\">0</span>\n<span class=\"n\">cpu</span> <span class=\"n\">time:</span> <span class=\"mi\">20</span> <span class=\"n\">real</span> <span class=\"n\">time:</span> <span class=\"mi\">27</span> <span class=\"n\">gc</span> <span class=\"n\">time:</span> <span class=\"mi\">0</span>\n</pre></div>\n\n</div>\n\n<p>So about 20 times faster than sort on a length&ndash;4 list.I use it in Typed Racket, on floating-point numbers. Typed Racket’s optimizer replaces <code>&lt;</code> with <code>unsafe-fl&lt;</code>. This tells the compiler that the elements are floats, so it can keep them stack-allocated, which reduces allocations further. In all, for my particular use of inline-sort, it’s over 50 times faster than sort.And using it is a heckuvalot easier than writing an if tree and reasoning about transitivity every time I need to sort a handful of floats.</p>\n\n<h2 id=\"conclusion\">Conclusion</h2>\n\n<p> Writing macros in expansion-time CPS to fully inline a recursive function works out beautifully. I suspect that it will work on any recursive, polymorphic function whose well-foundedness follows only from the structure of the input data.Also, it can generate a metric truckload of code.Interesting note: I originally wrote inline-sort using only syntax-rules, passing the names of higher-order macros to other macros as continuations. Sorting a five-element list took almost 19000 expansion steps, which is ridiculously inefficient even for a 120-leaf if tree.</p>") #t (u . "\n<p><em>posted by Neil Toronto</em></p>\n\n<p>While writing the code for the <a href=\"http://en.wikipedia.org/wiki/Triangular_distribution\">triangular distribution</a> in the upcoming math library, I found that I needed a function that sorts exactly three numbers. This kind of code is annoying to write and to get right. But it comes up rarely enough, and it seems simple enough, that I’ve never felt like making a library function for it.</p>\n\n<p>But what if I wrote a macro that generated code to sort n numbers very quickly, where n is known at expansion time, but the numbers themselves aren’t? I think I could justify putting that in a library.</p>\n\n<p>Here’s code that correctly sorts three numbers a, b and c:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"nb\">&lt;</span> <span class=\"n\">b</span> <span class=\"n\">c</span><span class=\"p\">)</span>\n    <span class=\"p\">(</span><span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"nb\">&lt;</span> <span class=\"n\">a</span> <span class=\"n\">b</span><span class=\"p\">)</span>\n        <span class=\"p\">(</span><span class=\"nb\">values</span> <span class=\"n\">a</span> <span class=\"n\">b</span> <span class=\"n\">c</span><span class=\"p\">)</span>\n        <span class=\"p\">(</span><span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"nb\">&lt;</span> <span class=\"n\">a</span> <span class=\"n\">c</span><span class=\"p\">)</span>\n            <span class=\"p\">(</span><span class=\"nb\">values</span> <span class=\"n\">b</span> <span class=\"n\">a</span> <span class=\"n\">c</span><span class=\"p\">)</span>\n            <span class=\"p\">(</span><span class=\"nb\">values</span> <span class=\"n\">b</span> <span class=\"n\">c</span> <span class=\"n\">a</span><span class=\"p\">)))</span>\n    <span class=\"p\">(</span><span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"nb\">&lt;</span> <span class=\"n\">a</span> <span class=\"n\">c</span><span class=\"p\">)</span>\n        <span class=\"p\">(</span><span class=\"nb\">values</span> <span class=\"n\">a</span> <span class=\"n\">c</span> <span class=\"n\">b</span><span class=\"p\">)</span>\n        <span class=\"p\">(</span><span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"nb\">&lt;</span> <span class=\"n\">a</span> <span class=\"n\">b</span><span class=\"p\">)</span>\n            <span class=\"p\">(</span><span class=\"nb\">values</span> <span class=\"n\">c</span> <span class=\"n\">a</span> <span class=\"n\">b</span><span class=\"p\">)</span>\n            <span class=\"p\">(</span><span class=\"nb\">values</span> <span class=\"n\">c</span> <span class=\"n\">b</span> <span class=\"n\">a</span><span class=\"p\">))))</span>\n</pre></div>\n\n</div>\n\n<p>It’s an if tree. Notice that there are 6 leaf expressions, for the 3! = 6 possible permutations. Also, it never compares more than it has to. It’s optimal.The optimality came from my reasoning about transitivity. For example, only two comparisons are needed before returning (values a b c). I knew that both (&lt; a b) and (&lt; b c), so (&lt; a b c) must be true by transitivity.</p>\n\n<p>It would be nice if the macro generated optimal code by explicitly reasoning about transitivity, or as an emergent property of the sorting algorithm it uses.</p>\n\n<p>We’ll write a macro that does the latter, by generating a fully inlined merge sort.</p>\n\n<p>[Edit: The final inline sort macro is <a href=\"https://gist.github.com/3456604\">here</a>.]</p>\n\n<h2 id=\"runtime-merge-sort\">Runtime Merge Sort</h2>\n\n<p>Start with a simple, runtime merge sort:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">merge</span> <span class=\"n\">as</span> <span class=\"n\">bs</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"k\">match*</span> <span class=\"p\">(</span><span class=\"n\">as</span> <span class=\"n\">bs</span><span class=\"p\">)</span>\n    <span class=\"p\">[((</span><span class=\"nb\">list</span><span class=\"p\">)</span> <span class=\"n\">bs</span><span class=\"p\">)</span>  <span class=\"n\">bs</span><span class=\"p\">]</span>\n    <span class=\"p\">[(</span><span class=\"n\">as</span> <span class=\"p\">(</span><span class=\"nb\">list</span><span class=\"p\">))</span>  <span class=\"n\">as</span><span class=\"p\">]</span>\n    <span class=\"p\">[((</span><span class=\"nb\">list</span> <span class=\"n\">a</span> <span class=\"n\">as</span> <span class=\"k\">...</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"nb\">list</span> <span class=\"n\">b</span> <span class=\"n\">bs</span> <span class=\"k\">...</span><span class=\"p\">))</span>\n     <span class=\"p\">(</span><span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"nb\">&lt;</span> <span class=\"n\">a</span> <span class=\"n\">b</span><span class=\"p\">)</span>\n         <span class=\"p\">(</span><span class=\"nb\">cons</span> <span class=\"n\">a</span> <span class=\"p\">(</span><span class=\"n\">merge</span> <span class=\"n\">as</span> <span class=\"p\">(</span><span class=\"nb\">cons</span> <span class=\"n\">b</span> <span class=\"n\">bs</span><span class=\"p\">)))</span>\n         <span class=\"p\">(</span><span class=\"nb\">cons</span> <span class=\"n\">b</span> <span class=\"p\">(</span><span class=\"n\">merge</span> <span class=\"p\">(</span><span class=\"nb\">cons</span> <span class=\"n\">a</span> <span class=\"n\">as</span><span class=\"p\">)</span> <span class=\"n\">bs</span><span class=\"p\">)))]))</span>\n \n<span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">merge-sort</span> <span class=\"n\">vs</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"k\">match</span> <span class=\"n\">vs</span>\n    <span class=\"p\">[(</span><span class=\"nb\">list</span><span class=\"p\">)</span>  <span class=\"n\">vs</span><span class=\"p\">]</span>\n    <span class=\"p\">[(</span><span class=\"nb\">list</span> <span class=\"n\">a</span><span class=\"p\">)</span>  <span class=\"n\">vs</span><span class=\"p\">]</span>\n    <span class=\"p\">[</span><span class=\"k\">_</span>  <span class=\"p\">(</span><span class=\"k\">define-values</span> <span class=\"p\">(</span><span class=\"n\">lvs</span> <span class=\"n\">rvs</span><span class=\"p\">)</span>\n          <span class=\"p\">(</span><span class=\"nb\">split-at</span> <span class=\"n\">vs</span> <span class=\"p\">(</span><span class=\"nb\">quotient</span> <span class=\"p\">(</span><span class=\"nb\">length</span> <span class=\"n\">vs</span><span class=\"p\">)</span> <span class=\"mi\">2</span><span class=\"p\">)))</span>\n        <span class=\"p\">(</span><span class=\"n\">merge</span> <span class=\"p\">(</span><span class=\"n\">merge-sort</span> <span class=\"n\">lvs</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"n\">merge-sort</span> <span class=\"n\">rvs</span><span class=\"p\">))]))</span>\n</pre></div>\n\n</div>\n\n<p>Example:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"nb\">&gt;</span> <span class=\"p\">(</span><span class=\"n\">merge-sort</span> <span class=\"o\">&#39;</span><span class=\"p\">(</span><span class=\"mi\">5</span> <span class=\"mi\">1</span> <span class=\"mi\">2</span> <span class=\"mi\">5</span> <span class=\"mi\">10</span><span class=\"p\">))</span>\n<span class=\"o\">&#39;</span><span class=\"p\">(</span><span class=\"mi\">1</span> <span class=\"mi\">2</span> <span class=\"mi\">5</span> <span class=\"mi\">5</span> <span class=\"mi\">10</span><span class=\"p\">)</span>\n</pre></div>\n\n</div>\n\n<p>To make a macro out of merge sort, we need to change two things. The most obvious is that it has to return syntax for an if instead of evaluating it. That’s easy for a novice macrologist: change the functions to operate on syntax, stick a syntax-quasiquote in front of the if, and unquote the bits inside that get evaluated at expansion time.</p>\n\n<p>But if we did only that, we’d end up with expanded code like this:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"nb\">&lt;</span> <span class=\"n\">a</span> <span class=\"n\">b</span><span class=\"p\">)</span>\n    <span class=\"p\">(</span><span class=\"nb\">cons</span> <span class=\"n\">a</span> <span class=\"p\">(</span><span class=\"k\">if</span> <span class=\"k\">...</span><span class=\"p\">))</span>\n    <span class=\"p\">(</span><span class=\"nb\">cons</span> <span class=\"n\">b</span> <span class=\"p\">(</span><span class=\"k\">if</span> <span class=\"k\">...</span><span class=\"p\">)))</span>\n</pre></div>\n\n</div>\n\n<p>It would be slow because cons allocates. We want the code to be fast.So the other change is to move the conses inside the ifs, and evaluate them at expansion time. We can then construct a values expression out of the resulting list.</p>\n\n<h2 id=\"accumulator-passing-style-wont-work\">Accumulator-Passing Style Won’t Work</h2>\n\n<p> Novice functional programmers should know that accumulator-passing style (APS) moves conses inward. For example, this “add 1 to each element” function:</p>\n\n<p> <code>racket\n (define (list-add1 vs)\n  (match vs\n    [(list)  (list)]\n    [(list v vs ...)\n     (cons (add1 v) (list-add1 vs))]))</code></p>\n\n<p>becomes this after conversion to APS:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">list-add1/acc</span> <span class=\"n\">vs</span> <span class=\"p\">[</span><span class=\"n\">acc</span> <span class=\"p\">(</span><span class=\"nb\">list</span><span class=\"p\">)])</span>\n  <span class=\"p\">(</span><span class=\"k\">match</span> <span class=\"n\">vs</span>\n    <span class=\"p\">[(</span><span class=\"nb\">list</span><span class=\"p\">)</span>  <span class=\"p\">(</span><span class=\"nb\">reverse</span> <span class=\"n\">acc</span><span class=\"p\">)]</span>\n    <span class=\"p\">[(</span><span class=\"nb\">list</span> <span class=\"n\">v</span> <span class=\"n\">vs</span> <span class=\"k\">...</span><span class=\"p\">)</span>\n     <span class=\"p\">(</span><span class=\"n\">list-add1/acc</span> <span class=\"n\">vs</span> <span class=\"p\">(</span><span class=\"nb\">cons</span> <span class=\"p\">(</span><span class=\"nb\">add1</span> <span class=\"n\">v</span><span class=\"p\">)</span> <span class=\"n\">acc</span><span class=\"p\">))]))</span>\n</pre></div>\n\n</div>\n\n<p>Now cons is where we want it: inside the recursive call, instead of in tail position. The problem is that APS doesn’t work on tree-shaped recursion.</p>\n\n<h2 id=\"continuation-passing-style-does-work\">Continuation-Passing Style Does Work</h2>\n\n<p>In continuation-passing style (CPS), we pass a continuation k—i.e. “what happens next”— instead of an accumulator. The functions call k instead of returning values. For example:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">list-add1/k</span> <span class=\"n\">vs</span> <span class=\"p\">[</span><span class=\"n\">k</span> <span class=\"nb\">identity</span><span class=\"p\">])</span>\n  <span class=\"p\">(</span><span class=\"k\">match</span> <span class=\"n\">vs</span>\n    <span class=\"p\">[(</span><span class=\"nb\">list</span><span class=\"p\">)</span>  <span class=\"p\">(</span><span class=\"n\">k</span> <span class=\"p\">(</span><span class=\"nb\">list</span><span class=\"p\">))]</span>\n    <span class=\"p\">[(</span><span class=\"nb\">list</span> <span class=\"n\">v</span> <span class=\"n\">vs</span> <span class=\"k\">...</span><span class=\"p\">)</span>\n     <span class=\"p\">(</span><span class=\"n\">list-add1/k</span> <span class=\"n\">vs</span> <span class=\"p\">(</span><span class=\"k\">λ</span> <span class=\"p\">(</span><span class=\"n\">vs</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"n\">k</span> <span class=\"p\">(</span><span class=\"nb\">cons</span> <span class=\"p\">(</span><span class=\"nb\">add1</span> <span class=\"n\">v</span><span class=\"p\">)</span> <span class=\"n\">vs</span><span class=\"p\">))))]))</span>\n</pre></div>\n\n</div>\n\n<p>If we want, we can pass something besides identity as the base-case continuation:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"nb\">&gt;</span> <span class=\"p\">(</span><span class=\"n\">list-add1/k</span> <span class=\"o\">&#39;</span><span class=\"p\">(</span><span class=\"mi\">1</span> <span class=\"mi\">2</span> <span class=\"mi\">3</span> <span class=\"mi\">4</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"k\">λ</span> <span class=\"p\">(</span><span class=\"n\">vs</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"nb\">apply</span> <span class=\"nb\">values</span> <span class=\"n\">vs</span><span class=\"p\">)))</span>\n<span class=\"mi\">2</span>\n<span class=\"mi\">3</span>\n<span class=\"mi\">4</span>\n<span class=\"mi\">5</span>\n</pre></div>\n\n</div>\n\n<p>CPS turns every call into a tail call, so it moves conses inward even with tree-shaped recursion. As a demonstration, here’s a CPSed merge sort:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">merge/k</span> <span class=\"n\">as</span> <span class=\"n\">bs</span> <span class=\"n\">k</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"k\">match*</span> <span class=\"p\">(</span><span class=\"n\">as</span> <span class=\"n\">bs</span><span class=\"p\">)</span>\n    <span class=\"p\">[((</span><span class=\"nb\">list</span><span class=\"p\">)</span> <span class=\"n\">bs</span><span class=\"p\">)</span>  <span class=\"p\">(</span><span class=\"n\">k</span> <span class=\"n\">bs</span><span class=\"p\">)]</span>\n    <span class=\"p\">[(</span><span class=\"n\">as</span> <span class=\"p\">(</span><span class=\"nb\">list</span><span class=\"p\">))</span>  <span class=\"p\">(</span><span class=\"n\">k</span> <span class=\"n\">as</span><span class=\"p\">)]</span>\n    <span class=\"p\">[((</span><span class=\"nb\">list</span> <span class=\"n\">a</span> <span class=\"n\">as</span> <span class=\"k\">...</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"nb\">list</span> <span class=\"n\">b</span> <span class=\"n\">bs</span> <span class=\"k\">...</span><span class=\"p\">))</span>\n     <span class=\"p\">(</span><span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"nb\">&lt;</span> <span class=\"n\">a</span> <span class=\"n\">b</span><span class=\"p\">)</span>\n         <span class=\"p\">(</span><span class=\"n\">merge/k</span> <span class=\"n\">as</span> <span class=\"p\">(</span><span class=\"nb\">cons</span> <span class=\"n\">b</span> <span class=\"n\">bs</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"k\">λ</span> <span class=\"p\">(</span><span class=\"n\">vs</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"n\">k</span> <span class=\"p\">(</span><span class=\"nb\">cons</span> <span class=\"n\">a</span> <span class=\"n\">vs</span><span class=\"p\">))))</span>\n         <span class=\"p\">(</span><span class=\"n\">merge/k</span> <span class=\"p\">(</span><span class=\"nb\">cons</span> <span class=\"n\">a</span> <span class=\"n\">as</span><span class=\"p\">)</span> <span class=\"n\">bs</span> <span class=\"p\">(</span><span class=\"k\">λ</span> <span class=\"p\">(</span><span class=\"n\">vs</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"n\">k</span> <span class=\"p\">(</span><span class=\"nb\">cons</span> <span class=\"n\">b</span> <span class=\"n\">vs</span><span class=\"p\">)))))]))</span>\n \n<span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">merge-sort/k</span> <span class=\"n\">vs</span> <span class=\"n\">k</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"k\">match</span> <span class=\"n\">vs</span>\n    <span class=\"p\">[(</span><span class=\"nb\">list</span><span class=\"p\">)</span>  <span class=\"p\">(</span><span class=\"n\">k</span> <span class=\"n\">vs</span><span class=\"p\">)]</span>\n    <span class=\"p\">[(</span><span class=\"nb\">list</span> <span class=\"n\">a</span><span class=\"p\">)</span>  <span class=\"p\">(</span><span class=\"n\">k</span> <span class=\"n\">vs</span><span class=\"p\">)]</span>\n    <span class=\"p\">[</span><span class=\"k\">_</span>  <span class=\"p\">(</span><span class=\"k\">define-values</span> <span class=\"p\">(</span><span class=\"n\">lvs</span> <span class=\"n\">rvs</span><span class=\"p\">)</span>\n          <span class=\"p\">(</span><span class=\"nb\">split-at</span> <span class=\"n\">vs</span> <span class=\"p\">(</span><span class=\"nb\">quotient</span> <span class=\"p\">(</span><span class=\"nb\">length</span> <span class=\"n\">vs</span><span class=\"p\">)</span> <span class=\"mi\">2</span><span class=\"p\">)))</span>\n        <span class=\"p\">(</span><span class=\"n\">merge-sort/k</span>\n         <span class=\"n\">lvs</span> <span class=\"p\">(</span><span class=\"k\">λ</span> <span class=\"p\">(</span><span class=\"n\">lvs</span><span class=\"p\">)</span>\n               <span class=\"p\">(</span><span class=\"n\">merge-sort/k</span>\n                <span class=\"n\">rvs</span> <span class=\"p\">(</span><span class=\"k\">λ</span> <span class=\"p\">(</span><span class=\"n\">rvs</span><span class=\"p\">)</span>\n                      <span class=\"p\">(</span><span class=\"n\">merge/k</span> <span class=\"n\">lvs</span> <span class=\"n\">rvs</span> <span class=\"n\">k</span><span class=\"p\">)))))]))</span>\n</pre></div>\n\n</div>\n\n<p>You can read the last expression in merge-sort/k as, “Sort lvs. Then, with the sorted lvs, sort rvs. Then, with the sorted rvs, merge lvs and rvs.” Example:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"nb\">&gt;</span> <span class=\"p\">(</span><span class=\"n\">merge-sort/k</span> <span class=\"o\">&#39;</span><span class=\"p\">(</span><span class=\"mi\">5</span> <span class=\"mi\">2</span> <span class=\"mi\">3</span> <span class=\"mi\">1</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"k\">λ</span> <span class=\"p\">(</span><span class=\"n\">vs</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"nb\">apply</span> <span class=\"nb\">values</span> <span class=\"n\">vs</span><span class=\"p\">)))</span>\n<span class=\"mi\">1</span>\n<span class=\"mi\">2</span>\n<span class=\"mi\">3</span>\n<span class=\"mi\">5</span>\n</pre></div>\n\n</div>\n\n<h2 id=\"the-inline-sort-macro\">The Inline Sort Macro</h2>\n\n<p>When we macro-ize the CPSed merge sort, we’ll turn the continuations into expansion-time functions. So not only will macro-ized CPS move conses inward, it’ll apply them all at expansion time!</p>\n\n<p>We’ll do it in three parts: the user-facing macro, the inline merge function, and the inline sort function.</p>\n\n<h2 id=\"the-user-facing-macro\">The User-Facing Macro</h2>\n\n<p>Let’s put a nice face on inline sorting:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">define-syntax</span> <span class=\"p\">(</span><span class=\"n\">inline-sort</span> <span class=\"n\">stx</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"k\">syntax-case</span> <span class=\"n\">stx</span> <span class=\"p\">()</span>\n    <span class=\"p\">[(</span><span class=\"k\">_</span> <span class=\"n\">lst</span> <span class=\"k\">...</span><span class=\"p\">)</span>\n     <span class=\"p\">(</span><span class=\"k\">with-syntax</span> <span class=\"p\">([(</span><span class=\"n\">vs</span> <span class=\"k\">...</span><span class=\"p\">)</span>\n                    <span class=\"p\">(</span><span class=\"nb\">generate-temporaries</span> <span class=\"o\">#&#39;</span><span class=\"p\">(</span><span class=\"n\">lst</span> <span class=\"k\">...</span><span class=\"p\">))])</span>\n       <span class=\"o\">#`</span><span class=\"p\">(</span><span class=\"k\">let</span> <span class=\"p\">([</span><span class=\"n\">vs</span> <span class=\"n\">lst</span><span class=\"p\">]</span> <span class=\"k\">...</span><span class=\"p\">)</span>\n           <span class=\"o\">#,</span><span class=\"p\">(</span><span class=\"n\">inline-sort/k</span> <span class=\"o\">#&#39;</span><span class=\"p\">(</span><span class=\"n\">vs</span> <span class=\"k\">...</span><span class=\"p\">)</span>\n                            <span class=\"p\">(</span><span class=\"k\">λ</span> <span class=\"p\">(</span><span class=\"n\">vs</span><span class=\"p\">)</span> <span class=\"o\">#`</span><span class=\"p\">(</span><span class=\"nb\">values</span> <span class=\"o\">#,@</span><span class=\"n\">vs</span><span class=\"p\">)))))]))</span>\n</pre></div>\n\n</div>\n\n<p>This macro does two things. First, it names the values to be sorted, so they don’t get re-evaluated every time they’re compared. Second, it calls inline-sort/k with a base-case continuation that converts syntax lists to values expressions.Note that the call #,(inline-sort/k &hellip;) happens at expansion time, and that the continuation (λ (vs) &hellip;) it passes is an expansion-time value.</p>\n\n<h2 id=\"the-inline-merge-function\">The Inline Merge Function</h2>\n\n<p>Changing merge/k to operate on syntax at expansion time is as straightforward as possible:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">define-for-syntax</span> <span class=\"p\">(</span><span class=\"n\">inline-merge/k</span> <span class=\"n\">as</span> <span class=\"n\">bs</span> <span class=\"n\">k</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"k\">syntax-case</span> <span class=\"p\">(</span><span class=\"nb\">list</span> <span class=\"n\">as</span> <span class=\"n\">bs</span><span class=\"p\">)</span> <span class=\"p\">()</span>\n    <span class=\"p\">[(()</span> <span class=\"n\">bs</span><span class=\"p\">)</span>  <span class=\"p\">(</span><span class=\"n\">k</span> <span class=\"o\">#&#39;</span><span class=\"n\">bs</span><span class=\"p\">)]</span>\n    <span class=\"p\">[(</span><span class=\"n\">as</span> <span class=\"p\">())</span>  <span class=\"p\">(</span><span class=\"n\">k</span> <span class=\"o\">#&#39;</span><span class=\"n\">as</span><span class=\"p\">)]</span>\n    <span class=\"p\">[((</span><span class=\"n\">a</span> <span class=\"n\">as</span> <span class=\"k\">...</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"n\">b</span> <span class=\"n\">bs</span> <span class=\"k\">...</span><span class=\"p\">))</span>\n     <span class=\"o\">#`</span><span class=\"p\">(</span><span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"nb\">&lt;</span> <span class=\"n\">a</span> <span class=\"n\">b</span><span class=\"p\">)</span>\n           <span class=\"o\">#,</span><span class=\"p\">(</span><span class=\"n\">inline-merge/k</span> <span class=\"o\">#&#39;</span><span class=\"p\">(</span><span class=\"n\">as</span> <span class=\"k\">...</span><span class=\"p\">)</span> <span class=\"o\">#&#39;</span><span class=\"p\">(</span><span class=\"n\">b</span> <span class=\"n\">bs</span> <span class=\"k\">...</span><span class=\"p\">)</span>\n                             <span class=\"p\">(</span><span class=\"k\">λ</span> <span class=\"p\">(</span><span class=\"n\">vs</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"n\">k</span> <span class=\"p\">(</span><span class=\"nb\">cons</span> <span class=\"o\">#&#39;</span><span class=\"n\">a</span> <span class=\"n\">vs</span><span class=\"p\">))))</span>\n           <span class=\"o\">#,</span><span class=\"p\">(</span><span class=\"n\">inline-merge/k</span> <span class=\"o\">#&#39;</span><span class=\"p\">(</span><span class=\"n\">a</span> <span class=\"n\">as</span> <span class=\"k\">...</span><span class=\"p\">)</span> <span class=\"o\">#&#39;</span><span class=\"p\">(</span><span class=\"n\">bs</span> <span class=\"k\">...</span><span class=\"p\">)</span>\n                             <span class=\"p\">(</span><span class=\"k\">λ</span> <span class=\"p\">(</span><span class=\"n\">vs</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"n\">k</span> <span class=\"p\">(</span><span class=\"nb\">cons</span> <span class=\"o\">#&#39;</span><span class=\"n\">b</span> <span class=\"n\">vs</span><span class=\"p\">)))))]))</span>\n</pre></div>\n\n</div>\n\n<p>The only substantial changes are the quasiquotes and unquotes, and using syntax-case to destructure syntax lists instead of using match to destructure lists. Again, note that the recursive calls #,(inline-merge/k &hellip;) in each if branch happen at expansion time, and that their continuations are expansion-time values.We can see what kind of code merge/k returns by applying it at expansion time:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"nb\">&gt;</span> <span class=\"p\">(</span><span class=\"k\">begin-for-syntax</span>\n    <span class=\"p\">(</span><span class=\"nb\">print</span>\n     <span class=\"p\">(</span><span class=\"nb\">syntax-&gt;datum</span>\n      <span class=\"p\">(</span><span class=\"n\">inline-merge/k</span> <span class=\"o\">#&#39;</span><span class=\"p\">(</span><span class=\"n\">a</span><span class=\"p\">)</span> <span class=\"o\">#&#39;</span><span class=\"p\">(</span><span class=\"n\">b</span> <span class=\"n\">c</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"k\">λ</span> <span class=\"p\">(</span><span class=\"n\">vs</span><span class=\"p\">)</span> <span class=\"n\">vs</span><span class=\"p\">)))))</span>\n<span class=\"o\">&#39;</span><span class=\"p\">(</span><span class=\"ss\">if</span> <span class=\"p\">(</span><span class=\"ss\">&lt;</span> <span class=\"ss\">a</span> <span class=\"ss\">b</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"ss\">a</span> <span class=\"ss\">b</span> <span class=\"ss\">c</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"ss\">if</span> <span class=\"p\">(</span><span class=\"ss\">&lt;</span> <span class=\"ss\">a</span> <span class=\"ss\">c</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"ss\">b</span> <span class=\"ss\">a</span> <span class=\"ss\">c</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"ss\">b</span> <span class=\"ss\">c</span> <span class=\"ss\">a</span><span class=\"p\">)))</span>\n</pre></div>\n\n</div>\n\n<p>The syntax list #&rsquo;(b c) is assumed already sorted, meaning (&lt; b c) at runtime. Therefore, if (&lt; a b) at runtime, by transitivity, (&lt; a b c) at runtime, so the merge generates #&rsquo;(a b c). In other words, inline-merge/k’s assumption that its arguments are sorted is equivalent to reasoning about transitivity.</p>\n\n<h2 id=\"the-inline-sort-function\">The Inline Sort Function</h2>\n\n<p>Lastly, the divide-and-conquer part:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">require</span> <span class=\"p\">(</span><span class=\"k\">for-syntax</span> <span class=\"n\">racket/list</span><span class=\"p\">))</span>  <span class=\"c1\">; for list functions</span>\n \n<span class=\"p\">(</span><span class=\"k\">define-for-syntax</span> <span class=\"p\">(</span><span class=\"n\">inline-sort/k</span> <span class=\"n\">vs</span> <span class=\"n\">k</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"k\">syntax-case</span> <span class=\"n\">vs</span> <span class=\"p\">()</span>\n    <span class=\"p\">[()</span>  <span class=\"p\">(</span><span class=\"n\">k</span> <span class=\"n\">vs</span><span class=\"p\">)]</span>\n    <span class=\"p\">[(</span><span class=\"n\">a</span><span class=\"p\">)</span>  <span class=\"p\">(</span><span class=\"n\">k</span> <span class=\"n\">vs</span><span class=\"p\">)]</span>\n    <span class=\"p\">[</span><span class=\"k\">_</span>  <span class=\"p\">(</span><span class=\"k\">let</span> <span class=\"p\">([</span><span class=\"n\">vs</span>  <span class=\"p\">(</span><span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"nb\">list?</span> <span class=\"n\">vs</span><span class=\"p\">)</span> <span class=\"n\">vs</span> <span class=\"p\">(</span><span class=\"nb\">syntax-&gt;list</span> <span class=\"n\">vs</span><span class=\"p\">))])</span>\n          <span class=\"p\">(</span><span class=\"k\">define-values</span> <span class=\"p\">(</span><span class=\"n\">lvs</span> <span class=\"n\">rvs</span><span class=\"p\">)</span>\n            <span class=\"p\">(</span><span class=\"nb\">split-at</span> <span class=\"n\">vs</span> <span class=\"p\">(</span><span class=\"nb\">quotient</span> <span class=\"p\">(</span><span class=\"nb\">length</span> <span class=\"n\">vs</span><span class=\"p\">)</span> <span class=\"mi\">2</span><span class=\"p\">)))</span>\n          <span class=\"p\">(</span><span class=\"n\">inline-sort/k</span>\n           <span class=\"n\">lvs</span> <span class=\"p\">(</span><span class=\"k\">λ</span> <span class=\"p\">(</span><span class=\"n\">lvs</span><span class=\"p\">)</span>\n                 <span class=\"p\">(</span><span class=\"n\">inline-sort/k</span>\n                  <span class=\"n\">rvs</span> <span class=\"p\">(</span><span class=\"k\">λ</span> <span class=\"p\">(</span><span class=\"n\">rvs</span><span class=\"p\">)</span>\n                        <span class=\"p\">(</span><span class=\"n\">inline-merge/k</span> <span class=\"n\">lvs</span> <span class=\"n\">rvs</span> <span class=\"n\">k</span><span class=\"p\">))))))]))</span>\n</pre></div>\n\n</div>\n\n<p>This is changed similarly to merge/k. The only new change is using syntax-&gt;list to convert syntax to lists so we can use the functions length and split-at. Example:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"nb\">&gt;</span> <span class=\"p\">(</span><span class=\"n\">inline-sort</span> <span class=\"mi\">5</span> <span class=\"mi\">2</span> <span class=\"mi\">3</span> <span class=\"mi\">1</span><span class=\"p\">)</span>\n<span class=\"mi\">1</span>\n<span class=\"mi\">2</span>\n<span class=\"mi\">3</span>\n<span class=\"mi\">5</span>\n</pre></div>\n\n</div>\n\n<p>Of course, the result of evaluating an inline-sort doesn’t tell the whole story. Let’s fire up the macro stepper and see what (inline-sort 5 2 3) expands to. Copying from the macro stepper window and renaming temp variables, we get</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">let</span> <span class=\"p\">([</span><span class=\"n\">a</span> <span class=\"mi\">5</span><span class=\"p\">]</span> <span class=\"p\">[</span><span class=\"n\">b</span> <span class=\"mi\">2</span><span class=\"p\">]</span> <span class=\"p\">[</span><span class=\"n\">c</span> <span class=\"mi\">3</span><span class=\"p\">])</span>\n  <span class=\"p\">(</span><span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"nb\">&lt;</span> <span class=\"n\">b</span> <span class=\"n\">c</span><span class=\"p\">)</span>\n      <span class=\"p\">(</span><span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"nb\">&lt;</span> <span class=\"n\">a</span> <span class=\"n\">b</span><span class=\"p\">)</span>\n          <span class=\"p\">(</span><span class=\"nb\">values</span> <span class=\"n\">a</span> <span class=\"n\">b</span> <span class=\"n\">c</span><span class=\"p\">)</span>\n          <span class=\"p\">(</span><span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"nb\">&lt;</span> <span class=\"n\">a</span> <span class=\"n\">c</span><span class=\"p\">)</span>\n              <span class=\"p\">(</span><span class=\"nb\">values</span> <span class=\"n\">b</span> <span class=\"n\">a</span> <span class=\"n\">c</span><span class=\"p\">)</span>\n              <span class=\"p\">(</span><span class=\"nb\">values</span> <span class=\"n\">b</span> <span class=\"n\">c</span> <span class=\"n\">a</span><span class=\"p\">)))</span>\n      <span class=\"p\">(</span><span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"nb\">&lt;</span> <span class=\"n\">a</span> <span class=\"n\">c</span><span class=\"p\">)</span>\n          <span class=\"p\">(</span><span class=\"nb\">values</span> <span class=\"n\">a</span> <span class=\"n\">c</span> <span class=\"n\">b</span><span class=\"p\">)</span>\n          <span class=\"p\">(</span><span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"nb\">&lt;</span> <span class=\"n\">a</span> <span class=\"n\">b</span><span class=\"p\">)</span>\n              <span class=\"p\">(</span><span class=\"nb\">values</span> <span class=\"n\">c</span> <span class=\"n\">a</span> <span class=\"n\">b</span><span class=\"p\">)</span>\n              <span class=\"p\">(</span><span class=\"nb\">values</span> <span class=\"n\">c</span> <span class=\"n\">b</span> <span class=\"n\">a</span><span class=\"p\">)))))</span>\n</pre></div>\n\n</div>\n\n<p>It’s an if tree. Notice that there are 6 leaf expressions, for the 3! = 6 possible permutations. Also, it never compares more than it has to. It’s optimal.</p>\n\n<h2 id=\"inline-sort-properties\">Inline Sort Properties</h2>\n\n<p>Inherited from the merge sort, the inline sort has the following properties (assuming a length-n list):</p>\n\n<ul>\n <li>\n  <p>Time optimality: The depth of the if tree is O(n log(n)).</p></li>\n <li>\n  <p>Size optimality: The number of leaves is exactly n!. The term “size optimality” is misleading, because that’s still a lot of code. I’ve seriously considered requiring any user of this macro to state how many permutations there are for the number of values they’re sorting. They’d have to prove to the macro that they know how much code they’re asking it to generate.Inline sort is wicked fast, as we should expect:</p></li></ul>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"nb\">&gt;</span> <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"n\">vs</span> <span class=\"o\">&#39;</span><span class=\"p\">(</span><span class=\"mi\">5</span> <span class=\"mi\">2</span> <span class=\"mi\">3</span> <span class=\"mi\">1</span><span class=\"p\">))</span>\n<span class=\"nb\">&gt;</span> <span class=\"p\">(</span><span class=\"k\">match-define</span> <span class=\"p\">(</span><span class=\"nb\">list</span> <span class=\"n\">a</span> <span class=\"n\">b</span> <span class=\"n\">c</span> <span class=\"n\">d</span><span class=\"p\">)</span> <span class=\"n\">vs</span><span class=\"p\">)</span>\n<span class=\"nb\">&gt;</span> <span class=\"p\">(</span><span class=\"k\">for</span> <span class=\"p\">([</span><span class=\"k\">_</span>  <span class=\"p\">(</span><span class=\"nb\">in-range</span> <span class=\"mi\">5</span><span class=\"p\">)])</span>\n    <span class=\"p\">(</span><span class=\"k\">time</span> <span class=\"p\">(</span><span class=\"k\">for</span> <span class=\"p\">([</span><span class=\"k\">_</span>  <span class=\"p\">(</span><span class=\"nb\">in-range</span> <span class=\"mi\">1000000</span><span class=\"p\">)])</span>\n            <span class=\"p\">(</span><span class=\"k\">match-let</span> <span class=\"p\">([(</span><span class=\"nb\">list</span> <span class=\"n\">a</span> <span class=\"n\">b</span> <span class=\"n\">c</span> <span class=\"n\">d</span><span class=\"p\">)</span>  <span class=\"p\">(</span><span class=\"nb\">sort</span> <span class=\"n\">vs</span> <span class=\"nb\">&lt;</span><span class=\"p\">)])</span>\n              <span class=\"p\">(</span><span class=\"nb\">void</span><span class=\"p\">)))))</span>\n<span class=\"n\">cpu</span> <span class=\"n\">time:</span> <span class=\"mi\">550</span> <span class=\"n\">real</span> <span class=\"n\">time:</span> <span class=\"mi\">540</span> <span class=\"n\">gc</span> <span class=\"n\">time:</span> <span class=\"mi\">30</span>\n<span class=\"n\">cpu</span> <span class=\"n\">time:</span> <span class=\"mi\">510</span> <span class=\"n\">real</span> <span class=\"n\">time:</span> <span class=\"mi\">518</span> <span class=\"n\">gc</span> <span class=\"n\">time:</span> <span class=\"mi\">0</span>\n<span class=\"n\">cpu</span> <span class=\"n\">time:</span> <span class=\"mi\">520</span> <span class=\"n\">real</span> <span class=\"n\">time:</span> <span class=\"mi\">517</span> <span class=\"n\">gc</span> <span class=\"n\">time:</span> <span class=\"mi\">20</span>\n<span class=\"n\">cpu</span> <span class=\"n\">time:</span> <span class=\"mi\">520</span> <span class=\"n\">real</span> <span class=\"n\">time:</span> <span class=\"mi\">517</span> <span class=\"n\">gc</span> <span class=\"n\">time:</span> <span class=\"mi\">0</span>\n<span class=\"n\">cpu</span> <span class=\"n\">time:</span> <span class=\"mi\">510</span> <span class=\"n\">real</span> <span class=\"n\">time:</span> <span class=\"mi\">516</span> <span class=\"n\">gc</span> <span class=\"n\">time:</span> <span class=\"mi\">10</span>\n<span class=\"nb\">&gt;</span> <span class=\"p\">(</span><span class=\"k\">for</span> <span class=\"p\">([</span><span class=\"k\">_</span>  <span class=\"p\">(</span><span class=\"nb\">in-range</span> <span class=\"mi\">5</span><span class=\"p\">)])</span>\n    <span class=\"p\">(</span><span class=\"k\">time</span> <span class=\"p\">(</span><span class=\"k\">for</span> <span class=\"p\">([</span><span class=\"k\">_</span>  <span class=\"p\">(</span><span class=\"nb\">in-range</span> <span class=\"mi\">1000000</span><span class=\"p\">)])</span>\n            <span class=\"p\">(</span><span class=\"k\">let-values</span> <span class=\"p\">([(</span><span class=\"n\">a</span> <span class=\"n\">b</span> <span class=\"n\">c</span> <span class=\"n\">d</span><span class=\"p\">)</span>  <span class=\"p\">(</span><span class=\"n\">inline-sort</span> <span class=\"n\">a</span> <span class=\"n\">b</span> <span class=\"n\">c</span> <span class=\"n\">d</span><span class=\"p\">)])</span>\n              <span class=\"p\">(</span><span class=\"nb\">void</span><span class=\"p\">)))))</span>\n<span class=\"n\">cpu</span> <span class=\"n\">time:</span> <span class=\"mi\">20</span> <span class=\"n\">real</span> <span class=\"n\">time:</span> <span class=\"mi\">28</span> <span class=\"n\">gc</span> <span class=\"n\">time:</span> <span class=\"mi\">0</span>\n<span class=\"n\">cpu</span> <span class=\"n\">time:</span> <span class=\"mi\">30</span> <span class=\"n\">real</span> <span class=\"n\">time:</span> <span class=\"mi\">27</span> <span class=\"n\">gc</span> <span class=\"n\">time:</span> <span class=\"mi\">0</span>\n<span class=\"n\">cpu</span> <span class=\"n\">time:</span> <span class=\"mi\">30</span> <span class=\"n\">real</span> <span class=\"n\">time:</span> <span class=\"mi\">27</span> <span class=\"n\">gc</span> <span class=\"n\">time:</span> <span class=\"mi\">0</span>\n<span class=\"n\">cpu</span> <span class=\"n\">time:</span> <span class=\"mi\">30</span> <span class=\"n\">real</span> <span class=\"n\">time:</span> <span class=\"mi\">27</span> <span class=\"n\">gc</span> <span class=\"n\">time:</span> <span class=\"mi\">0</span>\n<span class=\"n\">cpu</span> <span class=\"n\">time:</span> <span class=\"mi\">20</span> <span class=\"n\">real</span> <span class=\"n\">time:</span> <span class=\"mi\">27</span> <span class=\"n\">gc</span> <span class=\"n\">time:</span> <span class=\"mi\">0</span>\n</pre></div>\n\n</div>\n\n<p>So about 20 times faster than sort on a length&ndash;4 list.I use it in Typed Racket, on floating-point numbers. Typed Racket’s optimizer replaces <code>&lt;</code> with <code>unsafe-fl&lt;</code>. This tells the compiler that the elements are floats, so it can keep them stack-allocated, which reduces allocations further. In all, for my particular use of inline-sort, it’s over 50 times faster than sort.And using it is a heckuvalot easier than writing an if tree and reasoning about transitivity every time I need to sort a handful of floats.</p>\n\n<h2 id=\"conclusion\">Conclusion</h2>\n\n<p> Writing macros in expansion-time CPS to fully inline a recursive function works out beautifully. I suspect that it will work on any recursive, polymorphic function whose well-foundedness follows only from the structure of the input data.Also, it can generate a metric truckload of code.Interesting note: I originally wrote inline-sort using only syntax-rules, passing the names of higher-order macros to other macros as continuations. Sorting a five-element list took almost 19000 expansion steps, which is ridiculously inefficient even for a 120-leaf if tree.</p>\n<!-- more-->\n\n<hr />\n\n<p>Looks like a functional pearl to me!</p>\n\n<p>— <em>Matt, 24 August 2012</em></p>\n\n<hr />\n\n<p>As i remember, sorting networks macro from <code>Let over Lambda</code> book, solves the same problem differently.</p>\n\n<p>— <em>kmmbvnr, 24 August 2012</em></p>\n\n<hr />")) ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2009-02-18-steering-scheme.md" . unix) f post (u . "Steering Scheme") (? . 61) 1467223812 (p+ #"/Users/MB/git/racket-lang-org/blog/2009/02/steering-scheme.html" . unix) "/2009/02/steering-scheme.html" (u . "2009-02-18T10:49:00.003-05:00") (? . 26) (? . 69) (c (u . "")) (u . "\n<p><em>posted by matthias</em></p>\n\n<p>Election time is here again. A couple more days and the Scheme community will have a set of new steer-ers.</p>\n\n<p>What should we want from a steering committee?</p>\n\n<p>I have argued at this place before that good language design needs a feedback loop. Language designers write down specs; language implementers translate those specs into compilers and interpreters; programmers use these implementations to produce useful software. The loop comes in when implementers inform designers of flaws, inconsistencies, mistakes, errors, and other internal consistency problems in the specs. This is clearly happening with R6RS, and it is good. Implementers are a biased bunch, however. After all, they work on just one kind of program, and in a highly specialized domain that has been mined for a long time. How can you trust them? [*]</p>\n\n<p>The loop becomes truly useful when people write large software systems (not just compilers, because they really are special cases!) and find that the language fails them in some way. Such failures can come in a number of flavors. For a document such as R6RS, we should hope that programmers can discover problems with porting systems that are apparently due to ambiguities, flaws, mistakes, roaches in the actual document (as opposed to a specific implementation).</p>\n\n<p>So what does this have to do with the steering committee?</p>\n\n<p>The last thing we want from a steering committee is a radical commitment to change (whatever it may be); a prejudice concerning R6RS; a closed mind about the size of &ldquo;Scheme&rdquo; (it&rsquo;s too large, it&rsquo;s too small); a willingness to steer without making observations. A steering committee of overbearing curmudgeons is <em>not</em> what we want.</p>\n\n<p>What we do want is a committee that is willing to figure out how the listening is going to happen; how we can possibly finance a systematic way of listening (writing NSF grants, anyone?); how the feedback is best channeled into language design.</p>\n\n<p>Let&rsquo;s hope we get such a steering committee. The Scheme community deserves it.</p>\n\n<p>[*] No I am not naive enough to think that language implementers don&rsquo;t design languages, and that implementers don&rsquo;t program systems other than implementations. I am just skeptical that it is easy for them to separate out their various roles in an objective manner, even if many of them are able to think at several different levels about programs.</p>") #f (u . "\n<p><em>posted by matthias</em></p>\n\n<p>Election time is here again. A couple more days and the Scheme community will have a set of new steer-ers.</p>\n\n<p>What should we want from a steering committee?</p>\n\n<p>I have argued at this place before that good language design needs a feedback loop. Language designers write down specs; language implementers translate those specs into compilers and interpreters; programmers use these implementations to produce useful software. The loop comes in when implementers inform designers of flaws, inconsistencies, mistakes, errors, and other internal consistency problems in the specs. This is clearly happening with R6RS, and it is good. Implementers are a biased bunch, however. After all, they work on just one kind of program, and in a highly specialized domain that has been mined for a long time. How can you trust them? [*]</p>\n\n<p>The loop becomes truly useful when people write large software systems (not just compilers, because they really are special cases!) and find that the language fails them in some way. Such failures can come in a number of flavors. For a document such as R6RS, we should hope that programmers can discover problems with porting systems that are apparently due to ambiguities, flaws, mistakes, roaches in the actual document (as opposed to a specific implementation).</p>\n\n<p>So what does this have to do with the steering committee?</p>\n\n<p>The last thing we want from a steering committee is a radical commitment to change (whatever it may be); a prejudice concerning R6RS; a closed mind about the size of &ldquo;Scheme&rdquo; (it&rsquo;s too large, it&rsquo;s too small); a willingness to steer without making observations. A steering committee of overbearing curmudgeons is <em>not</em> what we want.</p>\n\n<p>What we do want is a committee that is willing to figure out how the listening is going to happen; how we can possibly finance a systematic way of listening (writing NSF grants, anyone?); how the feedback is best channeled into language design.</p>\n\n<p>Let&rsquo;s hope we get such a steering committee. The Scheme community deserves it.</p>\n\n<p>[*] No I am not naive enough to think that language implementers don&rsquo;t design languages, and that implementers don&rsquo;t program systems other than implementations. I am just skeptical that it is easy for them to separate out their various roles in an objective manner, even if many of them are able to think at several different levels about programs.</p>")) ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2009-05-18-soft-state-in-the-plt-web-server.md" . unix) f post (u . "Soft State in the PLT Web Server") (? . 27) 1467223812 (p+ #"/Users/MB/git/racket-lang-org/blog/2009/05/soft-state-in-the-plt-web-server.html" . unix) "/2009/05/soft-state-in-the-plt-web-server.html" (u . "2009-05-18T16:47:00.000-04:00") (? . 55) (? . 28) (c (u . "")) (u . "\n<p><em>posted by Jay McCarthy</em></p>\n\n<p>Many Web applications and network protocols have values in the continuation that are necessary to complete the computation, but that may be recomputed if they are not available. This is &ldquo;soft state&rdquo;.</p>\n\n<p>For example, a Web application may cache a user&rsquo;s preferences from a database and deliver it to a Web browser as a hidden value; when the value is returned to the application in subsequent steps, it is used to customize the display. However, if the preferences were not available (or were corrupted in some way), the application could retrieve them from the database.</p>\n\n<p>When using the PLT Web Server&rsquo;s native continuations, this roughly corresponds to the use of a <em>weak box</em>: a box that the GC is allowed to erase the contents of. When using the PLT Web Server&rsquo;s serializable continuations it roughly corresponds to a weak box and a <em>weak hash table</em> (that holds its keys weakly) to give the box a serializable value as an identifier.</p>\n\n<p>This programming pattern is a bit difficult to get right. So, a library that implements it is now provided with PLT Scheme: <a href=\"http://faculty.cs.byu.edu/~jay/plt-doc/web-server/stateless.html#(part._.Soft_.State)\"><code>web-server/lang/soft</code></a>.</p>\n\n<p>Here&rsquo;s a trivial example:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"kn\">#lang </span><span class=\"nn\">web-server</span>\n\n<span class=\"p\">(</span><span class=\"k\">provide</span> <span class=\"n\">interface-version</span> <span class=\"n\">start</span><span class=\"p\">)</span>\n<span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"n\">interface-version</span> <span class=\"o\">&#39;</span><span class=\"ss\">stateless</span><span class=\"p\">)</span>\n\n<span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"n\">softie</span>\n  <span class=\"p\">(</span><span class=\"n\">soft-state</span>\n   <span class=\"p\">(</span><span class=\"nb\">printf</span> <span class=\"s2\">\"Doing a long computation...~n\"</span><span class=\"p\">)</span>\n   <span class=\"p\">(</span><span class=\"nb\">sleep</span> <span class=\"mi\">1</span><span class=\"p\">)))</span>\n\n<span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">start</span> <span class=\"n\">req</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"n\">soft-state-ref</span> <span class=\"n\">softie</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"nb\">printf</span> <span class=\"s2\">\"Done~n\"</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"n\">start</span>\n   <span class=\"p\">(</span><span class=\"n\">send/suspend</span>\n    <span class=\"p\">(</span><span class=\"k\">lambda</span> <span class=\"p\">(</span><span class=\"n\">k-url</span><span class=\"p\">)</span>\n      <span class=\"o\">`</span><span class=\"p\">(</span><span class=\"ss\">html</span> <span class=\"p\">(</span><span class=\"ss\">body</span> <span class=\"p\">(</span><span class=\"ss\">a</span> <span class=\"p\">([</span><span class=\"ss\">href</span> <span class=\"o\">,</span><span class=\"n\">k-url</span><span class=\"p\">])</span> <span class=\"s2\">\"Done\"</span><span class=\"p\">)))))))</span>\n</pre></div>\n\n</div>") #f (u . "\n<p><em>posted by Jay McCarthy</em></p>\n\n<p>Many Web applications and network protocols have values in the continuation that are necessary to complete the computation, but that may be recomputed if they are not available. This is &ldquo;soft state&rdquo;.</p>\n\n<p>For example, a Web application may cache a user&rsquo;s preferences from a database and deliver it to a Web browser as a hidden value; when the value is returned to the application in subsequent steps, it is used to customize the display. However, if the preferences were not available (or were corrupted in some way), the application could retrieve them from the database.</p>\n\n<p>When using the PLT Web Server&rsquo;s native continuations, this roughly corresponds to the use of a <em>weak box</em>: a box that the GC is allowed to erase the contents of. When using the PLT Web Server&rsquo;s serializable continuations it roughly corresponds to a weak box and a <em>weak hash table</em> (that holds its keys weakly) to give the box a serializable value as an identifier.</p>\n\n<p>This programming pattern is a bit difficult to get right. So, a library that implements it is now provided with PLT Scheme: <a href=\"http://faculty.cs.byu.edu/~jay/plt-doc/web-server/stateless.html#(part._.Soft_.State)\"><code>web-server/lang/soft</code></a>.</p>\n\n<p>Here&rsquo;s a trivial example:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"kn\">#lang </span><span class=\"nn\">web-server</span>\n\n<span class=\"p\">(</span><span class=\"k\">provide</span> <span class=\"n\">interface-version</span> <span class=\"n\">start</span><span class=\"p\">)</span>\n<span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"n\">interface-version</span> <span class=\"o\">&#39;</span><span class=\"ss\">stateless</span><span class=\"p\">)</span>\n\n<span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"n\">softie</span>\n  <span class=\"p\">(</span><span class=\"n\">soft-state</span>\n   <span class=\"p\">(</span><span class=\"nb\">printf</span> <span class=\"s2\">\"Doing a long computation...~n\"</span><span class=\"p\">)</span>\n   <span class=\"p\">(</span><span class=\"nb\">sleep</span> <span class=\"mi\">1</span><span class=\"p\">)))</span>\n\n<span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">start</span> <span class=\"n\">req</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"n\">soft-state-ref</span> <span class=\"n\">softie</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"nb\">printf</span> <span class=\"s2\">\"Done~n\"</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"n\">start</span>\n   <span class=\"p\">(</span><span class=\"n\">send/suspend</span>\n    <span class=\"p\">(</span><span class=\"k\">lambda</span> <span class=\"p\">(</span><span class=\"n\">k-url</span><span class=\"p\">)</span>\n      <span class=\"o\">`</span><span class=\"p\">(</span><span class=\"ss\">html</span> <span class=\"p\">(</span><span class=\"ss\">body</span> <span class=\"p\">(</span><span class=\"ss\">a</span> <span class=\"p\">([</span><span class=\"ss\">href</span> <span class=\"o\">,</span><span class=\"n\">k-url</span><span class=\"p\">])</span> <span class=\"s2\">\"Done\"</span><span class=\"p\">)))))))</span>\n</pre></div>\n\n</div>")) ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2015-09-22-racket-package-server-security-vulnerabilities.md" . unix) f post (u . "Racket Package Server Security Vulnerabilities") (? . 103) 1467223812 (p+ #"/Users/MB/git/racket-lang-org/blog/2015/09/racket-package-server-security-vulnerabilities.html" . unix) "/2015/09/racket-package-server-security-vulnerabilities.html" (u . "2015-09-22T00:10:00.000-04:00") (? . 29) (? . 38) (c (u . "")) (u . "\n<p><em>posted by Sam Tobin-Hochstadt</em></p>\n\n<p>Recently, we discovered several security vulnerabilities with how both the Racket package catalog server and the Racket package client work. The vulnerabilities have now all been fixed, and we do not know of any exploitation of them. However, we encourage you to take the following steps:</p>\n\n<ul>\n <li>\n  <p>Change your password on the <a href=\"http://pkgs.racket-lang.org\">http://pkgs.racket-lang.org</a> site.</p></li>\n <li>\n  <p>Check any packages you have uploaded to the site, to ensure that no unexpected changes have been made to them.</p></li>\n <li>\n  <p>Do not use the released versions of the raco pkg catalog-archive command, or the <code>file/untar</code> and <code>file/unzip</code> libraries, on untrusted inputs. If you use these tools or libraries, use a snapshot build available from <a href=\"http://pre.racket-lang.org/\">http://pre.racket-lang.org/</a>.</p></li></ul>\n\n<h2 id=\"the-errors-and-how-they-were-fixed\">The errors, and how they were fixed</h2>\n\n<p>A total of 5 errors related to package handling were reported to us by Tony Garnock-Jones and Asumu Takikawa. Two were XSS vulnerabilities relating to handling user input in the package administration dialog. One was an error where unsanitized email addresses with path name components in them could allow a malicious user to impersonate someone else, whom they shared an email suffix with (such addresses are illegal on most mail servers, like Outlook and GMail, but not illegal in SMTP itself.) Two were errors in handling MANIFEST files and tar/zip archives, which allowed decompression to write to arbitrary locations on the file system. These last errors affected not only the server, which decompresses packages to analyze them, but also clients using the commands described above.</p>\n\n<p>The relevant server-side code was fixed to appropriately sanitize user input. The package handling libraries now reject any attempts to navigate up the filesystem hierarchy, meaning that these attacks are no longer possible.</p>\n\n<p>Unfortunately, due to the nature of these attacks, we cannot be sure that they were not exploited, but we have no evidence that they were. Therefore, we encourage anyone with an account to change their password, and to treat the password as compromised. Please also check your existing packages to make sure they are as you left them.</p>\n\n<p>Furthermore, using the <code>file/untar</code> and <code>file/unzip</code> libraries, the raco pkg catalog-archive command, and the internal functions that manipulate packages is not safe on untrusted inputs in released versions of Racket. Since raco pkg install executes code, it is already unsafe to use on untrusted packages, but simply extracting malicious packages is also unsafe.</p>\n\n<p>We have not released a new version of Racket, but encourage anyone who needs to perform these commands to use a snapshot build. The next version of Racket will be released on-schedule in October. If, however, you would benefit from a patched version of Racket 6.2.1, please let us know.</p>") #f (u . "\n<p><em>posted by Sam Tobin-Hochstadt</em></p>\n\n<p>Recently, we discovered several security vulnerabilities with how both the Racket package catalog server and the Racket package client work. The vulnerabilities have now all been fixed, and we do not know of any exploitation of them. However, we encourage you to take the following steps:</p>\n\n<ul>\n <li>\n  <p>Change your password on the <a href=\"http://pkgs.racket-lang.org\">http://pkgs.racket-lang.org</a> site.</p></li>\n <li>\n  <p>Check any packages you have uploaded to the site, to ensure that no unexpected changes have been made to them.</p></li>\n <li>\n  <p>Do not use the released versions of the raco pkg catalog-archive command, or the <code>file/untar</code> and <code>file/unzip</code> libraries, on untrusted inputs. If you use these tools or libraries, use a snapshot build available from <a href=\"http://pre.racket-lang.org/\">http://pre.racket-lang.org/</a>.</p></li></ul>\n\n<h2 id=\"the-errors-and-how-they-were-fixed\">The errors, and how they were fixed</h2>\n\n<p>A total of 5 errors related to package handling were reported to us by Tony Garnock-Jones and Asumu Takikawa. Two were XSS vulnerabilities relating to handling user input in the package administration dialog. One was an error where unsanitized email addresses with path name components in them could allow a malicious user to impersonate someone else, whom they shared an email suffix with (such addresses are illegal on most mail servers, like Outlook and GMail, but not illegal in SMTP itself.) Two were errors in handling MANIFEST files and tar/zip archives, which allowed decompression to write to arbitrary locations on the file system. These last errors affected not only the server, which decompresses packages to analyze them, but also clients using the commands described above.</p>\n\n<p>The relevant server-side code was fixed to appropriately sanitize user input. The package handling libraries now reject any attempts to navigate up the filesystem hierarchy, meaning that these attacks are no longer possible.</p>\n\n<p>Unfortunately, due to the nature of these attacks, we cannot be sure that they were not exploited, but we have no evidence that they were. Therefore, we encourage anyone with an account to change their password, and to treat the password as compromised. Please also check your existing packages to make sure they are as you left them.</p>\n\n<p>Furthermore, using the <code>file/untar</code> and <code>file/unzip</code> libraries, the raco pkg catalog-archive command, and the internal functions that manipulate packages is not safe on untrusted inputs in released versions of Racket. Since raco pkg install executes code, it is already unsafe to use on untrusted packages, but simply extracting malicious packages is also unsafe.</p>\n\n<p>We have not released a new version of Racket, but encourage anyone who needs to perform these commands to use a snapshot build. The next version of Racket will be released on-schedule in October. If, however, you would benefit from a patched version of Racket 6.2.1, please let us know.</p>")) ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2012-08-29-racketcon-2012.md" . unix) f post (u . "RacketCon 2012") (? . 116) 1467223812 (p+ #"/Users/MB/git/racket-lang-org/blog/2012/08/racketcon-2012.html" . unix) "/2012/08/racketcon-2012.html" (u . "2012-08-29T13:00:00.000-04:00") (? . 30) (? . 129) (c (u . "")) (u . "\n<p><em>posted by Sam Tobin-Hochstadt</em></p>\n\n<p>We&rsquo;re pleased to announce that <a href=\"http://con.racket-lang.org/\">(second RacketCon)</a> will take place on October 13, 2012, at Northeastern University in Boston. This year, RacketCon will feature 3 2-hour tutorial sessions, as well as a series of short talks about development in and of Racket over the last year.</p>\n\n<p>Potential tutorial sessions include:</p>\n\n<ul>\n <li>\n  <p>Building a new domain-specific language using syntactic extension</p></li>\n <li>\n  <p>Using contracts in application development</p></li>\n <li>\n  <p>Adding types to an existing application with Typed Racket</p></li>\n <li>\n  <p>Parallelizing Racket applications with futures and places Potential talks include:</p></li>\n <li>\n  <p>submodules</p></li>\n <li>\n  <p>WhaleSong</p></li>\n <li>\n  <p>futures and visualization</p></li>\n <li>\n  <p>distributed places</p></li>\n <li>\n  <p>optimization coaching</p></li>\n <li>\n  <p>Dracula and ACL2</p></li>\n <li>\n  <p>PLT Redex Lunch will be provided.</p></li></ul>\n\n<p>On Sunday after RacketCon, we plan to hold a hackathon to work as a group on various Racket projects such as documentation improvements and FFI bindings. This will be organized by <a href=\"http://www.ccs.neu.edu/home/asumu/\">Asumu Takikawa</a>.</p>\n\n<p>To register, fill out <a href=\"http://bit.ly/racketconsignup\">this form</a>. The <a href=\"http://con.racket-lang.org/\">conference website</a> has more information.</p>") #f (u . "\n<p><em>posted by Sam Tobin-Hochstadt</em></p>\n\n<p>We&rsquo;re pleased to announce that <a href=\"http://con.racket-lang.org/\">(second RacketCon)</a> will take place on October 13, 2012, at Northeastern University in Boston. This year, RacketCon will feature 3 2-hour tutorial sessions, as well as a series of short talks about development in and of Racket over the last year.</p>\n\n<p>Potential tutorial sessions include:</p>\n\n<ul>\n <li>\n  <p>Building a new domain-specific language using syntactic extension</p></li>\n <li>\n  <p>Using contracts in application development</p></li>\n <li>\n  <p>Adding types to an existing application with Typed Racket</p></li>\n <li>\n  <p>Parallelizing Racket applications with futures and places Potential talks include:</p></li>\n <li>\n  <p>submodules</p></li>\n <li>\n  <p>WhaleSong</p></li>\n <li>\n  <p>futures and visualization</p></li>\n <li>\n  <p>distributed places</p></li>\n <li>\n  <p>optimization coaching</p></li>\n <li>\n  <p>Dracula and ACL2</p></li>\n <li>\n  <p>PLT Redex Lunch will be provided.</p></li></ul>\n\n<p>On Sunday after RacketCon, we plan to hold a hackathon to work as a group on various Racket projects such as documentation improvements and FFI bindings. This will be organized by <a href=\"http://www.ccs.neu.edu/home/asumu/\">Asumu Takikawa</a>.</p>\n\n<p>To register, fill out <a href=\"http://bit.ly/racketconsignup\">this form</a>. The <a href=\"http://con.racket-lang.org/\">conference website</a> has more information.</p>")) ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2012-11-15-drracket-now-more-responsive.md" . unix) f post (u . "DrRacket, now more responsive") (? . 31) 1467223812 (p+ #"/Users/MB/git/racket-lang-org/blog/2012/11/drracket-now-more-responsive.html" . unix) "/2012/11/drracket-now-more-responsive.html" (u . "2012-11-15T00:26:00.000-05:00") (? . 32) (? . 33) (c (u . "")) (u . "\n<p><em>posted by Robby Findler</em></p>\n\n<p>DrRacket is now more responsive when editing than the 5.3.1 release. How much more? Well, I ran a script that starts up DrRacket, opens class-internal.rkt from the distribution and puts the insertion point right before the first \" character. It then repeats these three steps 10 times: first it types fdjafjdklafjkdalsfjdaklfjdkaslfdjafjdklafjkdalsfjdaklfjdkasl as fast as it can, then it types the same number of backspaces. Next it type \"a and waits for the syntax colorer to finish adjusting the colors. Then it deletes those two (again with two backspaces) finally waits for background check syntax to complete.</p>\n\n<p>The script also measures the number of wall-clock milliseconds that the handling of each event took and here are the results:</p>\n\n<p>Each vertical bar’s hight is proportional to the percentage of the events that took at least the corresponding number of milliseconds. The red bars show how well version 5.3.1’s DrRacket does, and the blue shows how the current git head fares (as of <a href=\"http://git.racket-lang.org/plt/commit/a4d440a5\">http://git.racket-lang.org/plt/commit/a4d440a5</a>).</p>\n\n<p>As you can see, about 80% of the events took less than 26 milliseconds to complete in the current version, but more like 60 milliseconds in 5.3.1. As some sense of scale, a television refreshes its screen every 16 2/3s millseconds, so if all of the events took less than that then DrRacket would feel very responsive indeed.</p>\n\n<p>How?:  The key to finding all of the performance improvements was finding something to measure. It sounds simple (and indeed, it didn’t take long to do), but once I had that, it because relatively easy to find suspiciously slow events, to sort out what they were doing and to speed them up. (Thanks to <a href=\"http://www.cs.utah.edu/~mflatt/\">Matthew</a> for this excellent advice!)</p>\n\n<p>Specifically, I added a bunch of logging to various parts of racket/gui, framework, and DrRacket itself. For example, the graphs above are generated from logging information about how long events take to be handled.</p>\n\n<p>Some of the problems were stupid things, e.g., <a href=\"http://git.racket-lang.org/plt/commit/4421e227ffa\">there was one place</a> where DrRacket was overriding a callback that happened on each keystroke that would invalidate the entire visible region of the editor. This forced the entire buffer to be redrawn on each keystroke, making DrRacket’s sluggishness proportional to the size of the definitions window(!).</p>\n\n<p>The performance graph above was recorded a smallish window, namely maximzed on my laptop: 1365x740. A bigger window doesn’t change the blue bars, but here’s how a 1102x1174 changes the red ones:</p>\n\n<p>There were two more complex fixes. First: background check syntax. It runs mostly in a separate, parallel place and thus (on a multi-core machine) doesn’t interfere with DrRacket’s editing all. The last phase, however, is to communicate the results of check syntax back and that has to update state on the GUI and thus competes with the handling of callbacks. This communication breaks up the check syntax information into chunks and installs that information one chunk at a time, so as to avoid tying up the event handling thread for too long. Thanks to some logging, I found that some of the chunks were too large and was able to split them up into smaller chunks.</p>\n\n<p>The most complex change was in the syntax colorer. It used to use a co-routine that would parse part of the buffer, suspend the co-routine, color the part it parsed, and then yield control back to handle other events. Unfortunately, the coroutine would commonly run for 10 or 15 milliseconds, but then build up 30 or 40 milliseconds worth of work to do to color the buffer. The fix to the colorer was to eliminate the co-routine and interleave the coloring and the parsing, meaning the whole process now has finer granularity, and thus is able to be interrupted more frequently and more accurately.</p>\n\n<p>Not done yet:  There is still a lot more to do. Editing scribble files is less responsive and the contour window definitely still makes DrRacket sluggish. Yesterday I was able to get DrRacket in a state that brought back some sluggishness and I don’t know how I did that (restarting DrRacket got rid of the problem, unfortunately). I also think I need to look more closely and what happens when purple search bubbles are visible. An interactive GC would probably also help.</p>\n\n<p>If you spot some way to make DrRacket feel more sluggish than it should be, please let me know!</p>") #t (u . "\n<p><em>posted by Robby Findler</em></p>\n\n<p>DrRacket is now more responsive when editing than the 5.3.1 release. How much more? Well, I ran a script that starts up DrRacket, opens class-internal.rkt from the distribution and puts the insertion point right before the first \" character. It then repeats these three steps 10 times: first it types fdjafjdklafjkdalsfjdaklfjdkaslfdjafjdklafjkdalsfjdaklfjdkasl as fast as it can, then it types the same number of backspaces. Next it type \"a and waits for the syntax colorer to finish adjusting the colors. Then it deletes those two (again with two backspaces) finally waits for background check syntax to complete.</p>\n\n<p>The script also measures the number of wall-clock milliseconds that the handling of each event took and here are the results:</p>\n\n<p>Each vertical bar’s hight is proportional to the percentage of the events that took at least the corresponding number of milliseconds. The red bars show how well version 5.3.1’s DrRacket does, and the blue shows how the current git head fares (as of <a href=\"http://git.racket-lang.org/plt/commit/a4d440a5\">http://git.racket-lang.org/plt/commit/a4d440a5</a>).</p>\n\n<p>As you can see, about 80% of the events took less than 26 milliseconds to complete in the current version, but more like 60 milliseconds in 5.3.1. As some sense of scale, a television refreshes its screen every 16 2/3s millseconds, so if all of the events took less than that then DrRacket would feel very responsive indeed.</p>\n\n<p>How?:  The key to finding all of the performance improvements was finding something to measure. It sounds simple (and indeed, it didn’t take long to do), but once I had that, it because relatively easy to find suspiciously slow events, to sort out what they were doing and to speed them up. (Thanks to <a href=\"http://www.cs.utah.edu/~mflatt/\">Matthew</a> for this excellent advice!)</p>\n\n<p>Specifically, I added a bunch of logging to various parts of racket/gui, framework, and DrRacket itself. For example, the graphs above are generated from logging information about how long events take to be handled.</p>\n\n<p>Some of the problems were stupid things, e.g., <a href=\"http://git.racket-lang.org/plt/commit/4421e227ffa\">there was one place</a> where DrRacket was overriding a callback that happened on each keystroke that would invalidate the entire visible region of the editor. This forced the entire buffer to be redrawn on each keystroke, making DrRacket’s sluggishness proportional to the size of the definitions window(!).</p>\n\n<p>The performance graph above was recorded a smallish window, namely maximzed on my laptop: 1365x740. A bigger window doesn’t change the blue bars, but here’s how a 1102x1174 changes the red ones:</p>\n\n<p>There were two more complex fixes. First: background check syntax. It runs mostly in a separate, parallel place and thus (on a multi-core machine) doesn’t interfere with DrRacket’s editing all. The last phase, however, is to communicate the results of check syntax back and that has to update state on the GUI and thus competes with the handling of callbacks. This communication breaks up the check syntax information into chunks and installs that information one chunk at a time, so as to avoid tying up the event handling thread for too long. Thanks to some logging, I found that some of the chunks were too large and was able to split them up into smaller chunks.</p>\n\n<p>The most complex change was in the syntax colorer. It used to use a co-routine that would parse part of the buffer, suspend the co-routine, color the part it parsed, and then yield control back to handle other events. Unfortunately, the coroutine would commonly run for 10 or 15 milliseconds, but then build up 30 or 40 milliseconds worth of work to do to color the buffer. The fix to the colorer was to eliminate the co-routine and interleave the coloring and the parsing, meaning the whole process now has finer granularity, and thus is able to be interrupted more frequently and more accurately.</p>\n\n<p>Not done yet:  There is still a lot more to do. Editing scribble files is less responsive and the contour window definitely still makes DrRacket sluggish. Yesterday I was able to get DrRacket in a state that brought back some sluggishness and I don’t know how I did that (restarting DrRacket got rid of the problem, unfortunately). I also think I need to look more closely and what happens when purple search bubbles are visible. An interactive GC would probably also help.</p>\n\n<p>If you spot some way to make DrRacket feel more sluggish than it should be, please let me know!</p>\n<!-- more-->\n\n<hr />\n\n<p>Excellent work!</p>\n\n<p>— <em>grant rettke, 15 November 2012</em></p>\n\n<hr />\n\n<p>the attention to details you guys have is incredible. thanks for the hard work.</p>\n\n<p>— <em>Jay Kominek, 15 November 2012</em></p>\n\n<hr />\n\n<p>As a user of DrRacket @ 2560x1600, this is amazing news!</p>\n\n<p>— <em>Nick Sivo, 15 November 2012</em></p>\n\n<hr />")) ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2010-03-08-talk-at-flourish.md" . unix) f post (u . "Talk at Flourish") (? . 34) 1467223812 (p+ #"/Users/MB/git/racket-lang-org/blog/2010/03/talk-at-flourish.html" . unix) "/2010/03/talk-at-flourish.html" (u . "2010-03-08T11:35:00.006-05:00") (? . 118) (? . 35) (c (u . "")) (u . "\n<p><em>posted by Robby Findler</em></p>\n\n<p>The image in this post shows a tree where the interior nodes represent directories and the leaf nodes represent files in the PLT source code. The leaves are colored based on the programming language used. (To avoid clutter, if there is more than one file in a given directory written in a particular language, that language only gets a single dot.)</p>\n\n<p>Some highlights: the blues are Scheme-like languages, the reds are langauges we use to write documentation (see <a href=\"http://docs.plt-scheme.org/scribble/\">Scribble</a> for more about them), the greens are teaching languages, orange is the language we use to bootstrap new languages, and yellow is a language for metadata about nearby files.</p>\n\n<p>Curious about how we managed to write and use so many different languages? I&rsquo;ll be giving a talk at <a href=\"http://www.flourishconf.com/flourish2010/\">Flourish 2010</a> next week (3/19 @11am, UIC in Chicago) explaining how. Come to learn more!</p>") #t (u . "\n<p><em>posted by Robby Findler</em></p>\n\n<p>The image in this post shows a tree where the interior nodes represent directories and the leaf nodes represent files in the PLT source code. The leaves are colored based on the programming language used. (To avoid clutter, if there is more than one file in a given directory written in a particular language, that language only gets a single dot.)</p>\n\n<p>Some highlights: the blues are Scheme-like languages, the reds are langauges we use to write documentation (see <a href=\"http://docs.plt-scheme.org/scribble/\">Scribble</a> for more about them), the greens are teaching languages, orange is the language we use to bootstrap new languages, and yellow is a language for metadata about nearby files.</p>\n\n<p>Curious about how we managed to write and use so many different languages? I&rsquo;ll be giving a talk at <a href=\"http://www.flourishconf.com/flourish2010/\">Flourish 2010</a> next week (3/19 @11am, UIC in Chicago) explaining how. Come to learn more!</p>\n<!-- more-->\n\n<hr />\n\n<p>Also curious if you drew the diagram in PLT-Scheme and how. :)</p>\n\n<p>— <em>Paulo Matos, 9 March 2010</em></p>\n\n<hr />\n\n<p>I wrote a plt script to get the data and then dropped it into twopi (a part of graphviz) to get the layout information for the graph but actually drew it using slideshow (since I wanted to tweak the drawing a little bit)</p>\n\n<p>— <em>Robby, 9 March 2010</em></p>\n\n<hr />")) ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2013-02-15-racket-v533.md" . unix) f post (u . "Racket v5.3.3") (? . 84) 1467223812 (p+ #"/Users/MB/git/racket-lang-org/blog/2013/02/racket-v533.html" . unix) "/2013/02/racket-v533.html" (u . "2013-02-15T15:51:00.003-05:00") (? . 82) (? . 70) (c (u . "")) (u . "\n<p><em>posted by Eli Barzilay</em></p>\n\n<p>Racket version 5.3.3 is now available from <a href=\"http://racket-lang.org/\">http://racket-lang.org/</a></p>\n\n<p>This is a bug-fix release to address a flaw in DrRacket v5.3.2 concerning interactions between the contour window and the syntax coloring.</p>") #t (u . "\n<p><em>posted by Eli Barzilay</em></p>\n\n<p>Racket version 5.3.3 is now available from <a href=\"http://racket-lang.org/\">http://racket-lang.org/</a></p>\n\n<p>This is a bug-fix release to address a flaw in DrRacket v5.3.2 concerning interactions between the contour window and the syntax coloring.</p>\n<!-- more-->\n\n<hr />\n\n<p>The Racket home page is unusual in not having any sort of top-level &ldquo;News&rdquo; link. Perhaps it could have a direct link to the Blog? I was reduced to googling (though I could&rsquo;ve found it under &ldquo;Community&rdquo;, I later discovered). If it&rsquo;s considered there are already enough top-level links, you might consider removing &ldquo;PLaneT&rdquo;, as it&rsquo;s not self-explanatory, and users who frequent it will presumably not go via the Racket home page (there are many quicker ways to get to PLaneT directly, and the home page&rsquo;s design looks, as it should be, newbie friendly with comprehensive navigation for experts who&rsquo;ve lost their way, rather than efficient for regular expert use).</p>\n\n<p>— <em>Reuben Thomas, 24 March 2013</em></p>\n\n<hr />")) ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2012-03-26-fixed-racket-v521-installers.md" . unix) f post (u . "Fixed Racket v5.2.1 Installers") (? . 45) 1467223812 (p+ #"/Users/MB/git/racket-lang-org/blog/2012/03/fixed-racket-v521-installers.html" . unix) "/2012/03/fixed-racket-v521-installers.html" (u . "2012-03-26T19:55:00.001-04:00") (? . 36) (? . 94) (c (u . "")) (u . "\n<p><em>posted by Eli Barzilay</em></p>\n\n<p>Dear Racketeers,</p>\n\n<p>We have just released a <a href=\"http://racket-lang.org/download/\">DrRacket version 5.2.1</a> that starts fine today. The fixed version has replaced the 5.2.1 installers. This version andthe original 5.2.1 differ only in this one fix.</p>") #f (u . "\n<p><em>posted by Eli Barzilay</em></p>\n\n<p>Dear Racketeers,</p>\n\n<p>We have just released a <a href=\"http://racket-lang.org/download/\">DrRacket version 5.2.1</a> that starts fine today. The fixed version has replaced the 5.2.1 installers. This version andthe original 5.2.1 differ only in this one fix.</p>")) ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2015-11-23-racket-v63.md" . unix) f post (u . "Racket v6.3") (? . 37) 1467223812 (p+ #"/Users/MB/git/racket-lang-org/blog/2015/11/racket-v63.html" . unix) "/2015/11/racket-v63.html" (u . "2015-11-23T23:30:00.000-05:00") (? . 38) (? . 3) (c (u . "")) (u . "\n<p><em>posted by Ryan Culpepper</em></p>\n\n<p>Racket version 6.3 is now available from <a href=\"http://racket-lang.org/\">http://racket-lang.org/</a></p>\n\n<ul>\n <li>\n  <p>Racket&rsquo;s macro expander uses a new representation of binding called &ldquo;set of scopes&rdquo;. The new binding model provides a simpler explanation of how macros preserve binding, especially across module boundaries and in hygiene-bending expansions. The new expander is mostly compatible with existing Racket macros, but there are some incompatibilities. For the formally inclined, a research paper on this macro system will appear at POPL next year: <a href=\"http://www.cs.utah.edu/plt/scope-sets/\">http://www.cs.utah.edu/plt/scope-sets/</a></p></li>\n <li>\n  <p>Racket&rsquo;s GUI library now uses Gtk+ 3 when available, instead of Gtk+ 2. Set the <code>PLT_GTK2</code> environment variable to select Gtk+ 2.</p></li>\n <li>\n  <p>Added a new Redex tutorial based on a week-long workshop in SLC.</p></li>\n <li>\n  <p>Better syntax error checking for Redex patterns that do not use holes correctly.</p></li>\n <li>\n  <p>The blueboxes are more agressive about finding names to look up in the docs, meaning they are useful much more often.</p></li>\n <li>\n  <p>Submodules are now fully supported in Typed Racket. Previously, some uses of submodules would produce internal errors, making it hard to <code>module+ test</code> and <code>module+ main</code> effectively in Typed Racket. The switch to the set-of-scopes expander fixed these problems, and submodules are now happily at home in Typed Racket.</p></li>\n <li>\n  <p>The <code>typed/racket/unsafe</code> library provides import and export forms that circumvent contract generation. This improves performance for typed-untyped interaction at the cost of safety and debuggability.</p></li>\n <li>\n  <p>Typed Racket provides experimental support for units (from <code>racket/unit</code>).</p></li>\n <li>\n  <p>The experimental <code>define-new-subtype</code> form allows overlaying finer distinctions between otherwise identical types, similar to Haskell&rsquo;s <code>new type</code>.</p></li>\n <li>\n  <p>The <code>Promise</code> type constructor changes in a backwards-incompatible way to exclude promises created with <code>promise/name</code>.</p></li>\n <li>\n  <p>The <code>unstable-*</code> packages are out of the main distribution. Most of their contents have been either merged with established Racket libraries or spun off as their own packages. This change is backwards compatible for packages that properly list their dependencies. <a href=\"../../2015/10/retiring-unstable.html\">Full details</a></p></li>\n <li>\n  <p>edu: <code>big-bang</code> supports a display-mode clause so that world programs can take over the entire screen.</p></li></ul>\n\n<p>Feedback welcome</p>") #t (u . "\n<p><em>posted by Ryan Culpepper</em></p>\n\n<p>Racket version 6.3 is now available from <a href=\"http://racket-lang.org/\">http://racket-lang.org/</a></p>\n\n<ul>\n <li>\n  <p>Racket&rsquo;s macro expander uses a new representation of binding called &ldquo;set of scopes&rdquo;. The new binding model provides a simpler explanation of how macros preserve binding, especially across module boundaries and in hygiene-bending expansions. The new expander is mostly compatible with existing Racket macros, but there are some incompatibilities. For the formally inclined, a research paper on this macro system will appear at POPL next year: <a href=\"http://www.cs.utah.edu/plt/scope-sets/\">http://www.cs.utah.edu/plt/scope-sets/</a></p></li>\n <li>\n  <p>Racket&rsquo;s GUI library now uses Gtk+ 3 when available, instead of Gtk+ 2. Set the <code>PLT_GTK2</code> environment variable to select Gtk+ 2.</p></li>\n <li>\n  <p>Added a new Redex tutorial based on a week-long workshop in SLC.</p></li>\n <li>\n  <p>Better syntax error checking for Redex patterns that do not use holes correctly.</p></li>\n <li>\n  <p>The blueboxes are more agressive about finding names to look up in the docs, meaning they are useful much more often.</p></li>\n <li>\n  <p>Submodules are now fully supported in Typed Racket. Previously, some uses of submodules would produce internal errors, making it hard to <code>module+ test</code> and <code>module+ main</code> effectively in Typed Racket. The switch to the set-of-scopes expander fixed these problems, and submodules are now happily at home in Typed Racket.</p></li>\n <li>\n  <p>The <code>typed/racket/unsafe</code> library provides import and export forms that circumvent contract generation. This improves performance for typed-untyped interaction at the cost of safety and debuggability.</p></li>\n <li>\n  <p>Typed Racket provides experimental support for units (from <code>racket/unit</code>).</p></li>\n <li>\n  <p>The experimental <code>define-new-subtype</code> form allows overlaying finer distinctions between otherwise identical types, similar to Haskell&rsquo;s <code>new type</code>.</p></li>\n <li>\n  <p>The <code>Promise</code> type constructor changes in a backwards-incompatible way to exclude promises created with <code>promise/name</code>.</p></li>\n <li>\n  <p>The <code>unstable-*</code> packages are out of the main distribution. Most of their contents have been either merged with established Racket libraries or spun off as their own packages. This change is backwards compatible for packages that properly list their dependencies. <a href=\"../../2015/10/retiring-unstable.html\">Full details</a></p></li>\n <li>\n  <p>edu: <code>big-bang</code> supports a display-mode clause so that world programs can take over the entire screen.</p></li></ul>\n\n<p>Feedback welcome</p>\n<!-- more-->\n\n<hr />\n\n<p>How to run the installer silently when we would like to distribute this to teachers with SCCM 2012.</p>\n\n<p>— <em>Ari Toivola, 25 November 2015</em></p>\n\n<hr />\n\n<p>I believe you broke the 2htdp/planetcute libraries with this release.</p>\n\n<p>At least, I get an error just like this page now shows: http://docs.racket-lang.org/teachpack/2htdpPlanet_Cute_Images.html</p>\n\n<p>(require 2htdp/planetcute)</p>\n\n<p>in the REPL:</p>\n\n<blockquote>\n <p>character-cat-girl g1: unbound identifier;  also, no #%top syntax transformer is bound in: g1</p></blockquote>\n\n<p>— <em>lalamine, 5 December 2015</em></p>\n\n<hr />\n\n<p>Ari: To run the Windows installer silently, supply the /S command-line argument</p>\n\n<p>— <em>Matthew Flatt, 9 December 2015</em></p>\n\n<hr />\n\n<p>lalamine: Thanks for the report! I cam able to replicate the problem with planetcute in v6.3. It looks like the problem happens only in interactive modes like the REPL and docs, and not when used within a module.</p>\n\n<p>The problem seems to be fixed in our development snapshots. Unfortunately, I don&rsquo;t know how it got broken or fixed, so we&rsquo;ll have to investigate more to ensure that the bug stays fixed.</p>\n\n<p>— <em>Matthew Flatt, 9 December 2015</em></p>\n\n<hr />\n\n<p>I see this bug; glad it&rsquo;s getting fixed. My daughter has made an awesome maze runner game with the planetcute images, so she was distressed about the broken compile. :)</p>\n\n<p>— <em>Peter, 10 December 2015</em></p>\n\n<hr />\n\n<p>It will force the use of dedicated AMD graphics of a 15-inch MacBook Pro but the previous version does not require it, it is consuming more battery than before.</p>\n\n<p>— <em>霏芃宋, 5 January 2016</em></p>\n\n<hr />\n\n<p>Regarding AMD graphics: The only change in graphics visible from that changelog is about the underlying graphical library Gtk. Can you check if setting PLT_GTK2=y before starting DrRacket makes a difference?</p>\n\n<p>— <em>Paolo Giarrusso, 21 January 2016</em></p>\n\n<hr />\n\n<p>Do you have a portable distribution for Windows anywhere? I used to use zipped binary snapshots for this purpose but they don&rsquo;t seem to be available any longer, only *.exe versions.</p>\n\n<p>— <em>Kevin Havener, 2 February 2016</em></p>\n\n<hr />")) ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2007-09-14-dont-say-abstract-instead-say-general.md" . unix) f post (u . "Don't say \"abstract\" (instead say \"general\")") (? . 39) 1467223812 (p+ #"/Users/MB/git/racket-lang-org/blog/2007/09/dont-say-abstract-instead-say-general.html" . unix) "/2007/09/dont-say-abstract-instead-say-general.html" (u . "2007-09-14T17:56:00.000-04:00") (? . 126) (? . 24) (c (u . "")) (u . "\n<p><em>posted by John Clements</em></p>\n\n<p>The word &ldquo;abstract&rdquo; is common in computer science. An abstract thing is one where some part of the whole is unspecified. For instance, the expression &ldquo;3*x + 3&rdquo; is an abstraction of the expression &ldquo;3*4+3&rdquo;, because the &ldquo;x&rdquo; is unspecified. Likewise, a function is an abstraction over some set of values, supplied when the function is called.</p>\n\n<p>The word &ldquo;general&rdquo; is not at all common in computer science. In non-computer-science use, the word &ldquo;general&rdquo; is used to describe things that may be applied to more than one thing or situation. For instance, a &ldquo;more general solution&rdquo; is one that applies not just to the problem at hand, but instead to a larger set of problems.</p>\n\n<p>From a computer science perspective, things that are abstract are also general. Things that are general are also abstract. Substituting the word &ldquo;general&rdquo; for the word &ldquo;abstract&rdquo; would not be a terrible hurdle.</p>\n\n<p>From a non-computer-science perspective, however, &ldquo;general&rdquo; and &ldquo;abstract&rdquo; have very different implications. Something that is general is better: it is more useful, it applies more frequently. Something that is abstract, though, is worse: it is lacking detail, it is non-concrete.</p>\n\n<p>This is one difference&mdash;the major difference?&mdash;between computer science (and of course mathematics) and the real world: the abstract is no less concrete. We can abstract over expressions using functions, and we can even abstract over syntactic things, using hygienic macros. The result of such abstraction is a perfectly well-defined element in our universe of expressions.</p>\n\n<p>In computer science, then, the pejorative sense of the word &ldquo;abstract&rdquo; is misleading, and the use of the terms &ldquo;abstract&rdquo; and &ldquo;abstraction&rdquo; merely provides ammunition for those who wish that we could all still be writing assembly language.</p>\n\n<p>I suggest instead the use of the word &ldquo;general.&rdquo;</p>\n\n<p>John &ldquo;purveyor of barbarous neologisms&rdquo; Clements</p>") #t (u . "\n<p><em>posted by John Clements</em></p>\n\n<p>The word &ldquo;abstract&rdquo; is common in computer science. An abstract thing is one where some part of the whole is unspecified. For instance, the expression &ldquo;3*x + 3&rdquo; is an abstraction of the expression &ldquo;3*4+3&rdquo;, because the &ldquo;x&rdquo; is unspecified. Likewise, a function is an abstraction over some set of values, supplied when the function is called.</p>\n\n<p>The word &ldquo;general&rdquo; is not at all common in computer science. In non-computer-science use, the word &ldquo;general&rdquo; is used to describe things that may be applied to more than one thing or situation. For instance, a &ldquo;more general solution&rdquo; is one that applies not just to the problem at hand, but instead to a larger set of problems.</p>\n\n<p>From a computer science perspective, things that are abstract are also general. Things that are general are also abstract. Substituting the word &ldquo;general&rdquo; for the word &ldquo;abstract&rdquo; would not be a terrible hurdle.</p>\n\n<p>From a non-computer-science perspective, however, &ldquo;general&rdquo; and &ldquo;abstract&rdquo; have very different implications. Something that is general is better: it is more useful, it applies more frequently. Something that is abstract, though, is worse: it is lacking detail, it is non-concrete.</p>\n\n<p>This is one difference&mdash;the major difference?&mdash;between computer science (and of course mathematics) and the real world: the abstract is no less concrete. We can abstract over expressions using functions, and we can even abstract over syntactic things, using hygienic macros. The result of such abstraction is a perfectly well-defined element in our universe of expressions.</p>\n\n<p>In computer science, then, the pejorative sense of the word &ldquo;abstract&rdquo; is misleading, and the use of the terms &ldquo;abstract&rdquo; and &ldquo;abstraction&rdquo; merely provides ammunition for those who wish that we could all still be writing assembly language.</p>\n\n<p>I suggest instead the use of the word &ldquo;general.&rdquo;</p>\n\n<p>John &ldquo;purveyor of barbarous neologisms&rdquo; Clements</p>\n<!-- more-->\n\n<hr />\n\n<p>Why would you want to adjust a valid and widespread usage just to integrate with usage elsewhere? If we followed this idea to its logical conclusion we would have no vocabulary at all.</p>\n\n<p>— <em>amoe, 15 September 2007</em></p>\n\n<hr />\n\n<p>Makes sense to me if you want to talk with the folks from elsewhere that you should learn their language. If you just want to stick with your own people, then you don&rsquo;t bother with things like that.</p>\n\n<p>— <em>Robby, 15 September 2007</em></p>\n\n<hr />\n\n<p>I&rsquo;m not sure that &ldquo;abstract&rdquo; and  &ldquo;general&rdquo; capture fungible notions.</p>\n\n<p>In computer science and mathematics, abstraction captures the essential core of something. I remember hearing David Foster Wallace, who&rsquo;d written a book about math, talking about how the number 5 is an abstraction over 5 sheep, 5 houses, and so on. But CS/math abstractions are very precise. I know exactly what you mean when you say &ldquo;five&rdquo;.</p>\n\n<p>To me, the word &ldquo;general&rdquo; as used in common parlance connotes some amount of fuzziness. &ldquo;Oh, that&rsquo;s the general idea.&rdquo; Not what you  want for computing &mdash; unless maybe  you&rsquo;re Lofti Zadeh.</p>\n\n<p>— <em>steck, 4 October 2007</em></p>\n\n<hr />\n\n<p>I know exactly what you mean when you say &ldquo;five&rdquo;.</p>\n\n<p>You do? 5 might be Frege&rsquo;s 5 (the set of all fivesomes), or von Neumann&rsquo;s 5 (the set {0, 1, 2, 3, 4}, where 4 is {0, 1, 2, 3}, where 3 is {0, 1, 2}, where 2 is {0, 1}, where 1 is {0}, where 0 is {}), or some other 5 altogether.</p>\n\n<p>— <em>John Cowan, 30 October 2007</em></p>\n\n<hr />")) ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2007-06-14-small-is-beautiful-large-is-useful-and-scheme-is-both.md" . unix) f post (u . "Small is Beautiful, Large is Useful, and Scheme is Both") (? . 43) 1467223812 (p+ #"/Users/MB/git/racket-lang-org/blog/2007/06/small-is-beautiful-large-is-useful-and-scheme-is-both.html" . unix) "/2007/06/small-is-beautiful-large-is-useful-and-scheme-is-both.html" (u . "2007-06-14T14:05:00.000-04:00") (? . 60) (? . 42) (c (u . "")) (u . "\n<p><em>posted by matthias</em></p>\n\n<p> They say, Scheme is small and this is good.</p>\n\n<p> Have you heard of X? No? It is <strong>the</strong> smallest computational basis. It is a single function that can compute everything a Turing machine can compute; a Church lambda calculus; a Post model; a RAM; a what-have-you model of computation. Indeed, X is so simple that two equations suffice to specify it completely [<a href=\"http://www.andrew.cmu.edu/user/cebrown/notes/barendregt.html\">Barendregt</a>, <a href=\"http://www.andrew.cmu.edu/user/cebrown/notes/barendregt.html#8\">page 166</a>]. Imagine that: a complete language report in two lines; a compiler that fits in a few K instead of Ms; no more arguments about smallness.</p>\n\n<p> Small alone can&rsquo;t be any good. If you used X alone, your programs would be the size of the universe or something like that. That&rsquo;s what the theory of computability teaches us [<a href=\"http://en.wikipedia.org/wiki/Church-Turing_thesis\">Church and Turing</a>]. Adding LAMBDA and a few primitives to get a pure functional language isn&rsquo;t good enough either. That&rsquo;s what the theory of expressiveness shows [<a href=\"http://www.ccs.neu.edu/scheme/pubs/#scp91-felleisen\">Felleisen</a>; <a href=\"http://theory.stanford.edu/people/jcm/publications.htm\">Mitchell</a>; <a href=\"http://portal.acm.org/citation.cfm?id=99583.99617\">Riecke</a>]. And, using an R5RS Scheme to build large systems with many people at a dozen sites isn&rsquo;t doable either. That&rsquo;s what the PLT experience determined.</p>\n\n<p>When we set out to construct DrScheme using MzScheme, we also conducted an experiment:</p>\n\n<p> Could we really build a graphical system that manages (shared) resources and that provides excellent error feedback with just plain Scheme?</p>\n\n<p> Could we just add enough libraries to do all this? Or would we have to change the kernel of the language? As much as we tried to keep MzScheme small, it became clear quickly that we needed exceptions, structures, module-like features, a mechanism for concurrency, a way to manage resources such as windows, tcp connections, and so on. The list isn&rsquo;t infinite but it is much longer than I expected. Our &ldquo;Revenge of the Son of the LISP machine&rdquo; paper is a good summary for the state of the art around 1999 [<a href=\"http://www.cs.utah.edu/~mflatt/publications/index.html\">Flatt and Son</a>].</p>\n\n<p>As language designers we stepped back time and again to look at our monster. What could we remove? What would we have to add in response? For some five years, we had first-class modules (units) and first-class classes in the core of the language. We had almost banned macros. They were so ugly I stopped teaching about them because I did want to use our own dog food in my courses but I couldn&rsquo;t stomach the macro system. It was such a step back from Eugene&rsquo;s extend-syntax. But then Matthew figured out the next big step in macro and module technology [<a href=\"http://www.cs.utah.edu/~mflatt/publications/index.html\">Flatt, You Want It When?</a>]. And with that out went units and classes from the core and many other things. So we learned lessons, and we need to keep building systems to learn more.</p>\n\n<p>I have no question that the idea of Scheme is beautiful. At the same time, I have also learned that if I wish to use this beautiful idea in practice, I need to add the ingredients that it takes to build large systems. R6RS reflects this insight, and I am happy about it.</p>") #t (u . "\n<p><em>posted by matthias</em></p>\n\n<p> They say, Scheme is small and this is good.</p>\n\n<p> Have you heard of X? No? It is <strong>the</strong> smallest computational basis. It is a single function that can compute everything a Turing machine can compute; a Church lambda calculus; a Post model; a RAM; a what-have-you model of computation. Indeed, X is so simple that two equations suffice to specify it completely [<a href=\"http://www.andrew.cmu.edu/user/cebrown/notes/barendregt.html\">Barendregt</a>, <a href=\"http://www.andrew.cmu.edu/user/cebrown/notes/barendregt.html#8\">page 166</a>]. Imagine that: a complete language report in two lines; a compiler that fits in a few K instead of Ms; no more arguments about smallness.</p>\n\n<p> Small alone can&rsquo;t be any good. If you used X alone, your programs would be the size of the universe or something like that. That&rsquo;s what the theory of computability teaches us [<a href=\"http://en.wikipedia.org/wiki/Church-Turing_thesis\">Church and Turing</a>]. Adding LAMBDA and a few primitives to get a pure functional language isn&rsquo;t good enough either. That&rsquo;s what the theory of expressiveness shows [<a href=\"http://www.ccs.neu.edu/scheme/pubs/#scp91-felleisen\">Felleisen</a>; <a href=\"http://theory.stanford.edu/people/jcm/publications.htm\">Mitchell</a>; <a href=\"http://portal.acm.org/citation.cfm?id=99583.99617\">Riecke</a>]. And, using an R5RS Scheme to build large systems with many people at a dozen sites isn&rsquo;t doable either. That&rsquo;s what the PLT experience determined.</p>\n\n<p>When we set out to construct DrScheme using MzScheme, we also conducted an experiment:</p>\n\n<p> Could we really build a graphical system that manages (shared) resources and that provides excellent error feedback with just plain Scheme?</p>\n\n<p> Could we just add enough libraries to do all this? Or would we have to change the kernel of the language? As much as we tried to keep MzScheme small, it became clear quickly that we needed exceptions, structures, module-like features, a mechanism for concurrency, a way to manage resources such as windows, tcp connections, and so on. The list isn&rsquo;t infinite but it is much longer than I expected. Our &ldquo;Revenge of the Son of the LISP machine&rdquo; paper is a good summary for the state of the art around 1999 [<a href=\"http://www.cs.utah.edu/~mflatt/publications/index.html\">Flatt and Son</a>].</p>\n\n<p>As language designers we stepped back time and again to look at our monster. What could we remove? What would we have to add in response? For some five years, we had first-class modules (units) and first-class classes in the core of the language. We had almost banned macros. They were so ugly I stopped teaching about them because I did want to use our own dog food in my courses but I couldn&rsquo;t stomach the macro system. It was such a step back from Eugene&rsquo;s extend-syntax. But then Matthew figured out the next big step in macro and module technology [<a href=\"http://www.cs.utah.edu/~mflatt/publications/index.html\">Flatt, You Want It When?</a>]. And with that out went units and classes from the core and many other things. So we learned lessons, and we need to keep building systems to learn more.</p>\n\n<p>I have no question that the idea of Scheme is beautiful. At the same time, I have also learned that if I wish to use this beautiful idea in practice, I need to add the ingredients that it takes to build large systems. R6RS reflects this insight, and I am happy about it.</p>\n<!-- more-->\n\n<hr />\n\n<p>Doesn&rsquo;t this ultimately mean that the Scheme program [1] has failed? Or to put it differently: Why not go back to older Lisp dialects and rediscover what was gratuitously thrown away just because it wasn&rsquo;t considered essential?</p>\n\n<p>[1] &ldquo;Programming languages should be designed not by piling feature on top of feature, but by removing the weaknesses and restrictions that make additional features appear necessary.&rdquo;, as the introduction to several instances of the Scheme report states.</p>\n\n<p>— <em>Pascal Costanza, 14 June 2007</em></p>\n\n<hr />\n\n<p>LISP was very large. Scheme was much smaller. Does this mean that adding features to Scheme moves it back toward LISP? No, not necessarily. If we learn from our progress, our &ldquo;second crack&rdquo; at some of these features may be nicer[*] than our first try.</p>\n\n<p>[*] more expressive, less difficult to implement, syntactically cleaner, etc.</p>\n\n<p>John &ldquo;De Gustibus&hellip;&rdquo; Clements</p>\n\n<p>— <em>John Clements, 14 June 2007</em></p>\n\n<hr />\n\n<p>I was interested to follow up on some of the papers, but the links didn&rsquo;t seem to take me to either the Flatt and Son or the You Want it When? papers&hellip;.</p>\n\n<p>— <em>Robert, 15 June 2007</em></p>\n\n<hr />\n\n<p>Hi Robert,</p>\n\n<p>&ldquo;You want it When?&rdquo; is the subtitle of the paper:  Composable and Compilable Macros.</p>\n\n<p>/Jens Axel</p>\n\n<p>— <em>Jens Axel Søgaard, 15 June 2007</em></p>\n\n<hr />\n\n<p>Pascal: The Scheme &ldquo;program&rdquo; hasn&rsquo;t failed at all because it isn&rsquo;t a program. It is a useful &ldquo;Abmahnung&rdquo; (imperative is as close as I can get in English) for the designers of programming languages. Due to this imperative, Scheme is simpler than CL to this day and will remain so: one space for values; one powerful construction for control; etc. To this day, I consider Scheme the experimental &ldquo;out of the box&rdquo; cousin of CL, and when Guy will write CLtL/3 one day, perhaps he and his colleagues will borrow from Scheme.</p>\n\n<p>Robert: &ldquo;son&rdquo; refers to an ICFP paper with the title &ldquo;revenge of the son of the LISP machine&rdquo; and &ldquo;You want it&rdquo; refers to an ICFP paper on modules and macros. Search on Matthew&rsquo;s page; he doesn&rsquo;t seem to have tags/labels available.</p>\n\n<p>— <em>matthias, 15 June 2007</em></p>\n\n<hr />\n\n<p>I stick to my question: Doesn&rsquo;t this mean that Scheme has ultimately failed to adhere to the imperative it set for itself?</p>\n\n<p>As far as I see it, the major contribution of the original Scheme reports was to show that it is possible to define a substrate of the then common language constructs and programming paradigms. First-class continuations and tail recursion give you the means to implement any control abstractions (including advanced ones like backtracking and generators), lambda expressions give you the basic mechanisms to implement data structures (including advanced ones like Smalltalk-style objects). Indeed, Scheme removed &ldquo;the weaknesses and restrictions that make such additional features appear necessary&rdquo; at the end of the 70&rsquo;s / beginning of the 80&rsquo;s.</p>\n\n<p>By R6RS, Scheme will have seen the addition of, for example, hygienic macros, a module system, Unicode, bytevectors, and records. However, these features have just been added on top of the existing Scheme language. It&rsquo;s at least not obvious to me that attempts have been made to remove &ldquo;the weaknesses and restrictions that make such additional features appear necessary.&rdquo; To the contrary: Syntax-rules was adopted as a macro system, although Clinger&rsquo;s &ldquo;Macros that Work&rdquo; would have been a subset on top of which other hygienic macro systems could have been built. Syntax-case is now being adopted but doesn&rsquo;t replace syntax-rules, although it&rsquo;s the more general macro system. If anyone wanted to add, say, syntactic closures on top of R6RS, there is no machinery to do so (or it&rsquo;s at least not obvious how to do this). Next, there is no substrate for implementing module systems, for example, in order to experiment with alternative module systems. I don&rsquo;t know whether such a substrate would be possible, but this doesn&rsquo;t change the fact that &ldquo;just&rdquo; one of the possible design alternative is being adopted. Scheme doesn&rsquo;t seem to adopt a way to extend the kinds of character sets it can deal with. Instead, Unicode is being adopted, again without a substrate that could enable other kinds of character sets. Bytevectors are given a literal syntax, but there is no provision for programmatically extending surface syntax, although it is know how to do this in Lisp dialects. Records are provided with different APIs. Although there is a low-level functional API for dealing with records, again there is no substrate that would allow building other variations of records. For example, there is no way to add multiple inheritance to records or to change how record fields are represented, although again it is known how to achieve these things with appropriate substrates.</p>\n\n<p>I agree with you that the notion of a minimal language that provides enough rope to build everything else on top is essentially a pipe dream. But claiming that a particular language is closer to this ideal than others although it is objectively (!) as bloated as the next one is pretentious.</p>\n\n<p>With regard to your remarks about a hypothetical CLtL3: I am not worried about the prospect of feeding some of the experiences of building current Scheme systems back into Common Lisp. To the contrary, I actually think that a lot of interesting work has been done in the Scheme community, some of which surpasses what is possible in Common Lisp. However, I am worried about the fact that this doesn&rsquo;t seem to happen the other way around. Few Schemers seem to have a good working knowledge of Common Lisp, as you can tell for example by mischaracterizations of Common Lisp in papers about Scheme-related research. Those who do, usually assess Common Lisp in a much more humble way. (See http://community.schemewiki.org/?Scheme-VS-Common-Lisp for example.)</p>\n\n<p>It&rsquo;s a shame that there is so little communication between the Scheme and the Common Lisp communities. We could learn a lot from each other, and it is important to realize that this holds for both directions. I am glad that Christian Queinnec, Manuel Serrano and especially Michael Sperber were present at this year&rsquo;s International Lisp Conference (mostly attended by Common Lispers), and hope that this has a positive effective in that regard in the long run.</p>\n\n<p>— <em>Pascal Costanza, 16 June 2007</em></p>\n\n<hr />\n\n<ol>\n <li>\n  <p>&ldquo;Scheme is simpler than CL&rdquo; does not mean it is better than CL. Perhaps I should have used the word &ldquo;uniform&rdquo; instead. See the conclusion of my expressiveness paper for &ldquo;better&rdquo;; this is not a new opinion.</p></li>\n <li>\n  <p>If you were on the PLT mailing list, you&rsquo;d see how much we try to learn from CL. We are currently discussing comprehensions and loops and keywords. We naturally look at CL (and other approaches) before we make a decision. [And besides Mike and Queinnec and Manuel, Friedman, Clinger and I have given talks at the conference when it is over here.]</p></li>\n <li>\n  <p>As for the substrate vs API decisions, I think what you are trying to say is that the idea of a thin API has failed. You are right in that dimension.</p></li></ol>\n\n<p>— <em>matthias, 16 June 2007</em></p>\n\n<hr />\n\n<ol>\n <li>Scheme was simpler / more uniform than CL, but not anymore. R6RS, as it is currently proposed, is simpler / more uniform in some respects, but more complex in others. For example, in Common Lisp, the external and the internal representation of source code is exactly the same, whereas Scheme makes a distinction between s-expressions and syntax objects. So Common Lisp is more uniform in that regard.</li></ol>\n\n<p>This is a general observation in programming language design, IMHO: If you simplify some aspects of a programming language, others will turn out more complex, and as soon as a programming language grows beyond a certain size, the best you can do is to try to balance the various trade offs. Unfortunately, the initial simplifications in the originally covered areas limit the kinds of decisions you can afford to make in other areas later on. This is a fate that a lot of programming languages have faced in the past and are still facing.</p>\n\n<p>I didn&rsquo;t try to say anything about &ldquo;better&rdquo; (and didn&rsquo;t intend to suggest that you do). &ldquo;Better&rdquo; is, of course, always relative to a particular task at hand.</p>\n\n<ol>\n <li>\n  <p>This is good to hear. The mailing list archive is hard to navigate and it seems impossible to search in it. The load seems to be high, so I probably will not subscribe to it. Just a hint: In Common Lisp, the performance overhead caused by keyword arguments can be compensated by taking advantage of compiler macros. This gives you full flexibility of &ldquo;dynamic&rdquo; keyword arguments while being able to preprocess them at compile time when concrete keyword arguments are statically known.</p></li>\n <li>\n  <p>It&rsquo;s good to hear that we agree on something. :)</p></li></ol>\n\n<p>— <em>Pascal Costanza, 16 June 2007</em></p>\n\n<hr />\n\n<p>It&rsquo;s a shame that there is so little communication between the Scheme and the Common Lisp communities. We could learn a lot from each other, and it is important to realize that this holds for both directions. I am glad that Christian Queinnec, Manuel Serrano and especially Michael Sperber were present at this year&rsquo;s International Lisp Conference (mostly attended by Common Lispers), and hope that this has a positive effective in that regard in the long run.</p>\n\n<p>— <em>kuril, 29 April 2008</em></p>\n\n<hr />")) ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2013-12-17-typed-racket-and-classes.md" . unix) f post (u . "Typed Racket and Classes") (? . 86) 1467223812 (p+ #"/Users/MB/git/racket-lang-org/blog/2013/12/typed-racket-and-classes.html" . unix) "/2013/12/typed-racket-and-classes.html" (u . "2013-12-17T16:44:00.000-05:00") (? . 92) (? . 85) (c (u . "")) (u . "\n<p><em>posted by Asumu Takikawa</em></p>\n\n<p>Recently we had our inaugural <a href=\"https://dekvek.com/racket-salon/\">Racket Salon</a> meetup here in Boston, graciously organized by Dan King. At the meetup I gave a short demo about the upcoming support for classes and object-oriented programming in Typed Racket. In this blog post, I’ll go over the concepts I presented in my demo.</p>\n\n<p>Background</p>\n\n<hr />\n\n<p>As many readers already know, <a href=\"http://www.cs.utah.edu/plt/snapshots/current/doc/ts-guide/index.html\">Typed Racket</a> is a gradually-typed sister language to Racket. That means it’s a <a href=\"http://en.wikipedia.org/wiki/Static_typing#Static_type-checking\">statically-typed</a> language that accommodates the idioms of Racket. Programs written in Racket should seamlessly port to Typed Racket with the addition of type annotations here and there. You can even keep some parts of the program dynamically-typed and Typed Racket will make sure those parts won’t break the type invariants via <a href=\"http://www.cs.utah.edu/plt/snapshots/current/doc/guide/contracts.html\">contracts</a>.</p>\n\n<p>Of course, supporting all Racket idioms is quite a lot of work, especially since it’s a constantly evolving language. One of the big pieces missing from Typed Racket right now is support for <a href=\"http://www.cs.utah.edu/plt/snapshots/current/doc/guide/classes.html\">classes and objects</a>. Since the GUI library heavily uses the class system, it’s important to support the object-oriented subset of Racket.</p>\n\n<p>Supporting classes isn’t trivial though. There are a bunch of issues, but the main ones are: (1) the class system is built as a complex macro and so reconstructing the information needed to type-check is tricky, and (2) we need to make sure that interoperation between Racket and Typed Racket using classes/objects can be done safely.</p>\n\n<p>I won’t go over the technical details about the implementation in this blog post, but contact me if you’re interested. In the rest of the blog post, I’ll show some examples to demonstrate what programming in Typed Racket with classes looks like. Just so you know, these examples won’t work in the current version of Typed Racket but will be supported in a future release.</p>\n\n<p>Side note: If you like to live dangerously, you can track the experimental branch with support for classes <a href=\"https://github.com/takikawa/racket/tree/tr-classes\">here</a>.</p>\n\n<h2 id=\"fishes-and-types\">Fishes and types</h2>\n\n<p>To start out, let’s look at an untyped example from the Racket Guide on classes and objects. The following snippet defines a fish% class. The class has several features: an initialization argument named size, a private field named current-size, three methods get-size, grow, and eat.</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"n\">fish%</span>\n  <span class=\"p\">(</span><span class=\"k\">class</span> <span class=\"nb\">object%</span>\n    <span class=\"p\">(</span><span class=\"k\">init</span> <span class=\"n\">size</span><span class=\"p\">)</span>\n    <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"n\">current-size</span> <span class=\"n\">size</span><span class=\"p\">)</span>\n    <span class=\"p\">(</span><span class=\"k\">super-new</span><span class=\"p\">)</span>\n    <span class=\"p\">(</span><span class=\"k\">define/public</span> <span class=\"p\">(</span><span class=\"n\">get-size</span><span class=\"p\">)</span>\n      <span class=\"n\">current-size</span><span class=\"p\">)</span>\n    <span class=\"p\">(</span><span class=\"k\">define/public</span> <span class=\"p\">(</span><span class=\"n\">grow</span> <span class=\"n\">amt</span><span class=\"p\">)</span>\n      <span class=\"p\">(</span><span class=\"k\">set!</span> <span class=\"n\">current-size</span> <span class=\"p\">(</span><span class=\"nb\">+</span> <span class=\"n\">amt</span> <span class=\"n\">current-size</span><span class=\"p\">)))</span>\n    <span class=\"p\">(</span><span class=\"k\">define/public</span> <span class=\"p\">(</span><span class=\"n\">eat</span> <span class=\"n\">other-fish</span><span class=\"p\">)</span>\n      <span class=\"p\">(</span><span class=\"n\">grow</span> <span class=\"p\">(</span><span class=\"k\">send</span> <span class=\"n\">other-fish</span> <span class=\"n\">get-size</span><span class=\"p\">)))))</span>\n</pre></div>\n\n</div>\n\n<p>The notation should seem mostly familiar if you’ve programmed in Java or other object-oriented languages. The % suffix is a convention for identifiers that are bound to class values. The object% value is the superclass of fish% and is the root class of all class hierarchies. The initialization argument size is used when constructing an instance of a class:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"nb\">&gt;</span> <span class=\"p\">(</span><span class=\"k\">new</span> <span class=\"n\">fish%</span> <span class=\"p\">[</span><span class=\"n\">size</span> <span class=\"mi\">3</span><span class=\"p\">])</span>\n<span class=\"p\">(</span><span class=\"n\">object:fish%</span> <span class=\"k\">...</span><span class=\"p\">)</span>\n</pre></div>\n\n</div>\n\n<p>Note that in Racket, classes are just values that can be passed around like anything else. For example, you can even do silly things like define nested inheriting classes:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"nb\">&gt;</span> <span class=\"p\">(</span><span class=\"k\">new</span> <span class=\"p\">(</span><span class=\"k\">class</span> <span class=\"p\">(</span><span class=\"k\">class</span> <span class=\"nb\">object%</span> <span class=\"p\">(</span><span class=\"k\">super-new</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"nb\">displayln</span> <span class=\"s2\">\"superclass\"</span><span class=\"p\">))</span>\n         <span class=\"p\">(</span><span class=\"k\">super-new</span><span class=\"p\">)</span>\n         <span class=\"p\">(</span><span class=\"nb\">displayln</span> <span class=\"s2\">\"subclass\"</span><span class=\"p\">)))</span>\n<span class=\"n\">superclass</span>\n<span class=\"n\">subclass</span>\n<span class=\"p\">(</span><span class=\"n\">object:eval:4:0</span> <span class=\"k\">...</span><span class=\"p\">)</span>\n</pre></div>\n\n</div>\n\n<p>In practice, this feature is quite useful since it lets you define <a href=\"http://www.cs.utah.edu/plt/snapshots/current/doc/guide/classes.html#%28part._.Mixins%29\">mixins</a> easily. That’s a topic for another blog post.</p>\n\n<p>Side note: In other words, Racket has first-class classes. This is a term you might see used in the programming language literature.</p>\n\n<p>Adding types to the fish program is easy. First, we can introduce a type definition for the fish class.</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"n\">define-type</span> <span class=\"n\">Fish%</span>\n  <span class=\"p\">(</span><span class=\"n\">Class</span> <span class=\"p\">(</span><span class=\"k\">init</span> <span class=\"p\">[</span><span class=\"n\">size</span> <span class=\"n\">Real</span><span class=\"p\">])</span>\n         <span class=\"p\">[</span><span class=\"n\">get-size</span> <span class=\"p\">(</span><span class=\"k\">-&gt;</span> <span class=\"n\">Real</span><span class=\"p\">)]</span>\n         <span class=\"p\">[</span><span class=\"n\">grow</span> <span class=\"p\">(</span><span class=\"n\">Real</span> <span class=\"k\">-&gt;</span> <span class=\"n\">Void</span><span class=\"p\">)]</span>\n         <span class=\"p\">[</span><span class=\"n\">draw</span> <span class=\"p\">(</span><span class=\"k\">-&gt;</span> <span class=\"n\">Pict</span><span class=\"p\">)]</span>\n         <span class=\"p\">[</span><span class=\"n\">eat</span> <span class=\"p\">((</span><span class=\"n\">Instance</span> <span class=\"n\">Fish%</span><span class=\"p\">)</span> <span class=\"k\">-&gt;</span> <span class=\"n\">Void</span><span class=\"p\">)]))</span>\n</pre></div>\n\n</div>\n\n<p>This type definition says that Fish% is a class type with the given initialization argument and methods types. Note that the type of the fish class Fish% is not the same as the type of its instances (Instance Fish%). This is an important distinction to make, since both the fish class value and fish object values may appear in the same program.</p>\n\n<p>Side note: If you’re familiar with Typed Racket, you may be surprised that the recursive reference to Fish% in the type definition works. Future versions of Typed Racket will support implicit recursive type definitions.</p>\n\n<p>With the type definition in hand, we can just annotate the class value with the type:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"n\">:</span> <span class=\"n\">fish%</span> <span class=\"n\">:</span> <span class=\"n\">Fish%</span><span class=\"p\">)</span>\n<span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"n\">fish%</span>\n  <span class=\"p\">(</span><span class=\"k\">class</span> <span class=\"nb\">object%</span>\n    <span class=\"p\">(</span><span class=\"k\">init</span> <span class=\"n\">size</span><span class=\"p\">)</span>\n    <span class=\"p\">(</span><span class=\"n\">:</span> <span class=\"n\">current-size</span> <span class=\"n\">Real</span><span class=\"p\">)</span>\n    <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"n\">current-size</span> <span class=\"n\">size</span><span class=\"p\">)</span>\n    <span class=\"p\">(</span><span class=\"k\">super-new</span><span class=\"p\">)</span>\n    <span class=\"p\">(</span><span class=\"k\">define/public</span> <span class=\"p\">(</span><span class=\"n\">get-size</span><span class=\"p\">)</span>\n      <span class=\"n\">current-size</span><span class=\"p\">)</span>\n    <span class=\"p\">(</span><span class=\"k\">define/public</span> <span class=\"p\">(</span><span class=\"n\">grow</span> <span class=\"n\">amt</span><span class=\"p\">)</span>\n      <span class=\"p\">(</span><span class=\"k\">set!</span> <span class=\"n\">current-size</span> <span class=\"p\">(</span><span class=\"nb\">+</span> <span class=\"n\">amt</span> <span class=\"n\">current-size</span><span class=\"p\">)))</span>\n    <span class=\"p\">(</span><span class=\"k\">define/public</span> <span class=\"p\">(</span><span class=\"n\">eat</span> <span class=\"n\">other-fish</span><span class=\"p\">)</span>\n      <span class=\"p\">(</span><span class=\"n\">grow</span> <span class=\"p\">(</span><span class=\"k\">send</span> <span class=\"n\">other-fish</span> <span class=\"n\">get-size</span><span class=\"p\">)))))</span>\n</pre></div>\n\n</div>\n\n<p>We do need an extra type annotation on the private field because its type isn’t included in the type definition above. This fish definition is a bit boring, so let’s spice it up a bit by making fishes drawable:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"n\">define-type</span> <span class=\"n\">Fish%</span>\n  <span class=\"p\">(</span><span class=\"n\">Class</span> <span class=\"p\">(</span><span class=\"k\">init</span> <span class=\"p\">[</span><span class=\"n\">size</span> <span class=\"n\">Real</span><span class=\"p\">])</span>\n         <span class=\"p\">(</span><span class=\"n\">get-size</span> <span class=\"p\">(</span><span class=\"k\">-&gt;</span> <span class=\"n\">Real</span><span class=\"p\">))</span>\n         <span class=\"p\">[</span><span class=\"n\">grow</span> <span class=\"p\">(</span><span class=\"n\">Real</span> <span class=\"k\">-&gt;</span> <span class=\"n\">Void</span><span class=\"p\">)]</span>\n         <span class=\"c1\">; a type for the new method</span>\n         <span class=\"p\">[</span><span class=\"n\">draw</span> <span class=\"p\">(</span><span class=\"k\">-&gt;</span> <span class=\"n\">Pict</span><span class=\"p\">)]</span>\n         <span class=\"p\">[</span><span class=\"n\">eat</span> <span class=\"p\">((</span><span class=\"n\">Instance</span> <span class=\"n\">Fish%</span><span class=\"p\">)</span> <span class=\"k\">-&gt;</span> <span class=\"n\">Void</span><span class=\"p\">)]))</span>\n<span class=\"p\">(</span><span class=\"n\">:</span> <span class=\"n\">fish%</span> <span class=\"n\">:</span> <span class=\"n\">Fish%</span><span class=\"p\">)</span>\n<span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"n\">fish%</span>\n  <span class=\"p\">(</span><span class=\"k\">class</span> <span class=\"nb\">object%</span>\n    <span class=\"p\">(</span><span class=\"k\">init</span> <span class=\"n\">size</span><span class=\"p\">)</span>\n    <span class=\"p\">(</span><span class=\"n\">:</span> <span class=\"n\">current-size</span> <span class=\"n\">Real</span><span class=\"p\">)</span>\n    <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"n\">current-size</span> <span class=\"n\">size</span><span class=\"p\">)</span>\n    <span class=\"p\">(</span><span class=\"k\">super-new</span><span class=\"p\">)</span>\n    <span class=\"p\">(</span><span class=\"k\">define/public</span> <span class=\"p\">(</span><span class=\"n\">get-size</span><span class=\"p\">)</span>\n      <span class=\"n\">current-size</span><span class=\"p\">)</span>\n    <span class=\"c1\">; new draw method</span>\n    <span class=\"p\">(</span><span class=\"k\">define/public</span> <span class=\"p\">(</span><span class=\"n\">draw</span><span class=\"p\">)</span>\n      <span class=\"p\">(</span><span class=\"n\">standard-fish</span> <span class=\"p\">(</span><span class=\"nb\">*</span> <span class=\"n\">current-size</span> <span class=\"mi\">10</span><span class=\"p\">)</span>\n                     <span class=\"p\">(</span><span class=\"nb\">*</span> <span class=\"n\">current-size</span> <span class=\"mi\">5</span><span class=\"p\">)))</span>\n    <span class=\"p\">(</span><span class=\"k\">define/public</span> <span class=\"p\">(</span><span class=\"n\">grow</span> <span class=\"n\">amt</span><span class=\"p\">)</span>\n      <span class=\"p\">(</span><span class=\"k\">set!</span> <span class=\"n\">current-size</span> <span class=\"p\">(</span><span class=\"nb\">+</span> <span class=\"n\">amt</span> <span class=\"n\">current-size</span><span class=\"p\">)))</span>\n    <span class=\"p\">(</span><span class=\"k\">define/public</span> <span class=\"p\">(</span><span class=\"n\">eat</span> <span class=\"n\">other-fish</span><span class=\"p\">)</span>\n      <span class=\"p\">(</span><span class=\"n\">grow</span> <span class=\"p\">(</span><span class=\"k\">send</span> <span class=\"n\">other-fish</span> <span class=\"n\">get-size</span><span class=\"p\">)))))</span>\n</pre></div>\n\n</div>\n\n<p>The new draw method that’s been added to the fish relies on some functions from the pict library. Since that’s not currently included in Typed Racket’s standard libraries, we need to give its exports some types:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"c1\">; this would go at the top of the file before fish%</span>\n<span class=\"p\">(</span><span class=\"n\">require/typed</span> <span class=\"n\">pict</span>\n               <span class=\"p\">[</span><span class=\"kd\">#:opaque</span> <span class=\"n\">Pict</span> <span class=\"n\">pict?</span><span class=\"p\">]</span>\n               <span class=\"p\">[</span><span class=\"n\">standard-fish</span> <span class=\"p\">(</span><span class=\"n\">Real</span> <span class=\"n\">Real</span> <span class=\"p\">[</span><span class=\"kd\">#:color</span> <span class=\"n\">String</span><span class=\"p\">]</span> <span class=\"k\">-&gt;</span> <span class=\"n\">Pict</span><span class=\"p\">)])</span>\n</pre></div>\n\n</div>\n\n<p>The <code>#:opaque</code> import form in Typed Racket lets you create a new type that corresponds to some predicate, in this case pict?. It’s useful for bringing in datatypes from dynamically-typed Racket libraries. With that new type, we can give a type for the standard-fish function.</p>\n\n<p>In the end, you can interact with some fish and draw them:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"nb\">&gt;</span> <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"n\">dory</span> <span class=\"p\">(</span><span class=\"k\">new</span> <span class=\"n\">fish%</span> <span class=\"p\">[</span><span class=\"n\">size</span> <span class=\"mi\">5</span><span class=\"p\">]))</span>\n<span class=\"nb\">&gt;</span> <span class=\"n\">dory</span>\n<span class=\"nb\">-</span> <span class=\"n\">:</span> <span class=\"p\">(</span><span class=\"n\">Instance</span> <span class=\"n\">Fish%</span><span class=\"p\">)</span>\n<span class=\"p\">(</span><span class=\"n\">object:fish%</span> <span class=\"k\">...</span><span class=\"p\">)</span>\n<span class=\"nb\">&gt;</span> <span class=\"p\">(</span><span class=\"k\">send</span> <span class=\"n\">dory</span> <span class=\"n\">draw</span><span class=\"p\">)</span>\n<span class=\"nb\">-</span> <span class=\"n\">:</span> <span class=\"n\">Pict</span>\n<span class=\"n\">image</span>\n<span class=\"nb\">&gt;</span> <span class=\"p\">(</span><span class=\"k\">send</span> <span class=\"n\">dory</span> <span class=\"n\">eat</span> <span class=\"n\">dory</span><span class=\"p\">)</span>\n<span class=\"nb\">&gt;</span> <span class=\"p\">(</span><span class=\"k\">send</span> <span class=\"n\">dory</span> <span class=\"n\">draw</span><span class=\"p\">)</span>\n<span class=\"nb\">-</span> <span class=\"n\">:</span> <span class=\"n\">Pict</span>\n<span class=\"n\">image</span>\n</pre></div>\n\n</div>\n\n<p>Conclusion:  At Racket Salon, I talked about a few other things including mixins and converting a slightly larger program that uses the GUI library. They didn’t translate well to a blog setting so I didn’t include them here. Racket Salon was a fun event, so I encourage anyone in the Boston area to attend!</p>\n\n<p>Typed Racket’s support for classes will land in a future version of Racket, possibly the release after v6.0.</p>") #f (u . "\n<p><em>posted by Asumu Takikawa</em></p>\n\n<p>Recently we had our inaugural <a href=\"https://dekvek.com/racket-salon/\">Racket Salon</a> meetup here in Boston, graciously organized by Dan King. At the meetup I gave a short demo about the upcoming support for classes and object-oriented programming in Typed Racket. In this blog post, I’ll go over the concepts I presented in my demo.</p>\n\n<p>Background</p>\n\n<hr />\n\n<p>As many readers already know, <a href=\"http://www.cs.utah.edu/plt/snapshots/current/doc/ts-guide/index.html\">Typed Racket</a> is a gradually-typed sister language to Racket. That means it’s a <a href=\"http://en.wikipedia.org/wiki/Static_typing#Static_type-checking\">statically-typed</a> language that accommodates the idioms of Racket. Programs written in Racket should seamlessly port to Typed Racket with the addition of type annotations here and there. You can even keep some parts of the program dynamically-typed and Typed Racket will make sure those parts won’t break the type invariants via <a href=\"http://www.cs.utah.edu/plt/snapshots/current/doc/guide/contracts.html\">contracts</a>.</p>\n\n<p>Of course, supporting all Racket idioms is quite a lot of work, especially since it’s a constantly evolving language. One of the big pieces missing from Typed Racket right now is support for <a href=\"http://www.cs.utah.edu/plt/snapshots/current/doc/guide/classes.html\">classes and objects</a>. Since the GUI library heavily uses the class system, it’s important to support the object-oriented subset of Racket.</p>\n\n<p>Supporting classes isn’t trivial though. There are a bunch of issues, but the main ones are: (1) the class system is built as a complex macro and so reconstructing the information needed to type-check is tricky, and (2) we need to make sure that interoperation between Racket and Typed Racket using classes/objects can be done safely.</p>\n\n<p>I won’t go over the technical details about the implementation in this blog post, but contact me if you’re interested. In the rest of the blog post, I’ll show some examples to demonstrate what programming in Typed Racket with classes looks like. Just so you know, these examples won’t work in the current version of Typed Racket but will be supported in a future release.</p>\n\n<p>Side note: If you like to live dangerously, you can track the experimental branch with support for classes <a href=\"https://github.com/takikawa/racket/tree/tr-classes\">here</a>.</p>\n\n<h2 id=\"fishes-and-types\">Fishes and types</h2>\n\n<p>To start out, let’s look at an untyped example from the Racket Guide on classes and objects. The following snippet defines a fish% class. The class has several features: an initialization argument named size, a private field named current-size, three methods get-size, grow, and eat.</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"n\">fish%</span>\n  <span class=\"p\">(</span><span class=\"k\">class</span> <span class=\"nb\">object%</span>\n    <span class=\"p\">(</span><span class=\"k\">init</span> <span class=\"n\">size</span><span class=\"p\">)</span>\n    <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"n\">current-size</span> <span class=\"n\">size</span><span class=\"p\">)</span>\n    <span class=\"p\">(</span><span class=\"k\">super-new</span><span class=\"p\">)</span>\n    <span class=\"p\">(</span><span class=\"k\">define/public</span> <span class=\"p\">(</span><span class=\"n\">get-size</span><span class=\"p\">)</span>\n      <span class=\"n\">current-size</span><span class=\"p\">)</span>\n    <span class=\"p\">(</span><span class=\"k\">define/public</span> <span class=\"p\">(</span><span class=\"n\">grow</span> <span class=\"n\">amt</span><span class=\"p\">)</span>\n      <span class=\"p\">(</span><span class=\"k\">set!</span> <span class=\"n\">current-size</span> <span class=\"p\">(</span><span class=\"nb\">+</span> <span class=\"n\">amt</span> <span class=\"n\">current-size</span><span class=\"p\">)))</span>\n    <span class=\"p\">(</span><span class=\"k\">define/public</span> <span class=\"p\">(</span><span class=\"n\">eat</span> <span class=\"n\">other-fish</span><span class=\"p\">)</span>\n      <span class=\"p\">(</span><span class=\"n\">grow</span> <span class=\"p\">(</span><span class=\"k\">send</span> <span class=\"n\">other-fish</span> <span class=\"n\">get-size</span><span class=\"p\">)))))</span>\n</pre></div>\n\n</div>\n\n<p>The notation should seem mostly familiar if you’ve programmed in Java or other object-oriented languages. The % suffix is a convention for identifiers that are bound to class values. The object% value is the superclass of fish% and is the root class of all class hierarchies. The initialization argument size is used when constructing an instance of a class:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"nb\">&gt;</span> <span class=\"p\">(</span><span class=\"k\">new</span> <span class=\"n\">fish%</span> <span class=\"p\">[</span><span class=\"n\">size</span> <span class=\"mi\">3</span><span class=\"p\">])</span>\n<span class=\"p\">(</span><span class=\"n\">object:fish%</span> <span class=\"k\">...</span><span class=\"p\">)</span>\n</pre></div>\n\n</div>\n\n<p>Note that in Racket, classes are just values that can be passed around like anything else. For example, you can even do silly things like define nested inheriting classes:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"nb\">&gt;</span> <span class=\"p\">(</span><span class=\"k\">new</span> <span class=\"p\">(</span><span class=\"k\">class</span> <span class=\"p\">(</span><span class=\"k\">class</span> <span class=\"nb\">object%</span> <span class=\"p\">(</span><span class=\"k\">super-new</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"nb\">displayln</span> <span class=\"s2\">\"superclass\"</span><span class=\"p\">))</span>\n         <span class=\"p\">(</span><span class=\"k\">super-new</span><span class=\"p\">)</span>\n         <span class=\"p\">(</span><span class=\"nb\">displayln</span> <span class=\"s2\">\"subclass\"</span><span class=\"p\">)))</span>\n<span class=\"n\">superclass</span>\n<span class=\"n\">subclass</span>\n<span class=\"p\">(</span><span class=\"n\">object:eval:4:0</span> <span class=\"k\">...</span><span class=\"p\">)</span>\n</pre></div>\n\n</div>\n\n<p>In practice, this feature is quite useful since it lets you define <a href=\"http://www.cs.utah.edu/plt/snapshots/current/doc/guide/classes.html#%28part._.Mixins%29\">mixins</a> easily. That’s a topic for another blog post.</p>\n\n<p>Side note: In other words, Racket has first-class classes. This is a term you might see used in the programming language literature.</p>\n\n<p>Adding types to the fish program is easy. First, we can introduce a type definition for the fish class.</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"n\">define-type</span> <span class=\"n\">Fish%</span>\n  <span class=\"p\">(</span><span class=\"n\">Class</span> <span class=\"p\">(</span><span class=\"k\">init</span> <span class=\"p\">[</span><span class=\"n\">size</span> <span class=\"n\">Real</span><span class=\"p\">])</span>\n         <span class=\"p\">[</span><span class=\"n\">get-size</span> <span class=\"p\">(</span><span class=\"k\">-&gt;</span> <span class=\"n\">Real</span><span class=\"p\">)]</span>\n         <span class=\"p\">[</span><span class=\"n\">grow</span> <span class=\"p\">(</span><span class=\"n\">Real</span> <span class=\"k\">-&gt;</span> <span class=\"n\">Void</span><span class=\"p\">)]</span>\n         <span class=\"p\">[</span><span class=\"n\">draw</span> <span class=\"p\">(</span><span class=\"k\">-&gt;</span> <span class=\"n\">Pict</span><span class=\"p\">)]</span>\n         <span class=\"p\">[</span><span class=\"n\">eat</span> <span class=\"p\">((</span><span class=\"n\">Instance</span> <span class=\"n\">Fish%</span><span class=\"p\">)</span> <span class=\"k\">-&gt;</span> <span class=\"n\">Void</span><span class=\"p\">)]))</span>\n</pre></div>\n\n</div>\n\n<p>This type definition says that Fish% is a class type with the given initialization argument and methods types. Note that the type of the fish class Fish% is not the same as the type of its instances (Instance Fish%). This is an important distinction to make, since both the fish class value and fish object values may appear in the same program.</p>\n\n<p>Side note: If you’re familiar with Typed Racket, you may be surprised that the recursive reference to Fish% in the type definition works. Future versions of Typed Racket will support implicit recursive type definitions.</p>\n\n<p>With the type definition in hand, we can just annotate the class value with the type:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"n\">:</span> <span class=\"n\">fish%</span> <span class=\"n\">:</span> <span class=\"n\">Fish%</span><span class=\"p\">)</span>\n<span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"n\">fish%</span>\n  <span class=\"p\">(</span><span class=\"k\">class</span> <span class=\"nb\">object%</span>\n    <span class=\"p\">(</span><span class=\"k\">init</span> <span class=\"n\">size</span><span class=\"p\">)</span>\n    <span class=\"p\">(</span><span class=\"n\">:</span> <span class=\"n\">current-size</span> <span class=\"n\">Real</span><span class=\"p\">)</span>\n    <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"n\">current-size</span> <span class=\"n\">size</span><span class=\"p\">)</span>\n    <span class=\"p\">(</span><span class=\"k\">super-new</span><span class=\"p\">)</span>\n    <span class=\"p\">(</span><span class=\"k\">define/public</span> <span class=\"p\">(</span><span class=\"n\">get-size</span><span class=\"p\">)</span>\n      <span class=\"n\">current-size</span><span class=\"p\">)</span>\n    <span class=\"p\">(</span><span class=\"k\">define/public</span> <span class=\"p\">(</span><span class=\"n\">grow</span> <span class=\"n\">amt</span><span class=\"p\">)</span>\n      <span class=\"p\">(</span><span class=\"k\">set!</span> <span class=\"n\">current-size</span> <span class=\"p\">(</span><span class=\"nb\">+</span> <span class=\"n\">amt</span> <span class=\"n\">current-size</span><span class=\"p\">)))</span>\n    <span class=\"p\">(</span><span class=\"k\">define/public</span> <span class=\"p\">(</span><span class=\"n\">eat</span> <span class=\"n\">other-fish</span><span class=\"p\">)</span>\n      <span class=\"p\">(</span><span class=\"n\">grow</span> <span class=\"p\">(</span><span class=\"k\">send</span> <span class=\"n\">other-fish</span> <span class=\"n\">get-size</span><span class=\"p\">)))))</span>\n</pre></div>\n\n</div>\n\n<p>We do need an extra type annotation on the private field because its type isn’t included in the type definition above. This fish definition is a bit boring, so let’s spice it up a bit by making fishes drawable:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"n\">define-type</span> <span class=\"n\">Fish%</span>\n  <span class=\"p\">(</span><span class=\"n\">Class</span> <span class=\"p\">(</span><span class=\"k\">init</span> <span class=\"p\">[</span><span class=\"n\">size</span> <span class=\"n\">Real</span><span class=\"p\">])</span>\n         <span class=\"p\">(</span><span class=\"n\">get-size</span> <span class=\"p\">(</span><span class=\"k\">-&gt;</span> <span class=\"n\">Real</span><span class=\"p\">))</span>\n         <span class=\"p\">[</span><span class=\"n\">grow</span> <span class=\"p\">(</span><span class=\"n\">Real</span> <span class=\"k\">-&gt;</span> <span class=\"n\">Void</span><span class=\"p\">)]</span>\n         <span class=\"c1\">; a type for the new method</span>\n         <span class=\"p\">[</span><span class=\"n\">draw</span> <span class=\"p\">(</span><span class=\"k\">-&gt;</span> <span class=\"n\">Pict</span><span class=\"p\">)]</span>\n         <span class=\"p\">[</span><span class=\"n\">eat</span> <span class=\"p\">((</span><span class=\"n\">Instance</span> <span class=\"n\">Fish%</span><span class=\"p\">)</span> <span class=\"k\">-&gt;</span> <span class=\"n\">Void</span><span class=\"p\">)]))</span>\n<span class=\"p\">(</span><span class=\"n\">:</span> <span class=\"n\">fish%</span> <span class=\"n\">:</span> <span class=\"n\">Fish%</span><span class=\"p\">)</span>\n<span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"n\">fish%</span>\n  <span class=\"p\">(</span><span class=\"k\">class</span> <span class=\"nb\">object%</span>\n    <span class=\"p\">(</span><span class=\"k\">init</span> <span class=\"n\">size</span><span class=\"p\">)</span>\n    <span class=\"p\">(</span><span class=\"n\">:</span> <span class=\"n\">current-size</span> <span class=\"n\">Real</span><span class=\"p\">)</span>\n    <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"n\">current-size</span> <span class=\"n\">size</span><span class=\"p\">)</span>\n    <span class=\"p\">(</span><span class=\"k\">super-new</span><span class=\"p\">)</span>\n    <span class=\"p\">(</span><span class=\"k\">define/public</span> <span class=\"p\">(</span><span class=\"n\">get-size</span><span class=\"p\">)</span>\n      <span class=\"n\">current-size</span><span class=\"p\">)</span>\n    <span class=\"c1\">; new draw method</span>\n    <span class=\"p\">(</span><span class=\"k\">define/public</span> <span class=\"p\">(</span><span class=\"n\">draw</span><span class=\"p\">)</span>\n      <span class=\"p\">(</span><span class=\"n\">standard-fish</span> <span class=\"p\">(</span><span class=\"nb\">*</span> <span class=\"n\">current-size</span> <span class=\"mi\">10</span><span class=\"p\">)</span>\n                     <span class=\"p\">(</span><span class=\"nb\">*</span> <span class=\"n\">current-size</span> <span class=\"mi\">5</span><span class=\"p\">)))</span>\n    <span class=\"p\">(</span><span class=\"k\">define/public</span> <span class=\"p\">(</span><span class=\"n\">grow</span> <span class=\"n\">amt</span><span class=\"p\">)</span>\n      <span class=\"p\">(</span><span class=\"k\">set!</span> <span class=\"n\">current-size</span> <span class=\"p\">(</span><span class=\"nb\">+</span> <span class=\"n\">amt</span> <span class=\"n\">current-size</span><span class=\"p\">)))</span>\n    <span class=\"p\">(</span><span class=\"k\">define/public</span> <span class=\"p\">(</span><span class=\"n\">eat</span> <span class=\"n\">other-fish</span><span class=\"p\">)</span>\n      <span class=\"p\">(</span><span class=\"n\">grow</span> <span class=\"p\">(</span><span class=\"k\">send</span> <span class=\"n\">other-fish</span> <span class=\"n\">get-size</span><span class=\"p\">)))))</span>\n</pre></div>\n\n</div>\n\n<p>The new draw method that’s been added to the fish relies on some functions from the pict library. Since that’s not currently included in Typed Racket’s standard libraries, we need to give its exports some types:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"c1\">; this would go at the top of the file before fish%</span>\n<span class=\"p\">(</span><span class=\"n\">require/typed</span> <span class=\"n\">pict</span>\n               <span class=\"p\">[</span><span class=\"kd\">#:opaque</span> <span class=\"n\">Pict</span> <span class=\"n\">pict?</span><span class=\"p\">]</span>\n               <span class=\"p\">[</span><span class=\"n\">standard-fish</span> <span class=\"p\">(</span><span class=\"n\">Real</span> <span class=\"n\">Real</span> <span class=\"p\">[</span><span class=\"kd\">#:color</span> <span class=\"n\">String</span><span class=\"p\">]</span> <span class=\"k\">-&gt;</span> <span class=\"n\">Pict</span><span class=\"p\">)])</span>\n</pre></div>\n\n</div>\n\n<p>The <code>#:opaque</code> import form in Typed Racket lets you create a new type that corresponds to some predicate, in this case pict?. It’s useful for bringing in datatypes from dynamically-typed Racket libraries. With that new type, we can give a type for the standard-fish function.</p>\n\n<p>In the end, you can interact with some fish and draw them:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"nb\">&gt;</span> <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"n\">dory</span> <span class=\"p\">(</span><span class=\"k\">new</span> <span class=\"n\">fish%</span> <span class=\"p\">[</span><span class=\"n\">size</span> <span class=\"mi\">5</span><span class=\"p\">]))</span>\n<span class=\"nb\">&gt;</span> <span class=\"n\">dory</span>\n<span class=\"nb\">-</span> <span class=\"n\">:</span> <span class=\"p\">(</span><span class=\"n\">Instance</span> <span class=\"n\">Fish%</span><span class=\"p\">)</span>\n<span class=\"p\">(</span><span class=\"n\">object:fish%</span> <span class=\"k\">...</span><span class=\"p\">)</span>\n<span class=\"nb\">&gt;</span> <span class=\"p\">(</span><span class=\"k\">send</span> <span class=\"n\">dory</span> <span class=\"n\">draw</span><span class=\"p\">)</span>\n<span class=\"nb\">-</span> <span class=\"n\">:</span> <span class=\"n\">Pict</span>\n<span class=\"n\">image</span>\n<span class=\"nb\">&gt;</span> <span class=\"p\">(</span><span class=\"k\">send</span> <span class=\"n\">dory</span> <span class=\"n\">eat</span> <span class=\"n\">dory</span><span class=\"p\">)</span>\n<span class=\"nb\">&gt;</span> <span class=\"p\">(</span><span class=\"k\">send</span> <span class=\"n\">dory</span> <span class=\"n\">draw</span><span class=\"p\">)</span>\n<span class=\"nb\">-</span> <span class=\"n\">:</span> <span class=\"n\">Pict</span>\n<span class=\"n\">image</span>\n</pre></div>\n\n</div>\n\n<p>Conclusion:  At Racket Salon, I talked about a few other things including mixins and converting a slightly larger program that uses the GUI library. They didn’t translate well to a blog setting so I didn’t include them here. Racket Salon was a fun event, so I encourage anyone in the Boston area to attend!</p>\n\n<p>Typed Racket’s support for classes will land in a future version of Racket, possibly the release after v6.0.</p>")) ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2008-06-03-plt-scheme-version-40-is-coming-soon.md" . unix) f post (u . "PLT Scheme version 4.0 is Coming Soon") (? . 54) 1467223812 (p+ #"/Users/MB/git/racket-lang-org/blog/2008/06/plt-scheme-version-40-is-coming-soon.html" . unix) "/2008/06/plt-scheme-version-40-is-coming-soon.html" (u . "2008-06-03T18:03:00.003-04:00") (? . 40) (? . 41) (c (u . "")) (u . "\n<p><em>posted by Matthew Flatt</em></p>\n\n<p>PLT Scheme is now 13 years old. The initial version was little more than glue code between a few open-source libraries, which seemed to offer the quickest solution to our modest goals. Modest success leads to bigger goals, however, and then continued success leads to ever more ambitious goals. Before you know it, a mass of users, co-developers, libraries, and documentation rely on design decisions that were made for a much smaller project years before.</p>\n\n<p>Naturally, many of those early design decisions turn out to be a poor fit for the project&rsquo;s eventual role. Starting from scratch isn&rsquo;t usually practical, so you gradually adjust the infrastructure to meet new needs. That was precisely the story for the version 300 series of releases for PLT Scheme. The biggest gap between our original and current goals was in run-time performance, so we replaced bytecode interpretation with a just-in-time native-code compiler, and we replaced a memory manager based on &ldquo;conservative&rdquo; estimates of pointer usage with one that uses precise information.</p>\n\n<p>Performance improves a bit more with version 4.0, but mostly we&rsquo;ve moved on to a bigger mismatch between the original and current goals: the way that PLT Scheme presents itself to users. PLT Scheme was originally conceived as R5RS Scheme with some extensions to make it practical, and with useful tools (notably an IDE) and libraries (notably a GUI library) built on that core. Our documentation and web pages reflected that architecture - which now seems completely upside-down.</p>\n\n<p>Version 4.0 is a fresh start in the way that we present PLT Scheme. It&rsquo;s a new language. PLT Scheme is a dialect of Scheme, certainly, but it&rsquo;s not merely a superset of R5RS, R6RS, or other standards, and those standards are not really the best place to start understanding PLT Scheme. At the same time, the unique extensibility features of the PLT Scheme language and tools allow them to support other languages easily, including R5RS (though a new <code>plt-r5rs</code> executable), R6RS, and more.</p>\n\n<p>Improvements to the PLT Scheme language include better syntax for modules, better support for optional and keyword function arguments, more expressive syntax for structure types, streamlined hash-table operations, new syntax for list comprehensions and iterations, a more complete and consistent set of list and string operations, and reduced dependence on mutable pairs. To current users of PLT Scheme, these changes will seem like the big ones behind version 4.0, but they&rsquo;re small compared to the overall re-organization and the accompanying documentation effort.</p>\n\n<p>We wrote hundreds of pages of new documentation, including much more tutorial and overview information. We ported hundreds of pages of existing documents to new a system that produces cleaner, better organized, more consistent output. We will replace the old tangle of web pages (that try to explain a confusing federation of tools) with a simple page about &ldquo;PLT Scheme.&rdquo; We have even streamlined the command-line flags for the main virtual machine.</p>\n\n<p>The development of PLT Scheme version 4.0 took about one year of hard work. In retrospect, that doesn&rsquo;t sound too bad, considering the scale of the existing code base, the number of things that we improved, and the total size of the documentation (about 2000 pages in PDF form). Still, you can imagine how happy we are to arrive at a stable release, and we hope that the improvements in PLT Scheme version 4.0 work as well for everyone else as they do for us.</p>\n\n<p>For a preview, see <a href=\"http://pre.plt-scheme.org/\">http://pre.plt-scheme.org/</a>. The final version 4.0 release is just days away.</p>") #t (u . "\n<p><em>posted by Matthew Flatt</em></p>\n\n<p>PLT Scheme is now 13 years old. The initial version was little more than glue code between a few open-source libraries, which seemed to offer the quickest solution to our modest goals. Modest success leads to bigger goals, however, and then continued success leads to ever more ambitious goals. Before you know it, a mass of users, co-developers, libraries, and documentation rely on design decisions that were made for a much smaller project years before.</p>\n\n<p>Naturally, many of those early design decisions turn out to be a poor fit for the project&rsquo;s eventual role. Starting from scratch isn&rsquo;t usually practical, so you gradually adjust the infrastructure to meet new needs. That was precisely the story for the version 300 series of releases for PLT Scheme. The biggest gap between our original and current goals was in run-time performance, so we replaced bytecode interpretation with a just-in-time native-code compiler, and we replaced a memory manager based on &ldquo;conservative&rdquo; estimates of pointer usage with one that uses precise information.</p>\n\n<p>Performance improves a bit more with version 4.0, but mostly we&rsquo;ve moved on to a bigger mismatch between the original and current goals: the way that PLT Scheme presents itself to users. PLT Scheme was originally conceived as R5RS Scheme with some extensions to make it practical, and with useful tools (notably an IDE) and libraries (notably a GUI library) built on that core. Our documentation and web pages reflected that architecture - which now seems completely upside-down.</p>\n\n<p>Version 4.0 is a fresh start in the way that we present PLT Scheme. It&rsquo;s a new language. PLT Scheme is a dialect of Scheme, certainly, but it&rsquo;s not merely a superset of R5RS, R6RS, or other standards, and those standards are not really the best place to start understanding PLT Scheme. At the same time, the unique extensibility features of the PLT Scheme language and tools allow them to support other languages easily, including R5RS (though a new <code>plt-r5rs</code> executable), R6RS, and more.</p>\n\n<p>Improvements to the PLT Scheme language include better syntax for modules, better support for optional and keyword function arguments, more expressive syntax for structure types, streamlined hash-table operations, new syntax for list comprehensions and iterations, a more complete and consistent set of list and string operations, and reduced dependence on mutable pairs. To current users of PLT Scheme, these changes will seem like the big ones behind version 4.0, but they&rsquo;re small compared to the overall re-organization and the accompanying documentation effort.</p>\n\n<p>We wrote hundreds of pages of new documentation, including much more tutorial and overview information. We ported hundreds of pages of existing documents to new a system that produces cleaner, better organized, more consistent output. We will replace the old tangle of web pages (that try to explain a confusing federation of tools) with a simple page about &ldquo;PLT Scheme.&rdquo; We have even streamlined the command-line flags for the main virtual machine.</p>\n\n<p>The development of PLT Scheme version 4.0 took about one year of hard work. In retrospect, that doesn&rsquo;t sound too bad, considering the scale of the existing code base, the number of things that we improved, and the total size of the documentation (about 2000 pages in PDF form). Still, you can imagine how happy we are to arrive at a stable release, and we hope that the improvements in PLT Scheme version 4.0 work as well for everyone else as they do for us.</p>\n\n<p>For a preview, see <a href=\"http://pre.plt-scheme.org/\">http://pre.plt-scheme.org/</a>. The final version 4.0 release is just days away.</p>\n<!-- more-->\n\n<hr />\n\n<p>Outstanding, I can hardly wait!</p>\n\n<p>JT http://www.FireMe.To/Udi</p>\n\n<p>— <em>Brad, 4 June 2008</em></p>\n\n<hr />\n\n<p>I want it <em>now</em>!</p>\n\n<p>— <em>Daniel, 4 June 2008</em></p>\n\n<hr />\n\n<p>daniel: the best I can do for now is point you to the pre-releases builds online. But it should be soon!</p>\n\n<p>http://pre.plt-scheme.org/installers/</p>\n\n<p>— <em>Robby, 4 June 2008</em></p>\n\n<hr />\n\n<p>Very exciting! The new documentation especially helped me get started with PLT Scheme.</p>\n\n<p>Thank you!</p>\n\n<p>— <em>David Vanderson, 4 June 2008</em></p>\n\n<hr />\n\n<p>Congrats, all! The re-emergence of Scheme in programming courses is in large part thanks to your efforts. Thank you!</p>\n\n<p>— <em>Duane Johnson, 4 June 2008</em></p>\n\n<hr />\n\n<p>Thanks,</p>\n\n<p>I was waiting for something fresh, I&rsquo;ve found it.</p>\n\n<p>— <em>kib, 4 June 2008</em></p>\n\n<hr />\n\n<p>I already find DrScheme good enough for my needs. All that I wish to see is a good tutorial (like the one the Python guys have put together).</p>\n\n<p>The lack of a good &ldquo;official&rdquo; tutorial, coupled with the difficulty one encounters reading online versions of printed books (SICP), is keeping me from using Scheme as a primary development language (I&rsquo;m a hobbyist programmer, and barely have enough resources to buy books etc.)</p>\n\n<p>— <em>General Maximus, 8 June 2008</em></p>\n\n<hr />\n\n<p>General Maximus: have you had a change to look at the v4.0 tutorials yet? They&rsquo;re at the link in the post (and soon will be on the main website).</p>\n\n<p>— <em>Robby, 8 June 2008</em></p>\n\n<hr />\n\n<p>You mean this one, right? : http://pre.plt-scheme.org/docs/html/guide/index.html</p>\n\n<p>I didn&rsquo;t look at it before. Looks pretty nice. Since I don&rsquo;t know much about Scheme, can you tell me how it is as an introductory tutorial?</p>\n\n<p>— <em>General Maximus, 8 June 2008</em></p>\n\n<hr />\n\n<p>That one is the one that covers the most ground and definitely should be useful, but if you&rsquo;re new to Scheme I would start with the two much shorter tutorials (below) and move to that one as you need more specific information for some particular task.</p>\n\n<p>http://pre.plt-scheme.org/docs/html/quick/</p>\n\n<p>http://pre.plt-scheme.org/docs/html/more/</p>\n\n<p>— <em>Robby, 8 June 2008</em></p>\n\n<hr />\n\n<p>I only see the 3.99.0.26 pre-release up on http://pre.plt-scheme.org/installers/.</p>\n\n<p>Are the 4.0 pre-releases up somewhere?</p>\n\n<p>— <em>databus, 8 June 2008</em></p>\n\n<hr />\n\n<p>3.99.x is the pre-release for 4.0.</p>\n\n<p>— <em>Robby, 8 June 2008</em></p>\n\n<hr />\n\n<p>Great, thanks Robby.</p>\n\n<p>— <em>databus, 8 June 2008</em></p>\n\n<hr />")) ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2007-07-27-callcc-and-self-modifying-code.md" . unix) f post (u . "`call/cc` and self-modifying code") (? . 42) 1467223812 (p+ #"/Users/MB/git/racket-lang-org/blog/2007/07/callcc-and-self-modifying-code.html" . unix) "/2007/07/callcc-and-self-modifying-code.html" (u . "2007-07-27T18:45:00.000-04:00") (? . 43) (? . 62) (c (u . "")) (u . "\n<p><em>posted by matthias</em></p>\n\n<p>Today I wrote this short illustration of call/cc and posted it on wikipedia:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"c1\">;; [LISTOF X] -&gt; ( -&gt; X u &#39;you-fell-off-the-end-off-the-list)</span>\n<span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">generate-one-element-at-a-time</span> <span class=\"n\">a-list</span><span class=\"p\">)</span>\n  <span class=\"c1\">;; (-&gt; X u &#39;you-fell-off-the-end-off-the-list)</span>\n  <span class=\"c1\">;; this is the actual generator, producing one item from a-list at a time</span>\n  <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">generator</span><span class=\"p\">)</span>\n     <span class=\"p\">(</span><span class=\"nb\">call/cc</span> <span class=\"n\">control-state</span><span class=\"p\">))</span> \n  <span class=\"c1\">;; [CONTINUATION X] -&gt; EMPTY</span>\n  <span class=\"c1\">;; hand the next item from a-list to \"return\" (or an end-of-list marker)&#39;</span>\n  <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">control-state</span> <span class=\"n\">return</span><span class=\"p\">)</span>\n     <span class=\"p\">(</span><span class=\"nb\">for-each</span> \n        <span class=\"p\">(</span><span class=\"k\">lambda</span> <span class=\"p\">(</span><span class=\"n\">an-element-from-a-list</span><span class=\"p\">)</span>\n           <span class=\"p\">(</span><span class=\"k\">set!</span> <span class=\"n\">return</span> <span class=\"c1\">;; fixed</span>\n             <span class=\"p\">(</span><span class=\"nb\">call/cc</span>\n               <span class=\"p\">(</span><span class=\"k\">lambda</span> <span class=\"p\">(</span><span class=\"n\">resume-here</span><span class=\"p\">)</span>\n                 <span class=\"p\">(</span><span class=\"k\">set!</span> <span class=\"n\">control-state</span> <span class=\"n\">resume-here</span><span class=\"p\">)</span>\n                 <span class=\"p\">(</span><span class=\"n\">return</span> <span class=\"n\">an-element-from-a-list</span><span class=\"p\">)))))</span>\n        <span class=\"n\">a-list</span><span class=\"p\">)</span>\n     <span class=\"p\">(</span><span class=\"n\">return</span> <span class=\"o\">&#39;</span><span class=\"ss\">you-fell-off-the-end-off-the-list</span><span class=\"p\">))</span>\n  <span class=\"c1\">;; time to return the generator</span>\n  <span class=\"n\">generator</span><span class=\"p\">)</span>\n</pre></div>\n\n</div>\n\n<p>It reminded of all the talk in the 1980s and 1990s that self-modifying code is bad. But look at the elegant assignment to <code>control-state</code> within its body. It&rsquo;s such a poem, I thought I&rsquo;d share it with people since nobody else blogs here anywya.</p>") #t (u . "\n<p><em>posted by matthias</em></p>\n\n<p>Today I wrote this short illustration of call/cc and posted it on wikipedia:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"c1\">;; [LISTOF X] -&gt; ( -&gt; X u &#39;you-fell-off-the-end-off-the-list)</span>\n<span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">generate-one-element-at-a-time</span> <span class=\"n\">a-list</span><span class=\"p\">)</span>\n  <span class=\"c1\">;; (-&gt; X u &#39;you-fell-off-the-end-off-the-list)</span>\n  <span class=\"c1\">;; this is the actual generator, producing one item from a-list at a time</span>\n  <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">generator</span><span class=\"p\">)</span>\n     <span class=\"p\">(</span><span class=\"nb\">call/cc</span> <span class=\"n\">control-state</span><span class=\"p\">))</span> \n  <span class=\"c1\">;; [CONTINUATION X] -&gt; EMPTY</span>\n  <span class=\"c1\">;; hand the next item from a-list to \"return\" (or an end-of-list marker)&#39;</span>\n  <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">control-state</span> <span class=\"n\">return</span><span class=\"p\">)</span>\n     <span class=\"p\">(</span><span class=\"nb\">for-each</span> \n        <span class=\"p\">(</span><span class=\"k\">lambda</span> <span class=\"p\">(</span><span class=\"n\">an-element-from-a-list</span><span class=\"p\">)</span>\n           <span class=\"p\">(</span><span class=\"k\">set!</span> <span class=\"n\">return</span> <span class=\"c1\">;; fixed</span>\n             <span class=\"p\">(</span><span class=\"nb\">call/cc</span>\n               <span class=\"p\">(</span><span class=\"k\">lambda</span> <span class=\"p\">(</span><span class=\"n\">resume-here</span><span class=\"p\">)</span>\n                 <span class=\"p\">(</span><span class=\"k\">set!</span> <span class=\"n\">control-state</span> <span class=\"n\">resume-here</span><span class=\"p\">)</span>\n                 <span class=\"p\">(</span><span class=\"n\">return</span> <span class=\"n\">an-element-from-a-list</span><span class=\"p\">)))))</span>\n        <span class=\"n\">a-list</span><span class=\"p\">)</span>\n     <span class=\"p\">(</span><span class=\"n\">return</span> <span class=\"o\">&#39;</span><span class=\"ss\">you-fell-off-the-end-off-the-list</span><span class=\"p\">))</span>\n  <span class=\"c1\">;; time to return the generator</span>\n  <span class=\"n\">generator</span><span class=\"p\">)</span>\n</pre></div>\n\n</div>\n\n<p>It reminded of all the talk in the 1980s and 1990s that self-modifying code is bad. But look at the elegant assignment to <code>control-state</code> within its body. It&rsquo;s such a poem, I thought I&rsquo;d share it with people since nobody else blogs here anywya.</p>\n<!-- more-->\n\n<hr />\n\n<p>This is really beautiful. :)</p>\n\n<p>— <em>Jianshi Huang, 28 July 2007</em></p>\n\n<hr />\n\n<p>A pretty little ditty, to be sure. Much of object-oriented programming relies on self-modifying code, if you think about it. Consider the strategy pattern or the state pattern. In object-oriented programs it may appear that we are changing the data, but we are really changing the code.</p>\n\n<p>— <em>I, Object, 28 July 2007</em></p>\n\n<hr />\n\n<p>Hello, a quick question:</p>\n\n<p>I&rsquo;m not a scheme guru, but the posted code seems a bit off. Specifically, it looks to me like &lsquo;return&rsquo; is only bound the first time generator is called, so if you used it like:</p>\n\n<p> (generator)  &hellip;  (generator)</p>\n\n<p>On the second call, it would jump back to the first call (since that&rsquo;s what the continuation stored in &lsquo;return&rsquo; is). It seems like it should instead be something like (totally untested):</p>\n\n<p> &hellip;  (lambda (an-element-from-a-list)  (set! return  (call/cc  (lambda (resume-here)  (set! control-state resume-here)  (return an-element-from-a-list)))))  &hellip;</p>\n\n<p>However, as I said, I don&rsquo;t write a lot of scheme, so maybe I&rsquo;m missing something.</p>\n\n<p>Apologies for the terrible formatting, but I&rsquo;m not sure how to tell blogger to display stuff as code.</p>\n\n<p>Cheers.</p>\n\n<p>— <em>Dan Doel, 28 July 2007</em></p>\n\n<hr />\n\n<p>this is a terrible misuse of call/cc. here is a better implementation:</p>\n\n<p>(define (one-at-a-time lst)  (lambda ()  (if (null? lst)  &rsquo;you-fell-off-the-end  (let ((x (car lst)))  (set! lst (cdr lst))  x))))</p>\n\n<p>— <em>Gavin, 29 July 2007</em></p>\n\n<hr />\n\n<p>@Gavin: Actually, it is exactly what the recent call/cc hype was about: To allow implicit (foreach) instead of explicit state machines, esp. in the context of web applications. Imagine the state getting a little bit more complicated. (You&rsquo;d need to hide the call/cc in an abstraction for the generator programmer as well, though.)</p>\n\n<p>— <em>Andreas Krey, 29 July 2007</em></p>\n\n<hr />\n\n<p>call/cc is indeed a bad choice if all you&rsquo;re doing is making a generator out of a flat list. However, the technique mentioned works about equally well for turning folds over arbitrary data structures into generators/cursors.</p>\n\n<p>For instance, writing a generator for a binary tree using only the analogues to car/cdr is a pain (I imagine you&rsquo;d manage a stack of nodes to be visited by hand). However, writing an in-order traversal is simple. This example shows that you can turn the latter into the former automatically and generically using call/cc.</p>\n\n<p>Of course, for the particular case of turning a fold into a cursor, delimited continuations are, perhaps, even nicer (and, in a sense, this example might be mimicking delimited continuations with call/cc + state). Something like:</p>\n\n<p>(define (mk-generator traversal structure)  (define (generator) (control-loop))</p>\n\n<p> (define (control-loop)  (reset  (traversal  (lambda (element)  (shift  (lambda (k)  (set! control-loop (lambda () (k #f)))  element)))  structure)  &rsquo;traversal-done))</p>\n\n<p> generator)</p>\n\n<p>Which, handily, avoids having to worry about keeping track of a return continuation for this problem.</p>\n\n<p>The problem of turning folds into cursors in various languages, and the advantages of structuring a collection library in such a way are discussed in more depth here.</p>\n\n<p>— <em>Dan Doel, 29 July 2007</em></p>\n\n<hr />\n\n<ol>\n <li>\n  <p>Thanks for pointing out the bug.</p></li>\n <li>\n  <p>This (correct) code is a poem on turning a loop into a generator. It is not serious code.</p></li>\n <li>\n  <p>And yes, it is writing code like that many times, which first suggested delimited continuations to me in the fall of 1984; it just took three years to write it up.</p></li></ol>\n\n<p>— <em>matthias, 29 July 2007</em></p>\n\n<hr />\n\n<p>Matthias, sorry to be commenting on such an old blog post ;-)</p>\n\n<p>This is a pretty cool example, but I think it would be clearer if the internal defines were desugared into a letrec. It&rsquo;s very odd to see a function definition mutated from inside the function in the first place, but somehow it seems more natural in a letrec. More importantly (for me at least), is that I can understand right away what the continuation of the letrec would be, but it&rsquo;s not at all obvious with the internal define &mdash; it looks as though the continuation of the (define (generator) &hellip;) code would continue by defining control-state again.</p>\n\n<p>— <em>Michael, 30 January 2008</em></p>\n\n<hr />\n\n<p>This is cute; it took me a minute to understand what was going on. On the other hand, a few years ago I would have been scratching my head for hours.</p>\n\n<p>One complaint though: this code holds onto a return continuation longer than necessary, introducing the possibility of memory leaks and/or poor GC performance.</p>\n\n<p>Is there some kind of generic technique for destroying a reference to a continuation &ldquo;on the way out&rdquo; as you call it?</p>\n\n<p>— <em>Leon Smith, 3 April 2008</em></p>\n\n<hr />")) ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2012-02-02-racket-v521.md" . unix) f post (u . "Racket v5.2.1") (? . 36) 1467223812 (p+ #"/Users/MB/git/racket-lang-org/blog/2012/02/racket-v521.html" . unix) "/2012/02/racket-v521.html" (u . "2012-02-02T15:30:00.001-05:00") (? . 44) (? . 45) (c (u . "")) (u . "\n<p><em>posted by Eli Barzilay</em></p>\n\n<p>Racket version 5.2.1 is now available from <a href=\"http://racket-lang.org/\">http://racket-lang.org/</a> Release Highlights::</p>\n\n<ul>\n <li>\n  <p>Performance improvements include the use of <code>epoll()</code>/<code>kqueue()</code> instead of <code>select()</code> for the Racket thread scheduler, cross-module inlining of small functions, and the use of SSE instead of x87 for JIT-compiled floating-point operations on platforms where SSE is always available (including x86_64 platforms). A related change is the interning of literal numbers, strings, byte strings, characters, and regexps that appear in code and syntax objects.</p></li>\n <li>\n  <p>DrRacket uses a set of composable ray-traced icons available from the new <code>images</code> library collection.</p></li>\n <li>\n  <p>Typed Racket&rsquo;s <code>typecheck-fail</code> form allows macro creators to customize the error messages that Typed Racket produces. This is especially useful when creating pattern matching macros.</p></li>\n <li>\n  <p>The performance of Redex&rsquo;s matcher has been substantially improved; depending on the model you should see improvements between 2x and 50x in the time it takes to reduce terms.</p></li>\n <li>\n  <p>Plots look nicer and are more correct at very small and very large scales. New features include customizable dual axis ticks and transforms (e.g., log axes, date and currency ticks, axis interval collapse and stretch), stacked histograms, and 3D vector fields. The legacy <code>fit</code> function and libfit have been removed.</p></li>\n <li>\n  <p>The <code>2htdp/universe</code> library&rsquo;s <code>big-bang</code> form supports an experimental game pad key handler.</p></li>\n <li>\n  <p>The <code>db</code> library now supports nested transactions and PostgreSQL arrays. Bugs involving MySQL authentication and memory corruption in the SQLite bindings have been fixed.</p></li>\n <li>\n  <p>The Macro Stepper tool in DrRacket no longer executes a program after expanding it.</p></li>\n <li>\n  <p>In the DMdA teaching languages, infinite recursive signatures (&ldquo;streams&rdquo;, for example) with no intervening <code>mixed</code> are now supported, and the signatures of record definitions without fields now have generators for use with <code>property</code>.</p></li>\n <li>\n  <p>MysterX&rsquo;s ActiveX support is deprecated and will be removed in the next release. MysterX&rsquo;s core COM functionality will become deprecated in the next release, but COM functionality will be supported for the foreseeable future as a compatibility layer over a forthcoming <code>ffi/com</code> library.</p></li></ul>") #t (u . "\n<p><em>posted by Eli Barzilay</em></p>\n\n<p>Racket version 5.2.1 is now available from <a href=\"http://racket-lang.org/\">http://racket-lang.org/</a> Release Highlights::</p>\n\n<ul>\n <li>\n  <p>Performance improvements include the use of <code>epoll()</code>/<code>kqueue()</code> instead of <code>select()</code> for the Racket thread scheduler, cross-module inlining of small functions, and the use of SSE instead of x87 for JIT-compiled floating-point operations on platforms where SSE is always available (including x86_64 platforms). A related change is the interning of literal numbers, strings, byte strings, characters, and regexps that appear in code and syntax objects.</p></li>\n <li>\n  <p>DrRacket uses a set of composable ray-traced icons available from the new <code>images</code> library collection.</p></li>\n <li>\n  <p>Typed Racket&rsquo;s <code>typecheck-fail</code> form allows macro creators to customize the error messages that Typed Racket produces. This is especially useful when creating pattern matching macros.</p></li>\n <li>\n  <p>The performance of Redex&rsquo;s matcher has been substantially improved; depending on the model you should see improvements between 2x and 50x in the time it takes to reduce terms.</p></li>\n <li>\n  <p>Plots look nicer and are more correct at very small and very large scales. New features include customizable dual axis ticks and transforms (e.g., log axes, date and currency ticks, axis interval collapse and stretch), stacked histograms, and 3D vector fields. The legacy <code>fit</code> function and libfit have been removed.</p></li>\n <li>\n  <p>The <code>2htdp/universe</code> library&rsquo;s <code>big-bang</code> form supports an experimental game pad key handler.</p></li>\n <li>\n  <p>The <code>db</code> library now supports nested transactions and PostgreSQL arrays. Bugs involving MySQL authentication and memory corruption in the SQLite bindings have been fixed.</p></li>\n <li>\n  <p>The Macro Stepper tool in DrRacket no longer executes a program after expanding it.</p></li>\n <li>\n  <p>In the DMdA teaching languages, infinite recursive signatures (&ldquo;streams&rdquo;, for example) with no intervening <code>mixed</code> are now supported, and the signatures of record definitions without fields now have generators for use with <code>property</code>.</p></li>\n <li>\n  <p>MysterX&rsquo;s ActiveX support is deprecated and will be removed in the next release. MysterX&rsquo;s core COM functionality will become deprecated in the next release, but COM functionality will be supported for the foreseeable future as a compatibility layer over a forthcoming <code>ffi/com</code> library.</p></li></ul>\n<!-- more-->\n\n<hr />\n\n<p>What is your opinion of Clojure?</p>\n\n<p>— <em>Owen, 2 February 2012</em></p>\n\n<hr />\n\n<p>I just compiled and installed the new racket release on my linux laptop! Racket&rsquo;s great! The performance seems to be much better than in previous versions and DrRacket IDE has improved much! Thanks!</p>\n\n<p>— <em>Axel S., 7 February 2012</em></p>\n\n<hr />\n\n<p>On Windows 7 with both the 32-bit and 64-bit installers, DrRacket can&rsquo;t run due to this error:</p>\n\n<p>read-bitmap: expects type  as 1st argument, given: &rsquo;#(# 270 270); other arguments were: &rsquo;unknown/alpha #f #t</p>\n\n<p>(The problem shows up for the new 5.2.1, but not on with 5.2 version.)</p>\n\n<p>— <em>Dan, 26 March 2012</em></p>\n\n<hr />\n\n<p>This is a bug that we are currently working on. Full message can be found here.</p>\n\n<p>— <em>Eli Barzilay, 26 March 2012</em></p>\n\n<hr />")) ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2011-02-14-racket-v51.md" . unix) f post (u . "Racket v5.1") (? . 17) 1467223812 (p+ #"/Users/MB/git/racket-lang-org/blog/2011/02/racket-v51.html" . unix) "/2011/02/racket-v51.html" (u . "2011-02-14T22:52:00.000-05:00") (? . 46) (? . 47) (c (u . "")) (u . "\n<p><em>posted by Eli Barzilay</em></p>\n\n<p>Racket version 5.1 is now available from <a href=\"http://racket-lang.org/\">http://racket-lang.org/</a>The most significant change in version 5.1 is a <a href=\"../../2010/12/racket-version-5.html\">rewrite of the GUI library</a>. Unix/X users will see the biggest difference with this change, because DrRacket and all Racket GUI programs now take on the desktop theme for menus, buttons, and other GUI widgets.</p>\n\n<p>In the long run, Racket GUI programs on all platforms will improve as a result of the library rewrite. In the short run, beware that this first release of a new library will inevitably include a new set of bugs.</p>\n\n<p>Version 5.1 changes in more detail:</p>\n\n<ul>\n <li>\n  <p>The <code>racket/draw</code> library&mdash;which implements the drawing half the GUI toolkit&mdash;can be used independent of the <code>racket/gui/base</code> library and without a graphics display (e.g., without an X11 connection).The new library has one small incompatibility with the old GUI toolbox: &rsquo;xor drawing is no longer supported. The new library has many additional features: rotation and general affine transformations, PDF and SVG drawing contexts, gradients, and alpha-channel bitmaps.</p></li>\n <li>\n  <p>The GRacket executable is no longer strictly necessary for running GUI programs, because the <code>racket/gui/base</code> library can be used from Racket. To the degree that a platform distinguishes GUI and console applications, however, the GRacket executable still offers some additional GUI-specific functionality (e.g., single-instance support).The new <code>racket/gui/base</code> library includes small incompatibilities with the old GUI toolbox: the <code>send-event</code>, <code>current-ps-afm-file-paths</code>, and <code>current-ps-cmap-file-paths</code> functions have been removed. The <code>racket/gui/base</code> library re-exports <code>racket/draw</code>, so it includes the same drawing functionality as before (except for &rsquo;xor drawing).</p></li>\n <li>\n  <p>The new <code>racket/snip</code> library can be used independently of <code>racket/gui/base</code> to work with graphical editor content (e.g., images in student programs). Like <code>racket/draw</code>, the <code>racket/snip</code> library is re-exported by <code>racket/gui/base</code>.</p></li>\n <li>\n  <p>The Web Server includes a backwards incompatible change that prevents X-expressions and lists of bytes from being directly returned from servlets. This change will increase performance for those types of responses and allow easier experimentation with response types. Please see \"<code>collects/web-server/compat/0/README</code>\" in the installation to learn about porting your servlets forward. Don&rsquo;t worry. It&rsquo;s easy.</p></li>\n <li>\n  <p>The new <code>raco demodularize</code> tool collapses a module&rsquo;s dependencies into a single module comprising the whole program. This transformation currently provides no performance improvement, but is the basis for cross-module optimization and dead-code elimination tools to come. The transformation is currently useful for static analysis of whole Racket programs.</p></li>\n <li>\n  <p>The picturing-programs teachpack, formerly installed via PLaneT, is now bundled with the standard distribution. Use the teachpack with <code>(require picturing-programs)</code> instead of <code>(require installed-teachpacks/picturing-programs)</code>. The old PLaneT-based installation procedure still works, but it now merely installs a stub that invokes the bundled version.</p></li>\n <li>\n  <p>Slideshow picts, <code>racket/draw</code> bitmaps, and images created with <code>2htdp/image</code> can now be used directly in Scribble documents. More generally, the new <code>file/convertible</code> protocol enables any value that is convertible to a PNG and/or PDF stream to be used as an image in a Scribble document.</p></li>\n <li>\n  <p>The Same game sports a new look and an improved scoring system. (The current known high score is 12,429; can you beat that?)</p></li></ul>") #t (u . "\n<p><em>posted by Eli Barzilay</em></p>\n\n<p>Racket version 5.1 is now available from <a href=\"http://racket-lang.org/\">http://racket-lang.org/</a>The most significant change in version 5.1 is a <a href=\"../../2010/12/racket-version-5.html\">rewrite of the GUI library</a>. Unix/X users will see the biggest difference with this change, because DrRacket and all Racket GUI programs now take on the desktop theme for menus, buttons, and other GUI widgets.</p>\n\n<p>In the long run, Racket GUI programs on all platforms will improve as a result of the library rewrite. In the short run, beware that this first release of a new library will inevitably include a new set of bugs.</p>\n\n<p>Version 5.1 changes in more detail:</p>\n\n<ul>\n <li>\n  <p>The <code>racket/draw</code> library&mdash;which implements the drawing half the GUI toolkit&mdash;can be used independent of the <code>racket/gui/base</code> library and without a graphics display (e.g., without an X11 connection).The new library has one small incompatibility with the old GUI toolbox: &rsquo;xor drawing is no longer supported. The new library has many additional features: rotation and general affine transformations, PDF and SVG drawing contexts, gradients, and alpha-channel bitmaps.</p></li>\n <li>\n  <p>The GRacket executable is no longer strictly necessary for running GUI programs, because the <code>racket/gui/base</code> library can be used from Racket. To the degree that a platform distinguishes GUI and console applications, however, the GRacket executable still offers some additional GUI-specific functionality (e.g., single-instance support).The new <code>racket/gui/base</code> library includes small incompatibilities with the old GUI toolbox: the <code>send-event</code>, <code>current-ps-afm-file-paths</code>, and <code>current-ps-cmap-file-paths</code> functions have been removed. The <code>racket/gui/base</code> library re-exports <code>racket/draw</code>, so it includes the same drawing functionality as before (except for &rsquo;xor drawing).</p></li>\n <li>\n  <p>The new <code>racket/snip</code> library can be used independently of <code>racket/gui/base</code> to work with graphical editor content (e.g., images in student programs). Like <code>racket/draw</code>, the <code>racket/snip</code> library is re-exported by <code>racket/gui/base</code>.</p></li>\n <li>\n  <p>The Web Server includes a backwards incompatible change that prevents X-expressions and lists of bytes from being directly returned from servlets. This change will increase performance for those types of responses and allow easier experimentation with response types. Please see \"<code>collects/web-server/compat/0/README</code>\" in the installation to learn about porting your servlets forward. Don&rsquo;t worry. It&rsquo;s easy.</p></li>\n <li>\n  <p>The new <code>raco demodularize</code> tool collapses a module&rsquo;s dependencies into a single module comprising the whole program. This transformation currently provides no performance improvement, but is the basis for cross-module optimization and dead-code elimination tools to come. The transformation is currently useful for static analysis of whole Racket programs.</p></li>\n <li>\n  <p>The picturing-programs teachpack, formerly installed via PLaneT, is now bundled with the standard distribution. Use the teachpack with <code>(require picturing-programs)</code> instead of <code>(require installed-teachpacks/picturing-programs)</code>. The old PLaneT-based installation procedure still works, but it now merely installs a stub that invokes the bundled version.</p></li>\n <li>\n  <p>Slideshow picts, <code>racket/draw</code> bitmaps, and images created with <code>2htdp/image</code> can now be used directly in Scribble documents. More generally, the new <code>file/convertible</code> protocol enables any value that is convertible to a PNG and/or PDF stream to be used as an image in a Scribble document.</p></li>\n <li>\n  <p>The Same game sports a new look and an improved scoring system. (The current known high score is 12,429; can you beat that?)</p></li></ul>\n<!-- more-->\n\n<hr />\n\n<p>Wow, that was a bunch of work. I&rsquo;ve been lurking, trying the nightly build about every week. Congratulations on the successful rewrite and thank you for the effort.</p>\n\n<p>— <em>griffinish, 19 February 2011</em></p>\n\n<hr />\n\n<p>Thanks a lot for Racket! It&rsquo;s really great.</p>\n\n<p>And could you help me? Does vim syntax file for Racket exist and how can I find one if yes?</p>\n\n<p>— <em>ul, 22 February 2011</em></p>\n\n<hr />\n\n<p>I&rsquo;m using the Lion GM and can&rsquo;t seem to launch any of the binaries included in the download. They invariably crash on launch.</p>\n\n<p>— <em>Alex Lew, 10 July 2011</em></p>\n\n<hr />\n\n<p>Try a newer version &mdash; IIRC, there were some relevant fixes since then.</p>\n\n<p>— <em>Eli Barzilay, 17 July 2011</em></p>\n\n<hr />")) ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2011-11-09-racket-v52.md" . unix) f post (u . "Racket v5.2") (? . 20) 1467223812 (p+ #"/Users/MB/git/racket-lang-org/blog/2011/11/racket-v52.html" . unix) "/2011/11/racket-v52.html" (u . "2011-11-09T22:49:00.000-05:00") (? . 48) (? . 44) (c (u . "")) (u . "\n<p><em>posted by Eli Barzilay</em></p>\n\n<p>Racket version 5.2 is now available from <a href=\"http://racket-lang.org/\">http://racket-lang.org/</a> Release Highlights::</p>\n\n<ul>\n <li>\n  <p>DrRacket comes with an experimental, on-line check syntax tool, although this new tool is disabled default. See below for more information.</p></li>\n <li>\n  <p>The new <code>db</code> library offers a high-level, functional interface to popular relational database systems, including PostgreSQL, MySQL, and SQLite, as well as other systems via ODBC.</p></li>\n <li>\n  <p>A new XREPL collection provides convenient commands for a plain racket REPL. It is particularly convenient for people who prefer console-based work and alternative editors. See also the new chapter on command-line tools and other editors at the end of the Racket Guide.</p></li>\n <li>\n  <p>The <code>plot</code> collection has been reimplemented in Racket. It now offers PDF output, log axes, histograms, and more. Some code that uses <code>plot</code> will still work, and some will need light porting. The <code>plot/compat</code> module offers expedient backward compatibility.</p></li>\n <li>\n  <p>DrRacket uses more conventional key bindings: <code>C-t</code> creates a new tab, <code>C-w</code> closes the current one, and <code>C-r</code> runs the definitions. On Mac OS X, the Command key is used. See “Defining Custom Shortcuts” in the DrRacket manual for an example that uses the old key bindings.</p></li>\n <li>\n  <p>The new <code>raco link</code> command registers a directory as a collection, which allows the collection directory to reside outside the “<code>collects</code>” tree and without changing the PLTCOLLECTS environment variable.</p></li>\n <li>\n  <p>Typed Racket:</p></li>\n <li>\n  <p>Typed Racket provides static performance debugging support to show which code gets optimized and point out code that does not. Use the “Performance Report” button in DrRacket.</p></li>\n <li>\n  <p>More intuitive types in printouts in the REPL and in error messages. Use <code>:query-result-type</code> to explore types, or <code>:print-type</code> for a full printout.</p></li>\n <li>\n  <p>Typed Racket now supports defining function with optional arguments using the same syntax as Racket.</p></li>\n <li>\n  <p>Redex now supports specifying (and testing and automatically typesetting) judgment forms including type systems and SOS-style operational semantics.</p></li>\n <li>\n  <p>Fixed several GUI problems, including problems on Ubuntu 11.10 (GTK+ 3) and 64-bit Mac OS X.</p></li>\n <li>\n  <p>Internal-definition expansion has changed to use <code>let*</code> semantics for sequences that contain no back references. This change removes a performance penalty for using internal definitions instead of <code>let</code> in common cases, and it only changes the meaning of programs that capture continuations in internal definitions. Internal definitions are now considered preferable in style to <code>let</code>.</p></li>\n <li>\n  <p>Support for <code>begin-for-syntax</code> has been generalized; modules may now define and export both value bindings and syntax bindings (macros) at phase 1 and higher. Due to a bug, phase 1 syntax (or higher) is not available in DrRacket&rsquo;s <code>#lang</code>-based REPL. A simple workaround is to disable debugging in DrRacket (see “no debugging” radio button in detailed language dialog).</p></li></ul>\n\n<p>Additional Items::</p>\n\n<ul>\n <li>\n  <p>The <code>racket/gui</code> library (and Slideshow) provides more support for multiple-screen displays.</p></li>\n <li>\n  <p>DrRacket remembers whether an opened file used LF or CRLF line endings, and will continue using the same. When creating a new file, a preference determines how it is saved.</p></li>\n <li>\n  <p><code>net/url</code> can now follow HTTP redirections.</p></li>\n <li>\n  <p>The LNCS and JFP class files are no longer distributed with Racket. Instead, they are downloaded on demand.</p></li>\n <li>\n  <p>The Algol language implementation is now available as a plain language using <code>#lang algol60</code>.</p></li>\n <li>\n  <p>The Racket-to-C compiler (as accessed via <code>raco ctool</code> or <code>mzc</code>) has been removed; Racket&rsquo;s JIT has long provided better performance, and the FFI provides better access to C libraries.</p></li>\n <li>\n  <p>Contracts can be applied to exports with the new <code>contract-out</code> form within <code>provide</code>, instead of a separate <code>provide/contract</code> form. (The new <code>contract-out</code> form is implemented as a new kind of “provide pre-transformer”.)</p></li>\n <li>\n  <p>The <code>date*</code> structure type is an extension of <code>date</code> with <code>nanosecond</code> and <code>time-zone-name</code> fields.</p></li>\n <li>\n  <p>New looping constructs: <code>for/sum</code> and <code>for/product</code>.</p></li>\n <li>\n  <p>Direct calls to keyword-accepting functions are now optimized to eliminate the overhead of keywords. In addition, the compiler detects and logs warnings for keyword-argument mismatches.</p></li>\n <li>\n  <p>The libfit interface is available from <code>plot/deprecated/fit</code>, and will be removed in the near future.</p></li>\n <li>\n  <p>The Unix installer has been re-done, and it is now more robust.</p></li>\n <li>\n  <p>The built-in reader and printer support for Honu is removed. (This functionality is re-implemented in Racket.)</p></li></ul>\n\n<p>On-line Check Syntax::  DrRacket now provides an on-line version of the syntax check tool, which means that syntax checking runs automatically while you continue to edit a program. With this tool enabled, its annotations (e.g., binding arrows) and actions (e.g., the renaming refactoring and direct documentation links) are almost always available. We have noticed that on-line syntax checking renders DrRacket unstable on occasion, perhaps because it relies on relatively new support for parallelism. Occurrences of the problem are rare, but they are not rare enough, which is why we have disabled the tool by default. At the same time, current users of the tool find it so valuable that we felt it should be included in the release. We expect to track down the remaining problems and enable the tool by default in near-future release. To enable on-line syntax checking (for <code>#lang</code>-based programs only), click on the red dot in the bottom right of DrRacket&rsquo;s window. To turn it off, click there again.</p>") #t (u . "\n<p><em>posted by Eli Barzilay</em></p>\n\n<p>Racket version 5.2 is now available from <a href=\"http://racket-lang.org/\">http://racket-lang.org/</a> Release Highlights::</p>\n\n<ul>\n <li>\n  <p>DrRacket comes with an experimental, on-line check syntax tool, although this new tool is disabled default. See below for more information.</p></li>\n <li>\n  <p>The new <code>db</code> library offers a high-level, functional interface to popular relational database systems, including PostgreSQL, MySQL, and SQLite, as well as other systems via ODBC.</p></li>\n <li>\n  <p>A new XREPL collection provides convenient commands for a plain racket REPL. It is particularly convenient for people who prefer console-based work and alternative editors. See also the new chapter on command-line tools and other editors at the end of the Racket Guide.</p></li>\n <li>\n  <p>The <code>plot</code> collection has been reimplemented in Racket. It now offers PDF output, log axes, histograms, and more. Some code that uses <code>plot</code> will still work, and some will need light porting. The <code>plot/compat</code> module offers expedient backward compatibility.</p></li>\n <li>\n  <p>DrRacket uses more conventional key bindings: <code>C-t</code> creates a new tab, <code>C-w</code> closes the current one, and <code>C-r</code> runs the definitions. On Mac OS X, the Command key is used. See “Defining Custom Shortcuts” in the DrRacket manual for an example that uses the old key bindings.</p></li>\n <li>\n  <p>The new <code>raco link</code> command registers a directory as a collection, which allows the collection directory to reside outside the “<code>collects</code>” tree and without changing the PLTCOLLECTS environment variable.</p></li>\n <li>\n  <p>Typed Racket:</p></li>\n <li>\n  <p>Typed Racket provides static performance debugging support to show which code gets optimized and point out code that does not. Use the “Performance Report” button in DrRacket.</p></li>\n <li>\n  <p>More intuitive types in printouts in the REPL and in error messages. Use <code>:query-result-type</code> to explore types, or <code>:print-type</code> for a full printout.</p></li>\n <li>\n  <p>Typed Racket now supports defining function with optional arguments using the same syntax as Racket.</p></li>\n <li>\n  <p>Redex now supports specifying (and testing and automatically typesetting) judgment forms including type systems and SOS-style operational semantics.</p></li>\n <li>\n  <p>Fixed several GUI problems, including problems on Ubuntu 11.10 (GTK+ 3) and 64-bit Mac OS X.</p></li>\n <li>\n  <p>Internal-definition expansion has changed to use <code>let*</code> semantics for sequences that contain no back references. This change removes a performance penalty for using internal definitions instead of <code>let</code> in common cases, and it only changes the meaning of programs that capture continuations in internal definitions. Internal definitions are now considered preferable in style to <code>let</code>.</p></li>\n <li>\n  <p>Support for <code>begin-for-syntax</code> has been generalized; modules may now define and export both value bindings and syntax bindings (macros) at phase 1 and higher. Due to a bug, phase 1 syntax (or higher) is not available in DrRacket&rsquo;s <code>#lang</code>-based REPL. A simple workaround is to disable debugging in DrRacket (see “no debugging” radio button in detailed language dialog).</p></li></ul>\n\n<p>Additional Items::</p>\n\n<ul>\n <li>\n  <p>The <code>racket/gui</code> library (and Slideshow) provides more support for multiple-screen displays.</p></li>\n <li>\n  <p>DrRacket remembers whether an opened file used LF or CRLF line endings, and will continue using the same. When creating a new file, a preference determines how it is saved.</p></li>\n <li>\n  <p><code>net/url</code> can now follow HTTP redirections.</p></li>\n <li>\n  <p>The LNCS and JFP class files are no longer distributed with Racket. Instead, they are downloaded on demand.</p></li>\n <li>\n  <p>The Algol language implementation is now available as a plain language using <code>#lang algol60</code>.</p></li>\n <li>\n  <p>The Racket-to-C compiler (as accessed via <code>raco ctool</code> or <code>mzc</code>) has been removed; Racket&rsquo;s JIT has long provided better performance, and the FFI provides better access to C libraries.</p></li>\n <li>\n  <p>Contracts can be applied to exports with the new <code>contract-out</code> form within <code>provide</code>, instead of a separate <code>provide/contract</code> form. (The new <code>contract-out</code> form is implemented as a new kind of “provide pre-transformer”.)</p></li>\n <li>\n  <p>The <code>date*</code> structure type is an extension of <code>date</code> with <code>nanosecond</code> and <code>time-zone-name</code> fields.</p></li>\n <li>\n  <p>New looping constructs: <code>for/sum</code> and <code>for/product</code>.</p></li>\n <li>\n  <p>Direct calls to keyword-accepting functions are now optimized to eliminate the overhead of keywords. In addition, the compiler detects and logs warnings for keyword-argument mismatches.</p></li>\n <li>\n  <p>The libfit interface is available from <code>plot/deprecated/fit</code>, and will be removed in the near future.</p></li>\n <li>\n  <p>The Unix installer has been re-done, and it is now more robust.</p></li>\n <li>\n  <p>The built-in reader and printer support for Honu is removed. (This functionality is re-implemented in Racket.)</p></li></ul>\n\n<p>On-line Check Syntax::  DrRacket now provides an on-line version of the syntax check tool, which means that syntax checking runs automatically while you continue to edit a program. With this tool enabled, its annotations (e.g., binding arrows) and actions (e.g., the renaming refactoring and direct documentation links) are almost always available. We have noticed that on-line syntax checking renders DrRacket unstable on occasion, perhaps because it relies on relatively new support for parallelism. Occurrences of the problem are rare, but they are not rare enough, which is why we have disabled the tool by default. At the same time, current users of the tool find it so valuable that we felt it should be included in the release. We expect to track down the remaining problems and enable the tool by default in near-future release. To enable on-line syntax checking (for <code>#lang</code>-based programs only), click on the red dot in the bottom right of DrRacket&rsquo;s window. To turn it off, click there again.</p>\n<!-- more-->\n\n<hr />\n\n<p>The new plot is awesome!</p>\n\n<p>— <em>deforce, 19 January 2012</em></p>\n\n<hr />")) ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2010-08-03-racket-v501.md" . unix) f post (u . "Racket v5.0.1") (? . 49) 1467223812 (p+ #"/Users/MB/git/racket-lang-org/blog/2010/08/racket-v501.html" . unix) "/2010/08/racket-v501.html" (u . "2010-08-03T22:36:00.000-04:00") (? . 50) (? . 51) (c (u . "")) (u . "\n<p><em>posted by Eli Barzilay</em></p>\n\n<p>Racket version 5.0.1 is now available from <a href=\"http://racket-lang.org/\">http://racket-lang.org/</a></p>\n\n<ul>\n <li>\n  <p>Datalog is a lightweight deductive database system with Racket integration. It is now available in the <code>datalog</code> collection and with <code>#lang datalog</code>.</p></li>\n <li>\n  <p>Racklog provides Prolog-style logic programming in Racket, adapted from Dorai Sitaram&rsquo;s Schelog package. It is available in the <code>racklog</code> collection and now as <code>#lang racklog</code>.</p></li>\n <li>\n  <p>By default <code>make install</code> and <code>raco setup</code> compile collections in parallel on all available processors. (Use <code>raco setup -j 1</code> to disable, if necessary.)</p></li>\n <li>\n  <p>Changes (as part of 5.0) in the <code>racket</code> language compared to the <code>scheme</code> language: constructor-style printing, a <code>struct</code> alternative to <code>define-struct</code> that fits more naturally with <code>match</code> and constructor-style printing, bytecode-dependency management via SHA&ndash;1 hashes instead of just timestamps (where the <code>openssl/sha1</code> library provides the SHA&ndash;1 hash function), a reorganization of <code>scheme/foreign</code> into <code>ffi/unsafe</code> and associated libraries, and new printing functions <code>eprintf</code> and <code>displayln</code>. Also, a generator from <code>racket/generator</code> is required to have the form <code>(generator () body ...)</code>, which supports a planned extension to let a generator accept arguments.</p></li>\n <li>\n  <p>Changes to the <code>racket</code> language (since 5.0): internal-definition positions allow mixing expressions with definitions, full continuations can escape past a continuation barrier, custodians can attempt to terminate subprocesses and subprocess groups (see <code>current-subprocess-custodian-mode</code>, <code>subprocess-group-enabled</code>), the JIT supports additional unboxing flonum operations and unsafe variants, <code>ffi/unsafe</code> provides an asychronous-call mechanism to deal with foreign threads, a new \".\" modifier for format string directives (e.g., \"~.s\" and \"~.a\") limits the respective output to <code>(error-print-width)</code> characters.</p></li>\n <li>\n  <p>The core type system of Typed Racket has been substantially revised. In particular, Typed Racket can now follow significantly more sophisticated reasoning about the relationships between predicates. Additionally, Typed Racket now allows variable arity types in more places, allowing programmers to specify variable-arity lists.</p></li>\n <li>\n  <p>We are working on an optimizing version of Typed Racket that takes advantage of type information for certain classes of programs. This project is a work in progress. For those interested, see the documentation for <code>#:optimized</code>.</p></li>\n <li>\n  <p>The <code>web-server/formlets</code> library adds a <code>formlet*</code> form that allows dynamic formlet construction, as opposed to <code>formlet</code> which requires syntactic Xexprs and static formlets. Several new library formlets are added.</p></li>\n <li>\n  <p>The <code>syntax/parse</code> library has new support for matching literals at different phases using the <code>#:phase</code> argument for literals and literal sets.</p></li>\n <li>\n  <p>RackUnit now includes a GUI test runner as <code>rackunit/gui</code>.</p></li>\n <li>\n  <p>The <code>2htdp/image</code> library now includes <code>flip-vertical</code> and <code>flip-horizontal</code> operations that mirror images (vertically and horizontally).</p></li></ul>") #t (u . "\n<p><em>posted by Eli Barzilay</em></p>\n\n<p>Racket version 5.0.1 is now available from <a href=\"http://racket-lang.org/\">http://racket-lang.org/</a></p>\n\n<ul>\n <li>\n  <p>Datalog is a lightweight deductive database system with Racket integration. It is now available in the <code>datalog</code> collection and with <code>#lang datalog</code>.</p></li>\n <li>\n  <p>Racklog provides Prolog-style logic programming in Racket, adapted from Dorai Sitaram&rsquo;s Schelog package. It is available in the <code>racklog</code> collection and now as <code>#lang racklog</code>.</p></li>\n <li>\n  <p>By default <code>make install</code> and <code>raco setup</code> compile collections in parallel on all available processors. (Use <code>raco setup -j 1</code> to disable, if necessary.)</p></li>\n <li>\n  <p>Changes (as part of 5.0) in the <code>racket</code> language compared to the <code>scheme</code> language: constructor-style printing, a <code>struct</code> alternative to <code>define-struct</code> that fits more naturally with <code>match</code> and constructor-style printing, bytecode-dependency management via SHA&ndash;1 hashes instead of just timestamps (where the <code>openssl/sha1</code> library provides the SHA&ndash;1 hash function), a reorganization of <code>scheme/foreign</code> into <code>ffi/unsafe</code> and associated libraries, and new printing functions <code>eprintf</code> and <code>displayln</code>. Also, a generator from <code>racket/generator</code> is required to have the form <code>(generator () body ...)</code>, which supports a planned extension to let a generator accept arguments.</p></li>\n <li>\n  <p>Changes to the <code>racket</code> language (since 5.0): internal-definition positions allow mixing expressions with definitions, full continuations can escape past a continuation barrier, custodians can attempt to terminate subprocesses and subprocess groups (see <code>current-subprocess-custodian-mode</code>, <code>subprocess-group-enabled</code>), the JIT supports additional unboxing flonum operations and unsafe variants, <code>ffi/unsafe</code> provides an asychronous-call mechanism to deal with foreign threads, a new \".\" modifier for format string directives (e.g., \"~.s\" and \"~.a\") limits the respective output to <code>(error-print-width)</code> characters.</p></li>\n <li>\n  <p>The core type system of Typed Racket has been substantially revised. In particular, Typed Racket can now follow significantly more sophisticated reasoning about the relationships between predicates. Additionally, Typed Racket now allows variable arity types in more places, allowing programmers to specify variable-arity lists.</p></li>\n <li>\n  <p>We are working on an optimizing version of Typed Racket that takes advantage of type information for certain classes of programs. This project is a work in progress. For those interested, see the documentation for <code>#:optimized</code>.</p></li>\n <li>\n  <p>The <code>web-server/formlets</code> library adds a <code>formlet*</code> form that allows dynamic formlet construction, as opposed to <code>formlet</code> which requires syntactic Xexprs and static formlets. Several new library formlets are added.</p></li>\n <li>\n  <p>The <code>syntax/parse</code> library has new support for matching literals at different phases using the <code>#:phase</code> argument for literals and literal sets.</p></li>\n <li>\n  <p>RackUnit now includes a GUI test runner as <code>rackunit/gui</code>.</p></li>\n <li>\n  <p>The <code>2htdp/image</code> library now includes <code>flip-vertical</code> and <code>flip-horizontal</code> operations that mirror images (vertically and horizontally).</p></li></ul>\n<!-- more-->\n\n<hr />\n\n<p>Can you please add a note to the download page when a compilable linux source is available? And while you&rsquo;re testing, try making an rpm with shared libraries enabled. I&rsquo;ve been trying to do that since 4.1.2 using the Fedora spec file, and mzscheme always seg faults.</p>\n\n<p>Thanks, Gene</p>\n\n<p>— <em>Gene Snider, 6 August 2010</em></p>\n\n<hr />\n\n<p>Thank you very much! Racket 5.0.1 successfully builds an rpm with shared libraries enabled on Fedora 14. Now to get the package maintainer up to speed.</p>\n\n<p>Gene</p>\n\n<p>— <em>Gene Snider, 14 August 2010</em></p>\n\n<hr />")) ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2008-08-12-plt-scheme-v41.md" . unix) f post (u . "PLT Scheme v4.1") (? . 52) 1467223812 (p+ #"/Users/MB/git/racket-lang-org/blog/2008/08/plt-scheme-v41.html" . unix) "/2008/08/plt-scheme-v41.html" (u . "2008-08-12T16:32:00.002-04:00") (? . 66) (? . 53) (c (u . "")) (u . "\n<p><em>posted by Eli Barzilay</em></p>\n\n<p>PLT Scheme version 4.1 is now available from  <a href=\"http://plt-scheme.org/\">http://plt-scheme.org/</a></p>\n\n<ul>\n <li>DrScheme changes:\n  <ul>\n   <li>The Module language now has an automatically inserted <code>#lang</code> declaration, so the interactions window is available right away for new windows.</li>\n   <li>Searching is now interactive (see the manual for details).</li>\n   <li>Memory limits are now enabled by default.</li></ul></li>\n <li>\n  <p>Typed Scheme supports a novel type checking mechanism for homogeneous and heterogeneous variable-arity function definitions and applications.</p></li>\n <li>\n  <p>Redex (a domain-specific language for testing operational semantics) is now included in the distribution. See also <code>[redex.plt-scheme.org](http://redex.plt-scheme.org/)</code>.</p></li>\n <li>\n  <p>Lots of improvement to the documentation, including: better searching, table-of-contents, and language-sensitive help (in the teaching languages).</p></li>\n <li>\n  <p>The world.ss teachpack no longer supports <code>end-of-time</code>, only <code>stop-when</code>.</p></li>\n <li>\n  <p>MzScheme has now a logging facility, search the documentationfor &ldquo;logger&rdquo; for more details.</p></li>\n <li>Bug fixes:\n  <ul>\n   <li><code>begin</code> in R5RS (and derived languages),</li>\n   <li><code>#lang planet</code>,</li>\n   <li><code>eval</code> works with phases.</li></ul></li></ul>\n\n<p>Feedback Welcome.</p>") #f (u . "\n<p><em>posted by Eli Barzilay</em></p>\n\n<p>PLT Scheme version 4.1 is now available from  <a href=\"http://plt-scheme.org/\">http://plt-scheme.org/</a></p>\n\n<ul>\n <li>DrScheme changes:\n  <ul>\n   <li>The Module language now has an automatically inserted <code>#lang</code> declaration, so the interactions window is available right away for new windows.</li>\n   <li>Searching is now interactive (see the manual for details).</li>\n   <li>Memory limits are now enabled by default.</li></ul></li>\n <li>\n  <p>Typed Scheme supports a novel type checking mechanism for homogeneous and heterogeneous variable-arity function definitions and applications.</p></li>\n <li>\n  <p>Redex (a domain-specific language for testing operational semantics) is now included in the distribution. See also <code>[redex.plt-scheme.org](http://redex.plt-scheme.org/)</code>.</p></li>\n <li>\n  <p>Lots of improvement to the documentation, including: better searching, table-of-contents, and language-sensitive help (in the teaching languages).</p></li>\n <li>\n  <p>The world.ss teachpack no longer supports <code>end-of-time</code>, only <code>stop-when</code>.</p></li>\n <li>\n  <p>MzScheme has now a logging facility, search the documentationfor &ldquo;logger&rdquo; for more details.</p></li>\n <li>Bug fixes:\n  <ul>\n   <li><code>begin</code> in R5RS (and derived languages),</li>\n   <li><code>#lang planet</code>,</li>\n   <li><code>eval</code> works with phases.</li></ul></li></ul>\n\n<p>Feedback Welcome.</p>")) ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2008-06-06-the-tour-in-video.md" . unix) f post (u . "The Tour in Video") (? . 41) 1467223812 (p+ #"/Users/MB/git/racket-lang-org/blog/2008/06/the-tour-in-video.html" . unix) "/2008/06/the-tour-in-video.html" (u . "2008-06-06T21:40:00.002-04:00") (? . 54) (? . 23) (c (u . "")) (u . "\n<p><em>posted by Shriram Krishnamurthi</em></p>\n\n<p>Putting behind its stodgy textual past, the DrScheme tour is now <a href=\"http://www.youtube.com/watch?v=vgQO_kHl39g\">in video</a>! It&rsquo;s rather preliminary, and can use lots of improvement, but now we&rsquo;re really taking it to the kids.</p>") #t (u . "\n<p><em>posted by Shriram Krishnamurthi</em></p>\n\n<p>Putting behind its stodgy textual past, the DrScheme tour is now <a href=\"http://www.youtube.com/watch?v=vgQO_kHl39g\">in video</a>! It&rsquo;s rather preliminary, and can use lots of improvement, but now we&rsquo;re really taking it to the kids.</p>\n<!-- more-->\n\n<hr />\n\n<p>In a better quality: http://www.youtube.com/watch?v=vgQO_kHl39g&amp;fmt=18</p>\n\n<p>Now you can read the examples a bit better.</p>\n\n<p>— <em>stesch, 7 June 2008</em></p>\n\n<hr />")) ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2009-05-18-scheme-workshop-deadline-not-extended.md" . unix) f post (u . "Scheme Workshop: deadline NOT extended!") (? . 55) 1467223812 (p+ #"/Users/MB/git/racket-lang-org/blog/2009/05/scheme-workshop-deadline-not-extended.html" . unix) "/2009/05/scheme-workshop-deadline-not-extended.html" (u . "2009-05-18T13:10:00.002-04:00") (? . 58) (? . 27) (c (u . "")) (u . "\n<p><em>posted by John Clements</em></p>\n\n<p>We&rsquo;re holding the line on our submission deadline; it&rsquo;s still June 5, so that gives you about three weeks to write something awesome.</p>\n\n<p>Re-posting the entire CfP on a blog seems a bit tacky, so instead I&rsquo;ll just post the link:</p>\n\n<p><a href=\"http://blog.plt-scheme.org/2009/01/cfp-scheme-workshop-2009.html\"> http://blog.plt-scheme.org/2009/01/cfp-scheme-workshop&ndash;2009.html</a></p>\n\n<p>We look forward to your submissions!</p>") #f (u . "\n<p><em>posted by John Clements</em></p>\n\n<p>We&rsquo;re holding the line on our submission deadline; it&rsquo;s still June 5, so that gives you about three weeks to write something awesome.</p>\n\n<p>Re-posting the entire CfP on a blog seems a bit tacky, so instead I&rsquo;ll just post the link:</p>\n\n<p><a href=\"http://blog.plt-scheme.org/2009/01/cfp-scheme-workshop-2009.html\"> http://blog.plt-scheme.org/2009/01/cfp-scheme-workshop&ndash;2009.html</a></p>\n\n<p>We look forward to your submissions!</p>")) ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2009-03-29-the-drscheme-repl-isnt-the-one-in-emacs.md" . unix) f post (u . "the DrScheme repl isn't the one in Emacs") (? . 56) 1467223812 (p+ #"/Users/MB/git/racket-lang-org/blog/2009/03/the-drscheme-repl-isnt-the-one-in-emacs.html" . unix) "/2009/03/the-drscheme-repl-isnt-the-one-in-emacs.html" (u . "2009-03-29T13:03:00.004-04:00") (? . 57) (? . 58) (c (u . "")) (u . "\n<p><em>posted by matthias</em></p>\n\n<p>Dear old Lisper,</p>\n\n<p>You have found drscheme and it is almost like your old Lisp machine. It is easy to program in it, it has things that nobody else has, and we all love parentheses. But after some initial enthusiasm you are wondering why in the world, we decided not to provide commands for sending individual definitions and expressions from the Definitions window to the Interactions window, aka, REPL.</p>\n\n<p>It wasn&rsquo;t an accident. It was by design after some difficult experiences. I am personally a product of the Emacs world that you are describing below, and my advisor Dan Friedman was called the &ldquo;Lispman&rdquo; on his door sign at Indiana.</p>\n\n<p>When I first discovered the idea of sending individual expressions and definitions from a buffer to a repl, it was a near-religious revelation to me. I wanted everyone to know this trick and use it. When I started teaching the freshman course at Rice, I told our chairman so and he asked &ldquo;why&rdquo;. I was shocked, awed, and I failed to explain to him how it mattered. He was a mathematician and I wrote it off. They don&rsquo;t know.</p>\n\n<p>Then I started watching my sophomores and juniors at Rice in lab. Now that was a true disappointment. Few if any used this trick and when they did, they more often tripped up and got the repl into a state where they didn&rsquo;t know what was going on.</p>\n\n<p>In the mid 90s, I wrote some more Little books with Dan, and boy, time and again, I watched him stumble across the state of the repl. I even watched him re-start the repl and load the whole buffer more often than not.</p>\n\n<p>Why? In the presence of macros and higher-order functions and other beasts, it is difficult for masters of the universe with 30 years of experience to keep track of things. What do you think students with 10 or 20 days worth of experience will do? Is it really such a deep principle of computing to create the objects incrementally in the repl as opposed to thinking systematically through the design of a program?</p>\n\n<p>I decided not and asked Robby to make DrScheme&rsquo;s repl transparent. That is, it re-starts the repl and re-loads the buffer every time. I consider this behavior a suitable compromise: have a repl but don&rsquo;t confuse yourself with send-defs and send-exprs. This is especially true in an age when sending an entire buffer takes as much time as sending an individual expression or definition. Soon we&rsquo;ll get &ldquo;compilation behind your back&rdquo; so that only the current buffer is re-interpreted. It&rsquo;ll start things even faster.</p>\n\n<p>Even though I had used the incremental mode for more than a decade when I switched from Emacs to DrScheme in 1998, I have hardly ever looked back. I miss a few other things but the incremental repl is one of those rituals old Lispers acquired and never questioned &hellip; but it isn&rsquo;t fundamental and critical to anything. (Note there is no qualifying clauses, no when no if no but. I really mean this last sentence the way I spelled it.)</p>") #t (u . "\n<p><em>posted by matthias</em></p>\n\n<p>Dear old Lisper,</p>\n\n<p>You have found drscheme and it is almost like your old Lisp machine. It is easy to program in it, it has things that nobody else has, and we all love parentheses. But after some initial enthusiasm you are wondering why in the world, we decided not to provide commands for sending individual definitions and expressions from the Definitions window to the Interactions window, aka, REPL.</p>\n\n<p>It wasn&rsquo;t an accident. It was by design after some difficult experiences. I am personally a product of the Emacs world that you are describing below, and my advisor Dan Friedman was called the &ldquo;Lispman&rdquo; on his door sign at Indiana.</p>\n\n<p>When I first discovered the idea of sending individual expressions and definitions from a buffer to a repl, it was a near-religious revelation to me. I wanted everyone to know this trick and use it. When I started teaching the freshman course at Rice, I told our chairman so and he asked &ldquo;why&rdquo;. I was shocked, awed, and I failed to explain to him how it mattered. He was a mathematician and I wrote it off. They don&rsquo;t know.</p>\n\n<p>Then I started watching my sophomores and juniors at Rice in lab. Now that was a true disappointment. Few if any used this trick and when they did, they more often tripped up and got the repl into a state where they didn&rsquo;t know what was going on.</p>\n\n<p>In the mid 90s, I wrote some more Little books with Dan, and boy, time and again, I watched him stumble across the state of the repl. I even watched him re-start the repl and load the whole buffer more often than not.</p>\n\n<p>Why? In the presence of macros and higher-order functions and other beasts, it is difficult for masters of the universe with 30 years of experience to keep track of things. What do you think students with 10 or 20 days worth of experience will do? Is it really such a deep principle of computing to create the objects incrementally in the repl as opposed to thinking systematically through the design of a program?</p>\n\n<p>I decided not and asked Robby to make DrScheme&rsquo;s repl transparent. That is, it re-starts the repl and re-loads the buffer every time. I consider this behavior a suitable compromise: have a repl but don&rsquo;t confuse yourself with send-defs and send-exprs. This is especially true in an age when sending an entire buffer takes as much time as sending an individual expression or definition. Soon we&rsquo;ll get &ldquo;compilation behind your back&rdquo; so that only the current buffer is re-interpreted. It&rsquo;ll start things even faster.</p>\n\n<p>Even though I had used the incremental mode for more than a decade when I switched from Emacs to DrScheme in 1998, I have hardly ever looked back. I miss a few other things but the incremental repl is one of those rituals old Lispers acquired and never questioned &hellip; but it isn&rsquo;t fundamental and critical to anything. (Note there is no qualifying clauses, no when no if no but. I really mean this last sentence the way I spelled it.)</p>\n<!-- more-->\n\n<hr />\n\n<p>This comment has been removed by the author.</p>\n\n<p>— <em>Kyle Cronin, 29 March 2009</em></p>\n\n<hr />\n\n<p>Why not provide the ability to do both? Reloading an expression and reloading the entire buffer are two different things that, while their functionality somewhat overlaps, provide two distinct ways of interacting with Lisp/Scheme expressions. You can have your big &ldquo;Run&rdquo; button for students new to Scheme, but also perhaps provide a keyboard shortcut that would send a definition or expression to the current REPL. One advantage to this is that often times when I&rsquo;m testing my code I&rsquo;ll create temporary variables with dummy data in the REPL, and being able to reload a definition without recreating the test data would be quite a timesaver. In other words, both mechanisms have their uses, and there&rsquo;s no reason why both can&rsquo;t be included. (this is a revision of my first reply, mainly due to some grammar issues)</p>\n\n<p>— <em>Kyle Cronin, 29 March 2009</em></p>\n\n<hr />\n\n<p>I can understand the motivation behind the design. But this way of working does not work well with my way of developing a program incrementally.</p>\n\n<p>Let&rsquo;s say you are developing the procedure string-prefix? which answers if a string is a prefix of another. You have a file utils.scm with the definition of string-prefix?</p>\n\n<p>Now you want to test it. Start the REPL and try your definition with a couple of examples. Iterate the process until you have a correct function.</p>\n\n<p>The bad thing here is that all the tests you have developed are only in the REPL and are not saved in the file utils.scm. So if you continue working on your program later and need to verify the definition of string-prefix? you must re-type and re-engineer a test suite for it.</p>\n\n<p>The way I do it, is to have the test suite in comments around the definition and send those tests with send exp and watch for the results.</p>\n\n<p>— <em>Pierre, 29 March 2009</em></p>\n\n<hr />\n\n<p>I, too, do not see why it can&rsquo;t be an option. One of the frustrations I have with the REPL in DrScheme is related to the error-flagging whenever I define something in the REPL.</p>\n\n<p>Yes, dang it, I <em>KNOW</em> it&rsquo;s inconsistent with the definitions window.</p>\n\n<p>Could it possibly be an option?</p>\n\n<p>— <em>Yakov, 29 March 2009</em></p>\n\n<hr />\n\n<p>I am guessing that most people avoid this by doing the exploratory part of the programming inside of the REPL and when they are happy with new functions they do a:</p>\n\n<p>M:S:right-arrow C:c C:F6 C:v</p>\n\n<p>— <em>grant rettke, 29 March 2009</em></p>\n\n<hr />\n\n<p>Another useful feature gone because somebody thinks they know better what is good for other people than those people themselves.</p>\n\n<p>— <em>Pascal Costanza, 29 March 2009</em></p>\n\n<hr />\n\n<p>Just like <code>goto</code>.</p>\n\n<p>— <em>Eli Barzilay, 29 March 2009</em></p>\n\n<hr />\n\n<p>Pascal: Someone will probably write a DrScheme plugin to add this feature.</p>\n\n<p>— <em>grant rettke, 29 March 2009</em></p>\n\n<hr />\n\n<p>&ldquo;Another feature gone &hellip;&rdquo; &mdash; I didn&rsquo;t know that features go away via someone&rsquo;s effort; I thought they came <em>in</em> via someone&rsquo;s effort. I must have been doing it wrong all along!</p>\n\n<p>— <em>Robby, 29 March 2009</em></p>\n\n<hr />\n\n<p>See this quote from Steele and Sussman.</p>\n\n<p>— <em>Pascal Costanza, 29 March 2009</em></p>\n\n<hr />\n\n<p>Pascal, Just to be clear: yes, I know about using <code>lambda</code> as a <code>goto</code>. In a sane language like Scheme, <code>goto</code> is gone &mdash; but only on the superficial level of what you see when you browse through the report or the manual. An incremental REPL is gone from PLT Scheme in a similarly superficial way: DrScheme does not support it &mdash; but it&rsquo;s still part of the language, and you can still fire up MzScheme and talk to it like any other REPL. More than that, as said in previous comments: it wouldn&rsquo;t be too hard to implement a send-last-sexpr functionality in DrScheme. Why was it done so far? For the exact same reason that nobody implemented a <code>prog</code> macro in PLT: nobody really needed it.</p>\n\n<p>— <em>Eli Barzilay, 29 March 2009</em></p>\n\n<hr />\n\n<p>Eli, the article above argues that it is a feature designed into DrScheme. It is one reason I never got warm with DrScheme, it does not support the style of interaction I like. I&rsquo;m old. Bearded. Lisp hacker. I&rsquo;m probably not the &lsquo;target&rsquo; for it. Yeah, how I liked MacScheme - that was fun.</p>\n\n<p>— <em>Rainer, 30 March 2009</em></p>\n\n<hr />\n\n<p>That was interesting. I am new to Scheme (PLT Scheme) and I have only played with DrScheme so I didn&rsquo;t know there was any other &ldquo;way&rdquo; to do it.</p>\n\n<p>Now, I have read the responses from the &ldquo;incrementalists&rdquo; and I see the point they are making. Couldn&rsquo;t what they want be just another &ldquo;mode&rdquo; for DrScheme? You change the option to &ldquo;Incremental REPL&rdquo; or something and you get the way of working they like.</p>\n\n<p>— <em>Robert, 30 March 2009</em></p>\n\n<hr />\n\n<p>Rainer: yes, it is a feature designed into DrScheme. But as mentioned above several times now, it doesn&rsquo;t contradict having the incremental kind of REPL too: all that is needed for that is a simple send-to-repl key, and that&rsquo;s really not too hard to do. See also Robby&rsquo;s reply: it took effort to implement the resetting functionality &mdash; an effort that was made due to the design decision. So DrScheme has an additional feature &mdash; and implementing a send-to-repl key just happens to be a something that is not going to use that feature (making it even easier to implement). Back for the reason why it wasn&rsquo;t implemented so far: it&rsquo;s because once people got used to it, they liked it. Once they liked it, they saw no need to implement support for the old mode of work. It&rsquo;s actually quite similar to why we use S-expression syntax: once people got used to that, they didn&rsquo;t see any reason to go back and implement M-expressions as originally planned.</p>\n\n<p>— <em>Eli Barzilay, 30 March 2009</em></p>\n\n<hr />\n\n<p>I do the vast majority of my programming as a scientist (in Matlab, unfortunately). However, I recently did some consulting work where the language I used was not important and so chose to use PLTScheme. Like my scientific work, though, this consulting involved a lot of large data sets which one wanted to load, and then interactively transform - generally speaking such &ldquo;exploratory data analysis&rdquo; is not a process for which large scale program design is very useful. What is useful is to be able to load large data sets (or perform long simulations or calculations) once, storing them in variables in a running interpreter, and then interactively plot and/or analyze the results - a process which often involves sending partial expressions to a running process to be evaluated. Had I been able to do this in DrScheme I might have used the environment. The absence of this feature was definitely irksome enough that I decided to use Emacs and Quack for my development instead.</p>\n\n<p>I don&rsquo;t know how many other programmers out there are use their programming languages as extensions of their ability to visualize and analyze data rather than as systems to design applications, but I would suspect it is a fair number. For them, it may be worth the confusion to allow incremental compilation/evaluation.</p>\n\n<p>— <em>J.V. Toups, 30 March 2009</em></p>\n\n<hr />\n\n<p>No matter &mdash; old Lispers can just post  to them newfangled Wikis to see the  effect of small changes in state on  the big picture.</p>\n\n<p>&mdash; Paul</p>\n\n<p>— <em>steck, 31 March 2009</em></p>\n\n<hr />\n\n<p>J.V., the data analysis problem is precisely the kind of process where a specialized environment is possibly superior to the old incremental Emacs mode. Just like writing shell scripts is neat once you have figured out how to use the Language dialog to preset command line arguments.</p>\n\n<p>— <em>matthias, 31 March 2009</em></p>\n\n<hr />\n\n<p>Why so much fuss about it? Like Grant pointed out, I generally develop and refine functions in the REPL and when I&rsquo;m satisfied with it, I write it to the definitions buffer. You may also copy from the definitions, copy on the REPL and further refine it, despite the &ldquo;out of sync&rdquo; alert.</p>\n\n<p>— <em>namekuseijin, 2 April 2009</em></p>\n\n<hr />\n\n<p>namekuseijin,</p>\n\n<p>Sure, you can also program with one arm tied behind your back. It&rsquo;s just not very helpful.</p>\n\n<p>The fact that you&rsquo;re programming in this style proves that you would benefit from a less restrictive environment. It also proves that the argument that &ldquo;nobody implemented it, because nobody needed it&rdquo; is not really valid. We have actually already seen a few people mentioning here that they would &ldquo;need&rdquo; it. But unfortunately, many programmers just use whatever they are given and don&rsquo;t question their tools too much, and instead use workarounds, like you seem to do in this case.</p>\n\n<p>You see this also a lot in the Java world. So, indeed, nothing much is really fundamental and critical to anything&hellip;</p>\n\n<p>— <em>Pascal Costanza, 2 April 2009</em></p>\n\n<hr />\n\n<p>&ldquo;A less restrictive environment&rdquo; is bogus: the environment lacks a keypress that makes copy-from-definitions-paste-to-repl easier, but it is <em>not</em> restricted. Confusing that with &ldquo;a restriction&rdquo; is what makes you draw other bogus conclusions, so I&rsquo;ll stop here.</p>\n\n<p>— <em>Eli Barzilay, 2 April 2009</em></p>\n\n<hr />\n\n<p>Pascal, like I said I usually just work out the functions at the excellent command line &mdash; complete with full command history, completion and parenthetical editing &mdash; and then paste to the definitions once I&rsquo;m done.</p>\n\n<p>If I ever have to redefine it, I may just either access the command history (even from previous closed sessions) or, from your usual emacs position when doing the same (in the tail of a definition), do: Alt+Shift+&lt;- (to select the definition) Ctrl+C (to copy) Ctrl+D (do go to interactions) Ctrl+V+Enter (to rerun the definition)</p>\n\n<p>Hardly Earth-shattering, specially in the face of the powerful command-line editing. But yeah, the above procedure could be turned into a single step with something as keybinding customization. Section 3.3.7 of the DrScheme environment manual spill out the details.</p>\n\n<p>I&rsquo;ve grown on Emacs, but got fed up of all the baroqueness and hand dextery. I&rsquo;m no virtuoso pianist.</p>\n\n<p>— <em>namekuseijin, 3 April 2009</em></p>\n\n<hr />\n\n<p>namekuseijin,</p>\n\n<p>Sure, it&rsquo;s possible to find workarounds to get what you want. And there may indeed be very good reasons to stick to these workarounds, because you deem other things more important than this.</p>\n\n<p>But note that your suggested workaround makes things even harder to follow than what Matthias describes in his blog posting. Not only do you now have to track which definitions actually resemble closest the current state of the image, you also have to track them down in a long list of definitions that is ordered by history rather than by some program logic.</p>\n\n<p>By the way, emacs is a straw man here. I don&rsquo;t like emacs that much either. But there are much better alternatives, like the IDEs for Macintosh Common Lisp, LispWorks, Allegro Common Lisp, and Corman Lisp, to name just a few current ones.</p>\n\n<p>For example, in LispWorks I can choose to define the current selected form in the buffer - or even undefine it! - by clicking the respective entries in the contextual menu that I get, as usual, by right-clicking. I can also select several forms in a row and define or undefine them in one go, which makes it already a lot easier to have some confidence in a consistent state of the system. And by using a system definition facility, it is also quite straightforward to do a complete reload of everything, but without invalidating all the data on which I want to test my definitions.</p>\n\n<p>But that&rsquo;s Common Lisp, and that&rsquo;s worse than Scheme in every respect, right? So much for religion&hellip;</p>\n\n<p>— <em>Pascal Costanza, 4 April 2009</em></p>\n\n<hr />\n\n<p>Pascal: your comments go down a line where each is more bogus than the previous. You now claim that namekuseijin&rsquo;s method is harder because definitions don&rsquo;t follow some mythical &ldquo;program logic&rdquo;. With any conventional REPL (including the one in DrScheme and in MzScheme) there is no &ldquo;program logic&rdquo; that dictates the ordering of definitions entered on the REPL &mdash; there is just the history of whatever you happen to have typed in. The core of Matthias&rsquo;s post is exactly about that: this history leads to hidden dependencies (and therefore bugs) that are not evident in your code.</p>\n\n<p>Yes, there are some Lisps that will allow you to dump the current runtime image &mdash; and yes, you can use that as a kind of a formalization of the history as &ldquo;the code&rdquo; &mdash; but trying to write real software (one that requires maintenance) this way is crazy. The problems involved in doing this kind of development are hard, and &mdash; AFAIK &mdash; no Lisp is actually trying to solve them <em>properly</em>. Ad-hoc &ldquo;solutions&rdquo; involve tools similar to what you mention: undefining a name, retroactively defining a name, etc. CLOS is a good example in the retroactive-change attempt: defining an already existing class has some complex semantics that try to update previously defined instances, and that tends to work only with very simple classes. In the more common cases you end up facing a need for <code>update-instance-for-redefined-class</code> &mdash; which means that you now need to actually write code around the problem inherent in REPLs. Worse, if the redefinition is due to change in your source, this code is a one-time throwaway tool that will never be used outside of your currently outdated REPL.</p>\n\n<p>IME, I found myself reaching a similar conclusion to Matthias: in theory, I can maintain the REPL, and I can invest some effort in doing so by writing update methods. In practice, it&rsquo;s just easier to restart the REPL and be done with it. It&rsquo;s nice to have a REPL, and it&rsquo;s easy to get carried away with it to the point where I write code for the sake of not killing it &mdash; and at that point a relevant question is whether the REPL is helping me or whether I&rsquo;m helping the REPL.</p>\n\n<p>The bottom line is that the Lisp world is infested with loading-order problems, and there are a good number of packages (and correspondingly a good amount of human effort) that try to solve these issues. And this is not some theoretical &ldquo;we had a problem and now it&rsquo;s solved&rdquo; &mdash; I see people who are running into these problems today, and I see people who are working on these problems today.</p>\n\n<p>— <em>Eli Barzilay, 4 April 2009</em></p>\n\n<hr />\n\n<p>Eli,</p>\n\n<p>If you send definitions from the buffer to the image, or send commands to undefine them, then you can preserve the arrangement of the program text according to some program logic. This has nothing to do with the REPL. (Corman Lisp seems very interesting here because it actually does not make the distinction between a buffer and a REPL anymore, but gives you only buffers from which you can interact with the image.)</p>\n\n<p>It&rsquo;s good that you have reached some conclusions and stick to a certain programming style. But why do you (or Matthias) make attempts to impose your own views on others?</p>\n\n<p>— <em>Pascal Costanza, 4 April 2009</em></p>\n\n<hr />\n\n<p>Never thought blogs could be as amusing as usenet. :)</p>\n\n<p>In any case, I&rsquo;ll get onto Corman Lisp when I&rsquo;m fed up with DrScheme&rsquo;s interaction style. should take a while&hellip;</p>\n\n<p>— <em>namekuseijin, 4 April 2009</em></p>\n\n<hr />\n\n<p>Pascal,</p>\n\n<p> No one is imposing their will on others.</p>\n\n<p>Indeed, others have explaining how one might build the kind of interactions you propose into DrScheme, if you were so inclined. As I said in a rather obtuse way earlier (for which I apologize), it takes work to do such things. If someone deems it important, they can certainly do it. I&rsquo;d be more than happy to help if said person gets stuck in trying.</p>\n\n<p>— <em>Robby, 4 April 2009</em></p>\n\n<hr />\n\n<p>Pascal,</p>\n\n<p>Re &ldquo;If you send definitions from the buffer to the image, or send commands to undefine them&rdquo; &mdash; that would be equivalent to writing your program with <code>eval</code>. While this is available in a number of languages including outside of the Lisp world, I have yet to see anyone writing &ldquo;Real&rdquo; code that way, for exactly the same reason I mentioned earlier: maintaining such code would be a nightmare. (And this is even if your environment provides your with more powerful eval-like primitives like querying the current bindings, or removing a binding &mdash; all existing in MzScheme (and in DrScheme, of course) too, BTW.)</p>\n\n<p>And re &ldquo;make attempts to impose your own views on others&rdquo; &mdash; where did I do that?? MzScheme <em>does</em> have these feature, DrScheme only <em>adds</em> a feature on top of MzScheme. Like I said about 2000 times now, the only thing that is actually missing from DrScheme would be a convenient &ldquo;send the current expression to the REPL&rdquo; key &mdash; which is very likely to be very easy to add. I also said that nobody did this because nobody has seen any burning need to do so. I can tell you even more: I <em>do</em> use the REPL to debug code every once in a while. Why didn&rsquo;t I bother adding that feature? Well, I said that too: I know where Emacs is when I need it, and Emacs is already doing what Emacs is doing very well &mdash; I have absolutely no desire to compete with it.</p>\n\n<p>— <em>Eli Barzilay, 4 April 2009</em></p>\n\n<hr />\n\n<p>Having read through the comments, while I can understand the reasoning behind not having a &ldquo;send the current expression to the REPL&rdquo; key, it seems that there are two distinct schools of thought here, with no middle ground.</p>\n\n<p>The best way to support both schools would probably be to have two distinct modes, one for each of both. I, for one, could definitely use both, each for different purposes.</p>\n\n<p>One reason that I still keep MIT/GNU Scheme around is that I like its feature to use C-x C-e to return the current expression to the REPL. It is actually convenient when working through such a book as SICP, because then I can keep a running log of the current session history without resetting the session every time I change a definition. It is also one reason that I haven&rsquo;t used DrScheme for SICP yet.</p>\n\n<p>On the other hand, I can see Matthias&rsquo;s point in re-starting the REPL and re-loading the definitions buffer for users who have difficulty in keeping track of the state of the REPL.</p>\n\n<p>Considering that effort was spent in making DrScheme&rsquo;s REPL transparent, and that it wasn&rsquo;t transparent before, why not retain the current mode in as a &ldquo;non-interactive mode,&rdquo; and simply create an alternative &ldquo;interactive mode&rdquo; based on code from the code base of an earlier version of DrScheme before that change was made.</p>\n\n<p>This should not take too much effort, and should be acceptable by both camps. It would resolve this conflict, and add a useful alternative, making DrScheme acceptable to both schools of interaction.</p>\n\n<p>— <em>Benjamin L. Russell, 8 April 2009</em></p>\n\n<hr />\n\n<p>Ok, so here is a try to create a keybinding to push a sexp to the interaction windows (I&rsquo;m not sure I will personally use this though):</p>\n\n<p>In &ldquo;keys.ss&rdquo; that defines my DrScheme keybindings, I bind &ldquo;c:e&rdquo; with a function that takes an editor and an event. Then I use: (send (send editor get-keymap) call-function &ldquo;select-backward-sexp&rdquo; editor event #f) and calls alike with &ldquo;shift-focus&rdquo;, &ldquo;copy-clipboard&rdquo;, &hellip;</p>\n\n<p>The problem is once &ldquo;shift-focus&rdquo; has been called, the focused editor has changed, but I don&rsquo;t know what it is, so I can&rsquo;t call &ldquo;paste-clipboard&rdquo; on the new editor (the interaction window in fact, which I&rsquo;m not sure is really an editor). So how do I get the editor under focus? Or how do I get the interactions editor?</p>\n\n<p>— <em>Laurent, 22 January 2010</em></p>\n\n<hr />\n\n<p>I&rsquo;ve added a note to the keybindings documentation that comes with the code to implement a few of the standard &lsquo;send things to the repl&rsquo; keybindings.</p>\n\n<p>— <em>Robby, 24 September 2011</em></p>\n\n<hr />")) ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2014-07-26-scheme-workshop-2014.md" . unix) f post (u . "Scheme Workshop 2014") (? . 99) 1467223812 (p+ #"/Users/MB/git/racket-lang-org/blog/2014/07/scheme-workshop-2014.html" . unix) "/2014/07/scheme-workshop-2014.html" (u . "2014-07-26T18:34:00.001-04:00") (? . 59) (? . 88) (c (u . "")) (u . "\n<p><em>posted by John Clements</em></p>\n\n<p>DEADLINE: 5 September 2014, (23:59 UTC&ndash;12)</p>\n\n<p>WEBSITE: <a href=\"http://homes.soic.indiana.edu/jhemann/scheme-14/\">http://homes.soic.indiana.edu/jhemann/scheme&ndash;14/</a></p>\n\n<p>LOCATION: Washington, DC (co-located with Clojure/conj)</p>\n\n<p>DATE: 19 November 2014</p>\n\n<p>The 2014 Scheme and Functional Programming Workshop is calling for submissions. Submissions related to Scheme and functional programming are welcome and encouraged. Topics of interest include but are not limited to:</p>\n\n<ul>\n <li>\n  <p>Program-development environments, debugging, testing</p></li>\n <li>\n  <p>Implementation (interpreters, compilers, tools, benchmarks, etc)</p></li>\n <li>\n  <p>Syntax, macros, and hygiene</p></li>\n <li>\n  <p>Distributed computing, concurrency, parallelism</p></li>\n <li>\n  <p>Interoperability with other languages, FFIs</p></li>\n <li>\n  <p>Continuations, modules, object systems, types</p></li>\n <li>\n  <p>Theory, formal semantics, correctness</p></li>\n <li>\n  <p>History, evolution and standardization of Scheme</p></li>\n <li>\n  <p>Applications, experience and industrial uses of Scheme</p></li>\n <li>\n  <p>Education</p></li>\n <li>\n  <p>Scheme pearls (elegant, instructive uses of Scheme)</p></li></ul>\n\n<p>We also welcome papers related to dynamic or multiparadigmatic languages and programming techniques.</p>\n\n<p>Full papers are due 5 September 2014.</p>\n\n<p>Authors will be notified by 10 October 2014.</p>\n\n<p>Camera-ready versions are due 24 Oct 2014.</p>\n\n<p>All deadlines are (23:59 UTC&ndash;12), &ldquo;Anywhere on Earth&rdquo;.</p>\n\n<p>For more information, please see: <a href=\"http://homes.soic.indiana.edu/jhemann/scheme-14/\">http://homes.soic.indiana.edu/jhemann/scheme&ndash;14/</a></p>\n\n<p>See you there!</p>") #f (u . "\n<p><em>posted by John Clements</em></p>\n\n<p>DEADLINE: 5 September 2014, (23:59 UTC&ndash;12)</p>\n\n<p>WEBSITE: <a href=\"http://homes.soic.indiana.edu/jhemann/scheme-14/\">http://homes.soic.indiana.edu/jhemann/scheme&ndash;14/</a></p>\n\n<p>LOCATION: Washington, DC (co-located with Clojure/conj)</p>\n\n<p>DATE: 19 November 2014</p>\n\n<p>The 2014 Scheme and Functional Programming Workshop is calling for submissions. Submissions related to Scheme and functional programming are welcome and encouraged. Topics of interest include but are not limited to:</p>\n\n<ul>\n <li>\n  <p>Program-development environments, debugging, testing</p></li>\n <li>\n  <p>Implementation (interpreters, compilers, tools, benchmarks, etc)</p></li>\n <li>\n  <p>Syntax, macros, and hygiene</p></li>\n <li>\n  <p>Distributed computing, concurrency, parallelism</p></li>\n <li>\n  <p>Interoperability with other languages, FFIs</p></li>\n <li>\n  <p>Continuations, modules, object systems, types</p></li>\n <li>\n  <p>Theory, formal semantics, correctness</p></li>\n <li>\n  <p>History, evolution and standardization of Scheme</p></li>\n <li>\n  <p>Applications, experience and industrial uses of Scheme</p></li>\n <li>\n  <p>Education</p></li>\n <li>\n  <p>Scheme pearls (elegant, instructive uses of Scheme)</p></li></ul>\n\n<p>We also welcome papers related to dynamic or multiparadigmatic languages and programming techniques.</p>\n\n<p>Full papers are due 5 September 2014.</p>\n\n<p>Authors will be notified by 10 October 2014.</p>\n\n<p>Camera-ready versions are due 24 Oct 2014.</p>\n\n<p>All deadlines are (23:59 UTC&ndash;12), &ldquo;Anywhere on Earth&rdquo;.</p>\n\n<p>For more information, please see: <a href=\"http://homes.soic.indiana.edu/jhemann/scheme-14/\">http://homes.soic.indiana.edu/jhemann/scheme&ndash;14/</a></p>\n\n<p>See you there!</p>")) ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2007-06-09-r6rs-is-perfect.md" . unix) f post (u . "R6RS is \"perfect\"") (? . 60) 1467223812 (p+ #"/Users/MB/git/racket-lang-org/blog/2007/06/r6rs-is-perfect.html" . unix) "/2007/06/r6rs-is-perfect.html" (u . "2007-06-09T13:15:00.000-04:00") (? . 122) (? . 43) (c (u . "")) (u . "\n<p><em>posted by matthias</em></p>\n\n<p>When I read the &ldquo;side by side&rdquo; and &ldquo;head to head&rdquo; descriptions of the alternatives facing the Scheme community (see Comp.Lang.Scheme and the R6RS mailing list), I am wondering which one is which and which one is better.</p>\n\n<ul>\n <li>\n  <p>Is it really good that Scheme (the spec) doesn&rsquo;t support a module system?</p></li>\n <li>\n  <p>Is it really good that almost all major implementations support their own version of a module system?</p></li>\n <li>\n  <p>Is it really good that programmers can&rsquo;t even leave the module structure intact when porting code?</p></li></ul>\n\n<p>Imagine your own similar questions and add them here. We have lived in a side-by-side universe for a long time, and there are quite a few programmers who have suffered from this not-really-the-same-language problem. Besides the module system, there are other not-quite-the-same-but-related features that implementations have and programmers wish to use. The R6RS process has pushed several major implementors/implementations to agree on a design for module systems and other constructs. Their report declares that they are ready to put a large amount of work in to get from r5rs to r6rs. I believe that this step would help the community in several arenas, listed in increasing order of relevance:</p>\n\n<ul>\n <li>\n  <p>the academic publishing business</p></li>\n <li>\n  <p>the fund raising business</p></li>\n <li>\n  <p>adapting each others innovations</p></li>\n <li>\n  <p>supporting programmers who learn on one and switch to another implementation</p></li>\n <li>\n  <p>supporting commercial programmers who need reassurance that there is more than one implementation and implementor [ever attended Commercial Uses of Functional Programming?]</p></li></ul>\n\n<p>Is the document perfect? Is every construct exactly the &lsquo;right thing&rsquo;? Of course not! Guy and Gerry revised their first Scheme report because they didn&rsquo;t get it &lsquo;right&rsquo;. R3RS and R4RS and R5RS revised flaws in R(n&ndash;1)RS because the authors/editors didn&rsquo;t get it &lsquo;right&rsquo;. It is extremely difficult, and usually impossible, to get the design of a complex artifacts (such as a programming language) &lsquo;right&rsquo; the first time. In these cases, it&rsquo;s all about the feedback loop and revising your design based on observations. (Remember the &lsquo;science&rsquo; part in the name of our discipline?) Indeed, &lsquo;right&rsquo; doesn&rsquo;t exist; what exists is &lsquo;most pragmatic and internally beautiful,&rsquo; and nothing else.  Our choice is quite simple: move forward as a community with some amount of convergence (r6rs) or split into dozens of mutually incompatible sub-communities (status quo, including SRFIs). <em>Also posted as <a href=\"http://lists.r6rs.org/pipermail/r6rs-discuss/2007-June/002538.html\"> &ldquo;R6RS is perfect&rdquo;</a> at the R6RS discussion list.</em></p>") #t (u . "\n<p><em>posted by matthias</em></p>\n\n<p>When I read the &ldquo;side by side&rdquo; and &ldquo;head to head&rdquo; descriptions of the alternatives facing the Scheme community (see Comp.Lang.Scheme and the R6RS mailing list), I am wondering which one is which and which one is better.</p>\n\n<ul>\n <li>\n  <p>Is it really good that Scheme (the spec) doesn&rsquo;t support a module system?</p></li>\n <li>\n  <p>Is it really good that almost all major implementations support their own version of a module system?</p></li>\n <li>\n  <p>Is it really good that programmers can&rsquo;t even leave the module structure intact when porting code?</p></li></ul>\n\n<p>Imagine your own similar questions and add them here. We have lived in a side-by-side universe for a long time, and there are quite a few programmers who have suffered from this not-really-the-same-language problem. Besides the module system, there are other not-quite-the-same-but-related features that implementations have and programmers wish to use. The R6RS process has pushed several major implementors/implementations to agree on a design for module systems and other constructs. Their report declares that they are ready to put a large amount of work in to get from r5rs to r6rs. I believe that this step would help the community in several arenas, listed in increasing order of relevance:</p>\n\n<ul>\n <li>\n  <p>the academic publishing business</p></li>\n <li>\n  <p>the fund raising business</p></li>\n <li>\n  <p>adapting each others innovations</p></li>\n <li>\n  <p>supporting programmers who learn on one and switch to another implementation</p></li>\n <li>\n  <p>supporting commercial programmers who need reassurance that there is more than one implementation and implementor [ever attended Commercial Uses of Functional Programming?]</p></li></ul>\n\n<p>Is the document perfect? Is every construct exactly the &lsquo;right thing&rsquo;? Of course not! Guy and Gerry revised their first Scheme report because they didn&rsquo;t get it &lsquo;right&rsquo;. R3RS and R4RS and R5RS revised flaws in R(n&ndash;1)RS because the authors/editors didn&rsquo;t get it &lsquo;right&rsquo;. It is extremely difficult, and usually impossible, to get the design of a complex artifacts (such as a programming language) &lsquo;right&rsquo; the first time. In these cases, it&rsquo;s all about the feedback loop and revising your design based on observations. (Remember the &lsquo;science&rsquo; part in the name of our discipline?) Indeed, &lsquo;right&rsquo; doesn&rsquo;t exist; what exists is &lsquo;most pragmatic and internally beautiful,&rsquo; and nothing else.  Our choice is quite simple: move forward as a community with some amount of convergence (r6rs) or split into dozens of mutually incompatible sub-communities (status quo, including SRFIs). <em>Also posted as <a href=\"http://lists.r6rs.org/pipermail/r6rs-discuss/2007-June/002538.html\"> &ldquo;R6RS is perfect&rdquo;</a> at the R6RS discussion list.</em></p>\n<!-- more-->\n\n<hr />\n\n<p>The biggest argument against R6RS seems to be bloat. They say Scheme betrays its root, because it gets big and complex, instead of &ldquo;smallest possible, while usable.&rdquo;</p>\n\n<p>Is it really debated enough, wether all this stuff belongs into Scheme? Probably. Then why don&rsquo;t people just point to the mailing list thread (or whatever)?</p>\n\n<p>— <em>beza1e1, 9 June 2007</em></p>\n\n<hr />\n\n<p>I&rsquo;m just curious - why cannot the module system and the rest of the stuff that R6RS tries to do be implemented as SRFIs first, and only after they&rsquo;re used for some time they could be frozen into the new spec ?</p>\n\n<p>— <em>taw, 9 June 2007</em></p>\n\n<hr />\n\n<p>Easy questions.</p>\n\n<p>Yes, one can produce an OS with Turing Machines. (At least I am pretty sure one can.) I still wouldn&rsquo;t want to do it. In this spirit, Scheme isn&rsquo;t the best medium for creating large applications and frameworks.</p>\n\n<p>The implementors (on the editoral board) <em>have</em> implemented variations of the proposed features and they like what they see. PLT users have experienced a good number of them, and they like what they see. Now it&rsquo;s time to commit.</p>\n\n<p>And I am pretty sure that for those who wish to stay behind, some soul among the implementor crowd (is there a language with more implementations than Scheme?) will maintain an old R4RS or R5RS compatible Scheme.</p>\n\n<p>— <em>matthias, 9 June 2007</em></p>\n\n<hr />\n\n<p>As far as I can tell, there&rsquo;s a vocal part of the Scheme community that is entirely unwilling to compromise anything for anyone. This is a bit foreign to me, having come to Scheme from Common Lisp. Whether they constitute a plurality or not is another matter, but consider just how many different forms of define-record syntax are out there.</p>\n\n<p>I as a programmer not an implementer would love to see any RnRS with some provision for modules, almost no matter what the syntax or semantics might be. I might have my own personal favorite, but the network benefit of (almost) everybody using the same damn thing is important. The SRFI libraries are immensely useful here, but because module systems are such a sore point there is no useful way, even leveraging SRFIs, to write one library that engages the native module system for any two different Scheme implementations.</p>\n\n<p>Pass the damn thing already. I&rsquo;ll write using Swahili identifiers if need be.</p>\n\n<p>— <em>Graham, 10 June 2007</em></p>\n\n<hr />\n\n<p>(Sorry about my non-native English and bad collocations.)</p>\n\n<p>Well, I think the biggest problem with the concept of modules coupled with the core is when we make this question to ourselves: &ldquo;what is really important to put on core? Is it module? Is it another thing else?&rdquo;</p>\n\n<p>Anyway, I think one great point of R6RS is about define Unicode as standard&hellip; Am I too wrong??</p>\n\n<p>— <em>SpamKids, 30 August 2009</em></p>\n\n<hr />")) ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2009-02-14-new-contract-related-features.md" . unix) f post (u . "New Contract-Related Features") (? . 26) 1467223812 (p+ #"/Users/MB/git/racket-lang-org/blog/2009/02/new-contract-related-features.html" . unix) "/2009/02/new-contract-related-features.html" (u . "2009-02-14T23:35:00.010-05:00") (? . 8) (? . 61) (c (u . "")) (u . "\n<p><em>posted by Stevie</em></p>\n\n<p>In SVN I&rsquo;ve added three new major features that involve contracts. One allows for more fine-grained control of contracts, and the other two allow for the use of contracts with signatures and units.</p>\n\n<h2 id=\"contract-regions\">Contract Regions</h2>\n\n<p><em>Contract regions</em> allow the programmer to protect a region of code with a contract boundary. In addition to the wrapped code, the programmer also provides a name for the region which is used in blame situations and a list of exported variables which can either be protected with contracts or unprotected. The region provides a true contract boundary, in that uses of contracted exports within the region are unprotected. Contract regions are specified with the <code>with-contract</code> form. The following contract region defines two mutually recursive functions:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">with-contract</span> <span class=\"n\">region1</span>\n <span class=\"p\">([</span><span class=\"n\">f</span> <span class=\"p\">(</span><span class=\"k\">-&gt;</span> <span class=\"nb\">number?</span> <span class=\"nb\">boolean?</span><span class=\"p\">)]</span>\n  <span class=\"p\">[</span><span class=\"n\">g</span> <span class=\"p\">(</span><span class=\"k\">-&gt;</span> <span class=\"nb\">number?</span> <span class=\"nb\">boolean?</span><span class=\"p\">)])</span>\n <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">f</span> <span class=\"n\">n</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"nb\">zero?</span> <span class=\"n\">n</span><span class=\"p\">)</span> <span class=\"no\">#f</span> <span class=\"p\">(</span><span class=\"n\">g</span> <span class=\"p\">(</span><span class=\"nb\">sub1</span> <span class=\"n\">n</span><span class=\"p\">))))</span>\n <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">g</span> <span class=\"n\">n</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"nb\">zero?</span> <span class=\"n\">n</span><span class=\"p\">)</span> <span class=\"no\">#t</span> <span class=\"p\">(</span><span class=\"n\">f</span> <span class=\"p\">(</span><span class=\"nb\">sub1</span> <span class=\"n\">n</span><span class=\"p\">)))))</span>\n <span class=\"o\">```</span>\n\n<span class=\"ss\">The</span> <span class=\"n\">internal</span> <span class=\"n\">calls</span> <span class=\"n\">to</span> <span class=\"o\">`</span><span class=\"ss\">f</span><span class=\"o\">`</span> <span class=\"ss\">and</span> <span class=\"o\">`</span><span class=\"ss\">g</span><span class=\"o\">`</span> <span class=\"ss\">are</span> <span class=\"n\">uncontracted</span><span class=\"o\">,</span> <span class=\"n\">but</span> <span class=\"n\">calls</span> <span class=\"n\">to</span> <span class=\"o\">`</span><span class=\"ss\">f</span><span class=\"o\">`</span><span class=\"ss\">and</span> <span class=\"o\">`</span><span class=\"ss\">g</span><span class=\"o\">`</span> <span class=\"ss\">outside</span> <span class=\"k\">this</span> <span class=\"n\">region</span> <span class=\"n\">would</span> <span class=\"n\">be</span> <span class=\"n\">appropriately</span> <span class=\"n\">contracted.</span>  <span class=\"n\">First-order</span> <span class=\"n\">checks</span> <span class=\"n\">are</span> <span class=\"n\">performed</span> <span class=\"n\">at</span> <span class=\"n\">the</span> <span class=\"n\">region</span><span class=\"o\">,</span> <span class=\"n\">so</span> <span class=\"n\">the</span>\n<span class=\"n\">following</span> <span class=\"n\">region:</span>\n\n<span class=\"o\">```</span><span class=\"ss\">racket</span>\n<span class=\"p\">(</span><span class=\"k\">with-contract</span> <span class=\"n\">region2</span>\n <span class=\"p\">([</span><span class=\"n\">n</span> <span class=\"nb\">number?</span><span class=\"p\">])</span>\n <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"n\">n</span> <span class=\"no\">#t</span><span class=\"p\">))</span>\n <span class=\"o\">```</span>\n\n<span class=\"ss\">results</span> <span class=\"n\">in</span> <span class=\"n\">the</span> <span class=\"n\">following</span> <span class=\"n\">error:</span>\n\n<span class=\"o\">```</span><span class=\"ss\">racket</span>\n<span class=\"p\">(</span><span class=\"n\">region</span> <span class=\"n\">region2</span><span class=\"p\">)</span> <span class=\"n\">broke</span> <span class=\"n\">the</span> <span class=\"k\">contract</span> <span class=\"nb\">number?</span> <span class=\"n\">on</span> <span class=\"n\">n</span><span class=\"c1\">; expected &lt;number?&gt;, given: #t</span>\n</pre></div>\n\n</div>\n\n<p>Notice that the blame not only gives the name of the region, but describes what type of contract boundary was involved.</p>\n\n<p>For contracting a single definition, there is the <code>define/contract</code> form which has a similar syntax to define, except that it takes a contract before the body of the definition.</p>\n\n<p>To compare the two forms, the following two definitions are equivalent:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">with-contract</span> <span class=\"n\">fact</span>\n <span class=\"p\">([</span><span class=\"n\">fact</span> <span class=\"p\">(</span><span class=\"k\">-&gt;</span> <span class=\"nb\">number?</span> <span class=\"nb\">number?</span><span class=\"p\">)])</span>\n <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">fact</span> <span class=\"n\">n</span><span class=\"p\">)</span>\n   <span class=\"p\">(</span><span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"nb\">zero?</span> <span class=\"n\">n</span><span class=\"p\">)</span> <span class=\"mi\">1</span> <span class=\"p\">(</span><span class=\"nb\">*</span> <span class=\"n\">n</span> <span class=\"p\">(</span><span class=\"n\">fact</span> <span class=\"p\">(</span><span class=\"nb\">sub1</span> <span class=\"n\">n</span><span class=\"p\">))))))</span>\n\n<span class=\"p\">(</span><span class=\"k\">define/contract</span> <span class=\"p\">(</span><span class=\"n\">fact</span> <span class=\"n\">n</span><span class=\"p\">)</span>\n <span class=\"p\">(</span><span class=\"k\">-&gt;</span> <span class=\"nb\">number?</span> <span class=\"nb\">number?</span><span class=\"p\">)</span>\n <span class=\"p\">(</span><span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"nb\">zero?</span> <span class=\"n\">n</span><span class=\"p\">)</span> <span class=\"mi\">1</span> <span class=\"p\">(</span><span class=\"nb\">*</span> <span class=\"n\">n</span> <span class=\"p\">(</span><span class=\"n\">fact</span> <span class=\"p\">(</span><span class=\"nb\">sub1</span> <span class=\"n\">n</span><span class=\"p\">)))))</span>\n</pre></div>\n\n</div>\n\n<p>First order checks are similarly performed at the definition for <code>define/contract</code>, so</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">define/contract</span> <span class=\"p\">(</span><span class=\"n\">fact</span> <span class=\"n\">n</span><span class=\"p\">)</span>\n <span class=\"p\">(</span><span class=\"k\">-&gt;</span> <span class=\"nb\">number?</span><span class=\"p\">)</span>\n <span class=\"p\">(</span><span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"nb\">zero?</span> <span class=\"n\">n</span><span class=\"p\">)</span> <span class=\"mi\">1</span> <span class=\"p\">(</span><span class=\"nb\">*</span> <span class=\"n\">n</span> <span class=\"p\">(</span><span class=\"n\">fact</span> <span class=\"p\">(</span><span class=\"nb\">sub1</span> <span class=\"n\">n</span><span class=\"p\">)))))</span>\n</pre></div>\n\n</div>\n\n<p>results in</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"n\">function</span> <span class=\"n\">fact</span><span class=\"p\">)</span> <span class=\"n\">broke</span> <span class=\"n\">the</span> <span class=\"k\">contract</span> <span class=\"p\">(</span><span class=\"k\">-&gt;</span> <span class=\"nb\">number?</span><span class=\"p\">)</span> <span class=\"n\">on</span> <span class=\"n\">fact</span><span class=\"c1\">; expected a procedure that accepts no arguments without any keywords, given: #&lt;procedure:fact&gt;</span>\n</pre></div>\n\n</div>\n\n<h2 id=\"signature-contracts\">Signature Contracts</h2>\n\n<p>In addition to contract regions, units are also now contract boundaries. One way to use contracts with units is to add contracts to unit signatures via the contracted <code>signature</code> form.</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">define-signature</span> <span class=\"n\">toy-factory^</span>\n <span class=\"p\">((</span><span class=\"k\">contracted</span>\n   <span class=\"p\">[</span><span class=\"n\">build-toys</span> <span class=\"p\">(</span><span class=\"k\">-&gt;</span> <span class=\"nb\">integer?</span> <span class=\"p\">(</span><span class=\"nb\">listof</span> <span class=\"n\">toy?</span><span class=\"p\">))]</span>\n   <span class=\"p\">[</span><span class=\"n\">repaint</span>    <span class=\"p\">(</span><span class=\"k\">-&gt;</span> <span class=\"n\">toy?</span> <span class=\"nb\">symbol?</span> <span class=\"n\">toy?</span><span class=\"p\">)]</span>\n   <span class=\"p\">[</span><span class=\"n\">toy?</span>       <span class=\"p\">(</span><span class=\"k\">-&gt;</span> <span class=\"nb\">any/c</span> <span class=\"nb\">boolean?</span><span class=\"p\">)]</span>\n   <span class=\"p\">[</span><span class=\"n\">toy-color</span>  <span class=\"p\">(</span><span class=\"k\">-&gt;</span> <span class=\"n\">toy?</span> <span class=\"nb\">symbol?</span><span class=\"p\">)])))</span>\n</pre></div>\n\n</div>\n\n<p>Notice that contracts in a signature can use variables listed in the signature.Now if we take the following implementation of that signature:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">define-unit</span> <span class=\"n\">simple-factory@</span>\n <span class=\"p\">(</span><span class=\"k\">import</span><span class=\"p\">)</span>\n <span class=\"p\">(</span><span class=\"k\">export</span> <span class=\"n\">toy-factory^</span><span class=\"p\">)</span>\n  \n <span class=\"p\">(</span><span class=\"k\">define-struct</span> <span class=\"n\">toy</span> <span class=\"p\">(</span><span class=\"n\">color</span><span class=\"p\">)</span> <span class=\"kd\">#:transparent</span><span class=\"p\">)</span>\n  \n <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">build-toys</span> <span class=\"n\">n</span><span class=\"p\">)</span>\n   <span class=\"p\">(</span><span class=\"k\">for/list</span> <span class=\"p\">([</span><span class=\"n\">i</span> <span class=\"p\">(</span><span class=\"nb\">in-range</span> <span class=\"n\">n</span><span class=\"p\">)])</span>\n     <span class=\"p\">(</span><span class=\"n\">make-toy</span> <span class=\"o\">&#39;</span><span class=\"ss\">blue</span><span class=\"p\">)))</span>\n  \n <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">repaint</span> <span class=\"n\">t</span> <span class=\"n\">col</span><span class=\"p\">)</span>\n   <span class=\"p\">(</span><span class=\"n\">make-toy</span> <span class=\"n\">col</span><span class=\"p\">)))</span>\n</pre></div>\n\n</div>\n\n<p>We get the appropriate contract checks on those exports:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"nb\">&gt;</span> <span class=\"p\">(</span><span class=\"k\">define-values/invoke-unit/infer</span> <span class=\"n\">simple-factory@</span><span class=\"p\">)</span>\n<span class=\"nb\">&gt;</span> <span class=\"p\">(</span><span class=\"n\">build-toys</span> <span class=\"mi\">3</span><span class=\"p\">)</span>\n<span class=\"p\">(</span><span class=\"o\">#</span><span class=\"p\">(</span><span class=\"ss\">struct:toy</span> <span class=\"ss\">blue</span><span class=\"p\">)</span> <span class=\"o\">#</span><span class=\"p\">(</span><span class=\"ss\">struct:toy</span> <span class=\"ss\">blue</span><span class=\"p\">)</span> <span class=\"o\">#</span><span class=\"p\">(</span><span class=\"ss\">struct:toy</span> <span class=\"ss\">blue</span><span class=\"p\">))</span>\n<span class=\"nb\">&gt;</span> <span class=\"p\">(</span><span class=\"n\">build-toys</span> <span class=\"no\">#f</span><span class=\"p\">)</span>\n<span class=\"n\">top-level</span> <span class=\"n\">broke</span> <span class=\"n\">the</span> <span class=\"k\">contract</span> <span class=\"p\">(</span><span class=\"k\">-&gt;</span> <span class=\"nb\">integer?</span> <span class=\"p\">(</span><span class=\"nb\">listof</span> <span class=\"n\">toy?</span><span class=\"p\">))</span>\n <span class=\"n\">on</span> <span class=\"n\">build-toys</span><span class=\"c1\">; expected &gt;, given: #f</span>\n</pre></div>\n\n</div>\n\n<p>As before, uses of contracted exports inside the unit are not checked.</p>\n\n<p>Since units are contract boundaries, they can be blamed appropriately. Take the following definitions:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">define-unit</span> <span class=\"n\">factory-user@</span>\n <span class=\"p\">(</span><span class=\"k\">import</span> <span class=\"n\">toy-factory^</span><span class=\"p\">)</span>\n <span class=\"p\">(</span><span class=\"k\">export</span><span class=\"p\">)</span>\n <span class=\"p\">(</span><span class=\"k\">let</span> <span class=\"p\">([</span><span class=\"n\">toys</span> <span class=\"p\">(</span><span class=\"n\">build-toys</span> <span class=\"mi\">3</span><span class=\"p\">)])</span>\n   <span class=\"p\">(</span><span class=\"n\">repaint</span> <span class=\"mi\">3</span> <span class=\"o\">&#39;</span><span class=\"ss\">blue</span><span class=\"p\">)))</span>\n\n<span class=\"p\">(</span><span class=\"k\">define-compound-unit/infer</span> <span class=\"n\">factory+user@</span>\n <span class=\"p\">(</span><span class=\"k\">import</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"k\">export</span><span class=\"p\">)</span>\n <span class=\"p\">(</span><span class=\"k\">link</span> <span class=\"n\">simple-factory@</span> <span class=\"n\">factory-user@</span><span class=\"p\">))</span>\n<span class=\"n\">When</span> <span class=\"n\">we</span> <span class=\"n\">invoke</span> <span class=\"n\">the</span> <span class=\"n\">combined</span> <span class=\"n\">unit:&gt;</span> <span class=\"p\">(</span><span class=\"k\">define-values/invoke-unit/infer</span> <span class=\"n\">factory+user@</span><span class=\"p\">)</span>\n<span class=\"p\">(</span><span class=\"k\">unit</span> <span class=\"n\">factory-user@</span><span class=\"p\">)</span> <span class=\"n\">broke</span> <span class=\"n\">the</span> <span class=\"k\">contract</span>\n <span class=\"p\">(</span><span class=\"k\">-&gt;</span> <span class=\"n\">toy?</span> <span class=\"nb\">symbol?</span> <span class=\"n\">toy?</span><span class=\"p\">)</span>\n<span class=\"n\">on</span> <span class=\"n\">repaint</span><span class=\"c1\">; expected &gt;, given: 3</span>\n</pre></div>\n\n</div>\n\n<h2 id=\"unit-contracts\">Unit Contracts</h2>\n\n<p>However, we may not always be able to add contracts to signatures. For example, there are many already-existing signatures in PLT Scheme that one may want to implement, or a programmer may want to take a unit value and add contracts to it after the fact.</p>\n\n<p>To do this, there is the <code>unit/c</code> contract combinator. It takes a list of imports and exports, where each signature is paired with a list of variables and their contracts for each signature. So if we had the uncontracted version of the toy-factory^ signature:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">define-signature</span> <span class=\"n\">toy-factory^</span>\n <span class=\"p\">(</span><span class=\"n\">build-toys</span> <span class=\"n\">repaint</span> <span class=\"n\">toy?</span> <span class=\"n\">toy-color</span><span class=\"p\">))</span>\n</pre></div>\n\n</div>\n\n<p>the following contracts would be appropriate for a unit that imports nothing and exports that signature:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">unit/c</span> <span class=\"p\">(</span><span class=\"k\">import</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"k\">export</span><span class=\"p\">))</span>\n<span class=\"p\">(</span><span class=\"k\">unit/c</span> <span class=\"p\">(</span><span class=\"k\">import</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"k\">export</span> <span class=\"n\">toy-factory^</span><span class=\"p\">))</span>\n<span class=\"p\">(</span><span class=\"k\">unit/c</span>\n <span class=\"p\">(</span><span class=\"k\">import</span><span class=\"p\">)</span>\n <span class=\"p\">(</span><span class=\"k\">export</span> <span class=\"p\">(</span><span class=\"n\">toy-factory^</span>\n          <span class=\"p\">[</span><span class=\"n\">toy-color</span> <span class=\"p\">(</span><span class=\"k\">-&gt;</span> <span class=\"n\">toy?</span> <span class=\"nb\">symbol?</span><span class=\"p\">)])))</span>\n<span class=\"p\">(</span><span class=\"k\">unit/c</span>\n <span class=\"p\">(</span><span class=\"k\">import</span><span class=\"p\">)</span>\n <span class=\"p\">(</span><span class=\"k\">export</span> <span class=\"p\">(</span><span class=\"n\">toy-factory^</span>\n          <span class=\"p\">[</span><span class=\"n\">build-toys</span> <span class=\"p\">(</span><span class=\"k\">-&gt;</span> <span class=\"nb\">integer?</span> <span class=\"p\">(</span><span class=\"nb\">listof</span> <span class=\"n\">toy?</span><span class=\"p\">))]</span>\n          <span class=\"p\">[</span><span class=\"n\">repaint</span>    <span class=\"p\">(</span><span class=\"k\">-&gt;</span> <span class=\"n\">toy?</span> <span class=\"nb\">symbol?</span> <span class=\"n\">toy?</span><span class=\"p\">)]</span>\n          <span class=\"p\">[</span><span class=\"n\">toy?</span>       <span class=\"p\">(</span><span class=\"k\">-&gt;</span> <span class=\"nb\">any/c</span> <span class=\"nb\">boolean?</span><span class=\"p\">)]</span>\n          <span class=\"p\">[</span><span class=\"n\">toy-color</span>  <span class=\"p\">(</span><span class=\"k\">-&gt;</span> <span class=\"n\">toy?</span> <span class=\"nb\">symbol?</span><span class=\"p\">)])))</span>\n</pre></div>\n\n</div>\n\n<p>Unit contracts can contain a superset of the import signatures and a subset of the export signatures for a given unit value. Also, variables that are not listed for a given signature are left alone when the contracts are being added.</p>\n\n<p>Since the results of applying <code>unit/c</code> is a new unit, then adding a contract can cause link inference to fail. For example, if we change the definition of <code>simple-factory@</code> above to</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">define/contract</span> <span class=\"n\">simple-factory@</span>\n <span class=\"p\">(</span><span class=\"k\">unit/c</span>\n  <span class=\"p\">(</span><span class=\"k\">import</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"k\">export</span> <span class=\"p\">(</span><span class=\"n\">toy-factory^</span>\n           <span class=\"p\">[</span><span class=\"n\">build-toys</span> <span class=\"p\">(</span><span class=\"k\">-&gt;</span> <span class=\"nb\">integer?</span> <span class=\"p\">(</span><span class=\"nb\">listof</span> <span class=\"n\">toy?</span><span class=\"p\">))]</span>\n           <span class=\"p\">[</span><span class=\"n\">repaint</span>    <span class=\"p\">(</span><span class=\"k\">-&gt;</span> <span class=\"n\">toy?</span> <span class=\"nb\">symbol?</span> <span class=\"n\">toy?</span><span class=\"p\">)]</span>\n           <span class=\"p\">[</span><span class=\"n\">toy?</span>       <span class=\"p\">(</span><span class=\"k\">-&gt;</span> <span class=\"nb\">any/c</span> <span class=\"nb\">boolean?</span><span class=\"p\">)]</span>\n           <span class=\"p\">[</span><span class=\"n\">toy-color</span>  <span class=\"p\">(</span><span class=\"k\">-&gt;</span> <span class=\"n\">toy?</span> <span class=\"nb\">symbol?</span><span class=\"p\">)])))</span>\n <span class=\"p\">(</span><span class=\"k\">unit</span>\n   <span class=\"p\">(</span><span class=\"k\">import</span><span class=\"p\">)</span>\n   <span class=\"p\">(</span><span class=\"k\">export</span> <span class=\"n\">toy-factory^</span><span class=\"p\">)</span>\n  \n   <span class=\"p\">(</span><span class=\"k\">define-struct</span> <span class=\"n\">toy</span> <span class=\"p\">(</span><span class=\"n\">color</span><span class=\"p\">)</span> <span class=\"kd\">#:transparent</span><span class=\"p\">)</span>\n  \n   <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">build-toys</span> <span class=\"n\">n</span><span class=\"p\">)</span>\n     <span class=\"p\">(</span><span class=\"k\">for/list</span> <span class=\"p\">([</span><span class=\"n\">i</span> <span class=\"p\">(</span><span class=\"nb\">in-range</span> <span class=\"n\">n</span><span class=\"p\">)])</span>\n       <span class=\"p\">(</span><span class=\"n\">make-toy</span> <span class=\"o\">&#39;</span><span class=\"ss\">blue</span><span class=\"p\">)))</span>\n  \n   <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">repaint</span> <span class=\"n\">t</span> <span class=\"n\">col</span><span class=\"p\">)</span>\n     <span class=\"p\">(</span><span class=\"n\">make-toy</span> <span class=\"n\">col</span><span class=\"p\">))))</span>\n</pre></div>\n\n</div>\n\n<p>Then when we try to combine it with the <code>factory-user@</code> unit, we get:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"n\">define-compound-unit/infer:</span> <span class=\"nb\">not</span> <span class=\"n\">a</span> <span class=\"k\">unit</span> <span class=\"n\">definition</span> <span class=\"n\">in:</span> <span class=\"n\">simple-factory@</span>\n</pre></div>\n\n</div>\n\n<p>One way to solve this is to use <code>define-unit-binding</code> to set up the static information for the new contracted value. Another possibility for unit definitions is to use <code>define-unit/contract</code>:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">define-unit/contract</span> <span class=\"n\">simple-factory@</span>\n <span class=\"p\">(</span><span class=\"k\">import</span><span class=\"p\">)</span>\n <span class=\"p\">(</span><span class=\"k\">export</span> <span class=\"p\">(</span><span class=\"n\">toy-factory^</span>\n          <span class=\"p\">[</span><span class=\"n\">build-toys</span> <span class=\"p\">(</span><span class=\"k\">-&gt;</span> <span class=\"nb\">integer?</span> <span class=\"p\">(</span><span class=\"nb\">listof</span> <span class=\"n\">toy?</span><span class=\"p\">))]</span>\n          <span class=\"p\">[</span><span class=\"n\">repaint</span>    <span class=\"p\">(</span><span class=\"k\">-&gt;</span> <span class=\"n\">toy?</span> <span class=\"nb\">symbol?</span> <span class=\"n\">toy?</span><span class=\"p\">)]</span>\n          <span class=\"p\">[</span><span class=\"n\">toy?</span>       <span class=\"p\">(</span><span class=\"k\">-&gt;</span> <span class=\"nb\">any/c</span> <span class=\"nb\">boolean?</span><span class=\"p\">)]</span>\n          <span class=\"p\">[</span><span class=\"n\">toy-color</span>  <span class=\"p\">(</span><span class=\"k\">-&gt;</span> <span class=\"n\">toy?</span> <span class=\"nb\">symbol?</span><span class=\"p\">)]))</span>\n\n <span class=\"p\">(</span><span class=\"k\">define-struct</span> <span class=\"n\">toy</span> <span class=\"p\">(</span><span class=\"n\">color</span><span class=\"p\">)</span> <span class=\"kd\">#:transparent</span><span class=\"p\">)</span>\n\n <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">build-toys</span> <span class=\"n\">n</span><span class=\"p\">)</span>\n   <span class=\"p\">(</span><span class=\"k\">for/list</span> <span class=\"p\">([</span><span class=\"n\">i</span> <span class=\"p\">(</span><span class=\"nb\">in-range</span> <span class=\"n\">n</span><span class=\"p\">)])</span>\n     <span class=\"p\">(</span><span class=\"n\">make-toy</span> <span class=\"o\">&#39;</span><span class=\"ss\">blue</span><span class=\"p\">)))</span>\n\n <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">repaint</span> <span class=\"n\">t</span> <span class=\"n\">col</span><span class=\"p\">)</span>\n   <span class=\"p\">(</span><span class=\"n\">make-toy</span> <span class=\"n\">col</span><span class=\"p\">)))</span>\n</pre></div>\n\n</div>\n\n<p>More about these features can be found in the Reference, and a short section about signature and unit contracts has been added to the Guide.</p>") #f (u . "\n<p><em>posted by Stevie</em></p>\n\n<p>In SVN I&rsquo;ve added three new major features that involve contracts. One allows for more fine-grained control of contracts, and the other two allow for the use of contracts with signatures and units.</p>\n\n<h2 id=\"contract-regions\">Contract Regions</h2>\n\n<p><em>Contract regions</em> allow the programmer to protect a region of code with a contract boundary. In addition to the wrapped code, the programmer also provides a name for the region which is used in blame situations and a list of exported variables which can either be protected with contracts or unprotected. The region provides a true contract boundary, in that uses of contracted exports within the region are unprotected. Contract regions are specified with the <code>with-contract</code> form. The following contract region defines two mutually recursive functions:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">with-contract</span> <span class=\"n\">region1</span>\n <span class=\"p\">([</span><span class=\"n\">f</span> <span class=\"p\">(</span><span class=\"k\">-&gt;</span> <span class=\"nb\">number?</span> <span class=\"nb\">boolean?</span><span class=\"p\">)]</span>\n  <span class=\"p\">[</span><span class=\"n\">g</span> <span class=\"p\">(</span><span class=\"k\">-&gt;</span> <span class=\"nb\">number?</span> <span class=\"nb\">boolean?</span><span class=\"p\">)])</span>\n <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">f</span> <span class=\"n\">n</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"nb\">zero?</span> <span class=\"n\">n</span><span class=\"p\">)</span> <span class=\"no\">#f</span> <span class=\"p\">(</span><span class=\"n\">g</span> <span class=\"p\">(</span><span class=\"nb\">sub1</span> <span class=\"n\">n</span><span class=\"p\">))))</span>\n <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">g</span> <span class=\"n\">n</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"nb\">zero?</span> <span class=\"n\">n</span><span class=\"p\">)</span> <span class=\"no\">#t</span> <span class=\"p\">(</span><span class=\"n\">f</span> <span class=\"p\">(</span><span class=\"nb\">sub1</span> <span class=\"n\">n</span><span class=\"p\">)))))</span>\n <span class=\"o\">```</span>\n\n<span class=\"ss\">The</span> <span class=\"n\">internal</span> <span class=\"n\">calls</span> <span class=\"n\">to</span> <span class=\"o\">`</span><span class=\"ss\">f</span><span class=\"o\">`</span> <span class=\"ss\">and</span> <span class=\"o\">`</span><span class=\"ss\">g</span><span class=\"o\">`</span> <span class=\"ss\">are</span> <span class=\"n\">uncontracted</span><span class=\"o\">,</span> <span class=\"n\">but</span> <span class=\"n\">calls</span> <span class=\"n\">to</span> <span class=\"o\">`</span><span class=\"ss\">f</span><span class=\"o\">`</span><span class=\"ss\">and</span> <span class=\"o\">`</span><span class=\"ss\">g</span><span class=\"o\">`</span> <span class=\"ss\">outside</span> <span class=\"k\">this</span> <span class=\"n\">region</span> <span class=\"n\">would</span> <span class=\"n\">be</span> <span class=\"n\">appropriately</span> <span class=\"n\">contracted.</span>  <span class=\"n\">First-order</span> <span class=\"n\">checks</span> <span class=\"n\">are</span> <span class=\"n\">performed</span> <span class=\"n\">at</span> <span class=\"n\">the</span> <span class=\"n\">region</span><span class=\"o\">,</span> <span class=\"n\">so</span> <span class=\"n\">the</span>\n<span class=\"n\">following</span> <span class=\"n\">region:</span>\n\n<span class=\"o\">```</span><span class=\"ss\">racket</span>\n<span class=\"p\">(</span><span class=\"k\">with-contract</span> <span class=\"n\">region2</span>\n <span class=\"p\">([</span><span class=\"n\">n</span> <span class=\"nb\">number?</span><span class=\"p\">])</span>\n <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"n\">n</span> <span class=\"no\">#t</span><span class=\"p\">))</span>\n <span class=\"o\">```</span>\n\n<span class=\"ss\">results</span> <span class=\"n\">in</span> <span class=\"n\">the</span> <span class=\"n\">following</span> <span class=\"n\">error:</span>\n\n<span class=\"o\">```</span><span class=\"ss\">racket</span>\n<span class=\"p\">(</span><span class=\"n\">region</span> <span class=\"n\">region2</span><span class=\"p\">)</span> <span class=\"n\">broke</span> <span class=\"n\">the</span> <span class=\"k\">contract</span> <span class=\"nb\">number?</span> <span class=\"n\">on</span> <span class=\"n\">n</span><span class=\"c1\">; expected &lt;number?&gt;, given: #t</span>\n</pre></div>\n\n</div>\n\n<p>Notice that the blame not only gives the name of the region, but describes what type of contract boundary was involved.</p>\n\n<p>For contracting a single definition, there is the <code>define/contract</code> form which has a similar syntax to define, except that it takes a contract before the body of the definition.</p>\n\n<p>To compare the two forms, the following two definitions are equivalent:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">with-contract</span> <span class=\"n\">fact</span>\n <span class=\"p\">([</span><span class=\"n\">fact</span> <span class=\"p\">(</span><span class=\"k\">-&gt;</span> <span class=\"nb\">number?</span> <span class=\"nb\">number?</span><span class=\"p\">)])</span>\n <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">fact</span> <span class=\"n\">n</span><span class=\"p\">)</span>\n   <span class=\"p\">(</span><span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"nb\">zero?</span> <span class=\"n\">n</span><span class=\"p\">)</span> <span class=\"mi\">1</span> <span class=\"p\">(</span><span class=\"nb\">*</span> <span class=\"n\">n</span> <span class=\"p\">(</span><span class=\"n\">fact</span> <span class=\"p\">(</span><span class=\"nb\">sub1</span> <span class=\"n\">n</span><span class=\"p\">))))))</span>\n\n<span class=\"p\">(</span><span class=\"k\">define/contract</span> <span class=\"p\">(</span><span class=\"n\">fact</span> <span class=\"n\">n</span><span class=\"p\">)</span>\n <span class=\"p\">(</span><span class=\"k\">-&gt;</span> <span class=\"nb\">number?</span> <span class=\"nb\">number?</span><span class=\"p\">)</span>\n <span class=\"p\">(</span><span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"nb\">zero?</span> <span class=\"n\">n</span><span class=\"p\">)</span> <span class=\"mi\">1</span> <span class=\"p\">(</span><span class=\"nb\">*</span> <span class=\"n\">n</span> <span class=\"p\">(</span><span class=\"n\">fact</span> <span class=\"p\">(</span><span class=\"nb\">sub1</span> <span class=\"n\">n</span><span class=\"p\">)))))</span>\n</pre></div>\n\n</div>\n\n<p>First order checks are similarly performed at the definition for <code>define/contract</code>, so</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">define/contract</span> <span class=\"p\">(</span><span class=\"n\">fact</span> <span class=\"n\">n</span><span class=\"p\">)</span>\n <span class=\"p\">(</span><span class=\"k\">-&gt;</span> <span class=\"nb\">number?</span><span class=\"p\">)</span>\n <span class=\"p\">(</span><span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"nb\">zero?</span> <span class=\"n\">n</span><span class=\"p\">)</span> <span class=\"mi\">1</span> <span class=\"p\">(</span><span class=\"nb\">*</span> <span class=\"n\">n</span> <span class=\"p\">(</span><span class=\"n\">fact</span> <span class=\"p\">(</span><span class=\"nb\">sub1</span> <span class=\"n\">n</span><span class=\"p\">)))))</span>\n</pre></div>\n\n</div>\n\n<p>results in</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"n\">function</span> <span class=\"n\">fact</span><span class=\"p\">)</span> <span class=\"n\">broke</span> <span class=\"n\">the</span> <span class=\"k\">contract</span> <span class=\"p\">(</span><span class=\"k\">-&gt;</span> <span class=\"nb\">number?</span><span class=\"p\">)</span> <span class=\"n\">on</span> <span class=\"n\">fact</span><span class=\"c1\">; expected a procedure that accepts no arguments without any keywords, given: #&lt;procedure:fact&gt;</span>\n</pre></div>\n\n</div>\n\n<h2 id=\"signature-contracts\">Signature Contracts</h2>\n\n<p>In addition to contract regions, units are also now contract boundaries. One way to use contracts with units is to add contracts to unit signatures via the contracted <code>signature</code> form.</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">define-signature</span> <span class=\"n\">toy-factory^</span>\n <span class=\"p\">((</span><span class=\"k\">contracted</span>\n   <span class=\"p\">[</span><span class=\"n\">build-toys</span> <span class=\"p\">(</span><span class=\"k\">-&gt;</span> <span class=\"nb\">integer?</span> <span class=\"p\">(</span><span class=\"nb\">listof</span> <span class=\"n\">toy?</span><span class=\"p\">))]</span>\n   <span class=\"p\">[</span><span class=\"n\">repaint</span>    <span class=\"p\">(</span><span class=\"k\">-&gt;</span> <span class=\"n\">toy?</span> <span class=\"nb\">symbol?</span> <span class=\"n\">toy?</span><span class=\"p\">)]</span>\n   <span class=\"p\">[</span><span class=\"n\">toy?</span>       <span class=\"p\">(</span><span class=\"k\">-&gt;</span> <span class=\"nb\">any/c</span> <span class=\"nb\">boolean?</span><span class=\"p\">)]</span>\n   <span class=\"p\">[</span><span class=\"n\">toy-color</span>  <span class=\"p\">(</span><span class=\"k\">-&gt;</span> <span class=\"n\">toy?</span> <span class=\"nb\">symbol?</span><span class=\"p\">)])))</span>\n</pre></div>\n\n</div>\n\n<p>Notice that contracts in a signature can use variables listed in the signature.Now if we take the following implementation of that signature:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">define-unit</span> <span class=\"n\">simple-factory@</span>\n <span class=\"p\">(</span><span class=\"k\">import</span><span class=\"p\">)</span>\n <span class=\"p\">(</span><span class=\"k\">export</span> <span class=\"n\">toy-factory^</span><span class=\"p\">)</span>\n  \n <span class=\"p\">(</span><span class=\"k\">define-struct</span> <span class=\"n\">toy</span> <span class=\"p\">(</span><span class=\"n\">color</span><span class=\"p\">)</span> <span class=\"kd\">#:transparent</span><span class=\"p\">)</span>\n  \n <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">build-toys</span> <span class=\"n\">n</span><span class=\"p\">)</span>\n   <span class=\"p\">(</span><span class=\"k\">for/list</span> <span class=\"p\">([</span><span class=\"n\">i</span> <span class=\"p\">(</span><span class=\"nb\">in-range</span> <span class=\"n\">n</span><span class=\"p\">)])</span>\n     <span class=\"p\">(</span><span class=\"n\">make-toy</span> <span class=\"o\">&#39;</span><span class=\"ss\">blue</span><span class=\"p\">)))</span>\n  \n <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">repaint</span> <span class=\"n\">t</span> <span class=\"n\">col</span><span class=\"p\">)</span>\n   <span class=\"p\">(</span><span class=\"n\">make-toy</span> <span class=\"n\">col</span><span class=\"p\">)))</span>\n</pre></div>\n\n</div>\n\n<p>We get the appropriate contract checks on those exports:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"nb\">&gt;</span> <span class=\"p\">(</span><span class=\"k\">define-values/invoke-unit/infer</span> <span class=\"n\">simple-factory@</span><span class=\"p\">)</span>\n<span class=\"nb\">&gt;</span> <span class=\"p\">(</span><span class=\"n\">build-toys</span> <span class=\"mi\">3</span><span class=\"p\">)</span>\n<span class=\"p\">(</span><span class=\"o\">#</span><span class=\"p\">(</span><span class=\"ss\">struct:toy</span> <span class=\"ss\">blue</span><span class=\"p\">)</span> <span class=\"o\">#</span><span class=\"p\">(</span><span class=\"ss\">struct:toy</span> <span class=\"ss\">blue</span><span class=\"p\">)</span> <span class=\"o\">#</span><span class=\"p\">(</span><span class=\"ss\">struct:toy</span> <span class=\"ss\">blue</span><span class=\"p\">))</span>\n<span class=\"nb\">&gt;</span> <span class=\"p\">(</span><span class=\"n\">build-toys</span> <span class=\"no\">#f</span><span class=\"p\">)</span>\n<span class=\"n\">top-level</span> <span class=\"n\">broke</span> <span class=\"n\">the</span> <span class=\"k\">contract</span> <span class=\"p\">(</span><span class=\"k\">-&gt;</span> <span class=\"nb\">integer?</span> <span class=\"p\">(</span><span class=\"nb\">listof</span> <span class=\"n\">toy?</span><span class=\"p\">))</span>\n <span class=\"n\">on</span> <span class=\"n\">build-toys</span><span class=\"c1\">; expected &gt;, given: #f</span>\n</pre></div>\n\n</div>\n\n<p>As before, uses of contracted exports inside the unit are not checked.</p>\n\n<p>Since units are contract boundaries, they can be blamed appropriately. Take the following definitions:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">define-unit</span> <span class=\"n\">factory-user@</span>\n <span class=\"p\">(</span><span class=\"k\">import</span> <span class=\"n\">toy-factory^</span><span class=\"p\">)</span>\n <span class=\"p\">(</span><span class=\"k\">export</span><span class=\"p\">)</span>\n <span class=\"p\">(</span><span class=\"k\">let</span> <span class=\"p\">([</span><span class=\"n\">toys</span> <span class=\"p\">(</span><span class=\"n\">build-toys</span> <span class=\"mi\">3</span><span class=\"p\">)])</span>\n   <span class=\"p\">(</span><span class=\"n\">repaint</span> <span class=\"mi\">3</span> <span class=\"o\">&#39;</span><span class=\"ss\">blue</span><span class=\"p\">)))</span>\n\n<span class=\"p\">(</span><span class=\"k\">define-compound-unit/infer</span> <span class=\"n\">factory+user@</span>\n <span class=\"p\">(</span><span class=\"k\">import</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"k\">export</span><span class=\"p\">)</span>\n <span class=\"p\">(</span><span class=\"k\">link</span> <span class=\"n\">simple-factory@</span> <span class=\"n\">factory-user@</span><span class=\"p\">))</span>\n<span class=\"n\">When</span> <span class=\"n\">we</span> <span class=\"n\">invoke</span> <span class=\"n\">the</span> <span class=\"n\">combined</span> <span class=\"n\">unit:&gt;</span> <span class=\"p\">(</span><span class=\"k\">define-values/invoke-unit/infer</span> <span class=\"n\">factory+user@</span><span class=\"p\">)</span>\n<span class=\"p\">(</span><span class=\"k\">unit</span> <span class=\"n\">factory-user@</span><span class=\"p\">)</span> <span class=\"n\">broke</span> <span class=\"n\">the</span> <span class=\"k\">contract</span>\n <span class=\"p\">(</span><span class=\"k\">-&gt;</span> <span class=\"n\">toy?</span> <span class=\"nb\">symbol?</span> <span class=\"n\">toy?</span><span class=\"p\">)</span>\n<span class=\"n\">on</span> <span class=\"n\">repaint</span><span class=\"c1\">; expected &gt;, given: 3</span>\n</pre></div>\n\n</div>\n\n<h2 id=\"unit-contracts\">Unit Contracts</h2>\n\n<p>However, we may not always be able to add contracts to signatures. For example, there are many already-existing signatures in PLT Scheme that one may want to implement, or a programmer may want to take a unit value and add contracts to it after the fact.</p>\n\n<p>To do this, there is the <code>unit/c</code> contract combinator. It takes a list of imports and exports, where each signature is paired with a list of variables and their contracts for each signature. So if we had the uncontracted version of the toy-factory^ signature:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">define-signature</span> <span class=\"n\">toy-factory^</span>\n <span class=\"p\">(</span><span class=\"n\">build-toys</span> <span class=\"n\">repaint</span> <span class=\"n\">toy?</span> <span class=\"n\">toy-color</span><span class=\"p\">))</span>\n</pre></div>\n\n</div>\n\n<p>the following contracts would be appropriate for a unit that imports nothing and exports that signature:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">unit/c</span> <span class=\"p\">(</span><span class=\"k\">import</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"k\">export</span><span class=\"p\">))</span>\n<span class=\"p\">(</span><span class=\"k\">unit/c</span> <span class=\"p\">(</span><span class=\"k\">import</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"k\">export</span> <span class=\"n\">toy-factory^</span><span class=\"p\">))</span>\n<span class=\"p\">(</span><span class=\"k\">unit/c</span>\n <span class=\"p\">(</span><span class=\"k\">import</span><span class=\"p\">)</span>\n <span class=\"p\">(</span><span class=\"k\">export</span> <span class=\"p\">(</span><span class=\"n\">toy-factory^</span>\n          <span class=\"p\">[</span><span class=\"n\">toy-color</span> <span class=\"p\">(</span><span class=\"k\">-&gt;</span> <span class=\"n\">toy?</span> <span class=\"nb\">symbol?</span><span class=\"p\">)])))</span>\n<span class=\"p\">(</span><span class=\"k\">unit/c</span>\n <span class=\"p\">(</span><span class=\"k\">import</span><span class=\"p\">)</span>\n <span class=\"p\">(</span><span class=\"k\">export</span> <span class=\"p\">(</span><span class=\"n\">toy-factory^</span>\n          <span class=\"p\">[</span><span class=\"n\">build-toys</span> <span class=\"p\">(</span><span class=\"k\">-&gt;</span> <span class=\"nb\">integer?</span> <span class=\"p\">(</span><span class=\"nb\">listof</span> <span class=\"n\">toy?</span><span class=\"p\">))]</span>\n          <span class=\"p\">[</span><span class=\"n\">repaint</span>    <span class=\"p\">(</span><span class=\"k\">-&gt;</span> <span class=\"n\">toy?</span> <span class=\"nb\">symbol?</span> <span class=\"n\">toy?</span><span class=\"p\">)]</span>\n          <span class=\"p\">[</span><span class=\"n\">toy?</span>       <span class=\"p\">(</span><span class=\"k\">-&gt;</span> <span class=\"nb\">any/c</span> <span class=\"nb\">boolean?</span><span class=\"p\">)]</span>\n          <span class=\"p\">[</span><span class=\"n\">toy-color</span>  <span class=\"p\">(</span><span class=\"k\">-&gt;</span> <span class=\"n\">toy?</span> <span class=\"nb\">symbol?</span><span class=\"p\">)])))</span>\n</pre></div>\n\n</div>\n\n<p>Unit contracts can contain a superset of the import signatures and a subset of the export signatures for a given unit value. Also, variables that are not listed for a given signature are left alone when the contracts are being added.</p>\n\n<p>Since the results of applying <code>unit/c</code> is a new unit, then adding a contract can cause link inference to fail. For example, if we change the definition of <code>simple-factory@</code> above to</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">define/contract</span> <span class=\"n\">simple-factory@</span>\n <span class=\"p\">(</span><span class=\"k\">unit/c</span>\n  <span class=\"p\">(</span><span class=\"k\">import</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"k\">export</span> <span class=\"p\">(</span><span class=\"n\">toy-factory^</span>\n           <span class=\"p\">[</span><span class=\"n\">build-toys</span> <span class=\"p\">(</span><span class=\"k\">-&gt;</span> <span class=\"nb\">integer?</span> <span class=\"p\">(</span><span class=\"nb\">listof</span> <span class=\"n\">toy?</span><span class=\"p\">))]</span>\n           <span class=\"p\">[</span><span class=\"n\">repaint</span>    <span class=\"p\">(</span><span class=\"k\">-&gt;</span> <span class=\"n\">toy?</span> <span class=\"nb\">symbol?</span> <span class=\"n\">toy?</span><span class=\"p\">)]</span>\n           <span class=\"p\">[</span><span class=\"n\">toy?</span>       <span class=\"p\">(</span><span class=\"k\">-&gt;</span> <span class=\"nb\">any/c</span> <span class=\"nb\">boolean?</span><span class=\"p\">)]</span>\n           <span class=\"p\">[</span><span class=\"n\">toy-color</span>  <span class=\"p\">(</span><span class=\"k\">-&gt;</span> <span class=\"n\">toy?</span> <span class=\"nb\">symbol?</span><span class=\"p\">)])))</span>\n <span class=\"p\">(</span><span class=\"k\">unit</span>\n   <span class=\"p\">(</span><span class=\"k\">import</span><span class=\"p\">)</span>\n   <span class=\"p\">(</span><span class=\"k\">export</span> <span class=\"n\">toy-factory^</span><span class=\"p\">)</span>\n  \n   <span class=\"p\">(</span><span class=\"k\">define-struct</span> <span class=\"n\">toy</span> <span class=\"p\">(</span><span class=\"n\">color</span><span class=\"p\">)</span> <span class=\"kd\">#:transparent</span><span class=\"p\">)</span>\n  \n   <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">build-toys</span> <span class=\"n\">n</span><span class=\"p\">)</span>\n     <span class=\"p\">(</span><span class=\"k\">for/list</span> <span class=\"p\">([</span><span class=\"n\">i</span> <span class=\"p\">(</span><span class=\"nb\">in-range</span> <span class=\"n\">n</span><span class=\"p\">)])</span>\n       <span class=\"p\">(</span><span class=\"n\">make-toy</span> <span class=\"o\">&#39;</span><span class=\"ss\">blue</span><span class=\"p\">)))</span>\n  \n   <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">repaint</span> <span class=\"n\">t</span> <span class=\"n\">col</span><span class=\"p\">)</span>\n     <span class=\"p\">(</span><span class=\"n\">make-toy</span> <span class=\"n\">col</span><span class=\"p\">))))</span>\n</pre></div>\n\n</div>\n\n<p>Then when we try to combine it with the <code>factory-user@</code> unit, we get:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"n\">define-compound-unit/infer:</span> <span class=\"nb\">not</span> <span class=\"n\">a</span> <span class=\"k\">unit</span> <span class=\"n\">definition</span> <span class=\"n\">in:</span> <span class=\"n\">simple-factory@</span>\n</pre></div>\n\n</div>\n\n<p>One way to solve this is to use <code>define-unit-binding</code> to set up the static information for the new contracted value. Another possibility for unit definitions is to use <code>define-unit/contract</code>:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">define-unit/contract</span> <span class=\"n\">simple-factory@</span>\n <span class=\"p\">(</span><span class=\"k\">import</span><span class=\"p\">)</span>\n <span class=\"p\">(</span><span class=\"k\">export</span> <span class=\"p\">(</span><span class=\"n\">toy-factory^</span>\n          <span class=\"p\">[</span><span class=\"n\">build-toys</span> <span class=\"p\">(</span><span class=\"k\">-&gt;</span> <span class=\"nb\">integer?</span> <span class=\"p\">(</span><span class=\"nb\">listof</span> <span class=\"n\">toy?</span><span class=\"p\">))]</span>\n          <span class=\"p\">[</span><span class=\"n\">repaint</span>    <span class=\"p\">(</span><span class=\"k\">-&gt;</span> <span class=\"n\">toy?</span> <span class=\"nb\">symbol?</span> <span class=\"n\">toy?</span><span class=\"p\">)]</span>\n          <span class=\"p\">[</span><span class=\"n\">toy?</span>       <span class=\"p\">(</span><span class=\"k\">-&gt;</span> <span class=\"nb\">any/c</span> <span class=\"nb\">boolean?</span><span class=\"p\">)]</span>\n          <span class=\"p\">[</span><span class=\"n\">toy-color</span>  <span class=\"p\">(</span><span class=\"k\">-&gt;</span> <span class=\"n\">toy?</span> <span class=\"nb\">symbol?</span><span class=\"p\">)]))</span>\n\n <span class=\"p\">(</span><span class=\"k\">define-struct</span> <span class=\"n\">toy</span> <span class=\"p\">(</span><span class=\"n\">color</span><span class=\"p\">)</span> <span class=\"kd\">#:transparent</span><span class=\"p\">)</span>\n\n <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">build-toys</span> <span class=\"n\">n</span><span class=\"p\">)</span>\n   <span class=\"p\">(</span><span class=\"k\">for/list</span> <span class=\"p\">([</span><span class=\"n\">i</span> <span class=\"p\">(</span><span class=\"nb\">in-range</span> <span class=\"n\">n</span><span class=\"p\">)])</span>\n     <span class=\"p\">(</span><span class=\"n\">make-toy</span> <span class=\"o\">&#39;</span><span class=\"ss\">blue</span><span class=\"p\">)))</span>\n\n <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">repaint</span> <span class=\"n\">t</span> <span class=\"n\">col</span><span class=\"p\">)</span>\n   <span class=\"p\">(</span><span class=\"n\">make-toy</span> <span class=\"n\">col</span><span class=\"p\">)))</span>\n</pre></div>\n\n</div>\n\n<p>More about these features can be found in the Reference, and a short section about signature and unit contracts has been added to the Guide.</p>")) ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2007-07-30-control-resumed.md" . unix) f post (u . "control, resumed") (? . 62) 1467223812 (p+ #"/Users/MB/git/racket-lang-org/blog/2007/07/control-resumed.html" . unix) "/2007/07/control-resumed.html" (u . "2007-07-30T11:55:00.000-04:00") (? . 42) (? . 90) (c (u . "")) (u . "\n<p><em>posted by matthias</em></p>\n\n<p>Since at least some people helped me re-re-invent prompt after my last post, I thought I would remind people that PLT Scheme is the <em>only</em> production system in the world that provides delimited and (truly) composable continuations directly (and w/o loss of TCO properties). So here is the same fragment again:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">require</span> <span class=\"p\">(</span><span class=\"k\">lib</span> <span class=\"s2\">\"control.ss\"</span><span class=\"p\">))</span>\n\n<span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">generate-one-element-at-a-time</span> <span class=\"n\">a-list</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">control-state</span><span class=\"p\">)</span>\n    <span class=\"p\">(</span><span class=\"nb\">for-each</span> <span class=\"p\">(</span><span class=\"k\">lambda</span> <span class=\"p\">(</span><span class=\"n\">an-element-from-a-list</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"n\">control</span> <span class=\"n\">resume-here</span>\n    <span class=\"p\">(</span><span class=\"k\">set!</span> <span class=\"n\">control-state</span> <span class=\"n\">resume-here</span><span class=\"p\">)</span>\n    <span class=\"n\">an-element-from-a-list</span><span class=\"p\">))</span>\n              <span class=\"n\">a-list</span><span class=\"p\">)</span>\n    <span class=\"o\">&#39;</span><span class=\"ss\">you-fell-off-the-end-off-the-list</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">generator</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"n\">prompt</span> <span class=\"p\">(</span><span class=\"n\">control-state</span><span class=\"p\">)))</span>\n  <span class=\"n\">generator</span><span class=\"p\">)</span>\n</pre></div>\n\n</div>\n\n<p>Take a look, compare and contrast with the previous post. Time permitting, I will continue to show you another control poem soon. P.S. See <a href=\"http://www.ccs.neu.edu/scheme/pubs/#icfp07-fyf\">Adding Delimited and Composable Control to a Production Programming Environment</a> for details.</p>") #f (u . "\n<p><em>posted by matthias</em></p>\n\n<p>Since at least some people helped me re-re-invent prompt after my last post, I thought I would remind people that PLT Scheme is the <em>only</em> production system in the world that provides delimited and (truly) composable continuations directly (and w/o loss of TCO properties). So here is the same fragment again:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">require</span> <span class=\"p\">(</span><span class=\"k\">lib</span> <span class=\"s2\">\"control.ss\"</span><span class=\"p\">))</span>\n\n<span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">generate-one-element-at-a-time</span> <span class=\"n\">a-list</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">control-state</span><span class=\"p\">)</span>\n    <span class=\"p\">(</span><span class=\"nb\">for-each</span> <span class=\"p\">(</span><span class=\"k\">lambda</span> <span class=\"p\">(</span><span class=\"n\">an-element-from-a-list</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"n\">control</span> <span class=\"n\">resume-here</span>\n    <span class=\"p\">(</span><span class=\"k\">set!</span> <span class=\"n\">control-state</span> <span class=\"n\">resume-here</span><span class=\"p\">)</span>\n    <span class=\"n\">an-element-from-a-list</span><span class=\"p\">))</span>\n              <span class=\"n\">a-list</span><span class=\"p\">)</span>\n    <span class=\"o\">&#39;</span><span class=\"ss\">you-fell-off-the-end-off-the-list</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">generator</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"n\">prompt</span> <span class=\"p\">(</span><span class=\"n\">control-state</span><span class=\"p\">)))</span>\n  <span class=\"n\">generator</span><span class=\"p\">)</span>\n</pre></div>\n\n</div>\n\n<p>Take a look, compare and contrast with the previous post. Time permitting, I will continue to show you another control poem soon. P.S. See <a href=\"http://www.ccs.neu.edu/scheme/pubs/#icfp07-fyf\">Adding Delimited and Composable Control to a Production Programming Environment</a> for details.</p>")) ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2010-01-28-plt-scheme-v424.md" . unix) f post (u . "PLT Scheme v4.2.4") (? . 63) 1467223812 (p+ #"/Users/MB/git/racket-lang-org/blog/2010/01/plt-scheme-v424.html" . unix) "/2010/01/plt-scheme-v424.html" (u . "2010-01-28T21:40:00.001-05:00") (? . 4) (? . 119) (c (u . "")) (u . "\n<p><em>posted by Eli Barzilay</em></p>\n\n<p>PLT Scheme version 4.2.4 is now available from <a href=\"http://plt-scheme.org/\"><code>http://plt-scheme.org/</code></a></p>\n\n<ul>\n <li>The <code>scheme/flonum</code> and <code>scheme/fixnum</code> libraries provide flonum- and fixnum-specific operations. In the case of flonum-specific operations, the JIT compiler can recognize combinations of operations (including local bindings) and improve performance by &ldquo;unboxing&rdquo; intermediate results.</li>\n <li>The <code>scheme/unsafe/ops</code> library provides arithmetic and other operations that are implemented without dynamic checks. Avoiding checks can sometimes improve performance, but at the expense of safety.</li>\n <li><code>2htdp/universe</code>: We have severed the connection between universe and an image library and made a few other, minor changes. Most programs will now have to change to require the <code>htdp/image</code> library explicitly. For the full details, see the new <a href=\"http://docs.plt-scheme.org/teachpack/2htdphtdp-port.html\">Porting World Programs</a> section of the documentation.</li>\n <li>The <code>2htdp/image</code> library continues to grow. In this release, it is supported by <code>2htdp/universe</code>, equality changed to be based on how the images are drawn, cropping and curves were added, and support for more kinds of pens were added.</li>\n <li><code>htdp/world</code>: The old world teachpack remains deprecated. HtDP/2e exclusively uses the new 2htdp/universe library. For backwards compatibility, the world teachpack will remain in the distribution until the coming summer.</li>\n <li>The <code>scheme/class</code> library now provides <code>this%</code>, which refers to the class of the current object (i.e. <code>this</code>).</li>\n <li><code>scheme/generator</code> has convenient functions for infinite generators, and for converting a generator to a sequence for iteration.</li>\n <li>PLT Scheme&rsquo;s add-on directory can be customized by the <code>$PLTADDONDIR</code> environment variable or <code>--addon</code>/<code>-A</code> command-line flags. This controls where downloaded Planet packages and their compiled Scribble documentation are installed.</li>\n <li>Additional extensions include: saving <code>errno</code> in foreign calls, much improved <code>sort</code> speed, normalized results from <code>procedure-arity</code>, and more.</li></ul>") #f (u . "\n<p><em>posted by Eli Barzilay</em></p>\n\n<p>PLT Scheme version 4.2.4 is now available from <a href=\"http://plt-scheme.org/\"><code>http://plt-scheme.org/</code></a></p>\n\n<ul>\n <li>The <code>scheme/flonum</code> and <code>scheme/fixnum</code> libraries provide flonum- and fixnum-specific operations. In the case of flonum-specific operations, the JIT compiler can recognize combinations of operations (including local bindings) and improve performance by &ldquo;unboxing&rdquo; intermediate results.</li>\n <li>The <code>scheme/unsafe/ops</code> library provides arithmetic and other operations that are implemented without dynamic checks. Avoiding checks can sometimes improve performance, but at the expense of safety.</li>\n <li><code>2htdp/universe</code>: We have severed the connection between universe and an image library and made a few other, minor changes. Most programs will now have to change to require the <code>htdp/image</code> library explicitly. For the full details, see the new <a href=\"http://docs.plt-scheme.org/teachpack/2htdphtdp-port.html\">Porting World Programs</a> section of the documentation.</li>\n <li>The <code>2htdp/image</code> library continues to grow. In this release, it is supported by <code>2htdp/universe</code>, equality changed to be based on how the images are drawn, cropping and curves were added, and support for more kinds of pens were added.</li>\n <li><code>htdp/world</code>: The old world teachpack remains deprecated. HtDP/2e exclusively uses the new 2htdp/universe library. For backwards compatibility, the world teachpack will remain in the distribution until the coming summer.</li>\n <li>The <code>scheme/class</code> library now provides <code>this%</code>, which refers to the class of the current object (i.e. <code>this</code>).</li>\n <li><code>scheme/generator</code> has convenient functions for infinite generators, and for converting a generator to a sequence for iteration.</li>\n <li>PLT Scheme&rsquo;s add-on directory can be customized by the <code>$PLTADDONDIR</code> environment variable or <code>--addon</code>/<code>-A</code> command-line flags. This controls where downloaded Planet packages and their compiled Scribble documentation are installed.</li>\n <li>Additional extensions include: saving <code>errno</code> in foreign calls, much improved <code>sort</code> speed, normalized results from <code>procedure-arity</code>, and more.</li></ul>")) ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2007-08-06-macros-and-hygiene-resumed.md" . unix) f post (u . "macros and hygiene, resumed") (? . 64) 1467223812 (p+ #"/Users/MB/git/racket-lang-org/blog/2007/08/macros-and-hygiene-resumed.html" . unix) "/2007/08/macros-and-hygiene-resumed.html" (u . "2007-08-06T11:21:00.000-04:00") (? . 91) (? . 65) (c (u . "")) (u . "\n<p><em>posted by matthias</em></p>\n\n<p>The Friday entry demonstrates how to break hygiene for a macro that defines a generator. Ryan Culpepper, the local macrologist, reminded me that expanding into this macro goes wrong in the syntax-case world:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">define-syntax</span> <span class=\"n\">define-that-expands-into-define/y</span> \n  <span class=\"p\">(</span><span class=\"k\">syntax-rules</span> <span class=\"p\">()</span>\n    <span class=\"p\">((</span><span class=\"k\">_</span> <span class=\"p\">(</span><span class=\"n\">name</span> <span class=\"n\">arg</span> <span class=\"k\">...</span><span class=\"p\">)</span> <span class=\"n\">body</span> <span class=\"k\">...</span><span class=\"p\">)</span> \n     <span class=\"p\">(</span><span class=\"n\">define/y</span> <span class=\"p\">(</span><span class=\"n\">name</span> <span class=\"n\">arg</span> <span class=\"k\">...</span><span class=\"p\">)</span> <span class=\"n\">body</span> <span class=\"k\">...</span><span class=\"p\">))))</span>\n\n<span class=\"p\">(</span><span class=\"n\">define-that-expands-into-define/y</span> <span class=\"p\">(</span><span class=\"n\">bar</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"n\">yield</span> <span class=\"mi\">1</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"n\">yield</span> <span class=\"mi\">2</span><span class=\"p\">)</span>\n  <span class=\"o\">&#39;</span><span class=\"ss\">finished</span><span class=\"p\">)</span>\n</pre></div>\n\n</div>\n\n<p>Run this in Pretty Big [DrScheme] and you get a strange note concerning MrEd&rsquo;s yield or run it in MzScheme [Textual] and you get an error message about &lsquo;yield&rsquo; being unbound.</p>\n\n<p>What gives? The &lsquo;stx&rsquo; of <code>datum-&gt;syntax-object</code> is the syntactic context of the new macro but it doesn&rsquo;t bind yield; it just uses it. So the definition of <code>yield</code> in <code>define/y</code> must be a different one according to the hygiene standards. Ergo yield is free at the top-level [MzScheme] or bound to the yield import from MrEd [Pretty Big].</p>\n\n<p>How can we try to fix this? The explanation suggests we use a different macro definition for <code>define/y</code>, one that uses a context that is guaranteed from the body of an instance of <code>define/y</code>:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">require</span> <span class=\"p\">(</span><span class=\"k\">lib</span> <span class=\"s2\">\"control.ss\"</span><span class=\"p\">))</span>\n\n<span class=\"p\">(</span><span class=\"k\">define-syntax</span> <span class=\"p\">(</span><span class=\"n\">define/y</span> <span class=\"n\">stx</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"k\">syntax-case</span> <span class=\"n\">stx</span> <span class=\"p\">()</span>\n    <span class=\"p\">[(</span><span class=\"k\">_</span> <span class=\"p\">(</span><span class=\"n\">name</span> <span class=\"n\">arg</span> <span class=\"k\">...</span><span class=\"p\">)</span> <span class=\"n\">body0</span> <span class=\"n\">body</span> <span class=\"k\">...</span><span class=\"p\">)</span>\n     <span class=\"p\">(</span><span class=\"k\">with-syntax</span> \n         <span class=\"p\">((</span><span class=\"n\">yield-name</span> \n           <span class=\"p\">(</span><span class=\"n\">datum-&gt;syntax-object</span> <span class=\"p\">(</span><span class=\"k\">syntax</span> <span class=\"n\">body0</span><span class=\"p\">)</span> <span class=\"o\">&#39;</span><span class=\"ss\">yield</span><span class=\"p\">)))</span>\n       <span class=\"p\">(</span><span class=\"k\">syntax</span>\n        <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">name</span> <span class=\"n\">arg</span> <span class=\"k\">...</span><span class=\"p\">)</span>\n          <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">yield-name</span> <span class=\"n\">x</span><span class=\"p\">)</span>\n            <span class=\"p\">(</span><span class=\"n\">control</span> <span class=\"n\">resume-here</span>\n             <span class=\"p\">(</span><span class=\"k\">set!</span> <span class=\"n\">name</span> \n                   <span class=\"p\">(</span><span class=\"k\">lambda</span> <span class=\"p\">()</span>\n                     <span class=\"p\">(</span><span class=\"n\">prompt</span> <span class=\"p\">(</span><span class=\"n\">resume-here</span> <span class=\"o\">&#39;</span><span class=\"ss\">dummy</span><span class=\"p\">))))</span>\n             <span class=\"n\">x</span><span class=\"p\">))</span>\n          <span class=\"p\">(</span><span class=\"n\">prompt</span> <span class=\"n\">body0</span> <span class=\"n\">body</span> <span class=\"k\">...</span><span class=\"p\">))))]))</span>\n\n<span class=\"p\">(</span><span class=\"k\">define-syntax</span> <span class=\"n\">define-that-expands-into-define/y</span> \n  <span class=\"p\">(</span><span class=\"k\">syntax-rules</span> <span class=\"p\">()</span>\n    <span class=\"p\">((</span><span class=\"k\">_</span> <span class=\"p\">(</span><span class=\"n\">name</span> <span class=\"n\">arg</span> <span class=\"k\">...</span><span class=\"p\">)</span> <span class=\"n\">body</span> <span class=\"k\">...</span><span class=\"p\">)</span> \n     <span class=\"p\">(</span><span class=\"n\">define/y</span> <span class=\"p\">(</span><span class=\"n\">name</span> <span class=\"n\">arg</span> <span class=\"k\">...</span><span class=\"p\">)</span> <span class=\"n\">body</span> <span class=\"k\">...</span><span class=\"p\">))))</span>\n\n<span class=\"c1\">;; --- try it out ---</span>\n\n<span class=\"p\">(</span><span class=\"n\">define-that-expands-into-define/y</span> <span class=\"p\">(</span><span class=\"n\">bar</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"n\">yield</span> <span class=\"mi\">1</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"n\">yield</span> <span class=\"mi\">2</span><span class=\"p\">)</span>\n  <span class=\"o\">&#39;</span><span class=\"ss\">finished</span><span class=\"p\">)</span>\n\n<span class=\"p\">(</span><span class=\"nb\">list</span> <span class=\"p\">(</span><span class=\"n\">bar</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"n\">bar</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"n\">bar</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"n\">bar</span><span class=\"p\">))</span>\n</pre></div>\n\n</div>\n\n<p>Run it. You will find that it works as expected.</p>\n\n<p>Tomorrow, time permitting, I will tell you what&rsquo;s wrong with it and how you can fix it.</p>") #t (u . "\n<p><em>posted by matthias</em></p>\n\n<p>The Friday entry demonstrates how to break hygiene for a macro that defines a generator. Ryan Culpepper, the local macrologist, reminded me that expanding into this macro goes wrong in the syntax-case world:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">define-syntax</span> <span class=\"n\">define-that-expands-into-define/y</span> \n  <span class=\"p\">(</span><span class=\"k\">syntax-rules</span> <span class=\"p\">()</span>\n    <span class=\"p\">((</span><span class=\"k\">_</span> <span class=\"p\">(</span><span class=\"n\">name</span> <span class=\"n\">arg</span> <span class=\"k\">...</span><span class=\"p\">)</span> <span class=\"n\">body</span> <span class=\"k\">...</span><span class=\"p\">)</span> \n     <span class=\"p\">(</span><span class=\"n\">define/y</span> <span class=\"p\">(</span><span class=\"n\">name</span> <span class=\"n\">arg</span> <span class=\"k\">...</span><span class=\"p\">)</span> <span class=\"n\">body</span> <span class=\"k\">...</span><span class=\"p\">))))</span>\n\n<span class=\"p\">(</span><span class=\"n\">define-that-expands-into-define/y</span> <span class=\"p\">(</span><span class=\"n\">bar</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"n\">yield</span> <span class=\"mi\">1</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"n\">yield</span> <span class=\"mi\">2</span><span class=\"p\">)</span>\n  <span class=\"o\">&#39;</span><span class=\"ss\">finished</span><span class=\"p\">)</span>\n</pre></div>\n\n</div>\n\n<p>Run this in Pretty Big [DrScheme] and you get a strange note concerning MrEd&rsquo;s yield or run it in MzScheme [Textual] and you get an error message about &lsquo;yield&rsquo; being unbound.</p>\n\n<p>What gives? The &lsquo;stx&rsquo; of <code>datum-&gt;syntax-object</code> is the syntactic context of the new macro but it doesn&rsquo;t bind yield; it just uses it. So the definition of <code>yield</code> in <code>define/y</code> must be a different one according to the hygiene standards. Ergo yield is free at the top-level [MzScheme] or bound to the yield import from MrEd [Pretty Big].</p>\n\n<p>How can we try to fix this? The explanation suggests we use a different macro definition for <code>define/y</code>, one that uses a context that is guaranteed from the body of an instance of <code>define/y</code>:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">require</span> <span class=\"p\">(</span><span class=\"k\">lib</span> <span class=\"s2\">\"control.ss\"</span><span class=\"p\">))</span>\n\n<span class=\"p\">(</span><span class=\"k\">define-syntax</span> <span class=\"p\">(</span><span class=\"n\">define/y</span> <span class=\"n\">stx</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"k\">syntax-case</span> <span class=\"n\">stx</span> <span class=\"p\">()</span>\n    <span class=\"p\">[(</span><span class=\"k\">_</span> <span class=\"p\">(</span><span class=\"n\">name</span> <span class=\"n\">arg</span> <span class=\"k\">...</span><span class=\"p\">)</span> <span class=\"n\">body0</span> <span class=\"n\">body</span> <span class=\"k\">...</span><span class=\"p\">)</span>\n     <span class=\"p\">(</span><span class=\"k\">with-syntax</span> \n         <span class=\"p\">((</span><span class=\"n\">yield-name</span> \n           <span class=\"p\">(</span><span class=\"n\">datum-&gt;syntax-object</span> <span class=\"p\">(</span><span class=\"k\">syntax</span> <span class=\"n\">body0</span><span class=\"p\">)</span> <span class=\"o\">&#39;</span><span class=\"ss\">yield</span><span class=\"p\">)))</span>\n       <span class=\"p\">(</span><span class=\"k\">syntax</span>\n        <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">name</span> <span class=\"n\">arg</span> <span class=\"k\">...</span><span class=\"p\">)</span>\n          <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">yield-name</span> <span class=\"n\">x</span><span class=\"p\">)</span>\n            <span class=\"p\">(</span><span class=\"n\">control</span> <span class=\"n\">resume-here</span>\n             <span class=\"p\">(</span><span class=\"k\">set!</span> <span class=\"n\">name</span> \n                   <span class=\"p\">(</span><span class=\"k\">lambda</span> <span class=\"p\">()</span>\n                     <span class=\"p\">(</span><span class=\"n\">prompt</span> <span class=\"p\">(</span><span class=\"n\">resume-here</span> <span class=\"o\">&#39;</span><span class=\"ss\">dummy</span><span class=\"p\">))))</span>\n             <span class=\"n\">x</span><span class=\"p\">))</span>\n          <span class=\"p\">(</span><span class=\"n\">prompt</span> <span class=\"n\">body0</span> <span class=\"n\">body</span> <span class=\"k\">...</span><span class=\"p\">))))]))</span>\n\n<span class=\"p\">(</span><span class=\"k\">define-syntax</span> <span class=\"n\">define-that-expands-into-define/y</span> \n  <span class=\"p\">(</span><span class=\"k\">syntax-rules</span> <span class=\"p\">()</span>\n    <span class=\"p\">((</span><span class=\"k\">_</span> <span class=\"p\">(</span><span class=\"n\">name</span> <span class=\"n\">arg</span> <span class=\"k\">...</span><span class=\"p\">)</span> <span class=\"n\">body</span> <span class=\"k\">...</span><span class=\"p\">)</span> \n     <span class=\"p\">(</span><span class=\"n\">define/y</span> <span class=\"p\">(</span><span class=\"n\">name</span> <span class=\"n\">arg</span> <span class=\"k\">...</span><span class=\"p\">)</span> <span class=\"n\">body</span> <span class=\"k\">...</span><span class=\"p\">))))</span>\n\n<span class=\"c1\">;; --- try it out ---</span>\n\n<span class=\"p\">(</span><span class=\"n\">define-that-expands-into-define/y</span> <span class=\"p\">(</span><span class=\"n\">bar</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"n\">yield</span> <span class=\"mi\">1</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"n\">yield</span> <span class=\"mi\">2</span><span class=\"p\">)</span>\n  <span class=\"o\">&#39;</span><span class=\"ss\">finished</span><span class=\"p\">)</span>\n\n<span class=\"p\">(</span><span class=\"nb\">list</span> <span class=\"p\">(</span><span class=\"n\">bar</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"n\">bar</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"n\">bar</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"n\">bar</span><span class=\"p\">))</span>\n</pre></div>\n\n</div>\n\n<p>Run it. You will find that it works as expected.</p>\n\n<p>Tomorrow, time permitting, I will tell you what&rsquo;s wrong with it and how you can fix it.</p>\n<!-- more-->\n\n<hr />\n\n<p>Isn&rsquo;t it still a problem that we cannot use yield in macros?</p>\n\n<p>As a silly example:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">define-syntax</span> <span class=\"n\">yield2</span>\n  <span class=\"p\">(</span><span class=\"k\">syntax-rules</span> <span class=\"p\">(</span><span class=\"n\">yield</span><span class=\"p\">)</span>\n    <span class=\"p\">((</span><span class=\"k\">_</span> <span class=\"n\">x</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"n\">yield</span> <span class=\"n\">x</span><span class=\"p\">))))</span>\n\n<span class=\"p\">(</span><span class=\"n\">define/y</span> <span class=\"p\">(</span><span class=\"n\">step</span><span class=\"p\">)</span>\n <span class=\"p\">(</span><span class=\"n\">yield2</span> <span class=\"mi\">1</span><span class=\"p\">)</span>\n <span class=\"o\">&#39;</span><span class=\"ss\">finished</span><span class=\"p\">)</span><span class=\"err\">)</span>\n</pre></div>\n\n</div>\n\n<p>We&rsquo;ll get a yield unbound error when calling step.</p>\n\n<p>— <em>Léa, 22 August 2007</em></p>\n\n<hr />\n\n<p>This comment has been removed by the author.</p>\n\n<p>— <em>Léa, 22 August 2007</em></p>\n\n<hr />\n\n<p>Ah, OK, this has to do with the lexical scope of yield.</p>\n\n<p>If I define</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"n\">define/y</span> <span class=\"p\">(</span><span class=\"n\">step</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"k\">define-syntax</span> <span class=\"n\">yield2</span>\n  <span class=\"p\">(</span><span class=\"k\">syntax-rules</span> <span class=\"p\">()</span>\n    <span class=\"p\">((</span><span class=\"k\">_</span> <span class=\"n\">x</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"n\">yield</span> <span class=\"n\">x</span><span class=\"p\">))))</span>\n  <span class=\"p\">(</span><span class=\"n\">yield2</span> <span class=\"mi\">1</span><span class=\"p\">)</span>\n  <span class=\"o\">&#39;</span><span class=\"ss\">finished</span><span class=\"p\">)</span>\n</pre></div>\n\n</div>\n\n<p>instead, it works.</p>\n\n<p>— <em>Léa, 22 August 2007</em></p>\n\n<hr />")) ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2008-07-29-search-in-drscheme.md" . unix) f post (u . "Search in DrScheme") (? . 66) 1467223812 (p+ #"/Users/MB/git/racket-lang-org/blog/2008/07/search-in-drscheme.html" . unix) "/2008/07/search-in-drscheme.html" (u . "2008-07-29T18:10:00.011-04:00") (? . 67) (? . 52) (c (u . "")) (u . "\n<p><em>posted by Robby Findler</em></p>\n\n<p>I&rsquo;ve just overhauled search in DrScheme. Instead of popping up a dialog box and asking you for a search string, you get a new editor along the bottom of the DrScheme window where you can type a search string and DrScheme responds by circling (in purple) all of the occurrences of the search string in the file, both in the main window and in the contour window.</p>\n\n<p>From there, you can use the new menu shortcuts to navigate forwards and backwards through the hits, optionally replacing occurrences of the search string with the replace strings (see the Edit menu).</p>\n\n<p>With the default settings, typing a search string does not move around in the main window. Specifically (unlike Emacs, Safari, or Firefox), you don&rsquo;t move immediately to the first occurrence of the search string. You have to hit return or one of the search keys (in the Edit menu) for that to happen. But you can enable this in the General pane of the Editing tab in the preferences dialog. Click on &ldquo;Search using anchors&rdquo;. Now, when you search for a string, DrScheme will whizz you right to it and when you edit the search string, DrScheme will shift the insertion point based on the search string. In order for you to keep track of where edits will go, you&rsquo;ll see a funny looking little red dongle in your text. That&rsquo;s where the insertion point was when you started your search, and that&rsquo;s where DrScheme starts all of these implicit searches from.</p>\n\n<p>Try it out and let us know what you think! In particular, is the anchor-based search or the non-anchor-based search more intuitive for you?</p>") #t (u . "\n<p><em>posted by Robby Findler</em></p>\n\n<p>I&rsquo;ve just overhauled search in DrScheme. Instead of popping up a dialog box and asking you for a search string, you get a new editor along the bottom of the DrScheme window where you can type a search string and DrScheme responds by circling (in purple) all of the occurrences of the search string in the file, both in the main window and in the contour window.</p>\n\n<p>From there, you can use the new menu shortcuts to navigate forwards and backwards through the hits, optionally replacing occurrences of the search string with the replace strings (see the Edit menu).</p>\n\n<p>With the default settings, typing a search string does not move around in the main window. Specifically (unlike Emacs, Safari, or Firefox), you don&rsquo;t move immediately to the first occurrence of the search string. You have to hit return or one of the search keys (in the Edit menu) for that to happen. But you can enable this in the General pane of the Editing tab in the preferences dialog. Click on &ldquo;Search using anchors&rdquo;. Now, when you search for a string, DrScheme will whizz you right to it and when you edit the search string, DrScheme will shift the insertion point based on the search string. In order for you to keep track of where edits will go, you&rsquo;ll see a funny looking little red dongle in your text. That&rsquo;s where the insertion point was when you started your search, and that&rsquo;s where DrScheme starts all of these implicit searches from.</p>\n\n<p>Try it out and let us know what you think! In particular, is the anchor-based search or the non-anchor-based search more intuitive for you?</p>\n<!-- more-->\n\n<hr />\n\n<p>It is better that it is intuitive or obvious to people how the anchoring works, then where it is anchored.</p>\n\n<p>Sure we&rsquo;ve all been trained by our favorite web browsers, but we&rsquo;re also fast learners ;).</p>\n\n<p>That said, I&rsquo;m quite used to the anchor being the start of the file.</p>\n\n<p>— <em>grant rettke, 30 July 2008</em></p>\n\n<hr />")) ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2009-03-12-maintaining-self-references-in-planet-packages.md" . unix) f post (u . "Maintaining self-references in Planet packages") (? . 68) 1467223812 (p+ #"/Users/MB/git/racket-lang-org/blog/2009/03/maintaining-self-references-in-planet-packages.html" . unix) "/2009/03/maintaining-self-references-in-planet-packages.html" (u . "2009-03-12T16:35:00.030-04:00") (? . 69) (? . 57) (c (u . "")) (u . "\n<p><em>posted by Carl Eastlund</em></p>\n\n<p><a href=\"http://docs.plt-scheme.org/planet/index.html\">PLaneT packages</a> may refer to themselves (i.e. include <a href=\"http://docs.plt-scheme.org/guide/module-paths.html\">module paths</a> referring to some part of the same package) for a number of reasons. One module may <a href=\"http://docs.plt-scheme.org/reference/require.html#%28form._%28%28lib._scheme/base..ss%29._require%29%29\">require</a> another. <a href=\"http://docs.plt-scheme.org/scribble/index.html\">Scribble</a> documentation traces <a href=\"http://docs.plt-scheme.org/reference/require.html#%28form._%28%28lib._scheme/base..ss%29._for-label%29%29\">for-label</a> imports to construct hypertext links. DrScheme <a href=\"http://docs.plt-scheme.org/tools/adding-languages.html\">language levels</a> may <a href=\"http://docs.plt-scheme.org/tools/drscheme_language.html#%28meth._%28%28%28lib._drscheme/tool-lib..ss%29._drscheme%7E3alanguage%7E3asimple-module-based-language%7E3c%7E25%7E3e%29._get-module%29%29\">provide a module path</a> for an initial <a href=\"http://docs.plt-scheme.org/guide/eval.html#%28part._namespaces%29\">namespace</a>.</p>\n\n<p>In each of these cases, we want the module path to refer to the <a href=\"http://docs.plt-scheme.org/planet/Using_PLaneT.html#%28part._.Fine-.Grained_.Control_.Over_.Package_.Imports%29\">same version</a> of the same package that it occurs in. On the other hand, we do not want to have to manually search and replace the version number every time we update. Before I solved this problem I would often release some new version x.0 of a package, only to find some lingering dependency on y.0 that my search/replace had not caught. Of course, then I had to go back and replace all occurrences of both x.0 and y.0 with x.1 and release again. To avoid this headache, we need a way to express self-referential module paths with precise, implicit version numbers.</p>\n\n<p>The built-in module paths don&rsquo;t quite support this. The relevant forms are PLaneT paths with version numbers, PLaneT paths without version numbers, and relative paths:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">planet</span> <span class=\"n\">my/package:1:0/dir/file</span><span class=\"p\">)</span>\n<span class=\"p\">(</span><span class=\"k\">planet</span> <span class=\"n\">my/package/dir/file</span><span class=\"p\">)</span>\n<span class=\"s2\">\"../dir/file.ss\"</span>\n</pre></div>\n\n</div>\n\n<p>PLaneT paths with version numbers suffer from the search and replace problem: they become obsolete, and must be changed with every new release.</p>\n\n<p>PLaneT paths without version numbers &ldquo;upgrade&rdquo; with a new release: they automatically refer to the latest version of a package. Unfortunately, this means they aren&rsquo;t really &ldquo;self&rdquo;-references. As soon as version 2.0 is released, every version-free reference to the package refers to 2.0. Even the references in version 1.0 get implicitly updated, and become forward references rather than self-references.</p>\n\n<p>Relative paths are precise, in that they always refer to the same version of the same package. However, because they implicitly refer to the directory containing the source code, they are only valid within a single file. They cannot be reliably passed to DrScheme for a language level namespace, traced for documentation links by Scribble, or used by other such external tools.</p>\n\n<p>None of these options provides precise, stable, externally comprehensible, self-referential module paths.</p>\n\n<p>To fill this need, I have released (planet <a href=\"http://planet.plt-scheme.org/package-source/cce/scheme.plt/4/1/planet-docs/main/planet.html\">cce/scheme:4:1/planet</a>). This module provides PLaneT package authors with several macros that construct references to the current package in require imports, Scribble documentation, and dynamic values. The self-referential modules paths are constructed automatically at compile time based on the <a href=\"http://docs.plt-scheme.org/reference/stxops.html\">source location</a> of the macro use and the <a href=\"http://docs.plt-scheme.org/planet/search-order.html#%28part._.Acceptable_.Local_.Package%29\">local PLaneT package database</a>. Their expanded form always includes an explicit package name and version number (both major and minor). Here I will summarize their use, with (planet my/package:1:0/dir/file) as a running example. For full details, see the <a href=\"http://planet.plt-scheme.org/package-source/cce/scheme.plt/4/1/planet-docs/main/index.html\">online documentation</a> or install the <a href=\"http://planet.plt-scheme.org/display.ss?package=scheme.plt&amp;amp;owner=cce\">package</a>.</p>\n\n<p>To import a module from within a PLaneT package, use the this-package-in require transformer. To re-export bindings from a module imported this way, use the this-package-out provide transformer, or use require/provide/this-package in place of both.</p>\n\n<p>For example, you might want to import and re-export bindings from dir/file:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">require</span> <span class=\"p\">(</span><span class=\"k\">planet</span> <span class=\"n\">my/package:1:0/dir/file</span><span class=\"p\">))</span>\n<span class=\"p\">(</span><span class=\"k\">provide</span> <span class=\"p\">(</span><span class=\"k\">all-from-out</span> <span class=\"p\">(</span><span class=\"k\">planet</span> <span class=\"n\">my/package:1:0/dir/file</span><span class=\"p\">)))</span>\n</pre></div>\n\n</div>\n\n<p>You can leave out the package name and version number, thus making the code invariant across upgrades, by writing:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">require</span> <span class=\"p\">(</span><span class=\"n\">this-package-in</span> <span class=\"n\">dir/file</span><span class=\"p\">))</span>\n<span class=\"p\">(</span><span class=\"k\">provide</span> <span class=\"p\">(</span><span class=\"n\">this-package-out</span> <span class=\"n\">dir/file</span><span class=\"p\">))</span>\n</pre></div>\n\n</div>\n\n<p>Or, you can further simplify it:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"n\">require/provide/this-package</span> <span class=\"n\">dir/file</span><span class=\"p\">)</span>\n</pre></div>\n\n</div>\n\n<p>All three of the above are equivalent (in version 1.0).</p>\n\n<p>In Scribble documentation, a module often refers to itself via <a href=\"http://docs.plt-scheme.org/scribble/doc-modules.html#%28form._%28%28lib._scribble/manual..ss%29._defmodule%29%29\">defmodule</a>, <a href=\"http://docs.plt-scheme.org/scribble/doc-modules.html#%28form._%28%28lib._scribble/manual..ss%29._declare-exporting%29%29\">declare-exporting</a>, or <a href=\"http://docs.plt-scheme.org/scribble/scribble_manual_code.html#%28form._%28%28lib._scribble/manual..ss%29._schememodname%29%29\">schememodname</a>. I provide the extensions defmodule/this-package, declare-exporting/this-package, and schememodname/this-package, respectively. These macros allow the user to supply a path such as dir/file, or to omit one to refer to the package as a whole (or its main module). In positions where the original macros allow a sequence of module paths, these forms allow two sequences, one for self-referential module paths and one for other paths.</p>\n\n<p>To document an entire module, one might first write:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"n\">defmodule</span> <span class=\"p\">(</span><span class=\"k\">planet</span> <span class=\"n\">my/package:1:0</span><span class=\"p\">))</span>\n</pre></div>\n\n</div>\n\n<p>The automatic self-reference version is simply:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"n\">defmodule/this-package</span><span class=\"p\">)</span>\n</pre></div>\n\n</div>\n\n<p>In more complicated cases, one might document a sub-part of a package or present bindings from multiple sources:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"n\">defmodule</span> <span class=\"p\">(</span><span class=\"k\">planet</span> <span class=\"n\">my/package:1:0/dir/file</span><span class=\"p\">)</span>\n  <span class=\"kd\">#:use-sources</span>\n  <span class=\"p\">[(</span><span class=\"k\">planet</span> <span class=\"n\">my/package:1:0/private/impl</span><span class=\"p\">)</span> <span class=\"n\">somewhere/else</span><span class=\"p\">])</span>\n</pre></div>\n\n</div>\n\n<p>These self-references can still be automated:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"n\">defmodule/this-package</span> <span class=\"n\">dir/file</span>\n  <span class=\"kd\">#:use-sources</span>\n  <span class=\"p\">[</span><span class=\"n\">private/impl</span><span class=\"p\">]</span>\n  <span class=\"p\">[</span><span class=\"n\">somewhere/else</span><span class=\"p\">])</span>\n</pre></div>\n\n</div>\n\n<p>Finally, I provide this-package-version-symbol for constructing PLaneT package symbols as runtime values. This macro is analogous to <a href=\"http://docs.plt-scheme.org/planet/Utility_Libraries.html#%28form._%28%28lib._planet/util..ss%29._this-package-version%29%29\">this-package-version</a> from the <a href=\"http://docs.plt-scheme.org/planet/Utility_Libraries.html#%28mod-path._planet/util%29\">planet/util</a> collection, but it constructs a symbol rather than an s-expression. You can use this symbol to construct a module path for a DrScheme language level, or escape it with unsyntax in Scribble&rsquo;s <a href=\"http://docs.plt-scheme.org/scribble/scribble_manual_code.html#%28form._%28%28lib._scribble/manual..ss%29._schemeblock%29%29\">schemeblock</a> typesetting to create self-referential example code.</p>\n\n<p>This list of utilities may not be complete. Users may need to write new macros for self-referential PLaneT packages. To that end, (planet <a href=\"http://planet.plt-scheme.org/package-source/cce/scheme.plt/4/1/planet-docs/main/syntax.html\">cce/scheme:4:1/syntax</a>) provides syntax-source-planet-package. This function is analogous to <a href=\"http://docs.plt-scheme.org/planet/Utility_Libraries.html#%28form._%28%28lib._planet/util..ss%29._this-package-version%29%29\">this-package-version</a>, but operates on <a href=\"http://docs.plt-scheme.org/guide/stx-obj.html\">syntax objects</a> and is designed to be used in <a href=\"http://docs.plt-scheme.org/guide/proc-macros.html\">macro transformers</a>. There are also -owner, -name, -major, -minor, and -symbol versions following the same analogy.</p>\n\n<p>I find these tools useful for maintaining my PLaneT packages, and I hope other authors will too. If you do give them a try, please send <a href=\"http://planet.plt-scheme.org/trac/newticket\">feedback</a> on what does or doesn&rsquo;t work, or what might be improved. I would eventually like to add a refined version to the PLT Scheme collections once we get enough experience to know that these tools are fairly complete and usable.</p>") #f (u . "\n<p><em>posted by Carl Eastlund</em></p>\n\n<p><a href=\"http://docs.plt-scheme.org/planet/index.html\">PLaneT packages</a> may refer to themselves (i.e. include <a href=\"http://docs.plt-scheme.org/guide/module-paths.html\">module paths</a> referring to some part of the same package) for a number of reasons. One module may <a href=\"http://docs.plt-scheme.org/reference/require.html#%28form._%28%28lib._scheme/base..ss%29._require%29%29\">require</a> another. <a href=\"http://docs.plt-scheme.org/scribble/index.html\">Scribble</a> documentation traces <a href=\"http://docs.plt-scheme.org/reference/require.html#%28form._%28%28lib._scheme/base..ss%29._for-label%29%29\">for-label</a> imports to construct hypertext links. DrScheme <a href=\"http://docs.plt-scheme.org/tools/adding-languages.html\">language levels</a> may <a href=\"http://docs.plt-scheme.org/tools/drscheme_language.html#%28meth._%28%28%28lib._drscheme/tool-lib..ss%29._drscheme%7E3alanguage%7E3asimple-module-based-language%7E3c%7E25%7E3e%29._get-module%29%29\">provide a module path</a> for an initial <a href=\"http://docs.plt-scheme.org/guide/eval.html#%28part._namespaces%29\">namespace</a>.</p>\n\n<p>In each of these cases, we want the module path to refer to the <a href=\"http://docs.plt-scheme.org/planet/Using_PLaneT.html#%28part._.Fine-.Grained_.Control_.Over_.Package_.Imports%29\">same version</a> of the same package that it occurs in. On the other hand, we do not want to have to manually search and replace the version number every time we update. Before I solved this problem I would often release some new version x.0 of a package, only to find some lingering dependency on y.0 that my search/replace had not caught. Of course, then I had to go back and replace all occurrences of both x.0 and y.0 with x.1 and release again. To avoid this headache, we need a way to express self-referential module paths with precise, implicit version numbers.</p>\n\n<p>The built-in module paths don&rsquo;t quite support this. The relevant forms are PLaneT paths with version numbers, PLaneT paths without version numbers, and relative paths:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">planet</span> <span class=\"n\">my/package:1:0/dir/file</span><span class=\"p\">)</span>\n<span class=\"p\">(</span><span class=\"k\">planet</span> <span class=\"n\">my/package/dir/file</span><span class=\"p\">)</span>\n<span class=\"s2\">\"../dir/file.ss\"</span>\n</pre></div>\n\n</div>\n\n<p>PLaneT paths with version numbers suffer from the search and replace problem: they become obsolete, and must be changed with every new release.</p>\n\n<p>PLaneT paths without version numbers &ldquo;upgrade&rdquo; with a new release: they automatically refer to the latest version of a package. Unfortunately, this means they aren&rsquo;t really &ldquo;self&rdquo;-references. As soon as version 2.0 is released, every version-free reference to the package refers to 2.0. Even the references in version 1.0 get implicitly updated, and become forward references rather than self-references.</p>\n\n<p>Relative paths are precise, in that they always refer to the same version of the same package. However, because they implicitly refer to the directory containing the source code, they are only valid within a single file. They cannot be reliably passed to DrScheme for a language level namespace, traced for documentation links by Scribble, or used by other such external tools.</p>\n\n<p>None of these options provides precise, stable, externally comprehensible, self-referential module paths.</p>\n\n<p>To fill this need, I have released (planet <a href=\"http://planet.plt-scheme.org/package-source/cce/scheme.plt/4/1/planet-docs/main/planet.html\">cce/scheme:4:1/planet</a>). This module provides PLaneT package authors with several macros that construct references to the current package in require imports, Scribble documentation, and dynamic values. The self-referential modules paths are constructed automatically at compile time based on the <a href=\"http://docs.plt-scheme.org/reference/stxops.html\">source location</a> of the macro use and the <a href=\"http://docs.plt-scheme.org/planet/search-order.html#%28part._.Acceptable_.Local_.Package%29\">local PLaneT package database</a>. Their expanded form always includes an explicit package name and version number (both major and minor). Here I will summarize their use, with (planet my/package:1:0/dir/file) as a running example. For full details, see the <a href=\"http://planet.plt-scheme.org/package-source/cce/scheme.plt/4/1/planet-docs/main/index.html\">online documentation</a> or install the <a href=\"http://planet.plt-scheme.org/display.ss?package=scheme.plt&amp;amp;owner=cce\">package</a>.</p>\n\n<p>To import a module from within a PLaneT package, use the this-package-in require transformer. To re-export bindings from a module imported this way, use the this-package-out provide transformer, or use require/provide/this-package in place of both.</p>\n\n<p>For example, you might want to import and re-export bindings from dir/file:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">require</span> <span class=\"p\">(</span><span class=\"k\">planet</span> <span class=\"n\">my/package:1:0/dir/file</span><span class=\"p\">))</span>\n<span class=\"p\">(</span><span class=\"k\">provide</span> <span class=\"p\">(</span><span class=\"k\">all-from-out</span> <span class=\"p\">(</span><span class=\"k\">planet</span> <span class=\"n\">my/package:1:0/dir/file</span><span class=\"p\">)))</span>\n</pre></div>\n\n</div>\n\n<p>You can leave out the package name and version number, thus making the code invariant across upgrades, by writing:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">require</span> <span class=\"p\">(</span><span class=\"n\">this-package-in</span> <span class=\"n\">dir/file</span><span class=\"p\">))</span>\n<span class=\"p\">(</span><span class=\"k\">provide</span> <span class=\"p\">(</span><span class=\"n\">this-package-out</span> <span class=\"n\">dir/file</span><span class=\"p\">))</span>\n</pre></div>\n\n</div>\n\n<p>Or, you can further simplify it:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"n\">require/provide/this-package</span> <span class=\"n\">dir/file</span><span class=\"p\">)</span>\n</pre></div>\n\n</div>\n\n<p>All three of the above are equivalent (in version 1.0).</p>\n\n<p>In Scribble documentation, a module often refers to itself via <a href=\"http://docs.plt-scheme.org/scribble/doc-modules.html#%28form._%28%28lib._scribble/manual..ss%29._defmodule%29%29\">defmodule</a>, <a href=\"http://docs.plt-scheme.org/scribble/doc-modules.html#%28form._%28%28lib._scribble/manual..ss%29._declare-exporting%29%29\">declare-exporting</a>, or <a href=\"http://docs.plt-scheme.org/scribble/scribble_manual_code.html#%28form._%28%28lib._scribble/manual..ss%29._schememodname%29%29\">schememodname</a>. I provide the extensions defmodule/this-package, declare-exporting/this-package, and schememodname/this-package, respectively. These macros allow the user to supply a path such as dir/file, or to omit one to refer to the package as a whole (or its main module). In positions where the original macros allow a sequence of module paths, these forms allow two sequences, one for self-referential module paths and one for other paths.</p>\n\n<p>To document an entire module, one might first write:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"n\">defmodule</span> <span class=\"p\">(</span><span class=\"k\">planet</span> <span class=\"n\">my/package:1:0</span><span class=\"p\">))</span>\n</pre></div>\n\n</div>\n\n<p>The automatic self-reference version is simply:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"n\">defmodule/this-package</span><span class=\"p\">)</span>\n</pre></div>\n\n</div>\n\n<p>In more complicated cases, one might document a sub-part of a package or present bindings from multiple sources:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"n\">defmodule</span> <span class=\"p\">(</span><span class=\"k\">planet</span> <span class=\"n\">my/package:1:0/dir/file</span><span class=\"p\">)</span>\n  <span class=\"kd\">#:use-sources</span>\n  <span class=\"p\">[(</span><span class=\"k\">planet</span> <span class=\"n\">my/package:1:0/private/impl</span><span class=\"p\">)</span> <span class=\"n\">somewhere/else</span><span class=\"p\">])</span>\n</pre></div>\n\n</div>\n\n<p>These self-references can still be automated:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"n\">defmodule/this-package</span> <span class=\"n\">dir/file</span>\n  <span class=\"kd\">#:use-sources</span>\n  <span class=\"p\">[</span><span class=\"n\">private/impl</span><span class=\"p\">]</span>\n  <span class=\"p\">[</span><span class=\"n\">somewhere/else</span><span class=\"p\">])</span>\n</pre></div>\n\n</div>\n\n<p>Finally, I provide this-package-version-symbol for constructing PLaneT package symbols as runtime values. This macro is analogous to <a href=\"http://docs.plt-scheme.org/planet/Utility_Libraries.html#%28form._%28%28lib._planet/util..ss%29._this-package-version%29%29\">this-package-version</a> from the <a href=\"http://docs.plt-scheme.org/planet/Utility_Libraries.html#%28mod-path._planet/util%29\">planet/util</a> collection, but it constructs a symbol rather than an s-expression. You can use this symbol to construct a module path for a DrScheme language level, or escape it with unsyntax in Scribble&rsquo;s <a href=\"http://docs.plt-scheme.org/scribble/scribble_manual_code.html#%28form._%28%28lib._scribble/manual..ss%29._schemeblock%29%29\">schemeblock</a> typesetting to create self-referential example code.</p>\n\n<p>This list of utilities may not be complete. Users may need to write new macros for self-referential PLaneT packages. To that end, (planet <a href=\"http://planet.plt-scheme.org/package-source/cce/scheme.plt/4/1/planet-docs/main/syntax.html\">cce/scheme:4:1/syntax</a>) provides syntax-source-planet-package. This function is analogous to <a href=\"http://docs.plt-scheme.org/planet/Utility_Libraries.html#%28form._%28%28lib._planet/util..ss%29._this-package-version%29%29\">this-package-version</a>, but operates on <a href=\"http://docs.plt-scheme.org/guide/stx-obj.html\">syntax objects</a> and is designed to be used in <a href=\"http://docs.plt-scheme.org/guide/proc-macros.html\">macro transformers</a>. There are also -owner, -name, -major, -minor, and -symbol versions following the same analogy.</p>\n\n<p>I find these tools useful for maintaining my PLaneT packages, and I hope other authors will too. If you do give them a try, please send <a href=\"http://planet.plt-scheme.org/trac/newticket\">feedback</a> on what does or doesn&rsquo;t work, or what might be improved. I would eventually like to add a refined version to the PLT Scheme collections once we get enough experience to know that these tools are fairly complete and usable.</p>")) ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2013-05-08-racketcon-2013.md" . unix) f post (u . "RacketCon 2013") (? . 97) 1467223812 (p+ #"/Users/MB/git/racket-lang-org/blog/2013/05/racketcon-2013.html" . unix) "/2013/05/racketcon-2013.html" (u . "2013-05-08T11:50:00.000-04:00") (? . 70) (? . 74) (c (u . "")) (u . "\n<p><em>posted by Asumu Takikawa</em></p>\n\n<p>We are pleased to announce that (thirdRacketCon) will take place on September 29, 2013 at Northeastern University in Boston. This year, we plan to bring in several speakers from industry, as well as host talks from Racket developers and users.</p>\n\n<p>Lunch will be provided.</p>\n\n<p>On the Saturday (28th) before RacketCon, we plan to hold a hackathon to work on various Racket projects.</p>\n\n<p>Registration will open during the summer, and we will post a detailed schedule of events around the same time. The conference website is at</p>\n\n<p><a href=\"http://con.racket-lang.org/\">http://con.racket-lang.org/</a></p>") #f (u . "\n<p><em>posted by Asumu Takikawa</em></p>\n\n<p>We are pleased to announce that (thirdRacketCon) will take place on September 29, 2013 at Northeastern University in Boston. This year, we plan to bring in several speakers from industry, as well as host talks from Racket developers and users.</p>\n\n<p>Lunch will be provided.</p>\n\n<p>On the Saturday (28th) before RacketCon, we plan to hold a hackathon to work on various Racket projects.</p>\n\n<p>Registration will open during the summer, and we will post a detailed schedule of events around the same time. The conference website is at</p>\n\n<p><a href=\"http://con.racket-lang.org/\">http://con.racket-lang.org/</a></p>")) ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2009-07-30-plt-scheme-v421.md" . unix) f post (u . "PLT Scheme v4.2.1") (? . 71) 1467223812 (p+ #"/Users/MB/git/racket-lang-org/blog/2009/07/plt-scheme-v421.html" . unix) "/2009/07/plt-scheme-v421.html" (u . "2009-07-30T08:24:00.001-04:00") (? . 72) (? . 98) (c (u . "")) (u . "\n<p><em>posted by Eli Barzilay</em></p>\n\n<p>PLT Scheme version 4.2.1 is now available from  <a href=\"http://plt-scheme.org/\"><code>http://plt-scheme.org/</code></a></p>\n\n<ul>\n <li>This is the last release that includes ProfessorJ. As of the next release, Kathy Gray who created and maintained the Professor will move the code to planet and maintain only at a minimal level.</li>\n <li>Typed Scheme 2.0 extends the type system significantly, making it more expressive. For example, predicates applied to selectors, such as (number? (car x)), are meaningful to the type system.</li>\n <li>Faster installation of Planet packages that trigger install of other Planet packages, because the documentation index is updated only once after a group of packages is installed.</li>\n <li>The <code>syntax/parse</code> library provides macro writers with an enhanced syntax pattern matcher that reports errors based on the patterns&rsquo; declared classes of syntax.</li>\n <li>Identifier mappings following the v4 dictionary interface and naming conventions are available from the <code>syntax/id-table</code> library.</li>\n <li>Redex: added <code>define-relation</code> and generalized patterns that appear in &ldquo;where&rdquo; clauses to use the full Redex pattern matcher. (This is a backwards incompatible change, but one often requested; see the Redex release notes for details.)</li>\n <li>The Web Server&rsquo;s serializable closures are now available for other purposes through the web-server/lang/serial-lambda library.</li>\n <li>Teachpacks: small changes to universe portion of the &ldquo;universe.ss&rdquo; API, plus the addition of a form for launching many (communicating) worlds simultaneously. Bug fixes concerning conversion to strings.</li>\n <li>It is now possible to create custom scribble readers with a command characters different than <code>@</code>, see <code>make-at-reader/inside</code> and <code>make-at-reader</code></li>\n <li>Note: this is likely to be the last release that includes a solaris distribution. If you need these builds, or if you have access to a (Sparc) Solaris machine than can be used in PLT builds, then please let me know.</li></ul>") #t (u . "\n<p><em>posted by Eli Barzilay</em></p>\n\n<p>PLT Scheme version 4.2.1 is now available from  <a href=\"http://plt-scheme.org/\"><code>http://plt-scheme.org/</code></a></p>\n\n<ul>\n <li>This is the last release that includes ProfessorJ. As of the next release, Kathy Gray who created and maintained the Professor will move the code to planet and maintain only at a minimal level.</li>\n <li>Typed Scheme 2.0 extends the type system significantly, making it more expressive. For example, predicates applied to selectors, such as (number? (car x)), are meaningful to the type system.</li>\n <li>Faster installation of Planet packages that trigger install of other Planet packages, because the documentation index is updated only once after a group of packages is installed.</li>\n <li>The <code>syntax/parse</code> library provides macro writers with an enhanced syntax pattern matcher that reports errors based on the patterns&rsquo; declared classes of syntax.</li>\n <li>Identifier mappings following the v4 dictionary interface and naming conventions are available from the <code>syntax/id-table</code> library.</li>\n <li>Redex: added <code>define-relation</code> and generalized patterns that appear in &ldquo;where&rdquo; clauses to use the full Redex pattern matcher. (This is a backwards incompatible change, but one often requested; see the Redex release notes for details.)</li>\n <li>The Web Server&rsquo;s serializable closures are now available for other purposes through the web-server/lang/serial-lambda library.</li>\n <li>Teachpacks: small changes to universe portion of the &ldquo;universe.ss&rdquo; API, plus the addition of a form for launching many (communicating) worlds simultaneously. Bug fixes concerning conversion to strings.</li>\n <li>It is now possible to create custom scribble readers with a command characters different than <code>@</code>, see <code>make-at-reader/inside</code> and <code>make-at-reader</code></li>\n <li>Note: this is likely to be the last release that includes a solaris distribution. If you need these builds, or if you have access to a (Sparc) Solaris machine than can be used in PLT builds, then please let me know.</li></ul>\n<!-- more-->\n\n<hr />\n\n<p>Hi, I have a Windows Laptop, and am getting &ldquo;Error launching installer&rdquo; for 4.2.1. My machine&rsquo;s particulars are: Microsoft Windows XP Professional Version 2002 Service Pack 3 Dell Latitude D630 Intel Core 2 Duo CPU T7250 @ 2.00GHz 1.99 GB of RAM</p>\n\n<p>— <em>y, 1 August 2009</em></p>\n\n<hr />")) ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2009-06-01-plt-scheme-v42.md" . unix) f post (u . "PLT Scheme v4.2") (? . 73) 1467223812 (p+ #"/Users/MB/git/racket-lang-org/blog/2009/06/plt-scheme-v42.html" . unix) "/2009/06/plt-scheme-v42.html" (u . "2009-06-01T14:41:00.001-04:00") (? . 75) (? . 72) (c (u . "")) (u . "\n<p><em>posted by Eli Barzilay</em></p>\n\n<p>PLT Scheme version 4.2 is now available from <a href=\"http://plt-scheme.org/\">http://plt-scheme.org/</a> Internally, this version includes a conversion from C++ to Scheme for part of the GUI toolbox &mdash; specifically, 25k lines of code that implement the general text and pasteboard editor. This conversion is a start on a larger reimplementation of the GUI toolbox. Although we believe that this change will help make PLT Scheme better in the long run, we must expect bugs in the short term due to porting errors. Users should therefore be aware of the change, even though the new implementation is meant to behave the same as previous versions.</p>\n\n<ul>\n <li>\n  <p>A new statistical profiler is now available; see the &ldquo;profiler&rdquo; manual for more information. Currently, the profiler supports only textual output, but future plans include a GUI interface and DrScheme integration.</p></li>\n <li>\n  <p>The <code>world</code> teachpack is now deprecated. Its replacement <code>universe</code> has a new interface that uses strings instead of symbols and characters.</p></li>\n <li>\n  <p>Web-server: Native continuations in the stateless servlet language support capturing continuations from untransformed contexts; soft state library for stateless servlets.</p></li>\n <li>\n  <p>DrScheme&rsquo;s Stepper can now jump to a selected program expression.</p></li>\n <li>\n  <p>New in <code>scheme/base</code>: <code>hash-has-key?</code>, <code>hash-ref!</code>, <code>in-sequences</code>, <code>in-cycle</code>. New in <code>scheme</code>: <code>count</code>, <code>make-list</code> (from <code>scheme/list</code>), <code>const</code> (from <code>scheme/function</code>).</p></li>\n <li>\n  <p>Some performance improvements, including faster start-up for small programs. The latter is a result of delaying module invocations at higher phases (compile time, meta-compile time, etc.) until compilation is demanded at the next lower phase; this on-demand instantiation is per-phase, as opposed to per-module within a phase.</p></li></ul>\n\n<p>[Note that mirror sites can take a while to catch up with the new downloads.]</p>\n\n<p>Feedback Welcome.</p>") #t (u . "\n<p><em>posted by Eli Barzilay</em></p>\n\n<p>PLT Scheme version 4.2 is now available from <a href=\"http://plt-scheme.org/\">http://plt-scheme.org/</a> Internally, this version includes a conversion from C++ to Scheme for part of the GUI toolbox &mdash; specifically, 25k lines of code that implement the general text and pasteboard editor. This conversion is a start on a larger reimplementation of the GUI toolbox. Although we believe that this change will help make PLT Scheme better in the long run, we must expect bugs in the short term due to porting errors. Users should therefore be aware of the change, even though the new implementation is meant to behave the same as previous versions.</p>\n\n<ul>\n <li>\n  <p>A new statistical profiler is now available; see the &ldquo;profiler&rdquo; manual for more information. Currently, the profiler supports only textual output, but future plans include a GUI interface and DrScheme integration.</p></li>\n <li>\n  <p>The <code>world</code> teachpack is now deprecated. Its replacement <code>universe</code> has a new interface that uses strings instead of symbols and characters.</p></li>\n <li>\n  <p>Web-server: Native continuations in the stateless servlet language support capturing continuations from untransformed contexts; soft state library for stateless servlets.</p></li>\n <li>\n  <p>DrScheme&rsquo;s Stepper can now jump to a selected program expression.</p></li>\n <li>\n  <p>New in <code>scheme/base</code>: <code>hash-has-key?</code>, <code>hash-ref!</code>, <code>in-sequences</code>, <code>in-cycle</code>. New in <code>scheme</code>: <code>count</code>, <code>make-list</code> (from <code>scheme/list</code>), <code>const</code> (from <code>scheme/function</code>).</p></li>\n <li>\n  <p>Some performance improvements, including faster start-up for small programs. The latter is a result of delaying module invocations at higher phases (compile time, meta-compile time, etc.) until compilation is demanded at the next lower phase; this on-demand instantiation is per-phase, as opposed to per-module within a phase.</p></li></ul>\n\n<p>[Note that mirror sites can take a while to catch up with the new downloads.]</p>\n\n<p>Feedback Welcome.</p>\n<!-- more-->\n\n<hr />\n\n<p>The rate of progress on PLT is quite impressive. I just wish that downloading and installing updates were a bit more automatic. Maybe it&rsquo;ll be included in 4.3? <em>crosses fingers</em> ;-)</p>\n\n<p>— <em>Kyle Cronin, 1 June 2009</em></p>\n\n<hr />\n\n<p>Kyle: You can check for updates from the help menu, and this will also have an option to check for updates every some time. When there is an update, you get the option of going to the website to download the new one. (Making the actual update happen automatically would be pretty difficult&hellip;)</p>\n\n<p>— <em>Eli Barzilay, 1 June 2009</em></p>\n\n<hr />\n\n<p>I tried to install the 4.2 version, and I got &ldquo;Error launching installer&rdquo;. I tried this multiple times from multiple mirrors. Doesn&rsquo;t work. My system is a laptop with: Windows XP Professional Version 2002 Service Pack 3, Intel Core 2 Duo CPU, T7250 @ 2.00GHz, 2GB RAM.</p>\n\n<p>— <em>y, 29 July 2009</em></p>\n\n<hr />\n\n<p>Hi</p>\n\n<p>I installed drscheme 4.2 recently and everything was fine and working until I restarted my system and when I tried running the development environment again I get a strange error, Uninstalling/Reinstalling even to another location does not help. please help me, I tried looking for a location wherin temporary or configuration data are stored, but i couldnt find any, this error seems to be related with the splash screen:</p>\n\n<p>draw-bitmap in dc(%): expected argument of type (bitmap% object&gt;) given #f</p>\n\n<p> === context === C:\\Users\\mehdi\\Documents\\PLT\\collects\\drscheme\\private\\drscheme-normal.ss:208:15</p>\n\n<p>I forgot, my OS is Vista Home Basic.</p>\n\n<p>Thank you.</p>\n\n<p>— <em>arcana, 29 July 2009</em></p>\n\n<hr />\n\n<p>Ok I have found the bug&hellip;</p>\n\n<p>How to explain this, 30th of july is the buggy day&hellip; May be it&rsquo;s because this is a special day, i&rsquo;ve heard that drscheme&rsquo;s splash screen shows information about the special days, and most likely, an icon or a bitmap is missing in there, that is why a &ldquo;false&rdquo; parameter is passed instead of a bitmap object.</p>\n\n<p>However, I&rsquo;ve taken a look at scheme-normal.ss, it seems that the special days are hard coded, unfortunately I&rsquo;m not even an American so I&rsquo;ve got no idea what special event is today!</p>\n\n<p>Anyway, sorry for disturbance !</p>\n\n<p>— <em>arcana, 29 July 2009</em></p>\n\n<hr />")) ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2013-05-29-marketplace-a-language-for-network-aware-programming.md" . unix) f post (u . "Marketplace: A language for network-aware programming") (? . 78) 1467223812 (p+ #"/Users/MB/git/racket-lang-org/blog/2013/05/marketplace-a-language-for-network-aware-programming.html" . unix) "/2013/05/marketplace-a-language-for-network-aware-programming.html" (u . "2013-05-29T17:43:00.000-04:00") (? . 74) (? . 77) (c (u . "")) (u . "\n<p><em>posted by Sam Tobin-Hochstadt</em></p>\n\n<p>We are happy to announce the release of Marketplace, a new programming language for building functional network programs. Marketplace combines two fundamental ideas in a new way: nested virtual machines and publish/subscribe messaging. Nesting allows programs to isolate processes and to delimit conversations. While publish/subscribe generalizes point-to-point and broadcast messaging, it smoothly turns the appearance and disappearance of participants and resources into presence and absence messages. Such messages make it particularly easy to start and stop services and to manage resources based on demand.</p>\n\n<p>Here is a simple TCP echo server written in Marketplace: </p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"kn\">#lang </span><span class=\"nn\">marketplace</span>\n \n<span class=\"p\">(</span><span class=\"n\">endpoint</span> <span class=\"kd\">#:subscriber</span> <span class=\"p\">(</span><span class=\"n\">tcp-channel</span> <span class=\"n\">?</span> <span class=\"p\">(</span><span class=\"n\">tcp-listener</span> <span class=\"mi\">5999</span><span class=\"p\">)</span> <span class=\"n\">?</span><span class=\"p\">)</span>\n          <span class=\"kd\">#:conversation</span> <span class=\"p\">(</span><span class=\"n\">tcp-channel</span> <span class=\"n\">from</span> <span class=\"n\">to</span> <span class=\"k\">_</span><span class=\"p\">)</span>\n          <span class=\"kd\">#:on-presence</span> <span class=\"p\">(</span><span class=\"n\">spawn</span> <span class=\"kd\">#:child</span> <span class=\"p\">(</span><span class=\"n\">echoer</span> <span class=\"n\">from</span> <span class=\"n\">to</span><span class=\"p\">)))</span>\n \n<span class=\"c1\">;; echoer: TcpAddress TcpAddress -&gt; Transition</span>\n<span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">echoer</span> <span class=\"n\">from</span> <span class=\"n\">to</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"n\">transition</span> <span class=\"n\">stateless</span>\n    <span class=\"p\">(</span><span class=\"n\">endpoint</span> <span class=\"kd\">#:subscriber</span> <span class=\"p\">(</span><span class=\"n\">tcp-channel</span> <span class=\"n\">from</span> <span class=\"n\">to</span> <span class=\"n\">?</span><span class=\"p\">)</span>\n              <span class=\"kd\">#:on-absence</span> <span class=\"p\">(</span><span class=\"n\">quit</span><span class=\"p\">)</span>\n              <span class=\"p\">[(</span><span class=\"n\">tcp-channel</span> <span class=\"k\">_</span> <span class=\"k\">_</span> <span class=\"n\">data</span><span class=\"p\">)</span>\n               <span class=\"p\">(</span><span class=\"n\">send-message</span> <span class=\"p\">(</span><span class=\"n\">tcp-channel</span> <span class=\"n\">to</span> <span class=\"n\">from</span> <span class=\"n\">data</span><span class=\"p\">))])))</span>\n</pre></div>\n\n</div>\n\n<p>The initial endpoint subscribes to TCP messages on port 5999. When a conversational partner appears, the endpoint spawns a new process that runs an echoer process. The latter is stateless and subscribes to TCP messages. When it gets messages with payload data, it sends them back out with the opposite addressing; when the TCP conversation disappears, it quits.</p>\n\n<p>Thus far, we have built several real systems using Marketplace: a DNS server, a DNS proxy, and an SSH server.</p>\n\n<p>The DNS proxy has handled DNS traffic for ourselves and other members of our lab for the last several months.</p>\n\n<p>You can read an overview along with detailed documentation for Marketplace at <a href=\"http://tonyg.github.io/marketplace/\">http://tonyg.github.io/marketplace/</a>.</p>\n\n<p>To get the sources for Marketplace as well as the applications point your browser to <a href=\"https://github.com/tonyg/marketplace\">https://github.com/tonyg/marketplace</a>.</p>\n\n<p>Enjoy!</p>\n\n<p>Tony Garnock-Jones</p>\n\n<p>Sam Tobin-Hochstadt</p>\n\n<p>Matthias Felleisen</p>") #t (u . "\n<p><em>posted by Sam Tobin-Hochstadt</em></p>\n\n<p>We are happy to announce the release of Marketplace, a new programming language for building functional network programs. Marketplace combines two fundamental ideas in a new way: nested virtual machines and publish/subscribe messaging. Nesting allows programs to isolate processes and to delimit conversations. While publish/subscribe generalizes point-to-point and broadcast messaging, it smoothly turns the appearance and disappearance of participants and resources into presence and absence messages. Such messages make it particularly easy to start and stop services and to manage resources based on demand.</p>\n\n<p>Here is a simple TCP echo server written in Marketplace: </p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"kn\">#lang </span><span class=\"nn\">marketplace</span>\n \n<span class=\"p\">(</span><span class=\"n\">endpoint</span> <span class=\"kd\">#:subscriber</span> <span class=\"p\">(</span><span class=\"n\">tcp-channel</span> <span class=\"n\">?</span> <span class=\"p\">(</span><span class=\"n\">tcp-listener</span> <span class=\"mi\">5999</span><span class=\"p\">)</span> <span class=\"n\">?</span><span class=\"p\">)</span>\n          <span class=\"kd\">#:conversation</span> <span class=\"p\">(</span><span class=\"n\">tcp-channel</span> <span class=\"n\">from</span> <span class=\"n\">to</span> <span class=\"k\">_</span><span class=\"p\">)</span>\n          <span class=\"kd\">#:on-presence</span> <span class=\"p\">(</span><span class=\"n\">spawn</span> <span class=\"kd\">#:child</span> <span class=\"p\">(</span><span class=\"n\">echoer</span> <span class=\"n\">from</span> <span class=\"n\">to</span><span class=\"p\">)))</span>\n \n<span class=\"c1\">;; echoer: TcpAddress TcpAddress -&gt; Transition</span>\n<span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">echoer</span> <span class=\"n\">from</span> <span class=\"n\">to</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"n\">transition</span> <span class=\"n\">stateless</span>\n    <span class=\"p\">(</span><span class=\"n\">endpoint</span> <span class=\"kd\">#:subscriber</span> <span class=\"p\">(</span><span class=\"n\">tcp-channel</span> <span class=\"n\">from</span> <span class=\"n\">to</span> <span class=\"n\">?</span><span class=\"p\">)</span>\n              <span class=\"kd\">#:on-absence</span> <span class=\"p\">(</span><span class=\"n\">quit</span><span class=\"p\">)</span>\n              <span class=\"p\">[(</span><span class=\"n\">tcp-channel</span> <span class=\"k\">_</span> <span class=\"k\">_</span> <span class=\"n\">data</span><span class=\"p\">)</span>\n               <span class=\"p\">(</span><span class=\"n\">send-message</span> <span class=\"p\">(</span><span class=\"n\">tcp-channel</span> <span class=\"n\">to</span> <span class=\"n\">from</span> <span class=\"n\">data</span><span class=\"p\">))])))</span>\n</pre></div>\n\n</div>\n\n<p>The initial endpoint subscribes to TCP messages on port 5999. When a conversational partner appears, the endpoint spawns a new process that runs an echoer process. The latter is stateless and subscribes to TCP messages. When it gets messages with payload data, it sends them back out with the opposite addressing; when the TCP conversation disappears, it quits.</p>\n\n<p>Thus far, we have built several real systems using Marketplace: a DNS server, a DNS proxy, and an SSH server.</p>\n\n<p>The DNS proxy has handled DNS traffic for ourselves and other members of our lab for the last several months.</p>\n\n<p>You can read an overview along with detailed documentation for Marketplace at <a href=\"http://tonyg.github.io/marketplace/\">http://tonyg.github.io/marketplace/</a>.</p>\n\n<p>To get the sources for Marketplace as well as the applications point your browser to <a href=\"https://github.com/tonyg/marketplace\">https://github.com/tonyg/marketplace</a>.</p>\n\n<p>Enjoy!</p>\n\n<p>Tony Garnock-Jones</p>\n\n<p>Sam Tobin-Hochstadt</p>\n\n<p>Matthias Felleisen</p>\n<!-- more-->\n\n<hr />\n\n<p>This looks really cool. I can&rsquo;t wait to try it out. How does it perform, and how robust is it against cracking attempts?</p>\n\n<p>— <em>Geoff Knauth, 30 May 2013</em></p>\n\n<hr />\n\n<p>Interesting. I guess it&rsquo;s inspired by Erlang. What&rsquo;s the reason for calling this a programming language, and not just a framework or library? I look forward to more information, and tutorials.</p>\n\n<p>— <em>Jon, 31 May 2013</em></p>\n\n<hr />\n\n<p>Geoff, we haven&rsquo;t yet tried to optimize this for performance, but the DNS proxy built with Marketplace serves all the DNS traffic for a bunch of people in our lab. As for security, that&rsquo;s all about what application you write using it.</p>\n\n<p>— <em>Sam Tobin-Hochstadt, 31 May 2013</em></p>\n\n<hr />\n\n<p>Jon, yes, Erlang is a big inspiration, among many other things. It&rsquo;s a language in the sense that it goes after <code>#lang</code>, and in the sense that it extends the programming model in a fundamental way. Ultimately, the distinction between framework, language, and library is fuzzy.</p>\n\n<p>— <em>Sam Tobin-Hochstadt, 31 May 2013</em></p>\n\n<hr />")) ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2009-05-25-typed-scheme-20.md" . unix) f post (u . "Typed Scheme 2.0") (? . 75) 1467223812 (p+ #"/Users/MB/git/racket-lang-org/blog/2009/05/typed-scheme-20.html" . unix) "/2009/05/typed-scheme-20.html" (u . "2009-05-25T13:47:00.003-04:00") (? . 76) (? . 73) (c (u . "")) (u . "\n<p><em>posted by Sam Tobin-Hochstadt</em></p>\n\n<p>Typed Scheme version 2.0 is now available from SVN.</p>\n\n<p>One persistent limitation of Typed Scheme has been that while this expression works as expected:</p>\n\n<p><code>(if (number? x) (add1 x) 7)</code></p>\n\n<p>The simple transformation of making <code>x</code> a part of a structure breaks Typed Scheme&rsquo;s ability to reason about the code. So this expression doesn&rsquo;t typecheck:</p>\n\n<p><code>(if (number? (car x)) (add1 (car x)) 7)</code></p>\n\n<p>With the newest version of Typed Scheme, now available in SVN, both of these will now work. In general, Typed Scheme can now follow paths into arbitrary immutable structures, including pairs.</p>\n\n<p>This is part of a more general reworking of underlying mechanisms of the Typed Scheme typechecker, which makes it both simpler and more flexible. I hope that it will be possible, sing this new foundation to add additional features that make more programs easy to express in Typed Scheme.</p>\n\n<p>Of course, these changes mean that Typed Scheme may be more unstable, so if you notice any new bugs, please let us know.</p>\n\n<p>Unfortunately, this won&rsquo;t be available in the upcoming 4.2 release, but it will be in the release after that.</p>\n\n<p>If you have any questions or comments or feature requests for Typed Scheme, please let us know.</p>") #f (u . "\n<p><em>posted by Sam Tobin-Hochstadt</em></p>\n\n<p>Typed Scheme version 2.0 is now available from SVN.</p>\n\n<p>One persistent limitation of Typed Scheme has been that while this expression works as expected:</p>\n\n<p><code>(if (number? x) (add1 x) 7)</code></p>\n\n<p>The simple transformation of making <code>x</code> a part of a structure breaks Typed Scheme&rsquo;s ability to reason about the code. So this expression doesn&rsquo;t typecheck:</p>\n\n<p><code>(if (number? (car x)) (add1 (car x)) 7)</code></p>\n\n<p>With the newest version of Typed Scheme, now available in SVN, both of these will now work. In general, Typed Scheme can now follow paths into arbitrary immutable structures, including pairs.</p>\n\n<p>This is part of a more general reworking of underlying mechanisms of the Typed Scheme typechecker, which makes it both simpler and more flexible. I hope that it will be possible, sing this new foundation to add additional features that make more programs easy to express in Typed Scheme.</p>\n\n<p>Of course, these changes mean that Typed Scheme may be more unstable, so if you notice any new bugs, please let us know.</p>\n\n<p>Unfortunately, this won&rsquo;t be available in the upcoming 4.2 release, but it will be in the release after that.</p>\n\n<p>If you have any questions or comments or feature requests for Typed Scheme, please let us know.</p>")) ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2013-06-18-racket-v535.md" . unix) f post (u . "Racket v5.3.5") (? . 77) 1467223812 (p+ #"/Users/MB/git/racket-lang-org/blog/2013/06/racket-v535.html" . unix) "/2013/06/racket-v535.html" (u . "2013-06-18T07:19:00.003-04:00") (? . 78) (? . 93) (c (u . "")) (u . "\n<p><em>posted by Eli Barzilay</em></p>\n\n<p>Racket version 5.3.5 is now available from <a href=\"http://racket-lang.org/\">http://racket-lang.org/</a> This is a special-purpose release to match the arrival of “Realm of Racket” in bookstores. Racket v5.3.5 adds a single <code>realm</code> collection to the v5.3.4 release. The new collection contains the source code that readers of Realm may wish to use for experiments.</p>") #f (u . "\n<p><em>posted by Eli Barzilay</em></p>\n\n<p>Racket version 5.3.5 is now available from <a href=\"http://racket-lang.org/\">http://racket-lang.org/</a> This is a special-purpose release to match the arrival of “Realm of Racket” in bookstores. Racket v5.3.5 adds a single <code>realm</code> collection to the v5.3.4 release. The new collection contains the source code that readers of Realm may wish to use for experiments.</p>")) ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2014-12-10-the-racket-package-system-and-planet.md" . unix) f post (u . "The Racket package system and PLaneT") (? . 79) 1467223812 (p+ #"/Users/MB/git/racket-lang-org/blog/2014/12/the-racket-package-system-and-planet.html" . unix) "/2014/12/the-racket-package-system-and-planet.html" (u . "2014-12-10T12:58:00.000-05:00") (? . 80) (? . 81) (c (u . "")) (u . "\n<p><em>posted by Jay McCarthy</em></p>\n\n<p>We have recently moved the majority of Racket&rsquo;s code base into packages and repositories separate from the main core repository. This has given the Racket package system another cycle of attention. Whenever this happens, there are often questions and confusion about how to solve various distribution problems with the package system. A natural point of comparison is the older PLaneT system provided by Racket that appears to solve similar problems. In this blog post, I attempt to explain the purpose of the package system and its relation to PLaneT.</p>\n\n<p>The package system and PLaneT do not solve the same problem and don&rsquo;t exist for the same reason.</p>\n\n<p>PLaneT is:</p>\n\n<ul>\n <li>\n  <p>A file distribution mechanism for source code.</p>\n  <p>Via <code>.plt</code> files that are installed into a particular place on your machine and then <code>raco setup</code>&rsquo;d.</p></li>\n <li>\n  <p>A mechanism for automatically downloading and installing source code just before it is needed by programs.</p>\n  <p>Via the <code>(planet ...)</code> require form.</p></li>\n <li>\n  <p>A centralized database of libraries</p>\n  <p>Via the PLaneT website and its server &amp; protocol which were undocumented and proprietary for the majority of PLaneT&rsquo;s life</p></li>\n <li>\n  <p>A prescriptive model of how programs and libraries should be composed.</p>\n  <p>Specifically the system of major/minor versions, tagging packages by author name, and embedding the names of packages in source code.</p></li></ul>\n\n<p>In contrast, the package system is:</p>\n\n<ul>\n <li>A file distribution mechanism for source code, byte code, and documentation. Via the <code>raco pkg</code> command.</li></ul>\n\n<p>In this way, the package system is almost identical to an operating system package system like Debian&rsquo;s dpkg and apt systems. The problem is very finely tailored and becomes more flexible as a result (notice that we can now distribute byte code and documentation.) This design aspires to follow the admonition of <a href=\"http://people.csail.mit.edu/jaffer/r3rs_2.html#SEC2\">holy writ</a>: &ldquo;Programming languages should be designed not by piling feature on top of feature, but by removing the weaknesses and restrictions that make additional features appear necessary.&rdquo;</p>\n\n<p>Furthermore, it was intended to solve practical problems throughout the Racket ecosystem. In particular, one of the common complaints people had and have about PLaneT is the very long install times because of long builds. The package system allows this problem to be solved by distributing pre-built code.</p>\n\n<p>Since the package system specifically does not address jobs 2, 3, or 4 of PLaneT, we have to ask, &ldquo;Do they need to be solved?&rdquo; and if so, &ldquo;How can we solve them on top of the package system, i.e. as a library in honor of the design principle?&rdquo;.</p>\n\n<p>In particular, 2 and 3 are very painful for people wanting to just use the file distribution mechanism of PLaneT. 2 causes unpredictability, because you don&rsquo;t know if running a program will start a long invocation of &ldquo;raco setup&rdquo;, require Internet access, and start running un-vetted code. 3 requires you to share your code if you want to use the file distribution mechanism and is a single point of failure for doing installation.</p>\n\n<p>By not mandating how to address 2 and 3 in the package system, we offer flexibility. Here is where the solutions to these jobs are now:</p>\n\n<ol>\n <li>\n  <p>There is currently no way to get automatic installs of packages. However, both DrRacket and xrepl offer advice about which packages you might want to install to compile and run the program. It would be natural to extend this advice to be automatic and patches are welcome. Given the experiences of operating systems which merely make suggestions (<code>nethack: command not found, provided by nethack-console</code>), I personally feel like we are at the sweet spot.</p></li>\n <li>\n  <p>The file distribution mechanism&rsquo;s flexible package sources combine with a very simple protocol for package catalogs (Take a URL, add<code>/pkg/</code>, add a string, get a <code>read</code>-able hash table) to look up packages you don&rsquo;t yet have. As a service, we run a few catalogs (one for each release, plus <a href=\"http://pkgs.racket-lang.org\">pkgs.r-l.o</a>). But we expect that users with special needs (such as sensitive installations that need exactly certain tested and trusted versions, especially with proprietary software) will build their own catalogs on private Web sites.</p></li></ol>\n\n<p>Clearly, however, job 4 is where PLaneT and the package system differ the most.</p>\n\n<p>With the package system, we follow the precedent of operating systems. An OS package&rsquo;s job is to get files into the right spot. An OS package contains a binary and instructions to install it as <code>/usr/bin/zsh</code>. It is not typical in OSes to be able to install multiple packages (such as different &ldquo;versions&rdquo; of the &ldquo;same&rdquo; package) that both provide <code>/usr/bin/zsh</code>. When you&rsquo;re at a Unix prompt, you don&rsquo;t have to write <code>zsh-5.0.5/usr/bin/zsh</code>. It&rsquo;s possible that many consider this is a big problem with OSes and indeed we do observe that it is fairly common to provide packages that provide binaries and libraries with embedded names such as how on my machine I have <code>python2.6</code>, <code>python2.7</code>, and <code>python3.2</code> all in my <code>$PATH</code>. It is important to realize, however, that the <code>deb</code> format and the <code>apt</code> tool didn&rsquo;t need to change to support this change or future changes in perspective in how to compose code.</p>\n\n<p>I hope this analogy helps understand the Racket package system. In the package system, a package doesn&rsquo;t install &ldquo;binaries&rdquo;, &ldquo;man pages&rdquo;, and &ldquo;init scripts&rdquo;, but installs similar things, such as &ldquo;module paths&rdquo;, &ldquo;documentation manuals&rdquo;, and \"<code>raco</code> commands\". Each of these has a notion of conflict: can&rsquo;t have two <code>zsh</code>s or two <code>racket/list</code>s; can&rsquo;t have two <code>zsh.1</code> pages or two docs named <code>doc</code>; can&rsquo;t have two modules trying to provide <code>raco neo-tokyo-is-about-to-explode</code>. If you find a random <code>.deb</code> on the Internet, can you predict what binaries it will contain from its name? No. The same goes for Racket packages. However, if you are egregiously weird, then people probably won&rsquo;t want to install your packages, just like for random <code>deb</code>s.</p>\n\n<p>However, clearly rules are helpful. In the world of operating systems, you know that basically all packages distributed by Debian can be installed at the same time, except for &ldquo;virtual packages&rdquo; that do stuff like selecting whether <code>postfix</code> or <code>sendmail</code> should be responsible for the <code>sendmail</code> command. These rules are not enforced through technology, though. Instead, the Debian maintainers have a social process that enforces them, with information being provided by technology (such as regression systems that identify unintended conflicts.) The catalog server that the Racket team provides helps facilitate a similar process with the concentric rings (all ring &lt;=1 packages can be installed at once and ring 1&lt; packages can do anything.)</p>\n\n<p>Non-conflicting sets of packages is the simplest rule to define and enforce. Other rules about backwards compatibility are much more complicated to define and enforce. I do not believe there is much precedent in the world of OSes, although we can see a little bit of what they do through things like <code>libgtk</code>, <code>libgtk2</code>, and <code>libgtk3</code>, where generally code written for one <code>libgtk2</code> package is compatible with all <code>libgtk2</code> packages made in the future, but <code>libgtk3</code> is effectively a totally different package and introduces totally separate binaries like <code>gtk3-config</code>.</p>\n\n<p>The most that the Racket team attempts to do here is to say, &ldquo;Here are the rules we will follow and we think you should follow them too.&rdquo; Specifically, that we will maintain backwards compatibility or make a new package. We can&rsquo;t and won&rsquo;t enforce this, nor do we always live up to it with our own work (but we feel really bad about it when we do.)</p>\n\n<p>Although my main goal of this section has been to explain my solution to (4), a great thing about the package system is that it is not binding at all. You can decide to follow the same rules as PLaneT. It is easy to do so:</p>\n\n<ul>\n <li>\n  <p>Always name your packages <code>$AUTHOR-$PACKAGE-$MAJOR</code></p></li>\n <li>\n  <p>Always provide modules from only the collection, <code>$AUTHOR-$PACKAGE-$MAJOR</code></p></li>\n <li>\n  <p>Maintain backwards compatibility within releases of <code>$AUTHOR-$PACKAGE-$MAJOR</code></p></li>\n <li>\n  <p>Update the <code>'version</code> metadata in the package <code>info.rkt</code> to reflect the <code>$MINOR</code> version.</p></li></ul>\n\n<p>And, boom!, you&rsquo;ve recreated the rules of PLaneT to a T except for two things: (a) you&rsquo;ll still need to put a dependency on <code>$AUTHOR-$PACKAGE-$MAJOR</code> on the outside of code in a package <code>info.rkt</code> file rather than just inside files and (b) you can&rsquo;t use <code>$AUTHOR-$PACKAGE</code> to refer to &ldquo;whatever the current <code>$MAJOR</code>&rdquo; is.</p>\n\n<p>The first compromise of adding something to the <code>info.rkt</code> is fairly modest, as it requires O(1) line modifications.</p>\n\n<p>The second compromise is more severe, although actually you could just maintain such a package and deal with the breakage that occurs when you try to upgrade. Such breakage, however, was present in PLaneT too, as when a package was installed based on <code>$AUTHOR-$PACKAGE</code> only the local machine would cache the version used, so if you took the requiring module to another machine, it would download a new version and, potentially, have a backwards incompatibility problem. Using the package system in the most naive way (i.e. installing the <code>$AUTHOR-$PACKAGE</code> at some point and programming to that) would work exactly the same as PLaneT, except that the package system was designed to be able to port installations from one machine to another with <code>raco pkg migrate</code>.</p>\n\n<p>I hope this blog post has helped explain the package system and shown that it does not prevent you from doing anything that PLaneT let you do, it only allows you to do more.</p>") #t (u . "\n<p><em>posted by Jay McCarthy</em></p>\n\n<p>We have recently moved the majority of Racket&rsquo;s code base into packages and repositories separate from the main core repository. This has given the Racket package system another cycle of attention. Whenever this happens, there are often questions and confusion about how to solve various distribution problems with the package system. A natural point of comparison is the older PLaneT system provided by Racket that appears to solve similar problems. In this blog post, I attempt to explain the purpose of the package system and its relation to PLaneT.</p>\n\n<p>The package system and PLaneT do not solve the same problem and don&rsquo;t exist for the same reason.</p>\n\n<p>PLaneT is:</p>\n\n<ul>\n <li>\n  <p>A file distribution mechanism for source code.</p>\n  <p>Via <code>.plt</code> files that are installed into a particular place on your machine and then <code>raco setup</code>&rsquo;d.</p></li>\n <li>\n  <p>A mechanism for automatically downloading and installing source code just before it is needed by programs.</p>\n  <p>Via the <code>(planet ...)</code> require form.</p></li>\n <li>\n  <p>A centralized database of libraries</p>\n  <p>Via the PLaneT website and its server &amp; protocol which were undocumented and proprietary for the majority of PLaneT&rsquo;s life</p></li>\n <li>\n  <p>A prescriptive model of how programs and libraries should be composed.</p>\n  <p>Specifically the system of major/minor versions, tagging packages by author name, and embedding the names of packages in source code.</p></li></ul>\n\n<p>In contrast, the package system is:</p>\n\n<ul>\n <li>A file distribution mechanism for source code, byte code, and documentation. Via the <code>raco pkg</code> command.</li></ul>\n\n<p>In this way, the package system is almost identical to an operating system package system like Debian&rsquo;s dpkg and apt systems. The problem is very finely tailored and becomes more flexible as a result (notice that we can now distribute byte code and documentation.) This design aspires to follow the admonition of <a href=\"http://people.csail.mit.edu/jaffer/r3rs_2.html#SEC2\">holy writ</a>: &ldquo;Programming languages should be designed not by piling feature on top of feature, but by removing the weaknesses and restrictions that make additional features appear necessary.&rdquo;</p>\n\n<p>Furthermore, it was intended to solve practical problems throughout the Racket ecosystem. In particular, one of the common complaints people had and have about PLaneT is the very long install times because of long builds. The package system allows this problem to be solved by distributing pre-built code.</p>\n\n<p>Since the package system specifically does not address jobs 2, 3, or 4 of PLaneT, we have to ask, &ldquo;Do they need to be solved?&rdquo; and if so, &ldquo;How can we solve them on top of the package system, i.e. as a library in honor of the design principle?&rdquo;.</p>\n\n<p>In particular, 2 and 3 are very painful for people wanting to just use the file distribution mechanism of PLaneT. 2 causes unpredictability, because you don&rsquo;t know if running a program will start a long invocation of &ldquo;raco setup&rdquo;, require Internet access, and start running un-vetted code. 3 requires you to share your code if you want to use the file distribution mechanism and is a single point of failure for doing installation.</p>\n\n<p>By not mandating how to address 2 and 3 in the package system, we offer flexibility. Here is where the solutions to these jobs are now:</p>\n\n<ol>\n <li>\n  <p>There is currently no way to get automatic installs of packages. However, both DrRacket and xrepl offer advice about which packages you might want to install to compile and run the program. It would be natural to extend this advice to be automatic and patches are welcome. Given the experiences of operating systems which merely make suggestions (<code>nethack: command not found, provided by nethack-console</code>), I personally feel like we are at the sweet spot.</p></li>\n <li>\n  <p>The file distribution mechanism&rsquo;s flexible package sources combine with a very simple protocol for package catalogs (Take a URL, add<code>/pkg/</code>, add a string, get a <code>read</code>-able hash table) to look up packages you don&rsquo;t yet have. As a service, we run a few catalogs (one for each release, plus <a href=\"http://pkgs.racket-lang.org\">pkgs.r-l.o</a>). But we expect that users with special needs (such as sensitive installations that need exactly certain tested and trusted versions, especially with proprietary software) will build their own catalogs on private Web sites.</p></li></ol>\n\n<p>Clearly, however, job 4 is where PLaneT and the package system differ the most.</p>\n\n<p>With the package system, we follow the precedent of operating systems. An OS package&rsquo;s job is to get files into the right spot. An OS package contains a binary and instructions to install it as <code>/usr/bin/zsh</code>. It is not typical in OSes to be able to install multiple packages (such as different &ldquo;versions&rdquo; of the &ldquo;same&rdquo; package) that both provide <code>/usr/bin/zsh</code>. When you&rsquo;re at a Unix prompt, you don&rsquo;t have to write <code>zsh-5.0.5/usr/bin/zsh</code>. It&rsquo;s possible that many consider this is a big problem with OSes and indeed we do observe that it is fairly common to provide packages that provide binaries and libraries with embedded names such as how on my machine I have <code>python2.6</code>, <code>python2.7</code>, and <code>python3.2</code> all in my <code>$PATH</code>. It is important to realize, however, that the <code>deb</code> format and the <code>apt</code> tool didn&rsquo;t need to change to support this change or future changes in perspective in how to compose code.</p>\n\n<p>I hope this analogy helps understand the Racket package system. In the package system, a package doesn&rsquo;t install &ldquo;binaries&rdquo;, &ldquo;man pages&rdquo;, and &ldquo;init scripts&rdquo;, but installs similar things, such as &ldquo;module paths&rdquo;, &ldquo;documentation manuals&rdquo;, and \"<code>raco</code> commands\". Each of these has a notion of conflict: can&rsquo;t have two <code>zsh</code>s or two <code>racket/list</code>s; can&rsquo;t have two <code>zsh.1</code> pages or two docs named <code>doc</code>; can&rsquo;t have two modules trying to provide <code>raco neo-tokyo-is-about-to-explode</code>. If you find a random <code>.deb</code> on the Internet, can you predict what binaries it will contain from its name? No. The same goes for Racket packages. However, if you are egregiously weird, then people probably won&rsquo;t want to install your packages, just like for random <code>deb</code>s.</p>\n\n<p>However, clearly rules are helpful. In the world of operating systems, you know that basically all packages distributed by Debian can be installed at the same time, except for &ldquo;virtual packages&rdquo; that do stuff like selecting whether <code>postfix</code> or <code>sendmail</code> should be responsible for the <code>sendmail</code> command. These rules are not enforced through technology, though. Instead, the Debian maintainers have a social process that enforces them, with information being provided by technology (such as regression systems that identify unintended conflicts.) The catalog server that the Racket team provides helps facilitate a similar process with the concentric rings (all ring &lt;=1 packages can be installed at once and ring 1&lt; packages can do anything.)</p>\n\n<p>Non-conflicting sets of packages is the simplest rule to define and enforce. Other rules about backwards compatibility are much more complicated to define and enforce. I do not believe there is much precedent in the world of OSes, although we can see a little bit of what they do through things like <code>libgtk</code>, <code>libgtk2</code>, and <code>libgtk3</code>, where generally code written for one <code>libgtk2</code> package is compatible with all <code>libgtk2</code> packages made in the future, but <code>libgtk3</code> is effectively a totally different package and introduces totally separate binaries like <code>gtk3-config</code>.</p>\n\n<p>The most that the Racket team attempts to do here is to say, &ldquo;Here are the rules we will follow and we think you should follow them too.&rdquo; Specifically, that we will maintain backwards compatibility or make a new package. We can&rsquo;t and won&rsquo;t enforce this, nor do we always live up to it with our own work (but we feel really bad about it when we do.)</p>\n\n<p>Although my main goal of this section has been to explain my solution to (4), a great thing about the package system is that it is not binding at all. You can decide to follow the same rules as PLaneT. It is easy to do so:</p>\n\n<ul>\n <li>\n  <p>Always name your packages <code>$AUTHOR-$PACKAGE-$MAJOR</code></p></li>\n <li>\n  <p>Always provide modules from only the collection, <code>$AUTHOR-$PACKAGE-$MAJOR</code></p></li>\n <li>\n  <p>Maintain backwards compatibility within releases of <code>$AUTHOR-$PACKAGE-$MAJOR</code></p></li>\n <li>\n  <p>Update the <code>'version</code> metadata in the package <code>info.rkt</code> to reflect the <code>$MINOR</code> version.</p></li></ul>\n\n<p>And, boom!, you&rsquo;ve recreated the rules of PLaneT to a T except for two things: (a) you&rsquo;ll still need to put a dependency on <code>$AUTHOR-$PACKAGE-$MAJOR</code> on the outside of code in a package <code>info.rkt</code> file rather than just inside files and (b) you can&rsquo;t use <code>$AUTHOR-$PACKAGE</code> to refer to &ldquo;whatever the current <code>$MAJOR</code>&rdquo; is.</p>\n\n<p>The first compromise of adding something to the <code>info.rkt</code> is fairly modest, as it requires O(1) line modifications.</p>\n\n<p>The second compromise is more severe, although actually you could just maintain such a package and deal with the breakage that occurs when you try to upgrade. Such breakage, however, was present in PLaneT too, as when a package was installed based on <code>$AUTHOR-$PACKAGE</code> only the local machine would cache the version used, so if you took the requiring module to another machine, it would download a new version and, potentially, have a backwards incompatibility problem. Using the package system in the most naive way (i.e. installing the <code>$AUTHOR-$PACKAGE</code> at some point and programming to that) would work exactly the same as PLaneT, except that the package system was designed to be able to port installations from one machine to another with <code>raco pkg migrate</code>.</p>\n\n<p>I hope this blog post has helped explain the package system and shown that it does not prevent you from doing anything that PLaneT let you do, it only allows you to do more.</p>\n<!-- more-->\n\n<hr />\n\n<p>I think node.js&rsquo;s package manager gets versioning right. NPM uses semver to manage dependency versions, and it works well. The node-semver package demonstrates how this versioning works. A semver string is then included a module&rsquo;s dependencies list, which can specify all sorts of things, including &ldquo;use the latest version of the library,&rdquo; &ldquo;use the latest version given a particular major.minor string,&rdquo; and &ldquo;use this precise major.minor.patch&rdquo; version.</p>\n\n<p>NPM handles the rest, downloading the correct version of the dependencies. The reason this is tricky is that this requires every module to have its own set of dependencies, since different modules can request different versions of packages. I&rsquo;m not sure exactly how Node handles loading multiple versions of the same dependency with regards to performance and interaction, though it might be worth looking into.</p>\n\n<p>In contrast, the Racket package manager provides very little versioning support, and packages have to be installed in an entire user or installation scope, rather than having module-specific dependency versioning. Is this bad? I don&rsquo;t know. But it&rsquo;s different, and I think NPM&rsquo;s model is worth considering.</p>\n\n<p>— <em>Alexis King, 9 January 2015</em></p>\n\n<hr />\n\n<p>NPM uses local packages. Essentially, every dependancy you install is local to your package, and no other packages can access them. Your dependancies, in turn have a tree of packages that you can&rsquo;t access. In other words, every single package gets a separate copy of its dependancies. This might seem terrible, but the node community is deeply rooted in UNIX, so most packages expose only a few functions doing one thing well, and so the overhead of having many copies is very low.</p>\n\n<p>— <em>g145, 4 September 2015</em></p>\n\n<hr />")) ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2013-01-31-racket-v532.md" . unix) f post (u . "Racket v5.3.2") (? . 82) 1467223812 (p+ #"/Users/MB/git/racket-lang-org/blog/2013/01/racket-v532.html" . unix) "/2013/01/racket-v532.html" (u . "2013-01-31T23:19:00.000-05:00") (? . 83) (? . 84) (c (u . "")) (u . "\n<p><em>posted by Eli Barzilay</em></p>\n\n<p>Racket version 5.3.2 is now available from <a href=\"http://racket-lang.org/\">http://racket-lang.org/</a> Core Libraries::</p>\n\n<ul>\n <li>\n  <p>The new <code>math</code> library provides functions and data structures for working with numbers and collections of numbers. Functions include non-elementary (such as gamma, zeta, Lambert&rsquo;s W), number-theoretic (factorization, modular arithmetic), linear algebra (arithmetic, decompositions), and statistical (expected values, order statistics, binning). Data structures include arbitrary-precision bigfloats, probability distributions, and multidimensional arrays.</p></li>\n <li>\n  <p>The new <code>file/untar</code>, <code>file/untgz</code>, and <code>file/unzip</code> libraries support unpacking widely used archive formats.</p></li>\n <li>\n  <p>The new <code>lazy-require</code> form allows programs to delay the loading and instantiation of helper modules until they are needed.</p></li>\n <li>\n  <p>The new <code>data/bit-vector</code> library provides an implementation of bit vectors (a mutable sequence of booleans) supporting popcount.</p></li>\n <li>\n  <p>The <code>racket/generic</code> library allows the specification of default method implementations for core datatypes.</p></li>\n <li>\n  <p>The <code>openssl</code> library can verify hostnames and use the operating system&rsquo;s certificate store to verify certificates.</p></li></ul>\n\n<p>Package System::</p>\n\n<ul>\n <li>\n  <p>A new package system is in beta release. This system will become Planet&rsquo;s successor. It differs significantly from the latter. For details, please read the documentation at <a href=\"http://docs.racket-lang.org/planet2/\">http://docs.racket-lang.org/planet2/</a> and list your packages on the new index at <a href=\"https://pkg.racket-lang.org/\">https://pkg.racket-lang.org/</a>.</p></li>\n <li>\n  <p>The <code>raco test</code> command supports testing by collection and package, in addition to by directory and file, with the <code>-c</code> and <code>-p</code> options.</p></li></ul>\n\n<p>Teaching Libraries::</p>\n\n<ul>\n <li>batch-io: the read and write functions work on Unix-style standard input and output.</li></ul>\n\n<p>DrRacket::</p>\n\n<ul>\n <li>\n  <p>DrRacket&rsquo;s GUI is more responsive.</p></li>\n <li>\n  <p>The automatic parenthesis insertion mode is improved.</p></li></ul>\n\n<p>Scribble::</p>\n\n<ul>\n <li>\n  <p>Scribble renders Markdown format files via the <code>--markdown</code> command-line flag. Example use case: Generate documentation hosted on GitHub or BitBucket.</p></li>\n <li>\n  <p>Documentation cross-reference information is stored in an SQLite3 database, which means that SQLite3 is required for building Racket documentation on Unix/Linux machines (but SQLite3 is included in Racket distributions for Windows and Mac OS X).</p></li></ul>\n\n<p> Using a database for cross-reference information significantly reduces the initial footprint of DrRacket, since DrRacket no longer needs to load all cross-reference information.</p>\n\n<p>Typed Racket::</p>\n\n<ul>\n <li>\n  <p>Typed Racket programs can require <code>plot/typed</code> to draw plots. List- and vector-accepting functions accept general sequences.</p></li>\n <li>\n  <p>Typed Racket supports Racket&rsquo;s delimited continuation and continuation mark operators.</p></li></ul>\n\n<p>Redex::</p>\n\n<ul>\n <li>Added more support for <code>define-judgment-form</code>, including random generation for well-formed judgments and visualization of judgments.</li></ul>\n\n<p>Deprecation::  The following have been removed in this release:</p>\n\n<ul>\n <li>the <code>planet</code> command-line tool; use <code>raco planet</code> instead.</li></ul>\n\n<p>The following has been deprecated and will be removed in the August 2013 release:</p>\n\n<ul>\n <li>the <code>mzlib/class100</code> library; use <code>racket/class</code> instead.</li></ul>") #f (u . "\n<p><em>posted by Eli Barzilay</em></p>\n\n<p>Racket version 5.3.2 is now available from <a href=\"http://racket-lang.org/\">http://racket-lang.org/</a> Core Libraries::</p>\n\n<ul>\n <li>\n  <p>The new <code>math</code> library provides functions and data structures for working with numbers and collections of numbers. Functions include non-elementary (such as gamma, zeta, Lambert&rsquo;s W), number-theoretic (factorization, modular arithmetic), linear algebra (arithmetic, decompositions), and statistical (expected values, order statistics, binning). Data structures include arbitrary-precision bigfloats, probability distributions, and multidimensional arrays.</p></li>\n <li>\n  <p>The new <code>file/untar</code>, <code>file/untgz</code>, and <code>file/unzip</code> libraries support unpacking widely used archive formats.</p></li>\n <li>\n  <p>The new <code>lazy-require</code> form allows programs to delay the loading and instantiation of helper modules until they are needed.</p></li>\n <li>\n  <p>The new <code>data/bit-vector</code> library provides an implementation of bit vectors (a mutable sequence of booleans) supporting popcount.</p></li>\n <li>\n  <p>The <code>racket/generic</code> library allows the specification of default method implementations for core datatypes.</p></li>\n <li>\n  <p>The <code>openssl</code> library can verify hostnames and use the operating system&rsquo;s certificate store to verify certificates.</p></li></ul>\n\n<p>Package System::</p>\n\n<ul>\n <li>\n  <p>A new package system is in beta release. This system will become Planet&rsquo;s successor. It differs significantly from the latter. For details, please read the documentation at <a href=\"http://docs.racket-lang.org/planet2/\">http://docs.racket-lang.org/planet2/</a> and list your packages on the new index at <a href=\"https://pkg.racket-lang.org/\">https://pkg.racket-lang.org/</a>.</p></li>\n <li>\n  <p>The <code>raco test</code> command supports testing by collection and package, in addition to by directory and file, with the <code>-c</code> and <code>-p</code> options.</p></li></ul>\n\n<p>Teaching Libraries::</p>\n\n<ul>\n <li>batch-io: the read and write functions work on Unix-style standard input and output.</li></ul>\n\n<p>DrRacket::</p>\n\n<ul>\n <li>\n  <p>DrRacket&rsquo;s GUI is more responsive.</p></li>\n <li>\n  <p>The automatic parenthesis insertion mode is improved.</p></li></ul>\n\n<p>Scribble::</p>\n\n<ul>\n <li>\n  <p>Scribble renders Markdown format files via the <code>--markdown</code> command-line flag. Example use case: Generate documentation hosted on GitHub or BitBucket.</p></li>\n <li>\n  <p>Documentation cross-reference information is stored in an SQLite3 database, which means that SQLite3 is required for building Racket documentation on Unix/Linux machines (but SQLite3 is included in Racket distributions for Windows and Mac OS X).</p></li></ul>\n\n<p> Using a database for cross-reference information significantly reduces the initial footprint of DrRacket, since DrRacket no longer needs to load all cross-reference information.</p>\n\n<p>Typed Racket::</p>\n\n<ul>\n <li>\n  <p>Typed Racket programs can require <code>plot/typed</code> to draw plots. List- and vector-accepting functions accept general sequences.</p></li>\n <li>\n  <p>Typed Racket supports Racket&rsquo;s delimited continuation and continuation mark operators.</p></li></ul>\n\n<p>Redex::</p>\n\n<ul>\n <li>Added more support for <code>define-judgment-form</code>, including random generation for well-formed judgments and visualization of judgments.</li></ul>\n\n<p>Deprecation::  The following have been removed in this release:</p>\n\n<ul>\n <li>the <code>planet</code> command-line tool; use <code>raco planet</code> instead.</li></ul>\n\n<p>The following has been deprecated and will be removed in the August 2013 release:</p>\n\n<ul>\n <li>the <code>mzlib/class100</code> library; use <code>racket/class</code> instead.</li></ul>")) ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2007-09-03-birthday-easter-eggs-in-drscheme.md" . unix) f post (u . "Birthday Easter Eggs in DrScheme") (? . 106) 1467223812 (p+ #"/Users/MB/git/racket-lang-org/blog/2007/09/birthday-easter-eggs-in-drscheme.html" . unix) "/2007/09/birthday-easter-eggs-in-drscheme.html" (u . "2007-09-03T18:26:00.001-04:00") (? . 104) (? . 125) (c (u . "")) (u . "\n<p><em>posted by Robby Findler</em></p>\n\n<p>DrScheme has five birthday easter eggs in it, one for each of the main contributers to the PLT Scheme infrastructure (<a href=\"http://www.ccs.neu.edu/%7Ematthias/\">Matthias</a>, <a href=\"http://www.cs.utah.edu/%7Emflatt/\">Matthew</a>, <a href=\"http://www.barzilay.org/\">Eli</a>, <a href=\"http://www.cs.brown.edu/%7Esk/\">Shriram</a>, and <a href=\"http://www.cs.uchicago.edu/%7Erobby/\">me</a>). I put four of them in there, and mostly concentrated on making them fun. Matthew added mine and the best part of that one is figuring out on earth it shows up (it is quite tricky to find the code that actually makes that one appear).</p>\n\n<p>I don&rsquo;t want to ruin the fun of searching for the Easter Eggs yourself, but just to get you started, do have a look at <code>plt/collects/framework/private/bday.ss</code>  for Matthias, Matthew, Shriram, and Eli&rsquo;s birthdays. Mine is July 2nd.</p>\n\n<p>Happy Hunting!</p>") #t (u . "\n<p><em>posted by Robby Findler</em></p>\n\n<p>DrScheme has five birthday easter eggs in it, one for each of the main contributers to the PLT Scheme infrastructure (<a href=\"http://www.ccs.neu.edu/%7Ematthias/\">Matthias</a>, <a href=\"http://www.cs.utah.edu/%7Emflatt/\">Matthew</a>, <a href=\"http://www.barzilay.org/\">Eli</a>, <a href=\"http://www.cs.brown.edu/%7Esk/\">Shriram</a>, and <a href=\"http://www.cs.uchicago.edu/%7Erobby/\">me</a>). I put four of them in there, and mostly concentrated on making them fun. Matthew added mine and the best part of that one is figuring out on earth it shows up (it is quite tricky to find the code that actually makes that one appear).</p>\n\n<p>I don&rsquo;t want to ruin the fun of searching for the Easter Eggs yourself, but just to get you started, do have a look at <code>plt/collects/framework/private/bday.ss</code>  for Matthias, Matthew, Shriram, and Eli&rsquo;s birthdays. Mine is July 2nd.</p>\n\n<p>Happy Hunting!</p>\n<!-- more-->\n\n<hr />\n\n<p>Happy Birthday!  Thanks a lot for this great program. I am using it in the Coursera class &ldquo;Introduction to Systematic Program Design&rdquo;. I am a beginner in programming and find it very nice to use. Have a wonderful day!</p>\n\n<p>— <em>Unknown, 2 July 2013</em></p>\n\n<hr />")) ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2014-02-26-racket-v60.md" . unix) f post (u . "Racket v6.0") (? . 85) 1467223812 (p+ #"/Users/MB/git/racket-lang-org/blog/2014/02/racket-v60.html" . unix) "/2014/02/racket-v60.html" (u . "2014-02-26T17:51:00.000-05:00") (? . 86) (? . 87) (c (u . "")) (u . "\n<p><em>posted by Ryan Culpepper</em></p>\n\n<p>Racket version 6.0 is now available from</p>\n\n<p><a href=\"http://racket-lang.org/\">http://racket-lang.org/</a></p>\n\n<p>Racket 6.0 has a new package system, including a catalog of hundreds of already-available packages. Please visit</p>\n\n<p><a href=\"http://pkgs.racket-lang.org/\">http://pkgs.racket-lang.org/</a></p>\n\n<p>for an overview of the packages.</p>\n\n<p>Racket versions 5.3.4 through 5.3.6 included &ldquo;beta&rdquo; versions of the package system. Racket version 6.0 incorporates many improvements suggested by preliminary experiences in those versions:</p>\n\n<ul>\n <li>\n  <p>A package is treated as a single collection by default, so it is even easier to use a GitHub repository as a package. Get started quickly:<a href=\"http://docs.racket-lang.org/pkg/getting-started.html\"> http://docs.racket-lang.org/pkg/getting-started.html</a></p></li>\n <li>\n  <p>DrRacket includes a new package manager GUI, available via the File|Package Manager &hellip; menu item. The GUI is also available as a stand-alone program via the &ldquo;gui-pkg-manager&rdquo; package.</p></li>\n <li>\n  <p>The main Racket distribution has been separated into about 200 packages. The Racket installer combines the core system with bundled versions of these packages.</p></li></ul>\n\n<p>Alternatively, you may now install a Minimal Racket distribution — which is about 1/10 the size of the main distribution — and add only those packages that you need.</p>\n\n<ul>\n <li>Package installation supports pre-built packages that include compiled byte code and rendered documentation, meaning packages can be installed quickly when built versions are available. All packages in the main distribution are available in pre-built form.</li></ul>\n\n<p>The recent 5.92 and 5.93 releases served as release candidates for 6.0, and 6.0 includes a few additional repairs related to the package system.</p>\n\n<p>Further improvements to the package system are in the works, notably including package documentation on the package-catalog web site.</p>\n\n<p>COMPATIBILITY NOTE: PLaneT, the previous Racket package system, will remain in place for the foreseeable future, but we expect all package work to shift to the new system.</p>\n\n<p>Beyond the package system, this release brings a number of other changes:</p>\n\n<ul>\n <li>\n  <p>Racket&rsquo;s HTML documentation has a new and improved look, thanks to Matthew Butterick.</p></li>\n <li>\n  <p>The documentation includes a style guide, <a href=\"http://docs.racket-lang.org/style/\">&ldquo;How to Program Racket&rdquo;</a>.</p></li>\n <li>\n  <p>Racket&rsquo;s JIT compiler supports the ARM architecture.</p></li>\n <li>\n  <p>Racket supports the Mac&rsquo;s Retina display mode.</p></li>\n <li>\n  <p>The performance of the Typed Racket compiler improved by 50% on some typed programs; e.g., see <a href=\"http://bit.ly/1d0Ye4z\">http://bit.ly/1d0Ye4z</a></p></li>\n <li>\n  <p>The profiler provides a new mode that uses the errortrace library to produce fine-grained profiles.</p></li>\n <li>\n  <p>A new contract profiler reports how much time programs spend checking contracts, and which contracts are most expensive.</p></li>\n <li>\n  <p>The math/flonum library exports fast 105-bit precision operations.</p></li>\n <li>\n  <p>Check Syntax handles generated identifiers, especially those introduced by struct (e.g. field selectors) and Redex (e.g., e_1, e_2)</p></li>\n <li>\n  <p>2htdp/batch-io includes functions for dealing with html/xml in files and web sites as X-expressions plus conveniences for web-based graph traversals.</p></li>\n <li>\n  <p>The `gen:set&rsquo; generic interface extends set operations to work on user-defined types that implement set methods, as well as on other set-like built-in types, such as lists.</p></li>\n <li>\n  <p>Picts support conversion to SVG format.</p></li>\n <li>\n  <p>Under unix, Racket provides desktop entries (.desktop files) for its graphical executables.</p></li></ul>") #t (u . "\n<p><em>posted by Ryan Culpepper</em></p>\n\n<p>Racket version 6.0 is now available from</p>\n\n<p><a href=\"http://racket-lang.org/\">http://racket-lang.org/</a></p>\n\n<p>Racket 6.0 has a new package system, including a catalog of hundreds of already-available packages. Please visit</p>\n\n<p><a href=\"http://pkgs.racket-lang.org/\">http://pkgs.racket-lang.org/</a></p>\n\n<p>for an overview of the packages.</p>\n\n<p>Racket versions 5.3.4 through 5.3.6 included &ldquo;beta&rdquo; versions of the package system. Racket version 6.0 incorporates many improvements suggested by preliminary experiences in those versions:</p>\n\n<ul>\n <li>\n  <p>A package is treated as a single collection by default, so it is even easier to use a GitHub repository as a package. Get started quickly:<a href=\"http://docs.racket-lang.org/pkg/getting-started.html\"> http://docs.racket-lang.org/pkg/getting-started.html</a></p></li>\n <li>\n  <p>DrRacket includes a new package manager GUI, available via the File|Package Manager &hellip; menu item. The GUI is also available as a stand-alone program via the &ldquo;gui-pkg-manager&rdquo; package.</p></li>\n <li>\n  <p>The main Racket distribution has been separated into about 200 packages. The Racket installer combines the core system with bundled versions of these packages.</p></li></ul>\n\n<p>Alternatively, you may now install a Minimal Racket distribution — which is about 1/10 the size of the main distribution — and add only those packages that you need.</p>\n\n<ul>\n <li>Package installation supports pre-built packages that include compiled byte code and rendered documentation, meaning packages can be installed quickly when built versions are available. All packages in the main distribution are available in pre-built form.</li></ul>\n\n<p>The recent 5.92 and 5.93 releases served as release candidates for 6.0, and 6.0 includes a few additional repairs related to the package system.</p>\n\n<p>Further improvements to the package system are in the works, notably including package documentation on the package-catalog web site.</p>\n\n<p>COMPATIBILITY NOTE: PLaneT, the previous Racket package system, will remain in place for the foreseeable future, but we expect all package work to shift to the new system.</p>\n\n<p>Beyond the package system, this release brings a number of other changes:</p>\n\n<ul>\n <li>\n  <p>Racket&rsquo;s HTML documentation has a new and improved look, thanks to Matthew Butterick.</p></li>\n <li>\n  <p>The documentation includes a style guide, <a href=\"http://docs.racket-lang.org/style/\">&ldquo;How to Program Racket&rdquo;</a>.</p></li>\n <li>\n  <p>Racket&rsquo;s JIT compiler supports the ARM architecture.</p></li>\n <li>\n  <p>Racket supports the Mac&rsquo;s Retina display mode.</p></li>\n <li>\n  <p>The performance of the Typed Racket compiler improved by 50% on some typed programs; e.g., see <a href=\"http://bit.ly/1d0Ye4z\">http://bit.ly/1d0Ye4z</a></p></li>\n <li>\n  <p>The profiler provides a new mode that uses the errortrace library to produce fine-grained profiles.</p></li>\n <li>\n  <p>A new contract profiler reports how much time programs spend checking contracts, and which contracts are most expensive.</p></li>\n <li>\n  <p>The math/flonum library exports fast 105-bit precision operations.</p></li>\n <li>\n  <p>Check Syntax handles generated identifiers, especially those introduced by struct (e.g. field selectors) and Redex (e.g., e_1, e_2)</p></li>\n <li>\n  <p>2htdp/batch-io includes functions for dealing with html/xml in files and web sites as X-expressions plus conveniences for web-based graph traversals.</p></li>\n <li>\n  <p>The `gen:set&rsquo; generic interface extends set operations to work on user-defined types that implement set methods, as well as on other set-like built-in types, such as lists.</p></li>\n <li>\n  <p>Picts support conversion to SVG format.</p></li>\n <li>\n  <p>Under unix, Racket provides desktop entries (.desktop files) for its graphical executables.</p></li></ul>\n<!-- more-->\n\n<hr />\n\n<p>How do I install the minimal set? So far I can only find it mentioned in announcements but can never find any instruction.</p>\n\n<p>— <em>Yi D, 27 February 2014</em></p>\n\n<hr />\n\n<p>To install Minimal Racket, follow the &ldquo;All Versions&rdquo; link from the download page, and then click \"[download Racket Minimal]\" on the first row of the table.</p>\n\n<p>We plan to revise the download page so that the Minimal Racket option easier to find.</p>\n\n<p>— <em>Matthew Flatt, 27 February 2014</em></p>\n\n<hr />\n\n<p>Will there be a section on compiling for ARM? Is it possible to target Android and use NDK? I have not been finding much on this.</p>\n\n<p>— <em>Chris Gill, 19 March 2014</em></p>\n\n<hr />\n\n<p>Why don&rsquo;t you provide source packages?</p>\n\n<p>— <em>Des Nerger, 27 April 2014</em></p>\n\n<hr />")) ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2014-10-07-plt-redex-summer-school-call-for-participation.md" . unix) f post (u . "PLT Redex Summer School, Call for Participation") (? . 100) 1467223812 (p+ #"/Users/MB/git/racket-lang-org/blog/2014/10/plt-redex-summer-school-call-for-participation.html" . unix) "/2014/10/plt-redex-summer-school-call-for-participation.html" (u . "2014-10-07T11:30:00.000-04:00") (? . 88) (? . 89) (c (u . "")) (u . "\n<p><em>posted by Robby Findler</em></p>\n\n<p>LOCATION: University of Utah, Salt Lake City</p>\n\n<p>DATES: July 27 - July 31, 2015</p>\n\n<p><a href=\"http://www.cs.utah.edu/~mflatt/plt-redex/\">http://www.cs.utah.edu/~mflatt/plt-redex/</a></p>\n\n<p>PLT Redex is a lightweight, embedded DSL for modeling programming languages, their reduction semantics, and their type systems. It comes with an IDE and a toolbox for exploring, testing, debugging, and type-setting language models. The PLT research group has successfully used Redex to model and analyze a wide spectrum of published models.</p>\n\n<p>The summer school will introduce students to the underlying theory of reduction semantics, programming in the Redex language, and using its tool suite effectively. The course is intended for PhD students and researchers in programming languages. Enrollment is limited to 25 attendees.</p>\n\n<p>While the workshop itself is free, attendees must pay for travel, room, and board. We expect room and board to be around $500, assuming an arrival in the evening of Sunday July 26 and leaving Friday July 31 or August 1. Partial financial support for PhD students is available.</p>\n\n<p>To register, send email to Matthew Flatt (mflatt@cs.utah.edu). If you are a PhD student and requesting financial support, CC your advisor and ask for a one-line confirmation email.</p>\n\n<p>Literature</p>\n\n<p> Matthias Felleisen, Robert Bruce Findler, Matthew Flatt. <em>Semantics Engineering with PLT Redex</em>. MIT Press, 2012.</p>\n\n<p> Casey Klein, John Clements, Christos Dimoulas, Carl Eastlund, Matthias Felleisen, Matthew Flatt, Jay McCarthy, Jon Rafkind, Sam Tobin-Hochstadt, Robert Bruce Findler. <em>Run Your Research: On the Effectiveness of Lightweight Mechanization</em>. POPL 2012.</p>") #f (u . "\n<p><em>posted by Robby Findler</em></p>\n\n<p>LOCATION: University of Utah, Salt Lake City</p>\n\n<p>DATES: July 27 - July 31, 2015</p>\n\n<p><a href=\"http://www.cs.utah.edu/~mflatt/plt-redex/\">http://www.cs.utah.edu/~mflatt/plt-redex/</a></p>\n\n<p>PLT Redex is a lightweight, embedded DSL for modeling programming languages, their reduction semantics, and their type systems. It comes with an IDE and a toolbox for exploring, testing, debugging, and type-setting language models. The PLT research group has successfully used Redex to model and analyze a wide spectrum of published models.</p>\n\n<p>The summer school will introduce students to the underlying theory of reduction semantics, programming in the Redex language, and using its tool suite effectively. The course is intended for PhD students and researchers in programming languages. Enrollment is limited to 25 attendees.</p>\n\n<p>While the workshop itself is free, attendees must pay for travel, room, and board. We expect room and board to be around $500, assuming an arrival in the evening of Sunday July 26 and leaving Friday July 31 or August 1. Partial financial support for PhD students is available.</p>\n\n<p>To register, send email to Matthew Flatt (mflatt@cs.utah.edu). If you are a PhD student and requesting financial support, CC your advisor and ask for a one-line confirmation email.</p>\n\n<p>Literature</p>\n\n<p> Matthias Felleisen, Robert Bruce Findler, Matthew Flatt. <em>Semantics Engineering with PLT Redex</em>. MIT Press, 2012.</p>\n\n<p> Casey Klein, John Clements, Christos Dimoulas, Carl Eastlund, Matthias Felleisen, Matthew Flatt, Jay McCarthy, Jon Rafkind, Sam Tobin-Hochstadt, Robert Bruce Findler. <em>Run Your Research: On the Effectiveness of Lightweight Mechanization</em>. POPL 2012.</p>")) ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2007-08-03-experience-report-scheme-in-commercial-web-application-development.md" . unix) f post (u . "Experience Report: Scheme in Commercial Web Application Development") (? . 114) 1467223812 (p+ #"/Users/MB/git/racket-lang-org/blog/2007/08/experience-report-scheme-in-commercial-web-application-development.html" . unix) "/2007/08/experience-report-scheme-in-commercial-web-application-development.html" (u . "2007-08-03T05:35:00.000-04:00") (? . 90) (? . 91) (c (u . "")) (u . "\n<p><em>posted by Noel</em></p>\n\n<p>Our paper &ldquo;Experience Report: Scheme in Commercial Web Application Development&rdquo; is online. As the title suggests, it describes our experiences over the past year developing a number of web-based applications in PLT Scheme. If we&rsquo;d chosen a language like Java or Ruby we could have used a large number of libraries developed for web apps, whereas PLT Scheme has relatively few libraries in this area, and they haven&rsquo;t been tested under high load. So we were gambling that Scheme would make us so productive we could develop our own libraries <em>and</em> the applications we were contracted to produce in the same time it would take to develop just the applications in another language. It was a gamble that paid off. You&rsquo;ll have to read the paper for all the details, but suffice to say we delivered the applications on time (and more are in development) and our libraries already compare well against big names like Ruby on Rails and J2EE.</p>\n\n<p>On thing that got cut from the paper was our use of <a href=\"http://www.flapjax-lang.org/\">Flapjax</a> is parts of the interface. If you write complicated Javascript to take a look at it. It really does simplify event handling, and our code using Flapjax is half the size of our original code without it.</p>\n\n<p><strong>Update:</strong> This is more or less the same post as on <a href=\"http://www.untyped.com/untyping/archives/2007/08/a_scheme_case_s_1.html\">Untyping</a></p>") #t (u . "\n<p><em>posted by Noel</em></p>\n\n<p>Our paper &ldquo;Experience Report: Scheme in Commercial Web Application Development&rdquo; is online. As the title suggests, it describes our experiences over the past year developing a number of web-based applications in PLT Scheme. If we&rsquo;d chosen a language like Java or Ruby we could have used a large number of libraries developed for web apps, whereas PLT Scheme has relatively few libraries in this area, and they haven&rsquo;t been tested under high load. So we were gambling that Scheme would make us so productive we could develop our own libraries <em>and</em> the applications we were contracted to produce in the same time it would take to develop just the applications in another language. It was a gamble that paid off. You&rsquo;ll have to read the paper for all the details, but suffice to say we delivered the applications on time (and more are in development) and our libraries already compare well against big names like Ruby on Rails and J2EE.</p>\n\n<p>On thing that got cut from the paper was our use of <a href=\"http://www.flapjax-lang.org/\">Flapjax</a> is parts of the interface. If you write complicated Javascript to take a look at it. It really does simplify event handling, and our code using Flapjax is half the size of our original code without it.</p>\n\n<p><strong>Update:</strong> This is more or less the same post as on <a href=\"http://www.untyped.com/untyping/archives/2007/08/a_scheme_case_s_1.html\">Untyping</a></p>\n<!-- more-->\n\n<hr />\n\n<p>Does anyone happen to know the scale of the use of scheme or lisp as a web side server language used by MIT&rsquo;s Electrical Engineering Computer Science department in 6.001 or other classes?</p>\n\n<p>— <em>Aaron, 8 August 2007</em></p>\n\n<hr />\n\n<p>I took 6.001 in in the Spring of 2005, and we did not use scheme (our variant was MIT Scheme) for any server-side scripting. Come to think of it, we didn&rsquo;t do much of any server-side work, although we built a web crawler as a project.</p>\n\n<p>— <em>Brad, 19 September 2007</em></p>\n\n<hr />\n\n<p>Great.Thank you for the Report. what is the difference commercial and business Web Application Development.</p>\n\n<p>— <em>suhan, 2 December 2011</em></p>\n\n<hr />")) ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2013-08-10-racket-v536.md" . unix) f post (u . "Racket v5.3.6") (? . 92) 1467223812 (p+ #"/Users/MB/git/racket-lang-org/blog/2013/08/racket-v536.html" . unix) "/2013/08/racket-v536.html" (u . "2013-08-10T08:57:00.001-04:00") (? . 93) (? . 86) (c (u . "")) (u . "\n<p><em>posted by Eli Barzilay</em></p>\n\n<p>Racket version 5.3.6 is now available from <a href=\"http://racket-lang.org/\">http://racket-lang.org/</a> Racket v5.3.6 is a bug-fix release. It eliminates errors from v5.3.5 that people have found over the summer.</p>") #f (u . "\n<p><em>posted by Eli Barzilay</em></p>\n\n<p>Racket version 5.3.6 is now available from <a href=\"http://racket-lang.org/\">http://racket-lang.org/</a> Racket v5.3.6 is a bug-fix release. It eliminates errors from v5.3.5 that people have found over the summer.</p>")) ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2008-07-04-plt-scheme-v402.md" . unix) f post (u . "PLT Scheme v4.0.2") (? . 67) 1467223812 (p+ #"/Users/MB/git/racket-lang-org/blog/2008/07/plt-scheme-v402.html" . unix) "/2008/07/plt-scheme-v402.html" (u . "2008-07-04T21:05:00.002-04:00") (? . 22) (? . 66) (c (u . "")) (u . "\n<p><em>posted by Eli Barzilay</em></p>\n\n<p>PLT Scheme version 4.0.2 is now available from</p>\n\n<p> <a href=\"http://plt-scheme.org/\">http://plt-scheme.org/</a> This release fixes a bug that caused PLaneT packages to install abnormally slow in 4.0.1.</p>\n\n<p>[ For those that use the nightly builds, subversion, or 4.0.1tsrj2008, you already have this fix (and even more fixes). You do not need to upgrade. The version in svn is now 4.0.2.3 to minimize confusion. ]</p>\n\n<p>Feedback Welcome.</p>") #t (u . "\n<p><em>posted by Eli Barzilay</em></p>\n\n<p>PLT Scheme version 4.0.2 is now available from</p>\n\n<p> <a href=\"http://plt-scheme.org/\">http://plt-scheme.org/</a> This release fixes a bug that caused PLaneT packages to install abnormally slow in 4.0.1.</p>\n\n<p>[ For those that use the nightly builds, subversion, or 4.0.1tsrj2008, you already have this fix (and even more fixes). You do not need to upgrade. The version in svn is now 4.0.2.3 to minimize confusion. ]</p>\n\n<p>Feedback Welcome.</p>\n<!-- more-->\n\n<hr />\n\n<p>On behalf of a faculty pusblisher i would like to ask if is there someone that can point me the best way to address a message concerning the authorization for distribution of the &ldquo;Dr. Scheme&rdquo; application in a CD-ROM that will include an eBook in Portuguese called : how to programme in scheme.</p>\n\n<p>Can anyone help me?</p>\n\n<p>you can write me to feuped@fe.up.pt</p>\n\n<p>— <em>nportela, 6 August 2008</em></p>\n\n<hr />")) ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2012-04-02-scribble-your-blogs.md" . unix) f post (u . "Scribble Your Blogs") (? . 94) 1467223812 (p+ #"/Users/MB/git/racket-lang-org/blog/2012/04/scribble-your-blogs.html" . unix) "/2012/04/scribble-your-blogs.html" (u . "2012-04-02T18:46:00.000-04:00") (? . 45) (? . 95) (c (u . "")) (u . "\n<p><em>posted by Ryan Culpepper</em></p>\n\n<p>Scribble is a great language for writing documentation. Now it&rsquo;s a great language for writing blog posts, too. I&rsquo;ve just released a tool called Scriblogify that compiles Scribble documents and posts them as blog entries. Scriblogify is a more polished and automated version of the scripts I&rsquo;ve been using for several months to prepare posts for <a href=\"http://macrologist.blogspot.com\">my own blog</a>.</p>\n\n<p>To get Scriblogify, just download it from <a href=\"http://planet.racket-lang.org/\">PLaneT</a>:</p>\n\n<p><code>(require(planetryanc/scriblogify:1))</code></p>\n\n<p>or</p>\n\n<p><code>raco planet install ryanc scriblogify.plt 1 0</code></p>\n\n<p>The package automatically installs a raco subcommand (<code>raco scriblogify</code>) that can be used to configure Scriblogify and process and upload blog posts.</p>\n\n<p>Configure Scriblogify by running</p>\n\n<p><code>raco scriblogify --setup</code></p>\n\n<p>That will open a browser window with the Scriblogify configuration servlet. The servlet will prompt you to authorize Scriblogify to access your Blogger and Picasa Web Albums accounts (only the Blogger/Picasa combination is currently supported) and then create one or more profiles—named combinations of blogs and web albums to upload to.</p>\n\n<p>Scriblogify automatically handles images computed in your Scribble documents by uploading them to a web album. For example, here are some images computed with the slideshow/pict library:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"nb\">&gt;</span> <span class=\"p\">(</span><span class=\"k\">require</span> <span class=\"n\">slideshow/pict</span><span class=\"p\">)</span>\n<span class=\"nb\">&gt;</span> <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"n\">rainbow-colors</span>\n    <span class=\"o\">&#39;</span><span class=\"p\">(</span><span class=\"s2\">\"red\"</span> <span class=\"s2\">\"orange\"</span> <span class=\"s2\">\"yellow\"</span> <span class=\"s2\">\"green\"</span> <span class=\"s2\">\"blue\"</span> <span class=\"s2\">\"purple\"</span><span class=\"p\">))</span>\n<span class=\"nb\">&gt;</span> <span class=\"p\">(</span><span class=\"k\">for/list</span> <span class=\"p\">([</span><span class=\"n\">c</span> <span class=\"n\">rainbow-colors</span><span class=\"p\">])</span>\n    <span class=\"p\">(</span><span class=\"n\">colorize</span> <span class=\"p\">(</span><span class=\"n\">filled-rounded-rectangle</span> <span class=\"mi\">20</span> <span class=\"mi\">20</span><span class=\"p\">)</span> <span class=\"n\">c</span><span class=\"p\">))</span>\n<span class=\"o\">&#39;</span><span class=\"p\">(</span><span class=\"ss\">image</span> <span class=\"ss\">image</span> <span class=\"ss\">image</span> <span class=\"ss\">image</span> <span class=\"ss\">image</span> <span class=\"ss\">image</span><span class=\"p\">)</span>\n\n<span class=\"nb\">&gt;</span> <span class=\"p\">(</span><span class=\"k\">for/list</span> <span class=\"p\">([</span><span class=\"n\">c</span> <span class=\"n\">rainbow-colors</span><span class=\"p\">]</span>\n             <span class=\"p\">[</span><span class=\"n\">dir</span> <span class=\"p\">(</span><span class=\"nb\">in-cycle</span> <span class=\"o\">&#39;</span><span class=\"p\">(</span><span class=\"ss\">right</span> <span class=\"ss\">left</span><span class=\"p\">))])</span>\n    <span class=\"p\">(</span><span class=\"n\">standard-fish</span> <span class=\"mi\">25</span> <span class=\"mi\">25</span> <span class=\"kd\">#:color</span> <span class=\"n\">c</span> <span class=\"kd\">#:direction</span> <span class=\"n\">dir</span><span class=\"p\">))</span>\n<span class=\"o\">&#39;</span><span class=\"p\">(</span><span class=\"ss\">image</span> <span class=\"ss\">image</span> <span class=\"ss\">image</span> <span class=\"ss\">image</span> <span class=\"ss\">image</span> <span class=\"ss\">image</span><span class=\"p\">)</span>\n\n<span class=\"nb\">&gt;</span> <span class=\"p\">(</span><span class=\"n\">cc-superimpose</span>\n   <span class=\"p\">(</span><span class=\"n\">cc-superimpose</span> <span class=\"p\">(</span><span class=\"n\">cloud</span> <span class=\"mi\">100</span> <span class=\"mi\">80</span> <span class=\"s2\">\"lightblue\"</span><span class=\"p\">)</span>\n                   <span class=\"p\">(</span><span class=\"n\">cloud</span> <span class=\"mi\">90</span> <span class=\"mi\">70</span> <span class=\"s2\">\"white\"</span><span class=\"p\">))</span>\n   <span class=\"p\">(</span><span class=\"n\">hc-append</span> <span class=\"mi\">10</span>\n    <span class=\"p\">(</span><span class=\"n\">standard-fish</span> <span class=\"mi\">30</span> <span class=\"mi\">30</span> <span class=\"kd\">#:color</span> <span class=\"s2\">\"red\"</span> <span class=\"kd\">#:direction</span> <span class=\"o\">&#39;</span><span class=\"ss\">right</span><span class=\"p\">)</span>\n    <span class=\"p\">(</span><span class=\"n\">standard-fish</span> <span class=\"mi\">25</span> <span class=\"mi\">20</span> <span class=\"kd\">#:color</span> <span class=\"s2\">\"blue\"</span> <span class=\"kd\">#:direction</span> <span class=\"o\">&#39;</span><span class=\"ss\">left</span><span class=\"p\">)))</span>\n<span class=\"n\">image</span>\n</pre></div>\n\n</div>\n\n<p>By Scribbling your blog entries, you get Scribble&rsquo;s nice code formatting, colorizing, and documentation links for free—well, once you&rsquo;ve updated your blog&rsquo;s CSS (see below). If you&rsquo;re blogging about bleeding-edge work, there&rsquo;s an option to make Scriblogify link to the <a href=\"http://pre.racket-lang.org/docs/html/\">nightly build docs</a> (updated daily) instead of the <a href=\"http://docs.racket-lang.org/\">release docs</a> (updated every 3 months).</p>\n\n<p>Scriblogify&rsquo;s documentation has more details, including how to update your blog&rsquo;s CSS for Scribbled content and what bloggable Scribble documents look like.You can see the source for this blog post <a href=\"https://github.com/rmculpepper/scriblogify/blob/v1.0/samples/scribble-your-blogs.scrbl\">here</a>. This blog entry was created with the following command:raco  <code>scriblogify -p the-racket-blog scribble-your-blogs.scrbl</code></p>\n\n<p>Now go forth and Scribble your blogs.</p>") #t (u . "\n<p><em>posted by Ryan Culpepper</em></p>\n\n<p>Scribble is a great language for writing documentation. Now it&rsquo;s a great language for writing blog posts, too. I&rsquo;ve just released a tool called Scriblogify that compiles Scribble documents and posts them as blog entries. Scriblogify is a more polished and automated version of the scripts I&rsquo;ve been using for several months to prepare posts for <a href=\"http://macrologist.blogspot.com\">my own blog</a>.</p>\n\n<p>To get Scriblogify, just download it from <a href=\"http://planet.racket-lang.org/\">PLaneT</a>:</p>\n\n<p><code>(require(planetryanc/scriblogify:1))</code></p>\n\n<p>or</p>\n\n<p><code>raco planet install ryanc scriblogify.plt 1 0</code></p>\n\n<p>The package automatically installs a raco subcommand (<code>raco scriblogify</code>) that can be used to configure Scriblogify and process and upload blog posts.</p>\n\n<p>Configure Scriblogify by running</p>\n\n<p><code>raco scriblogify --setup</code></p>\n\n<p>That will open a browser window with the Scriblogify configuration servlet. The servlet will prompt you to authorize Scriblogify to access your Blogger and Picasa Web Albums accounts (only the Blogger/Picasa combination is currently supported) and then create one or more profiles—named combinations of blogs and web albums to upload to.</p>\n\n<p>Scriblogify automatically handles images computed in your Scribble documents by uploading them to a web album. For example, here are some images computed with the slideshow/pict library:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"nb\">&gt;</span> <span class=\"p\">(</span><span class=\"k\">require</span> <span class=\"n\">slideshow/pict</span><span class=\"p\">)</span>\n<span class=\"nb\">&gt;</span> <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"n\">rainbow-colors</span>\n    <span class=\"o\">&#39;</span><span class=\"p\">(</span><span class=\"s2\">\"red\"</span> <span class=\"s2\">\"orange\"</span> <span class=\"s2\">\"yellow\"</span> <span class=\"s2\">\"green\"</span> <span class=\"s2\">\"blue\"</span> <span class=\"s2\">\"purple\"</span><span class=\"p\">))</span>\n<span class=\"nb\">&gt;</span> <span class=\"p\">(</span><span class=\"k\">for/list</span> <span class=\"p\">([</span><span class=\"n\">c</span> <span class=\"n\">rainbow-colors</span><span class=\"p\">])</span>\n    <span class=\"p\">(</span><span class=\"n\">colorize</span> <span class=\"p\">(</span><span class=\"n\">filled-rounded-rectangle</span> <span class=\"mi\">20</span> <span class=\"mi\">20</span><span class=\"p\">)</span> <span class=\"n\">c</span><span class=\"p\">))</span>\n<span class=\"o\">&#39;</span><span class=\"p\">(</span><span class=\"ss\">image</span> <span class=\"ss\">image</span> <span class=\"ss\">image</span> <span class=\"ss\">image</span> <span class=\"ss\">image</span> <span class=\"ss\">image</span><span class=\"p\">)</span>\n\n<span class=\"nb\">&gt;</span> <span class=\"p\">(</span><span class=\"k\">for/list</span> <span class=\"p\">([</span><span class=\"n\">c</span> <span class=\"n\">rainbow-colors</span><span class=\"p\">]</span>\n             <span class=\"p\">[</span><span class=\"n\">dir</span> <span class=\"p\">(</span><span class=\"nb\">in-cycle</span> <span class=\"o\">&#39;</span><span class=\"p\">(</span><span class=\"ss\">right</span> <span class=\"ss\">left</span><span class=\"p\">))])</span>\n    <span class=\"p\">(</span><span class=\"n\">standard-fish</span> <span class=\"mi\">25</span> <span class=\"mi\">25</span> <span class=\"kd\">#:color</span> <span class=\"n\">c</span> <span class=\"kd\">#:direction</span> <span class=\"n\">dir</span><span class=\"p\">))</span>\n<span class=\"o\">&#39;</span><span class=\"p\">(</span><span class=\"ss\">image</span> <span class=\"ss\">image</span> <span class=\"ss\">image</span> <span class=\"ss\">image</span> <span class=\"ss\">image</span> <span class=\"ss\">image</span><span class=\"p\">)</span>\n\n<span class=\"nb\">&gt;</span> <span class=\"p\">(</span><span class=\"n\">cc-superimpose</span>\n   <span class=\"p\">(</span><span class=\"n\">cc-superimpose</span> <span class=\"p\">(</span><span class=\"n\">cloud</span> <span class=\"mi\">100</span> <span class=\"mi\">80</span> <span class=\"s2\">\"lightblue\"</span><span class=\"p\">)</span>\n                   <span class=\"p\">(</span><span class=\"n\">cloud</span> <span class=\"mi\">90</span> <span class=\"mi\">70</span> <span class=\"s2\">\"white\"</span><span class=\"p\">))</span>\n   <span class=\"p\">(</span><span class=\"n\">hc-append</span> <span class=\"mi\">10</span>\n    <span class=\"p\">(</span><span class=\"n\">standard-fish</span> <span class=\"mi\">30</span> <span class=\"mi\">30</span> <span class=\"kd\">#:color</span> <span class=\"s2\">\"red\"</span> <span class=\"kd\">#:direction</span> <span class=\"o\">&#39;</span><span class=\"ss\">right</span><span class=\"p\">)</span>\n    <span class=\"p\">(</span><span class=\"n\">standard-fish</span> <span class=\"mi\">25</span> <span class=\"mi\">20</span> <span class=\"kd\">#:color</span> <span class=\"s2\">\"blue\"</span> <span class=\"kd\">#:direction</span> <span class=\"o\">&#39;</span><span class=\"ss\">left</span><span class=\"p\">)))</span>\n<span class=\"n\">image</span>\n</pre></div>\n\n</div>\n\n<p>By Scribbling your blog entries, you get Scribble&rsquo;s nice code formatting, colorizing, and documentation links for free—well, once you&rsquo;ve updated your blog&rsquo;s CSS (see below). If you&rsquo;re blogging about bleeding-edge work, there&rsquo;s an option to make Scriblogify link to the <a href=\"http://pre.racket-lang.org/docs/html/\">nightly build docs</a> (updated daily) instead of the <a href=\"http://docs.racket-lang.org/\">release docs</a> (updated every 3 months).</p>\n\n<p>Scriblogify&rsquo;s documentation has more details, including how to update your blog&rsquo;s CSS for Scribbled content and what bloggable Scribble documents look like.You can see the source for this blog post <a href=\"https://github.com/rmculpepper/scriblogify/blob/v1.0/samples/scribble-your-blogs.scrbl\">here</a>. This blog entry was created with the following command:raco  <code>scriblogify -p the-racket-blog scribble-your-blogs.scrbl</code></p>\n\n<p>Now go forth and Scribble your blogs.</p>\n<!-- more-->\n\n<hr />\n\n<p>This comment has been removed by the author.</p>\n\n<p>— <em>Unknown, 2 April 2012</em></p>\n\n<hr />\n\n<p>This is awesome! I actually rolled my own Scribble-blog hack at http://cscheid.net (click on any post and you can see the scribble source).</p>\n\n<p>If I could run this on my own backend, I&rsquo;d love to get rid of my kludgy setup.</p>\n\n<p>— <em>Unknown, 2 April 2012</em></p>\n\n<hr />")) ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2012-06-03-submodules.md" . unix) f post (u . "Submodules") (? . 95) 1467223812 (p+ #"/Users/MB/git/racket-lang-org/blog/2012/06/submodules.html" . unix) "/2012/06/submodules.html" (u . "2012-06-03T02:10:00.000-04:00") (? . 94) (? . 96) (c (u . "")) (u . "\n<p><em>posted by Matthew Flatt</em></p>\n\n<p>A Racket submodule is a module that is syntactically nested within another module. Submodules will be supported in the next release of Racket, and they are available in the current <a href=\"http://pre.racket-lang.org/installers/\">pre-release version</a>.</p>\n\n<p>Submodules provide nested namespaces, but that kind of nesting is already available through forms like <code>define-package</code>. The power of submodules is that they can be separately loaded and separately run relative to their enclosing modules, in the same way that top-level modules can be separately load and run. This separation of dependencies means that submodules can be used to add code and information to modules—such as tests, documentation, and parsing information—that is loaded only when specifically requested.</p>\n\n<h2 id=\"the-main-submodule\">The <code>main</code> Submodule</h2>\n\n<p>One use of a submodule is to declare a <code>main</code> submodule. A <code>main</code> submodule is instantiated when the enclosing module is run as the main program, but not when the enclosing module is used as a library.</p>\n\n<p><code>\"fish.rkt\"</code></p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"kn\">#lang </span><span class=\"nn\">racket/base</span>\n<span class=\"p\">(</span><span class=\"k\">provide</span> <span class=\"n\">fish</span><span class=\"p\">)</span>\n<span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"n\">fish</span> <span class=\"o\">&#39;</span><span class=\"p\">(</span><span class=\"mi\">1</span> <span class=\"mi\">2</span><span class=\"p\">))</span>\n<span class=\"p\">(</span><span class=\"k\">module+</span> <span class=\"n\">main</span>\n  <span class=\"p\">(</span><span class=\"nb\">map</span> <span class=\"nb\">displayln</span> <span class=\"n\">fish</span><span class=\"p\">))</span>\n</pre></div>\n\n</div>\n\n<p><code>\"sum-fish.rkt\"</code></p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"kn\">#lang </span><span class=\"nn\">racket/base</span>\n<span class=\"p\">(</span><span class=\"k\">require</span> <span class=\"s2\">\"fish.rkt\"</span><span class=\"p\">)</span>\n<span class=\"p\">(</span><span class=\"nb\">apply</span> <span class=\"nb\">+</span> <span class=\"n\">fish</span><span class=\"p\">)</span>\n</pre></div>\n\n</div>\n\n<p>The <code>\"fish.rkt\"</code> module exports fish as a list of numbers. Running <code>\"sum-fish.rkt\"</code>, which imports <code>\"fish.rkt\"</code>, prints the sum of the numbers. Running <code>\"fish.rkt\"</code> directly, however, triggers the instantiation of the main submodule within <code>\"fish.rkt\"</code>, which displays each number in fish on its own line.</p>\n\n<p>A <code>(module+ main ....)</code> declaration is similar to the Python <code>if __name__ == \"__main__\":</code> idiom, but with a significant difference. Importing <code>\"fish.rkt\"</code> into another module ignores the main submodule completely, so that the main submodule’s code and its dependencies aren’t loaded.</p>\n\n<h2 id=\"unit-tests\">Unit Tests</h2>\n\n<p>Another use for submodules—and one where independent loading matters more than for <code>\"fish.rkt\"</code>’s <code>main</code>—is for test suites. A <code>main</code> submodule could be used for tests, so that running the module runs its tests, but our preferred convention is to declare a <code>test</code> submodule:</p>\n\n<p><code>\"fish2.rkt\"</code></p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"kn\">#lang </span><span class=\"nn\">racket/base</span>\n<span class=\"p\">(</span><span class=\"k\">provide</span> <span class=\"n\">fish</span><span class=\"p\">)</span>\n<span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"n\">fish</span> <span class=\"o\">&#39;</span><span class=\"p\">(</span><span class=\"mi\">1</span> <span class=\"mi\">2</span><span class=\"p\">))</span>\n<span class=\"p\">(</span><span class=\"k\">module+</span> <span class=\"n\">test</span>\n  <span class=\"p\">(</span><span class=\"k\">require</span> <span class=\"n\">rackunit</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"n\">check</span> <span class=\"nb\">andmap</span> <span class=\"nb\">number?</span> <span class=\"n\">fish</span><span class=\"p\">))</span>\n</pre></div>\n\n</div>\n\n<p>The new <code>raco test</code> shell command runs the <code>test</code> submodule of a given module, so that <code>raco test fish2.rkt</code> checks that all the values of the <code>fish</code> list are numbers. The <code>test</code> submodule imports <code>rackunit</code> for its check form, but that import does not create a dependency on <code>rackunit</code> (which is a substantial library) for modules that import <code>\"fish2.rkt\"</code>; the dependency is only for the test submodule.</p>\n\n<p>The <code>module+</code> form creates a dependency of the submodule on the enclosing module, since it implicitly imports all bindings of its enclosing module. The implicit import explains why the test submodule in <code>\"fish2.rkt\"</code> can use fish directly (i.e., it’s not simply because the submodule is syntactically nested). The implicit import includes all bindings from the enclosing module, including bindings that are not exported via provide, which supports unit tests for unexported functions.</p>\n\n<p>Finally, the <code>module+</code> form splices together multiple declarations of a particular submodule, which is useful for interleaving definitions and tests:</p>\n\n<p><code>\"fish3.rkt\"</code></p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"kn\">#lang </span><span class=\"nn\">racket/base</span>\n<span class=\"p\">(</span><span class=\"k\">provide</span> <span class=\"n\">fish</span> <span class=\"n\">feed</span><span class=\"p\">)</span>\n<span class=\"p\">(</span><span class=\"k\">module+</span> <span class=\"n\">test</span> <span class=\"p\">(</span><span class=\"k\">require</span> <span class=\"n\">rackunit</span><span class=\"p\">))</span>\n<span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"n\">fish</span> <span class=\"o\">&#39;</span><span class=\"p\">(</span><span class=\"mi\">1</span> <span class=\"mi\">2</span><span class=\"p\">))</span>\n<span class=\"p\">(</span><span class=\"k\">module+</span> <span class=\"n\">test</span> <span class=\"p\">(</span><span class=\"n\">check</span> <span class=\"nb\">andmap</span> <span class=\"nb\">number?</span> <span class=\"n\">fish</span><span class=\"p\">))</span>\n<span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">feed</span> <span class=\"n\">n</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"nb\">+</span> <span class=\"n\">n</span> <span class=\"mi\">1</span><span class=\"p\">))</span>\n<span class=\"p\">(</span><span class=\"k\">module+</span> <span class=\"n\">test</span> <span class=\"p\">(</span><span class=\"n\">check-equal?</span> <span class=\"mi\">3</span> <span class=\"p\">(</span><span class=\"n\">feed</span> <span class=\"mi\">2</span><span class=\"p\">)))</span>\n</pre></div>\n\n</div>\n\n<p>Since tests are isolated to a submodule, it might make sense to “strip” tests from a set of modules to prepare them for distribution to end-users. Although we haven’t created the <code>raco strip</code> command, yet, it’s a likely future addition. In that way, submodules act like sections in an object-linking file format such as ELF.</p>\n\n<h2 id=\"core-submodule-forms\">Core Submodule Forms</h2>\n\n<p>The <code>module+</code> form is actually just a macro that expands to a more primitive form for declaring submodules. The primitive submodule forms are <code>module</code> and <code>module*</code>, which reflect the two different directions that module dependencies can run: the <code>module*</code> form allows the submodule to import its enclosing module, while the <code>module</code> form allows the enclosing module to import the submodule.</p>\n\n<p>As a minor feature, submodules can be declared with <code>module</code> and used by a <code>require</code>—essentially the same within a module as interactively:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"kn\">#lang </span><span class=\"nn\">racket/base</span>\n<span class=\"p\">(</span><span class=\"k\">module</span> <span class=\"n\">zoo</span> <span class=\"n\">racket/base</span>\n  <span class=\"p\">(</span><span class=\"k\">provide</span> <span class=\"n\">tiger</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"n\">tiger</span> <span class=\"s2\">\"Tony\"</span><span class=\"p\">))</span>\n<span class=\"p\">(</span><span class=\"k\">require</span> <span class=\"o\">&#39;</span><span class=\"ss\">zoo</span><span class=\"p\">)</span>\n<span class=\"n\">tiger</span>\n</pre></div>\n\n</div>\n\n<p>More significantly, <code>module</code> allows a submodule to be free of any dependency on its enclosing module, while the enclosing module similarly has no obligation to import the submodule.</p>\n\n<p>The <code>module*</code> form similarly implies no a priori dependency of the submodule on its enclosing module, except that a <code>#f</code> for the submodule’s initial import means an import of all of the enclosing module’s bindings. The <code>module+</code> form expands (after collecting all pieces of a submodule’s body) to a <code>module*</code> form with a <code>#f</code> initial import.</p>\n\n<h2 id=\"in-source-documentation\">In-Source Documentation</h2>\n\n<p>A more interesting example is the <code>scribble/srcdoc</code> library, which supports documentation within a library’s source in a JavaDoc-like way:</p>\n\n<p><code>\"fish4.rkt\"</code></p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"kn\">#lang </span><span class=\"nn\">racket</span>\n<span class=\"p\">(</span><span class=\"k\">require</span> <span class=\"n\">scribble/srcdoc</span>\n         <span class=\"p\">(</span><span class=\"n\">for-doc</span> <span class=\"n\">racket/base</span> <span class=\"n\">scribble/manual</span><span class=\"p\">))</span>\n<span class=\"p\">(</span><span class=\"k\">provide</span>\n <span class=\"p\">(</span><span class=\"n\">thing-doc</span>\n  <span class=\"n\">fish</span> <span class=\"p\">(</span><span class=\"nb\">listof</span> <span class=\"nb\">number?</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"s2\">\"Our fish, each represented as a number.\"</span><span class=\"p\">)))</span>\n<span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"n\">fish</span> <span class=\"o\">&#39;</span><span class=\"p\">(</span><span class=\"mi\">1</span> <span class=\"mi\">2</span><span class=\"p\">))</span>\n<span class=\"p\">(</span><span class=\"k\">provide</span>\n <span class=\"p\">(</span><span class=\"n\">proc-doc/names</span>\n  <span class=\"n\">feed</span> <span class=\"p\">(</span><span class=\"nb\">number?</span> <span class=\"o\">.</span> <span class=\"k\">-&gt;</span> <span class=\"o\">.</span> <span class=\"nb\">number?</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"n\">n</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"s2\">\"Feed 1 pound of food to the fish \"</span> <span class=\"p\">(</span><span class=\"n\">racket</span> <span class=\"n\">n</span><span class=\"p\">)</span> <span class=\"s2\">\".\"</span><span class=\"p\">)))</span>\n<span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">feed</span> <span class=\"n\">n</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"nb\">+</span> <span class=\"n\">n</span> <span class=\"mi\">1</span><span class=\"p\">))</span>\n</pre></div>\n\n</div>\n\n<p>The <code>scribble/srcdoc</code> library provides <code>thing-doc</code> and <code>proc-doc</code>, which can be used instead of a plain <code>provide</code> form to attach both a contract and documentation to the exported binding. The contract is used at run time to guard uses of the value. The contract is also included in the documentation with hyperlinks to bindings that are used in the contract, such as <code>number?</code>.</p>\n\n<p>In addition to provide forms, the <code>scribble/srcdoc</code> library provides <code>for-doc</code> for use within <code>require</code>. A <code>for-doc</code> imports forms that are used in the implementation of the documentation, as opposed to the implementation of the library. In <code>\"fish4.rkt\"</code>, <code>scribble/manual</code> is imported for the racket form that is used in the documentation of feed.</p>\n\n<p>These forms from <code>scribble/srcdoc</code> work together to construct a <code>srcdoc</code> submodule that contains documentation for the enclosing module without creating any documentation-related run-time overhead for the enclosing module. The module’s documentation is loaded from bytecode only when specifically requested from the <code>srcdoc</code> submodule for inclusion in a documentation build via <code>include-extracted</code>:</p>\n\n<p><code>\"fish4.scrbl\"</code></p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"kn\">#lang </span><span class=\"nn\">scribble/manual</span>\n<span class=\"n\">@</span><span class=\"p\">(</span><span class=\"k\">require</span> <span class=\"n\">scribble/extract</span><span class=\"p\">)</span>\n<span class=\"n\">@title</span><span class=\"p\">{</span><span class=\"n\">Fish</span><span class=\"p\">}</span>\n<span class=\"n\">@defmodule</span><span class=\"p\">[</span><span class=\"s2\">\"fish.rkt\"</span><span class=\"p\">]</span>\n<span class=\"n\">@include-extracted</span><span class=\"p\">[</span><span class=\"s2\">\"fish4.rkt\"</span><span class=\"p\">]</span>\n</pre></div>\n\n</div>\n\n<h2 id=\"implementing-languages\">Implementing Languages</h2>\n\n<p>Top-level modules in Racket intentionally inherit no bindings from the top-level environment, so that (1) a module’s meaning is fixed independent of its load order or other effects, and (2) the initial import of a module can act as a “language” with complete control over the module’s meaning. That is, <code>#lang</code> is in principle the only top-level form in Racket. With only modules at the top level, however, macros cannot abstract over sets of top-level modules.</p>\n\n<p>Submodules provide more flexibility, in that a macro defined within a module can abstract over a set of submodules. As it happens, abstracting over a set of submodules is useful for defining a new language for use with <code>#lang</code>.</p>\n\n<p>A language for use with <code>#lang</code> is implemented by several pieces that live at different times, including the language’s parser, the language’s run-time support library, and the language’s syntax-coloring plug-in for DrRacket. Formerly, a programmer who implements a language with those three pieces was forced to write three different modules (or else tangle the different pieces in a single module, which invariably pulls too many dependencies into any one of them). Those pieces now can be in submodules, which opens the possibility for new abstractions that conveniently generate the various pieces of a language.</p>\n\n<p>For example, if you want to define an <code>ocean</code> language that is <code>racket/base</code> plus <code>fish</code>, it’s enough to install the following module as <code>\"main.rkt\"</code> in an <code>\"ocean\"</code> collection (e.g., in an <code>\"ocean\"</code> directory is that is registered as a collection with the command <code>raco link ocean</code>):</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"kn\">#lang </span><span class=\"nn\">racket/base</span>\n<span class=\"p\">(</span><span class=\"k\">provide</span> <span class=\"p\">(</span><span class=\"k\">all-from-out</span> <span class=\"n\">racket/base</span><span class=\"p\">)</span>\n         <span class=\"n\">fish</span><span class=\"p\">)</span>\n<span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"n\">fish</span> <span class=\"o\">&#39;</span><span class=\"p\">(</span><span class=\"mi\">1</span> <span class=\"mi\">2</span> <span class=\"mi\">3</span><span class=\"p\">))</span>\n<span class=\"p\">(</span><span class=\"nb\">displayln</span> <span class=\"s2\">\"Fish are swimming\"</span><span class=\"p\">)</span>\n<span class=\"p\">(</span><span class=\"k\">module</span> <span class=\"n\">reader</span> <span class=\"n\">syntax/module-reader</span>\n  <span class=\"kd\">#:language</span> <span class=\"o\">&#39;</span><span class=\"ss\">ocean</span><span class=\"p\">)</span>\n</pre></div>\n\n</div>\n\n<p>When Racket sees a module that starts <code>#lang ocean</code>, it does not simply load the <code>\"main.rkt\"</code> module of the <code>\"ocean\"</code> collection. Instead, <code>#lang</code> looks for a reader submodule of the <code>\"main.rkt\"</code> module. The reader module above does not depend on its enclosing module, so that parsing a module in the ocean language does not trigger the “Fish are swimming” printout. Instead, the <code>#:language 'ocean</code> part of the reader submodule indicates that a module parsed from <code>#lang ocean</code> starts by importing the <code>ocean</code> module, so the bindings of <code>ocean</code> are available in the program, and “Fish are swimming” will print when the program is run.</p>\n\n<h2 id=\"submodules-are-like\">Submodules are Like&hellip;</h2>\n\n<p>At some level, syntactic nesting of modules is an obvious feature to include in a module system. Nevertheless, Racket’s submodules are not like nested modules in most languages—including Python, Chez, or ML—where nesting is for namespace management and nested modules are always instantiated along with the enclosing module. Racket submodules can be used in a similar way, but the fact that submodules are separately loadable makes them available to solve a larger class of problems.</p>\n\n<p>If I had to pick just one analogy, I’d say that submodules are most like a generalization of annotations in the Java sense. Java annotations allow the decoration of code with metadata, and the annotations are preserved through run time, so that annotations can be inspected in source, in compiled code, or reflectively at run time. Java annotations are limited to data, so that any abstraction or programatic interpretation of the data depends on yet another external tool and language, or else the code part (such as test to run for a <code>@Test</code> annotation) is difficult to separate from the main program. C# attributes are slightly more general, in that the data can have associated methods, but attribute code is still mingled with run-time code. Submodules generalize annotations to make them “live,” so that the language of annotations can include expressions, functions, and even syntactic extensions, while allowing the annotation/submodule code to stay separate from the base code.</p>\n\n<p>For more information on submodules, see the pre-release Guide section.</p>") #t (u . "\n<p><em>posted by Matthew Flatt</em></p>\n\n<p>A Racket submodule is a module that is syntactically nested within another module. Submodules will be supported in the next release of Racket, and they are available in the current <a href=\"http://pre.racket-lang.org/installers/\">pre-release version</a>.</p>\n\n<p>Submodules provide nested namespaces, but that kind of nesting is already available through forms like <code>define-package</code>. The power of submodules is that they can be separately loaded and separately run relative to their enclosing modules, in the same way that top-level modules can be separately load and run. This separation of dependencies means that submodules can be used to add code and information to modules—such as tests, documentation, and parsing information—that is loaded only when specifically requested.</p>\n\n<h2 id=\"the-main-submodule\">The <code>main</code> Submodule</h2>\n\n<p>One use of a submodule is to declare a <code>main</code> submodule. A <code>main</code> submodule is instantiated when the enclosing module is run as the main program, but not when the enclosing module is used as a library.</p>\n\n<p><code>\"fish.rkt\"</code></p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"kn\">#lang </span><span class=\"nn\">racket/base</span>\n<span class=\"p\">(</span><span class=\"k\">provide</span> <span class=\"n\">fish</span><span class=\"p\">)</span>\n<span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"n\">fish</span> <span class=\"o\">&#39;</span><span class=\"p\">(</span><span class=\"mi\">1</span> <span class=\"mi\">2</span><span class=\"p\">))</span>\n<span class=\"p\">(</span><span class=\"k\">module+</span> <span class=\"n\">main</span>\n  <span class=\"p\">(</span><span class=\"nb\">map</span> <span class=\"nb\">displayln</span> <span class=\"n\">fish</span><span class=\"p\">))</span>\n</pre></div>\n\n</div>\n\n<p><code>\"sum-fish.rkt\"</code></p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"kn\">#lang </span><span class=\"nn\">racket/base</span>\n<span class=\"p\">(</span><span class=\"k\">require</span> <span class=\"s2\">\"fish.rkt\"</span><span class=\"p\">)</span>\n<span class=\"p\">(</span><span class=\"nb\">apply</span> <span class=\"nb\">+</span> <span class=\"n\">fish</span><span class=\"p\">)</span>\n</pre></div>\n\n</div>\n\n<p>The <code>\"fish.rkt\"</code> module exports fish as a list of numbers. Running <code>\"sum-fish.rkt\"</code>, which imports <code>\"fish.rkt\"</code>, prints the sum of the numbers. Running <code>\"fish.rkt\"</code> directly, however, triggers the instantiation of the main submodule within <code>\"fish.rkt\"</code>, which displays each number in fish on its own line.</p>\n\n<p>A <code>(module+ main ....)</code> declaration is similar to the Python <code>if __name__ == \"__main__\":</code> idiom, but with a significant difference. Importing <code>\"fish.rkt\"</code> into another module ignores the main submodule completely, so that the main submodule’s code and its dependencies aren’t loaded.</p>\n\n<h2 id=\"unit-tests\">Unit Tests</h2>\n\n<p>Another use for submodules—and one where independent loading matters more than for <code>\"fish.rkt\"</code>’s <code>main</code>—is for test suites. A <code>main</code> submodule could be used for tests, so that running the module runs its tests, but our preferred convention is to declare a <code>test</code> submodule:</p>\n\n<p><code>\"fish2.rkt\"</code></p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"kn\">#lang </span><span class=\"nn\">racket/base</span>\n<span class=\"p\">(</span><span class=\"k\">provide</span> <span class=\"n\">fish</span><span class=\"p\">)</span>\n<span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"n\">fish</span> <span class=\"o\">&#39;</span><span class=\"p\">(</span><span class=\"mi\">1</span> <span class=\"mi\">2</span><span class=\"p\">))</span>\n<span class=\"p\">(</span><span class=\"k\">module+</span> <span class=\"n\">test</span>\n  <span class=\"p\">(</span><span class=\"k\">require</span> <span class=\"n\">rackunit</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"n\">check</span> <span class=\"nb\">andmap</span> <span class=\"nb\">number?</span> <span class=\"n\">fish</span><span class=\"p\">))</span>\n</pre></div>\n\n</div>\n\n<p>The new <code>raco test</code> shell command runs the <code>test</code> submodule of a given module, so that <code>raco test fish2.rkt</code> checks that all the values of the <code>fish</code> list are numbers. The <code>test</code> submodule imports <code>rackunit</code> for its check form, but that import does not create a dependency on <code>rackunit</code> (which is a substantial library) for modules that import <code>\"fish2.rkt\"</code>; the dependency is only for the test submodule.</p>\n\n<p>The <code>module+</code> form creates a dependency of the submodule on the enclosing module, since it implicitly imports all bindings of its enclosing module. The implicit import explains why the test submodule in <code>\"fish2.rkt\"</code> can use fish directly (i.e., it’s not simply because the submodule is syntactically nested). The implicit import includes all bindings from the enclosing module, including bindings that are not exported via provide, which supports unit tests for unexported functions.</p>\n\n<p>Finally, the <code>module+</code> form splices together multiple declarations of a particular submodule, which is useful for interleaving definitions and tests:</p>\n\n<p><code>\"fish3.rkt\"</code></p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"kn\">#lang </span><span class=\"nn\">racket/base</span>\n<span class=\"p\">(</span><span class=\"k\">provide</span> <span class=\"n\">fish</span> <span class=\"n\">feed</span><span class=\"p\">)</span>\n<span class=\"p\">(</span><span class=\"k\">module+</span> <span class=\"n\">test</span> <span class=\"p\">(</span><span class=\"k\">require</span> <span class=\"n\">rackunit</span><span class=\"p\">))</span>\n<span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"n\">fish</span> <span class=\"o\">&#39;</span><span class=\"p\">(</span><span class=\"mi\">1</span> <span class=\"mi\">2</span><span class=\"p\">))</span>\n<span class=\"p\">(</span><span class=\"k\">module+</span> <span class=\"n\">test</span> <span class=\"p\">(</span><span class=\"n\">check</span> <span class=\"nb\">andmap</span> <span class=\"nb\">number?</span> <span class=\"n\">fish</span><span class=\"p\">))</span>\n<span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">feed</span> <span class=\"n\">n</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"nb\">+</span> <span class=\"n\">n</span> <span class=\"mi\">1</span><span class=\"p\">))</span>\n<span class=\"p\">(</span><span class=\"k\">module+</span> <span class=\"n\">test</span> <span class=\"p\">(</span><span class=\"n\">check-equal?</span> <span class=\"mi\">3</span> <span class=\"p\">(</span><span class=\"n\">feed</span> <span class=\"mi\">2</span><span class=\"p\">)))</span>\n</pre></div>\n\n</div>\n\n<p>Since tests are isolated to a submodule, it might make sense to “strip” tests from a set of modules to prepare them for distribution to end-users. Although we haven’t created the <code>raco strip</code> command, yet, it’s a likely future addition. In that way, submodules act like sections in an object-linking file format such as ELF.</p>\n\n<h2 id=\"core-submodule-forms\">Core Submodule Forms</h2>\n\n<p>The <code>module+</code> form is actually just a macro that expands to a more primitive form for declaring submodules. The primitive submodule forms are <code>module</code> and <code>module*</code>, which reflect the two different directions that module dependencies can run: the <code>module*</code> form allows the submodule to import its enclosing module, while the <code>module</code> form allows the enclosing module to import the submodule.</p>\n\n<p>As a minor feature, submodules can be declared with <code>module</code> and used by a <code>require</code>—essentially the same within a module as interactively:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"kn\">#lang </span><span class=\"nn\">racket/base</span>\n<span class=\"p\">(</span><span class=\"k\">module</span> <span class=\"n\">zoo</span> <span class=\"n\">racket/base</span>\n  <span class=\"p\">(</span><span class=\"k\">provide</span> <span class=\"n\">tiger</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"n\">tiger</span> <span class=\"s2\">\"Tony\"</span><span class=\"p\">))</span>\n<span class=\"p\">(</span><span class=\"k\">require</span> <span class=\"o\">&#39;</span><span class=\"ss\">zoo</span><span class=\"p\">)</span>\n<span class=\"n\">tiger</span>\n</pre></div>\n\n</div>\n\n<p>More significantly, <code>module</code> allows a submodule to be free of any dependency on its enclosing module, while the enclosing module similarly has no obligation to import the submodule.</p>\n\n<p>The <code>module*</code> form similarly implies no a priori dependency of the submodule on its enclosing module, except that a <code>#f</code> for the submodule’s initial import means an import of all of the enclosing module’s bindings. The <code>module+</code> form expands (after collecting all pieces of a submodule’s body) to a <code>module*</code> form with a <code>#f</code> initial import.</p>\n\n<h2 id=\"in-source-documentation\">In-Source Documentation</h2>\n\n<p>A more interesting example is the <code>scribble/srcdoc</code> library, which supports documentation within a library’s source in a JavaDoc-like way:</p>\n\n<p><code>\"fish4.rkt\"</code></p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"kn\">#lang </span><span class=\"nn\">racket</span>\n<span class=\"p\">(</span><span class=\"k\">require</span> <span class=\"n\">scribble/srcdoc</span>\n         <span class=\"p\">(</span><span class=\"n\">for-doc</span> <span class=\"n\">racket/base</span> <span class=\"n\">scribble/manual</span><span class=\"p\">))</span>\n<span class=\"p\">(</span><span class=\"k\">provide</span>\n <span class=\"p\">(</span><span class=\"n\">thing-doc</span>\n  <span class=\"n\">fish</span> <span class=\"p\">(</span><span class=\"nb\">listof</span> <span class=\"nb\">number?</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"s2\">\"Our fish, each represented as a number.\"</span><span class=\"p\">)))</span>\n<span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"n\">fish</span> <span class=\"o\">&#39;</span><span class=\"p\">(</span><span class=\"mi\">1</span> <span class=\"mi\">2</span><span class=\"p\">))</span>\n<span class=\"p\">(</span><span class=\"k\">provide</span>\n <span class=\"p\">(</span><span class=\"n\">proc-doc/names</span>\n  <span class=\"n\">feed</span> <span class=\"p\">(</span><span class=\"nb\">number?</span> <span class=\"o\">.</span> <span class=\"k\">-&gt;</span> <span class=\"o\">.</span> <span class=\"nb\">number?</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"n\">n</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"s2\">\"Feed 1 pound of food to the fish \"</span> <span class=\"p\">(</span><span class=\"n\">racket</span> <span class=\"n\">n</span><span class=\"p\">)</span> <span class=\"s2\">\".\"</span><span class=\"p\">)))</span>\n<span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">feed</span> <span class=\"n\">n</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"nb\">+</span> <span class=\"n\">n</span> <span class=\"mi\">1</span><span class=\"p\">))</span>\n</pre></div>\n\n</div>\n\n<p>The <code>scribble/srcdoc</code> library provides <code>thing-doc</code> and <code>proc-doc</code>, which can be used instead of a plain <code>provide</code> form to attach both a contract and documentation to the exported binding. The contract is used at run time to guard uses of the value. The contract is also included in the documentation with hyperlinks to bindings that are used in the contract, such as <code>number?</code>.</p>\n\n<p>In addition to provide forms, the <code>scribble/srcdoc</code> library provides <code>for-doc</code> for use within <code>require</code>. A <code>for-doc</code> imports forms that are used in the implementation of the documentation, as opposed to the implementation of the library. In <code>\"fish4.rkt\"</code>, <code>scribble/manual</code> is imported for the racket form that is used in the documentation of feed.</p>\n\n<p>These forms from <code>scribble/srcdoc</code> work together to construct a <code>srcdoc</code> submodule that contains documentation for the enclosing module without creating any documentation-related run-time overhead for the enclosing module. The module’s documentation is loaded from bytecode only when specifically requested from the <code>srcdoc</code> submodule for inclusion in a documentation build via <code>include-extracted</code>:</p>\n\n<p><code>\"fish4.scrbl\"</code></p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"kn\">#lang </span><span class=\"nn\">scribble/manual</span>\n<span class=\"n\">@</span><span class=\"p\">(</span><span class=\"k\">require</span> <span class=\"n\">scribble/extract</span><span class=\"p\">)</span>\n<span class=\"n\">@title</span><span class=\"p\">{</span><span class=\"n\">Fish</span><span class=\"p\">}</span>\n<span class=\"n\">@defmodule</span><span class=\"p\">[</span><span class=\"s2\">\"fish.rkt\"</span><span class=\"p\">]</span>\n<span class=\"n\">@include-extracted</span><span class=\"p\">[</span><span class=\"s2\">\"fish4.rkt\"</span><span class=\"p\">]</span>\n</pre></div>\n\n</div>\n\n<h2 id=\"implementing-languages\">Implementing Languages</h2>\n\n<p>Top-level modules in Racket intentionally inherit no bindings from the top-level environment, so that (1) a module’s meaning is fixed independent of its load order or other effects, and (2) the initial import of a module can act as a “language” with complete control over the module’s meaning. That is, <code>#lang</code> is in principle the only top-level form in Racket. With only modules at the top level, however, macros cannot abstract over sets of top-level modules.</p>\n\n<p>Submodules provide more flexibility, in that a macro defined within a module can abstract over a set of submodules. As it happens, abstracting over a set of submodules is useful for defining a new language for use with <code>#lang</code>.</p>\n\n<p>A language for use with <code>#lang</code> is implemented by several pieces that live at different times, including the language’s parser, the language’s run-time support library, and the language’s syntax-coloring plug-in for DrRacket. Formerly, a programmer who implements a language with those three pieces was forced to write three different modules (or else tangle the different pieces in a single module, which invariably pulls too many dependencies into any one of them). Those pieces now can be in submodules, which opens the possibility for new abstractions that conveniently generate the various pieces of a language.</p>\n\n<p>For example, if you want to define an <code>ocean</code> language that is <code>racket/base</code> plus <code>fish</code>, it’s enough to install the following module as <code>\"main.rkt\"</code> in an <code>\"ocean\"</code> collection (e.g., in an <code>\"ocean\"</code> directory is that is registered as a collection with the command <code>raco link ocean</code>):</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"kn\">#lang </span><span class=\"nn\">racket/base</span>\n<span class=\"p\">(</span><span class=\"k\">provide</span> <span class=\"p\">(</span><span class=\"k\">all-from-out</span> <span class=\"n\">racket/base</span><span class=\"p\">)</span>\n         <span class=\"n\">fish</span><span class=\"p\">)</span>\n<span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"n\">fish</span> <span class=\"o\">&#39;</span><span class=\"p\">(</span><span class=\"mi\">1</span> <span class=\"mi\">2</span> <span class=\"mi\">3</span><span class=\"p\">))</span>\n<span class=\"p\">(</span><span class=\"nb\">displayln</span> <span class=\"s2\">\"Fish are swimming\"</span><span class=\"p\">)</span>\n<span class=\"p\">(</span><span class=\"k\">module</span> <span class=\"n\">reader</span> <span class=\"n\">syntax/module-reader</span>\n  <span class=\"kd\">#:language</span> <span class=\"o\">&#39;</span><span class=\"ss\">ocean</span><span class=\"p\">)</span>\n</pre></div>\n\n</div>\n\n<p>When Racket sees a module that starts <code>#lang ocean</code>, it does not simply load the <code>\"main.rkt\"</code> module of the <code>\"ocean\"</code> collection. Instead, <code>#lang</code> looks for a reader submodule of the <code>\"main.rkt\"</code> module. The reader module above does not depend on its enclosing module, so that parsing a module in the ocean language does not trigger the “Fish are swimming” printout. Instead, the <code>#:language 'ocean</code> part of the reader submodule indicates that a module parsed from <code>#lang ocean</code> starts by importing the <code>ocean</code> module, so the bindings of <code>ocean</code> are available in the program, and “Fish are swimming” will print when the program is run.</p>\n\n<h2 id=\"submodules-are-like\">Submodules are Like&hellip;</h2>\n\n<p>At some level, syntactic nesting of modules is an obvious feature to include in a module system. Nevertheless, Racket’s submodules are not like nested modules in most languages—including Python, Chez, or ML—where nesting is for namespace management and nested modules are always instantiated along with the enclosing module. Racket submodules can be used in a similar way, but the fact that submodules are separately loadable makes them available to solve a larger class of problems.</p>\n\n<p>If I had to pick just one analogy, I’d say that submodules are most like a generalization of annotations in the Java sense. Java annotations allow the decoration of code with metadata, and the annotations are preserved through run time, so that annotations can be inspected in source, in compiled code, or reflectively at run time. Java annotations are limited to data, so that any abstraction or programatic interpretation of the data depends on yet another external tool and language, or else the code part (such as test to run for a <code>@Test</code> annotation) is difficult to separate from the main program. C# attributes are slightly more general, in that the data can have associated methods, but attribute code is still mingled with run-time code. Submodules generalize annotations to make them “live,” so that the language of annotations can include expressions, functions, and even syntactic extensions, while allowing the annotation/submodule code to stay separate from the base code.</p>\n\n<p>For more information on submodules, see the pre-release Guide section.</p>\n<!-- more-->\n\n<hr />\n\n<p>That was enormously helpful. I&rsquo;d followed the discussion of submodules on the mailing list, but hadn&rsquo;t quite &ldquo;gotten&rdquo; them until now. (I particularly like that you focused on the <em>problem</em> that this feature solves).</p>\n\n<p>I hope you put this essay, or something like it, into the Racket Guide.</p>\n\n<p>— <em>offby1, 3 June 2012</em></p>\n\n<hr />")) ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2013-05-08-racket-v534.md" . unix) f post (u . "Racket v5.3.4") (? . 74) 1467223812 (p+ #"/Users/MB/git/racket-lang-org/blog/2013/05/racket-v534.html" . unix) "/2013/05/racket-v534.html" (u . "2013-05-08T12:44:00.001-04:00") (? . 97) (? . 78) (c (u . "")) (u . "\n<p><em>posted by Eli Barzilay</em></p>\n\n<p>Racket version 5.3.4 is now available from <a href=\"http://racket-lang.org/\">http://racket-lang.org/</a></p>\n\n<ul>\n <li>\n  <p>Extflonums (80-bit floating-point numbers) are supported on some x86/x86_64 platforms — including Windows, and including platforms where Racket is compiled to use SSE instructions for flonum arithmetic. Thanks to Michael Filonenko.</p></li>\n <li>\n  <p>OS X: DrRacket and all of the other apps are now signed with an official key.</p></li>\n <li>\n  <p>Tally Maze: a new game based an enumeration of 2d mazes.</p></li>\n <li>\n  <p>The Optimization Coach, a DrRacket plugin, has been moved from the Racket distribution to the Racket package repository. Install it with: <code>raco pkg install optimization-coach</code>.</p></li>\n <li>\n  <p>Redex: <code>define-union-language</code> now merges productions when languages define the same nonterminals. Thanks to William Bowman.</p></li>\n <li>\n  <p>The <code>srfi/19</code> library is now compatible with the date structure type exported by <code>racket/base</code>.</p></li></ul>") #f (u . "\n<p><em>posted by Eli Barzilay</em></p>\n\n<p>Racket version 5.3.4 is now available from <a href=\"http://racket-lang.org/\">http://racket-lang.org/</a></p>\n\n<ul>\n <li>\n  <p>Extflonums (80-bit floating-point numbers) are supported on some x86/x86_64 platforms — including Windows, and including platforms where Racket is compiled to use SSE instructions for flonum arithmetic. Thanks to Michael Filonenko.</p></li>\n <li>\n  <p>OS X: DrRacket and all of the other apps are now signed with an official key.</p></li>\n <li>\n  <p>Tally Maze: a new game based an enumeration of 2d mazes.</p></li>\n <li>\n  <p>The Optimization Coach, a DrRacket plugin, has been moved from the Racket distribution to the Racket package repository. Install it with: <code>raco pkg install optimization-coach</code>.</p></li>\n <li>\n  <p>Redex: <code>define-union-language</code> now merges productions when languages define the same nonterminals. Thanks to William Bowman.</p></li>\n <li>\n  <p>The <code>srfi/19</code> library is now compatible with the date structure type exported by <code>racket/base</code>.</p></li></ul>")) ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2009-09-21-set-vs-set-box-and-unbox.md" . unix) f post (u . "`set!` vs. `set-box!` and `unbox`") (? . 98) 1467223812 (p+ #"/Users/MB/git/racket-lang-org/blog/2009/09/set-vs-set-box-and-unbox.html" . unix) "/2009/09/set-vs-set-box-and-unbox.html" (u . "2009-09-21T07:23:00.007-04:00") (? . 71) (? . 124) (c (u . "")) (u . "\n<p><em>posted by Robby Findler</em></p>\n\n<p>A few weeks ago I was chatting with some PLT folks and was surprised to hear them say that they avoided <code>set!</code> because using <code>set-box!</code> and <code>unbox</code> was easier to see what was going on.</p>\n\n<p>This struck me as wrong since one might pass boxes around and then you can&rsquo;t be sure which box you&rsquo;re mutating, but you cannot pass variable references around and thus which variable you&rsquo;re using is always lexically apparent. (Of course, when you add <code>lambda</code> into the mix that isn&rsquo;t really true, since you can capture a variable in a closure and pass that around.)</p>\n\n<p>Their point seemed to be that you had to write something special at each use of the box, unlike with <code>set!</code> where you simply write a variable reference and it might be getting a changing quantity and it might not be. This made me realize I could do something to help, at least, and so I changed Check Syntax so that it colored <code>set!</code>&rsquo;d variables in red, like this:</p>") #f (u . "\n<p><em>posted by Robby Findler</em></p>\n\n<p>A few weeks ago I was chatting with some PLT folks and was surprised to hear them say that they avoided <code>set!</code> because using <code>set-box!</code> and <code>unbox</code> was easier to see what was going on.</p>\n\n<p>This struck me as wrong since one might pass boxes around and then you can&rsquo;t be sure which box you&rsquo;re mutating, but you cannot pass variable references around and thus which variable you&rsquo;re using is always lexically apparent. (Of course, when you add <code>lambda</code> into the mix that isn&rsquo;t really true, since you can capture a variable in a closure and pass that around.)</p>\n\n<p>Their point seemed to be that you had to write something special at each use of the box, unlike with <code>set!</code> where you simply write a variable reference and it might be getting a changing quantity and it might not be. This made me realize I could do something to help, at least, and so I changed Check Syntax so that it colored <code>set!</code>&rsquo;d variables in red, like this:</p>")) ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2014-08-02-racket-v61.md" . unix) f post (u . "Racket v6.1") (? . 88) 1467223812 (p+ #"/Users/MB/git/racket-lang-org/blog/2014/08/racket-v61.html" . unix) "/2014/08/racket-v61.html" (u . "2014-08-02T14:31:00.000-04:00") (? . 99) (? . 100) (c (u . "")) (u . "\n<p><em>posted by Ryan Culpepper</em></p>\n\n<p>PLT Design Inc. announces the release of Racket version 6.1 at</p>\n\n<p><a href=\"http://racket-lang.org/\">http://racket-lang.org/</a></p>\n\n<p>The major innovation concerns local recursive variable definitions. Instead of initializing variables with an <code>undefined</code> value, Racket raises an exception when such a variable is used before its definition. (Thanks to Claire Alvis for adapting Dybvig&rsquo;s &ldquo;Fixing Letrec&rdquo; work.)</p>\n\n<p>Since programs are rarely intended to produce <code>#&lt;undefined&gt;</code>, raising an exception provides early and improved feedback. Module-level variables have always triggered such an exception when used too early, and this change finally gives local bindings — including class fields — the same meaning.</p>\n\n<p>This change is backwards-incompatible with prior releases of Racket. Aside from exposing a few bugs, the change will mainly affect programs that include</p>\n\n<p><code>(define undefined (letrec ([x x]) x))</code></p>\n\n<p>to obtain the <code>#&lt;undefined&gt;</code> value. In its stead, Racket provides the same value via the <code>racket/undefined</code> library (which was introduced in the previous release). Programmers are encouraged to use it in place of the pattern above to obtain the &ldquo;undefined&rdquo; value.</p>\n\n<p>The release also includes the following small changes:</p>\n\n<ul>\n <li>\n  <p>Plumbers generalize the flush-on-exit capability of primitive output ports to enable arbitrary flushing actions and to give programmers control over the timing of flushes (i.e., a composable <code>atexit</code>). New functions include <code>current-plumber</code>, <code>plumber-add-flush!</code>, and <code>plumber-flush-all</code>.</p></li>\n <li>\n  <p>Contracts: the contract system&rsquo;s random testing facility has been strengthened so that it can easily find simple mistakes in contracted data structure implementations (e.g. an accidental reverse of a conditional in a heap invariant check).</p></li>\n <li>\n  <p>Redex: the semantics of mis-match patterns (variables followed by <code>_!_</code>) inside ellipses has changed in a backwards-incompatible way. This change simplifies the patterns&rsquo; semantics and increases the usefulness of these patterns.</p></li>\n <li>\n  <p>Teaching languages: <code>check-random</code> is an addition to the preferred unit testing framework in the teaching languages. It enables the testing of students&rsquo; functions that use random-number generation. (Thanks to David Van Horn (UMaryland) for proposing this idea.)</p></li>\n <li>\n  <p>Upgraded and normalized versions of graphics libraries and dependencies (Pango, Cairo, GLib, etc.) that are bundled with Racket on Windows and Mac OS X. For example, FreeType support is consistently enabled.</p></li>\n <li>\n  <p>Typed Racket: its standard library includes contracted exports from the Racket standard library, such as the formatting combinators of <code>racket/format</code>. It also supports Racket&rsquo;s asynchronous channels; see the <code>typed/racket/async-channel</code> library.</p></li>\n <li>\n  <p>SSL: The <code>openssl</code> library supports forward secrecy via DHE and ECDHE cipher suites (thanks to Edward Lee) and Server Name Indication (thanks to Jay Kominek).</p></li>\n <li>\n  <p>The <code>mzlib/class100</code> library has been removed. Use <code>racket/class</code> instead.</p></li></ul>") #t (u . "\n<p><em>posted by Ryan Culpepper</em></p>\n\n<p>PLT Design Inc. announces the release of Racket version 6.1 at</p>\n\n<p><a href=\"http://racket-lang.org/\">http://racket-lang.org/</a></p>\n\n<p>The major innovation concerns local recursive variable definitions. Instead of initializing variables with an <code>undefined</code> value, Racket raises an exception when such a variable is used before its definition. (Thanks to Claire Alvis for adapting Dybvig&rsquo;s &ldquo;Fixing Letrec&rdquo; work.)</p>\n\n<p>Since programs are rarely intended to produce <code>#&lt;undefined&gt;</code>, raising an exception provides early and improved feedback. Module-level variables have always triggered such an exception when used too early, and this change finally gives local bindings — including class fields — the same meaning.</p>\n\n<p>This change is backwards-incompatible with prior releases of Racket. Aside from exposing a few bugs, the change will mainly affect programs that include</p>\n\n<p><code>(define undefined (letrec ([x x]) x))</code></p>\n\n<p>to obtain the <code>#&lt;undefined&gt;</code> value. In its stead, Racket provides the same value via the <code>racket/undefined</code> library (which was introduced in the previous release). Programmers are encouraged to use it in place of the pattern above to obtain the &ldquo;undefined&rdquo; value.</p>\n\n<p>The release also includes the following small changes:</p>\n\n<ul>\n <li>\n  <p>Plumbers generalize the flush-on-exit capability of primitive output ports to enable arbitrary flushing actions and to give programmers control over the timing of flushes (i.e., a composable <code>atexit</code>). New functions include <code>current-plumber</code>, <code>plumber-add-flush!</code>, and <code>plumber-flush-all</code>.</p></li>\n <li>\n  <p>Contracts: the contract system&rsquo;s random testing facility has been strengthened so that it can easily find simple mistakes in contracted data structure implementations (e.g. an accidental reverse of a conditional in a heap invariant check).</p></li>\n <li>\n  <p>Redex: the semantics of mis-match patterns (variables followed by <code>_!_</code>) inside ellipses has changed in a backwards-incompatible way. This change simplifies the patterns&rsquo; semantics and increases the usefulness of these patterns.</p></li>\n <li>\n  <p>Teaching languages: <code>check-random</code> is an addition to the preferred unit testing framework in the teaching languages. It enables the testing of students&rsquo; functions that use random-number generation. (Thanks to David Van Horn (UMaryland) for proposing this idea.)</p></li>\n <li>\n  <p>Upgraded and normalized versions of graphics libraries and dependencies (Pango, Cairo, GLib, etc.) that are bundled with Racket on Windows and Mac OS X. For example, FreeType support is consistently enabled.</p></li>\n <li>\n  <p>Typed Racket: its standard library includes contracted exports from the Racket standard library, such as the formatting combinators of <code>racket/format</code>. It also supports Racket&rsquo;s asynchronous channels; see the <code>typed/racket/async-channel</code> library.</p></li>\n <li>\n  <p>SSL: The <code>openssl</code> library supports forward secrecy via DHE and ECDHE cipher suites (thanks to Edward Lee) and Server Name Indication (thanks to Jay Kominek).</p></li>\n <li>\n  <p>The <code>mzlib/class100</code> library has been removed. Use <code>racket/class</code> instead.</p></li></ul>\n<!-- more-->\n\n<hr />\n\n<p>I an running the new beta version of Mac OSX Yosemite and DrRacket will not run! please help!!!</p>\n\n<p>— <em>John Sheriff, 9 September 2014</em></p>\n\n<hr />\n\n<p>Is there a way to order http://docs.racket-lang.org/guide/ as a printed manual or download as a PDF to print my own for reference?</p>\n\n<p>— <em>The Drifter, 10 September 2014</em></p>\n\n<hr />\n\n<p>+John Sherriff: It looks like a bug related to Yosemite was fixed on August 27th, after the release of 6.1.</p>\n\n<p>Here&rsquo;s the (closed) bug report.</p>\n\n<p>http://bugs.racket-lang.org/query/?cmd=view%20audit-trail&amp;database=default&amp;pr=14672</p>\n\n<p>If you want to run a newer version, you might be interested in the nightly-build package, available at</p>\n\n<p>http://www.cs.utah.edu/plt/snapshots/</p>\n\n<p>— <em>John Clements, 10 September 2014</em></p>\n\n<hr />\n\n<p>I can&rsquo;t run it on Mac OS X Yosemite</p>\n\n<p>— <em>Ege Şenkul, 18 October 2014</em></p>\n\n<hr />")) ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2007-05-10-adjusting-drschemes-keybindings.md" . unix) f post (u . "Adjusting DrScheme's Keybindings") (? . 101) 1467223812 (p+ #"/Users/MB/git/racket-lang-org/blog/2007/05/adjusting-drschemes-keybindings.html" . unix) "/2007/05/adjusting-drschemes-keybindings.html" (u . "2007-05-10T12:48:00.000-04:00") (? . 102) (? . 121) (c (u . "")) (u . "\n<p><em>posted by Robby Findler</em></p>\n\n<p>Check out Kyle Smith&rsquo;s blog post on how to change <a href=\"http://www.drscheme.org/\">DrScheme</a>&rsquo;s keybindings:</p>\n\n<p><a href=\"http://schemekeys.blogspot.com/2007/05/keybinding-101-in-drscheme.html\">Keybinding 101 in DrScheme</a></p>") #f (u . "\n<p><em>posted by Robby Findler</em></p>\n\n<p>Check out Kyle Smith&rsquo;s blog post on how to change <a href=\"http://www.drscheme.org/\">DrScheme</a>&rsquo;s keybindings:</p>\n\n<p><a href=\"http://schemekeys.blogspot.com/2007/05/keybinding-101-in-drscheme.html\">Keybinding 101 in DrScheme</a></p>")) ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2015-10-30-retiring-unstable.md" . unix) f post (u . "Retiring `unstable`") (? . 38) 1467223812 (p+ #"/Users/MB/git/racket-lang-org/blog/2015/10/retiring-unstable.html" . unix) "/2015/10/retiring-unstable.html" (u . "2015-10-30T17:34:00.000-04:00") (? . 103) (? . 37) (c (u . "")) (u . "\n<p><em>posted by Vincent St-Amour</em></p>\n\n<p>Some of you may be familiar with the <code>unstable</code> collection, whose purpose was to serve as a staging ground for new APIs that hadn&rsquo;t yet found a more permanent home. With the advent of the package system, packages can serve that same purpose, which removes the need for a dedicated <code>unstable</code> collection provided by the main distribution.</p>\n\n<p>For this reason we are moving <code>unstable-*</code> packages out of the main distribution.</p>\n\n<p>For backwards compatibility, the packages remain available from the package catalog. Packages that properly list their dependencies (as they should! it&rsquo;s an error not to!) are unaffected by this change. Packages that are missing dependencies may need to be adjusted to include the appropriate <code>unstable</code> dependencies.</p>\n\n<p>The <code>unstable</code> packages contained many useful functions and APIs, and we merged many of them into established Racket libraries. Others were spun off as their own packages. The remaining APIs, which we judged too narrow or too immature, we left in <code>unstable</code> packages, where they are still available in their original form. In all cases, the original <code>unstable</code> libraries continue to export the same bindings they always did, to ensure backwards compatibility.</p>\n\n<p>For completeness, here is a list of the fate of each unstable library that used to be part of the main distribution.</p>\n\n<ul>\n <li><code>unstable/2d</code>\n  <ul>\n   <li>Moved to the <code>2d</code> package.</li></ul></li>\n <li><code>unstable/arrow</code>\n  <ul>\n   <li>Left in <code>unstable-lib</code>.</li></ul></li>\n <li><code>unstable/automata</code>\n  <ul>\n   <li>Moved to the <code>automata</code> package.</li></ul></li>\n <li><code>unstable/bytes</code>\n  <ul>\n   <li>Left in <code>unstable-lib</code>.</li></ul></li>\n <li><code>unstable/class-iop</code>\n  <ul>\n   <li>Moved to the <code>class-iop</code> package.</li></ul></li>\n <li><code>unstable/contract</code>\n  <ul>\n   <li>\n    <p>Moved <code>non-empty-string?</code> to <code>racket/string</code>.</p></li>\n   <li>\n    <p>Moved <code>port-number?</code> and <code>tcp-listen-port?</code> to <code>racket/tcp</code>, the latter renamed to <code>listen-port-number?</code>.</p></li>\n   <li>\n    <p>Moved <code>if/c</code>, <code>failure-result/c</code>, <code>predicate/c</code> and <code>rename-contract</code> to <code>racket/contract</code>.</p></li>\n   <li>\n    <p>Moved <code>treeof</code> to <code>plot/utils</code>.</p></li>\n   <li>\n    <p>Moved <code>sequence/c</code> to <code>racket/sequence</code>.</p></li>\n   <li>\n    <p>Left <code>path-piece?</code>, <code>maybe/c</code>, <code>truth/c</code> in <code>unstable-contract-lib</code>.</p></li></ul></li>\n <li><code>unstable/custom-write</code>\n  <ul>\n   <li>\n    <p>Moved <code>make-constructor-style-printer</code> to <code>racket/struct</code>.</p></li>\n   <li>\n    <p>Left <code>prop:auto-custom-write</code> in <code>unstable-lib</code>.</p></li></ul></li>\n <li><code>unstable/debug</code>\n  <ul>\n   <li>Left in <code>unstable-debug-lib</code>.</li></ul></li>\n <li><code>unstable/define</code>\n  <ul>\n   <li>Left in <code>unstable-lib</code>.</li></ul></li>\n <li><code>unstable/error</code>\n  <ul>\n   <li>Left in <code>unstable-lib</code>.</li></ul></li>\n <li><code>unstable/find</code>\n  <ul>\n   <li>Left in <code>unstable-lib</code>.</li></ul></li>\n <li><code>unstable/flonum</code>\n  <ul>\n   <li>Superseded by <code>math/flonum</code>. Left in <code>unstable-flonum-lib</code>.</li></ul></li>\n <li><code>unstable/function</code>\n  <ul>\n   <li>Merged with <code>racket/function</code>.</li></ul></li>\n <li><code>unstable/future</code>\n  <ul>\n   <li>Merged with <code>racket/future</code>.</li></ul></li>\n <li><code>unstable/gui/notify</code>\n  <ul>\n   <li>Moved to <code>framework/notify</code>, with naming changes.</li></ul></li>\n <li><code>unstable/gui/pict</code>\n  <ul>\n   <li>\n    <p>Moved <code>color/c</code>, <code>light</code>, <code>dark</code>, <code>red</code>, <code>orange</code>, <code>yellow</code>, <code>green</code>, <code>blue</code>, <code>purple</code>, <code>black</code>, <code>brown</code>, <code>gray</code>, <code>white</code>, <code>cyan</code>, and <code>magenta</code> to <code>pict/color</code>.</p></li>\n   <li>\n    <p>Moved <code>show</code>, <code>hide</code>, <code>pict-if</code>, <code>pict-cond</code>, and <code>pict-case</code> to <code>pict/conditional</code>.</p></li>\n   <li>\n    <p>Merged <code>scale-to</code> with <code>pict</code>&rsquo;s <code>scale-to-fit</code>.</p></li>\n   <li>\n    <p>Merged <code>ellipse/border</code>, <code>circle/border</code>, <code>rectangle/border</code>, <code>rounded-rectangle/border</code> with <code>pict</code>&rsquo;s <code>ellipse</code>, <code>circle</code>, <code>rectangle</code>, and <code>rounded-rectangle</code>, respectively.</p></li>\n   <li>\n    <p>Merged <code>pin-label-line</code>, <code>pin-arrow-label-line</code>, and <code>pin-arrows-label-line</code> with <code>pict</code>&rsquo;s <code>pin-line</code>, <code>pin-arrow-line</code>, and <code>pin-arrows-line</code>, respectively.</p></li>\n   <li>\n    <p>Moved <code>blur</code>, <code>shadow</code>, and <code>shadow-frame</code> to <code>pict/shadow</code>.</p></li>\n   <li>\n    <p>Moved <code>unstable/gui/pict/align</code> to <code>ppict/align</code>, in the <code>ppict</code> package.</p></li>\n   <li>\n    <p>Left <code>color</code>, <code>pict-match</code>, <code>pict-combine</code>, <code>with-pict-combine</code>, <code>fill</code>, <code>strike</code>, <code>shade</code>, <code>blur-bitmap!</code>, <code>arch</code>, <code>draw-pict-centered</code>, <code>backdrop</code>, <code>cross-out</code>, and <code>make-plt-title-background</code> in <code>unstable-lib</code>.</p></li></ul></li>\n <li><code>unstable/gui/ppict</code>\n  <ul>\n   <li>Moved to the <code>ppict</code> package.</li></ul></li>\n <li><code>unstable/gui/prefs</code>\n  <ul>\n   <li>Moved to <code>framework/preferences</code>, with naming changes.</li></ul></li>\n <li><code>unstable/gui/redex</code>\n  <ul>\n   <li>Left in <code>unstable-redex</code>.</li></ul></li>\n <li><code>unstable/gui/scribble</code>\n  <ul>\n   <li>Left in <code>unstable-lib</code>.</li></ul></li>\n <li><code>unstable/gui/slideshow</code>\n  <ul>\n   <li>\n    <p>Moved <code>with-size</code>, <code>with-scale</code>, <code>big</code>, <code>small</code>, <code>with-font</code>, <code>with-style</code>, <code>bold</code>, <code>italic</code>, <code>subscript</code>, <code>superscript</code>, <code>caps</code>, and <code>blank-line</code> to <code>slideshow/text</code>.</p></li>\n   <li>\n    <p>Moved <code>slide/staged</code>, <code>staged</code>, <code>stage</code>, <code>stage-name</code>, <code>at</code>, <code>before</code>, <code>after</code>, <code>before/at</code>, <code>after/at</code> to the <code>staged-slide</code> package.</p></li>\n   <li>\n    <p>Left <code>column</code>, <code>columns</code>, <code>column-size</code>, <code>two-columns</code>, <code>mini-slide</code>, <code>tabular</code>, <code>reveal</code>, <code>revealing-slide</code>, and <code>items-slide</code> in <code>unstable-lib</code>.</p></li></ul></li>\n <li><code>unstable/gui/snip</code>\n  <ul>\n   <li>Left in <code>unstable-lib</code>.</li></ul></li>\n <li><code>unstable/hash</code>\n  <ul>\n   <li>Merged with <code>racket/hash</code>.</li></ul></li>\n <li><code>unstable/latent-contract</code>\n  <ul>\n   <li>Left in <code>unstable-latent-contract-lib</code>.</li></ul></li>\n <li><code>unstable/lazy-require</code>\n  <ul>\n   <li>\n    <p><code>lazy-require</code> has been in <code>racket/lazy-require</code> for some time.</p></li>\n   <li>\n    <p>Left <code>begin-on-demand</code> in <code>unstable-lib</code>.</p></li></ul></li>\n <li><code>unstable/list</code>\n  <ul>\n   <li>\n    <p>Moved <code>check-duplicates</code>, <code>remf</code>, <code>remf*</code>, <code>group-by</code>, <code>cartesian-product</code>, <code>list-update</code>, and <code>list-set</code> to <code>racket/list</code>. * Moved <code>list-prefix?</code>, <code>take-common-prefix</code>, <code>drop-common-prefix</code>, and <code>split-common-prefix</code> to <code>racket/list</code>, with slight API changes to harmonize with Racket&rsquo;s list API.</p></li>\n   <li>\n    <p>Left <code>filter-multiple</code>, <code>extend</code>, <code>map/values</code>, and <code>map2</code> in <code>unstable-list-lib</code>.</p></li></ul></li>\n <li><code>unstable/logging</code>\n  <ul>\n   <li>\n    <p>Moved <code>with-intercepted-logging</code> and <code>with-logging-to-port</code> to <code>racket/logging</code>.</p></li>\n   <li>\n    <p>Left <code>start-recording</code> and <code>stop-recording</code> in <code>unstable-lib</code>.</p></li></ul></li>\n <li><code>unstable/macro-testing</code>\n  <ul>\n   <li>Moved to <code>syntax/macro-testing</code>.</li></ul></li>\n <li><code>unstable/markparam</code>\n  <ul>\n   <li>Moved to the <code>markparam</code> package.</li></ul></li>\n <li><code>unstable/open-place</code>\n  <ul>\n   <li>Moved <code>open-place</code> to <code>racket/place</code>, and renamed it <code>place/context</code>.</li></ul></li>\n <li><code>unstable/options</code>\n  <ul>\n   <li>Moved to the <code>option-contract</code> package.</li></ul></li>\n <li><code>unstable/parameter-group</code>\n  <ul>\n   <li>Moved to the <code>parameter-group</code> package.</li></ul></li>\n <li><code>unstable/pretty</code>\n  <ul>\n   <li>\n    <p>Merged <code>pretty-format/write</code>, <code>pretty-format/display</code>, and <code>pretty-format/print</code> with <code>racket/pretty</code>&rsquo;s <code>pretty-format</code>.</p></li>\n   <li>\n    <p>Left <code>break-lines</code> in <code>unstable-pretty-lib</code>.</p></li></ul></li>\n <li><code>unstable/recontract</code>\n  <ul>\n   <li>Merged with <code>racket/contract</code> some time ago.</li></ul></li>\n <li><code>unstable/sandbox</code>\n  <ul>\n   <li>Merged with <code>scribble/eval</code>.</li></ul></li>\n <li><code>unstable/sequence</code>\n  <ul>\n   <li>\n    <p>Moved <code>in-syntax</code> and <code>in-slice</code> to <code>racket/sequence</code>.</p></li>\n   <li>\n    <p>Left <code>in-pairs</code>, <code>in-sequence-forever</code>, and <code>sequence-lift</code> in <code>unstable-lib</code>.</p></li></ul></li>\n <li><code>unstable/socket</code>\n  <ul>\n   <li>Moved to the <code>unix-socket</code> package.</li></ul></li>\n <li><code>unstable/string</code>\n  <ul>\n   <li>Left in <code>unstable-lib</code>.</li></ul></li>\n <li><code>unstable/struct</code>\n  <ul>\n   <li>\n    <p>Moved <code>struct-&gt;list</code> to <code>racket/struct</code>.</p></li>\n   <li>\n    <p>Left <code>make</code> in <code>unstable-lib</code>.</p></li></ul></li>\n <li><code>unstable/syntax</code>\n  <ul>\n   <li>\n    <p>Moved <code>make-variable-like-transformer</code> to <code>syntax/transformer</code>.</p></li>\n   <li>\n    <p>Moved <code>syntax-source-directory</code> and <code>syntax-source-file-name</code> to <code>syntax/location</code>.</p></li>\n   <li>\n    <p>Left <code>explode-module-path-index</code>, <code>phase-of-enclosing-module</code>, <code>format-unique-id</code>, <code>syntax-length</code>, and <code>syntax-within?</code> in <code>unstable/syntax</code>.</p></li></ul></li>\n <li><code>unstable/temp-c</code>\n  <ul>\n   <li>Moved to the <code>temp-c</code> package.</li></ul></li>\n <li><code>unstable/time</code>\n  <ul>\n   <li>Left in <code>unstable-lib</code>.</li></ul></li>\n <li><code>unstable/wrapc</code>\n  <ul>\n   <li>Moved to <code>syntax/contract</code>.</li></ul></li></ul>") #t (u . "\n<p><em>posted by Vincent St-Amour</em></p>\n\n<p>Some of you may be familiar with the <code>unstable</code> collection, whose purpose was to serve as a staging ground for new APIs that hadn&rsquo;t yet found a more permanent home. With the advent of the package system, packages can serve that same purpose, which removes the need for a dedicated <code>unstable</code> collection provided by the main distribution.</p>\n\n<p>For this reason we are moving <code>unstable-*</code> packages out of the main distribution.</p>\n\n<p>For backwards compatibility, the packages remain available from the package catalog. Packages that properly list their dependencies (as they should! it&rsquo;s an error not to!) are unaffected by this change. Packages that are missing dependencies may need to be adjusted to include the appropriate <code>unstable</code> dependencies.</p>\n\n<p>The <code>unstable</code> packages contained many useful functions and APIs, and we merged many of them into established Racket libraries. Others were spun off as their own packages. The remaining APIs, which we judged too narrow or too immature, we left in <code>unstable</code> packages, where they are still available in their original form. In all cases, the original <code>unstable</code> libraries continue to export the same bindings they always did, to ensure backwards compatibility.</p>\n\n<p>For completeness, here is a list of the fate of each unstable library that used to be part of the main distribution.</p>\n\n<ul>\n <li><code>unstable/2d</code>\n  <ul>\n   <li>Moved to the <code>2d</code> package.</li></ul></li>\n <li><code>unstable/arrow</code>\n  <ul>\n   <li>Left in <code>unstable-lib</code>.</li></ul></li>\n <li><code>unstable/automata</code>\n  <ul>\n   <li>Moved to the <code>automata</code> package.</li></ul></li>\n <li><code>unstable/bytes</code>\n  <ul>\n   <li>Left in <code>unstable-lib</code>.</li></ul></li>\n <li><code>unstable/class-iop</code>\n  <ul>\n   <li>Moved to the <code>class-iop</code> package.</li></ul></li>\n <li><code>unstable/contract</code>\n  <ul>\n   <li>\n    <p>Moved <code>non-empty-string?</code> to <code>racket/string</code>.</p></li>\n   <li>\n    <p>Moved <code>port-number?</code> and <code>tcp-listen-port?</code> to <code>racket/tcp</code>, the latter renamed to <code>listen-port-number?</code>.</p></li>\n   <li>\n    <p>Moved <code>if/c</code>, <code>failure-result/c</code>, <code>predicate/c</code> and <code>rename-contract</code> to <code>racket/contract</code>.</p></li>\n   <li>\n    <p>Moved <code>treeof</code> to <code>plot/utils</code>.</p></li>\n   <li>\n    <p>Moved <code>sequence/c</code> to <code>racket/sequence</code>.</p></li>\n   <li>\n    <p>Left <code>path-piece?</code>, <code>maybe/c</code>, <code>truth/c</code> in <code>unstable-contract-lib</code>.</p></li></ul></li>\n <li><code>unstable/custom-write</code>\n  <ul>\n   <li>\n    <p>Moved <code>make-constructor-style-printer</code> to <code>racket/struct</code>.</p></li>\n   <li>\n    <p>Left <code>prop:auto-custom-write</code> in <code>unstable-lib</code>.</p></li></ul></li>\n <li><code>unstable/debug</code>\n  <ul>\n   <li>Left in <code>unstable-debug-lib</code>.</li></ul></li>\n <li><code>unstable/define</code>\n  <ul>\n   <li>Left in <code>unstable-lib</code>.</li></ul></li>\n <li><code>unstable/error</code>\n  <ul>\n   <li>Left in <code>unstable-lib</code>.</li></ul></li>\n <li><code>unstable/find</code>\n  <ul>\n   <li>Left in <code>unstable-lib</code>.</li></ul></li>\n <li><code>unstable/flonum</code>\n  <ul>\n   <li>Superseded by <code>math/flonum</code>. Left in <code>unstable-flonum-lib</code>.</li></ul></li>\n <li><code>unstable/function</code>\n  <ul>\n   <li>Merged with <code>racket/function</code>.</li></ul></li>\n <li><code>unstable/future</code>\n  <ul>\n   <li>Merged with <code>racket/future</code>.</li></ul></li>\n <li><code>unstable/gui/notify</code>\n  <ul>\n   <li>Moved to <code>framework/notify</code>, with naming changes.</li></ul></li>\n <li><code>unstable/gui/pict</code>\n  <ul>\n   <li>\n    <p>Moved <code>color/c</code>, <code>light</code>, <code>dark</code>, <code>red</code>, <code>orange</code>, <code>yellow</code>, <code>green</code>, <code>blue</code>, <code>purple</code>, <code>black</code>, <code>brown</code>, <code>gray</code>, <code>white</code>, <code>cyan</code>, and <code>magenta</code> to <code>pict/color</code>.</p></li>\n   <li>\n    <p>Moved <code>show</code>, <code>hide</code>, <code>pict-if</code>, <code>pict-cond</code>, and <code>pict-case</code> to <code>pict/conditional</code>.</p></li>\n   <li>\n    <p>Merged <code>scale-to</code> with <code>pict</code>&rsquo;s <code>scale-to-fit</code>.</p></li>\n   <li>\n    <p>Merged <code>ellipse/border</code>, <code>circle/border</code>, <code>rectangle/border</code>, <code>rounded-rectangle/border</code> with <code>pict</code>&rsquo;s <code>ellipse</code>, <code>circle</code>, <code>rectangle</code>, and <code>rounded-rectangle</code>, respectively.</p></li>\n   <li>\n    <p>Merged <code>pin-label-line</code>, <code>pin-arrow-label-line</code>, and <code>pin-arrows-label-line</code> with <code>pict</code>&rsquo;s <code>pin-line</code>, <code>pin-arrow-line</code>, and <code>pin-arrows-line</code>, respectively.</p></li>\n   <li>\n    <p>Moved <code>blur</code>, <code>shadow</code>, and <code>shadow-frame</code> to <code>pict/shadow</code>.</p></li>\n   <li>\n    <p>Moved <code>unstable/gui/pict/align</code> to <code>ppict/align</code>, in the <code>ppict</code> package.</p></li>\n   <li>\n    <p>Left <code>color</code>, <code>pict-match</code>, <code>pict-combine</code>, <code>with-pict-combine</code>, <code>fill</code>, <code>strike</code>, <code>shade</code>, <code>blur-bitmap!</code>, <code>arch</code>, <code>draw-pict-centered</code>, <code>backdrop</code>, <code>cross-out</code>, and <code>make-plt-title-background</code> in <code>unstable-lib</code>.</p></li></ul></li>\n <li><code>unstable/gui/ppict</code>\n  <ul>\n   <li>Moved to the <code>ppict</code> package.</li></ul></li>\n <li><code>unstable/gui/prefs</code>\n  <ul>\n   <li>Moved to <code>framework/preferences</code>, with naming changes.</li></ul></li>\n <li><code>unstable/gui/redex</code>\n  <ul>\n   <li>Left in <code>unstable-redex</code>.</li></ul></li>\n <li><code>unstable/gui/scribble</code>\n  <ul>\n   <li>Left in <code>unstable-lib</code>.</li></ul></li>\n <li><code>unstable/gui/slideshow</code>\n  <ul>\n   <li>\n    <p>Moved <code>with-size</code>, <code>with-scale</code>, <code>big</code>, <code>small</code>, <code>with-font</code>, <code>with-style</code>, <code>bold</code>, <code>italic</code>, <code>subscript</code>, <code>superscript</code>, <code>caps</code>, and <code>blank-line</code> to <code>slideshow/text</code>.</p></li>\n   <li>\n    <p>Moved <code>slide/staged</code>, <code>staged</code>, <code>stage</code>, <code>stage-name</code>, <code>at</code>, <code>before</code>, <code>after</code>, <code>before/at</code>, <code>after/at</code> to the <code>staged-slide</code> package.</p></li>\n   <li>\n    <p>Left <code>column</code>, <code>columns</code>, <code>column-size</code>, <code>two-columns</code>, <code>mini-slide</code>, <code>tabular</code>, <code>reveal</code>, <code>revealing-slide</code>, and <code>items-slide</code> in <code>unstable-lib</code>.</p></li></ul></li>\n <li><code>unstable/gui/snip</code>\n  <ul>\n   <li>Left in <code>unstable-lib</code>.</li></ul></li>\n <li><code>unstable/hash</code>\n  <ul>\n   <li>Merged with <code>racket/hash</code>.</li></ul></li>\n <li><code>unstable/latent-contract</code>\n  <ul>\n   <li>Left in <code>unstable-latent-contract-lib</code>.</li></ul></li>\n <li><code>unstable/lazy-require</code>\n  <ul>\n   <li>\n    <p><code>lazy-require</code> has been in <code>racket/lazy-require</code> for some time.</p></li>\n   <li>\n    <p>Left <code>begin-on-demand</code> in <code>unstable-lib</code>.</p></li></ul></li>\n <li><code>unstable/list</code>\n  <ul>\n   <li>\n    <p>Moved <code>check-duplicates</code>, <code>remf</code>, <code>remf*</code>, <code>group-by</code>, <code>cartesian-product</code>, <code>list-update</code>, and <code>list-set</code> to <code>racket/list</code>. * Moved <code>list-prefix?</code>, <code>take-common-prefix</code>, <code>drop-common-prefix</code>, and <code>split-common-prefix</code> to <code>racket/list</code>, with slight API changes to harmonize with Racket&rsquo;s list API.</p></li>\n   <li>\n    <p>Left <code>filter-multiple</code>, <code>extend</code>, <code>map/values</code>, and <code>map2</code> in <code>unstable-list-lib</code>.</p></li></ul></li>\n <li><code>unstable/logging</code>\n  <ul>\n   <li>\n    <p>Moved <code>with-intercepted-logging</code> and <code>with-logging-to-port</code> to <code>racket/logging</code>.</p></li>\n   <li>\n    <p>Left <code>start-recording</code> and <code>stop-recording</code> in <code>unstable-lib</code>.</p></li></ul></li>\n <li><code>unstable/macro-testing</code>\n  <ul>\n   <li>Moved to <code>syntax/macro-testing</code>.</li></ul></li>\n <li><code>unstable/markparam</code>\n  <ul>\n   <li>Moved to the <code>markparam</code> package.</li></ul></li>\n <li><code>unstable/open-place</code>\n  <ul>\n   <li>Moved <code>open-place</code> to <code>racket/place</code>, and renamed it <code>place/context</code>.</li></ul></li>\n <li><code>unstable/options</code>\n  <ul>\n   <li>Moved to the <code>option-contract</code> package.</li></ul></li>\n <li><code>unstable/parameter-group</code>\n  <ul>\n   <li>Moved to the <code>parameter-group</code> package.</li></ul></li>\n <li><code>unstable/pretty</code>\n  <ul>\n   <li>\n    <p>Merged <code>pretty-format/write</code>, <code>pretty-format/display</code>, and <code>pretty-format/print</code> with <code>racket/pretty</code>&rsquo;s <code>pretty-format</code>.</p></li>\n   <li>\n    <p>Left <code>break-lines</code> in <code>unstable-pretty-lib</code>.</p></li></ul></li>\n <li><code>unstable/recontract</code>\n  <ul>\n   <li>Merged with <code>racket/contract</code> some time ago.</li></ul></li>\n <li><code>unstable/sandbox</code>\n  <ul>\n   <li>Merged with <code>scribble/eval</code>.</li></ul></li>\n <li><code>unstable/sequence</code>\n  <ul>\n   <li>\n    <p>Moved <code>in-syntax</code> and <code>in-slice</code> to <code>racket/sequence</code>.</p></li>\n   <li>\n    <p>Left <code>in-pairs</code>, <code>in-sequence-forever</code>, and <code>sequence-lift</code> in <code>unstable-lib</code>.</p></li></ul></li>\n <li><code>unstable/socket</code>\n  <ul>\n   <li>Moved to the <code>unix-socket</code> package.</li></ul></li>\n <li><code>unstable/string</code>\n  <ul>\n   <li>Left in <code>unstable-lib</code>.</li></ul></li>\n <li><code>unstable/struct</code>\n  <ul>\n   <li>\n    <p>Moved <code>struct-&gt;list</code> to <code>racket/struct</code>.</p></li>\n   <li>\n    <p>Left <code>make</code> in <code>unstable-lib</code>.</p></li></ul></li>\n <li><code>unstable/syntax</code>\n  <ul>\n   <li>\n    <p>Moved <code>make-variable-like-transformer</code> to <code>syntax/transformer</code>.</p></li>\n   <li>\n    <p>Moved <code>syntax-source-directory</code> and <code>syntax-source-file-name</code> to <code>syntax/location</code>.</p></li>\n   <li>\n    <p>Left <code>explode-module-path-index</code>, <code>phase-of-enclosing-module</code>, <code>format-unique-id</code>, <code>syntax-length</code>, and <code>syntax-within?</code> in <code>unstable/syntax</code>.</p></li></ul></li>\n <li><code>unstable/temp-c</code>\n  <ul>\n   <li>Moved to the <code>temp-c</code> package.</li></ul></li>\n <li><code>unstable/time</code>\n  <ul>\n   <li>Left in <code>unstable-lib</code>.</li></ul></li>\n <li><code>unstable/wrapc</code>\n  <ul>\n   <li>Moved to <code>syntax/contract</code>.</li></ul></li></ul>\n<!-- more-->\n\n<hr />\n\n<p>Hi, it&rsquo;s my first day with Racket. Attempting to install the pict3d library is failing in a way that mentions not finding unstable/custom-write.</p>\n\n<p>I&rsquo;m guessing this probably relates to the reorganization mentioned above.</p>\n\n<p>Any tips? Thanks!</p>\n\n<p>— <em>Corporate Sheep, 27 November 2015</em></p>\n\n<hr />")) ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2007-08-22-new-debugger-features.md" . unix) f post (u . "New Debugger Features") (? . 104) 1467223812 (p+ #"/Users/MB/git/racket-lang-org/blog/2007/08/new-debugger-features.html" . unix) "/2007/08/new-debugger-features.html" (u . "2007-08-22T21:54:00.001-04:00") (? . 105) (? . 106) (c (u . "")) (u . "\n<p><em>posted by Greg Cooper</em></p>\n\n<p>As Eli mentioned, v371 introduces support for debugging several files at a time, as well as new buttons for stepping Over and Out of expressions in the debugger.</p>\n\n<p>Debugging across multiple files is easy. Start by opening the &ldquo;main&rdquo; file that you want to debug and all of the files it requires (directly or indirectly) that you want to debug along with it. Then click Debug in the main file&rsquo;s frame. For example, if I wanted to see what the FrTime dataflow engine (in frp-core.ss) does when a particular program (say demo-module.ss) runs, I would open these two files and click Debug in the frame for demo-module.ss.</p>\n\n<p>As each required file loads, DrScheme offers the option of debugging it. If you choose &ldquo;yes&rdquo;, then the file is included in the debugging session, so you can set breakpoints and step into it. (Note that this will make the code in the file run more slowly, and single-stepping at calls to its functions will bring you into it.) A file can only participate in one debugging session at a time, so if you&rsquo;re already debugging it with some other program, DrScheme will tell you so (instead of asking whether to debug it). For best results, all of the files you debug should be modules. Once a file is included in the debugging session, you can set breakpoints and step into it as if you were debugging it by itself.</p>\n\n<p>As soon as you can debug programs that span several files, it&rsquo;s particularly valuable to be able to do more than set breakpoints and single-step. This is the motivation for the new Over and Out buttons, which are also quite simple. If the execution marker is at the start of an expression that&rsquo;s not in tail position, then you can step over the entire expression, which is equivalent to setting a one-shot breakpoint at the end of the expression and continuing. (If you&rsquo;ve set breakpoints inside the expression, or inside any functions it calls, then execution may suspend before reaching the end.) Likewise, if execution is suspended and the current expression is evaluating within a debugging-enabled context, then you can step out to the innermost such context. This would be difficult to simulate by hand, since you&rsquo;d need to keep track of recent callers.</p>\n\n<p>At any given point, either or both of the Over and Out buttons may be disabled, but over the course of a session they can eliminate a lot of tedium.</p>\n\n<p>The screenshot above shows a session debugging frp-core.ss as used by demo-module.ss. Execution is suspended on a right paren, so stepping Over is disabled, but we see the expression&rsquo;s value at the upper left, we&rsquo;ve moused over b to see its value at the upper right, and it&rsquo;s possible to step Out.</p>") #f (u . "\n<p><em>posted by Greg Cooper</em></p>\n\n<p>As Eli mentioned, v371 introduces support for debugging several files at a time, as well as new buttons for stepping Over and Out of expressions in the debugger.</p>\n\n<p>Debugging across multiple files is easy. Start by opening the &ldquo;main&rdquo; file that you want to debug and all of the files it requires (directly or indirectly) that you want to debug along with it. Then click Debug in the main file&rsquo;s frame. For example, if I wanted to see what the FrTime dataflow engine (in frp-core.ss) does when a particular program (say demo-module.ss) runs, I would open these two files and click Debug in the frame for demo-module.ss.</p>\n\n<p>As each required file loads, DrScheme offers the option of debugging it. If you choose &ldquo;yes&rdquo;, then the file is included in the debugging session, so you can set breakpoints and step into it. (Note that this will make the code in the file run more slowly, and single-stepping at calls to its functions will bring you into it.) A file can only participate in one debugging session at a time, so if you&rsquo;re already debugging it with some other program, DrScheme will tell you so (instead of asking whether to debug it). For best results, all of the files you debug should be modules. Once a file is included in the debugging session, you can set breakpoints and step into it as if you were debugging it by itself.</p>\n\n<p>As soon as you can debug programs that span several files, it&rsquo;s particularly valuable to be able to do more than set breakpoints and single-step. This is the motivation for the new Over and Out buttons, which are also quite simple. If the execution marker is at the start of an expression that&rsquo;s not in tail position, then you can step over the entire expression, which is equivalent to setting a one-shot breakpoint at the end of the expression and continuing. (If you&rsquo;ve set breakpoints inside the expression, or inside any functions it calls, then execution may suspend before reaching the end.) Likewise, if execution is suspended and the current expression is evaluating within a debugging-enabled context, then you can step out to the innermost such context. This would be difficult to simulate by hand, since you&rsquo;d need to keep track of recent callers.</p>\n\n<p>At any given point, either or both of the Over and Out buttons may be disabled, but over the course of a session they can eliminate a lot of tedium.</p>\n\n<p>The screenshot above shows a session debugging frp-core.ss as used by demo-module.ss. Execution is suspended on a right paren, so stepping Over is disabled, but we see the expression&rsquo;s value at the upper left, we&rsquo;ve moused over b to see its value at the upper right, and it&rsquo;s possible to step Out.</p>")) ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2010-11-07-racket-v502.md" . unix) f post (u . "Racket v5.0.2") (? . 107) 1467223812 (p+ #"/Users/MB/git/racket-lang-org/blog/2010/11/racket-v502.html" . unix) "/2010/11/racket-v502.html" (u . "2010-11-07T01:33:00.000-04:00") (? . 108) (? . 46) (c (u . "")) (u . "\n<p><em>posted by Eli Barzilay</em></p>\n\n<p>Racket version 5.0.2 is now available from <a href=\"http://racket-lang.org/\">http://racket-lang.org/</a></p>\n\n<ul>\n <li>\n  <p>Typed Racket&rsquo;s optimizer is now turned on by default; error messages have been simplified and clarified.</p></li>\n <li>\n  <p>Contracts: contracts on mutable containers allow functions or other higher order values, and contracts are checked when updating or dereferencing the containers. The new contracts are slower than the old ones, so the old check-once functionality is still available.A new dependent function contract combinator, <code>-&gt;i</code>, properly assigns blame for contracts that violate themselves and the generated wrappers are more efficient than <code>-&gt;d</code>. (Although it does more checking so your contracts may be faster or slower).See the docs for <code>box/c</code>, <code>hash/c</code>, <code>vector/c</code>, <code>vectorof</code> and <code>-&gt;i</code> for more details.</p></li>\n <li>\n  <p>The <code>when</code>, <code>unless</code>, <code>cond</code>, <code>case</code>, and <code>match</code> forms (in <code>racket/base</code> and derived languages) now allow immediate internal definitions.</p></li>\n <li>\n  <p>Web server: the formlets library provides more HTML form elements; <code>make-xexpr-response</code> supports a preamble for DTD declarations; <code>serve/servlet</code> supports stateless servlets.</p></li>\n <li>\n  <p>New WebSocket implementation, see <code>net/websocket</code> for details.</p></li>\n <li>\n  <p>The new <code>data</code> collection contains implementations of several data structures, including growable vectors and order-based dictionaries.</p></li>\n <li>\n  <p><code>racket/match</code> is now significantly faster.</p></li>\n <li>\n  <p>The Racket documentations are built in parallel by default.</p></li>\n <li>\n  <p>The stepper is now compatible with programs using the Universe teachpack.</p></li>\n <li>\n  <p><code>2htdp/image</code>: pinholes are now supported in the library (if you don&rsquo;t use pinhole primitives you will not see them); a number of new triangle functions added; supports conversion of images to color lists and back. Also, cropping has been improved for scenes; see the documentation section on the nitty-gritty of pixels for details.</p></li>\n <li>\n  <p>Signatures have been moved to ASL, BSL, BSL+, ISL, and ISL+ (HtDP teaching languages) no longer support checked signatures.</p></li>\n <li>\n  <p>Student languages: one-armed <code>check-error</code> in all levels; ASL is extended with hash operations, and <code>define-datatype</code>.</p></li>\n <li>\n  <p>DMdA languages: Checking for parametric signatures is now eager. This catches errors earlier, but retains the asymptotic complexity properties; signatures for record types now have generators; <code>list-of</code> and <code>any</code> signatures are now provided.</p></li></ul>") #f (u . "\n<p><em>posted by Eli Barzilay</em></p>\n\n<p>Racket version 5.0.2 is now available from <a href=\"http://racket-lang.org/\">http://racket-lang.org/</a></p>\n\n<ul>\n <li>\n  <p>Typed Racket&rsquo;s optimizer is now turned on by default; error messages have been simplified and clarified.</p></li>\n <li>\n  <p>Contracts: contracts on mutable containers allow functions or other higher order values, and contracts are checked when updating or dereferencing the containers. The new contracts are slower than the old ones, so the old check-once functionality is still available.A new dependent function contract combinator, <code>-&gt;i</code>, properly assigns blame for contracts that violate themselves and the generated wrappers are more efficient than <code>-&gt;d</code>. (Although it does more checking so your contracts may be faster or slower).See the docs for <code>box/c</code>, <code>hash/c</code>, <code>vector/c</code>, <code>vectorof</code> and <code>-&gt;i</code> for more details.</p></li>\n <li>\n  <p>The <code>when</code>, <code>unless</code>, <code>cond</code>, <code>case</code>, and <code>match</code> forms (in <code>racket/base</code> and derived languages) now allow immediate internal definitions.</p></li>\n <li>\n  <p>Web server: the formlets library provides more HTML form elements; <code>make-xexpr-response</code> supports a preamble for DTD declarations; <code>serve/servlet</code> supports stateless servlets.</p></li>\n <li>\n  <p>New WebSocket implementation, see <code>net/websocket</code> for details.</p></li>\n <li>\n  <p>The new <code>data</code> collection contains implementations of several data structures, including growable vectors and order-based dictionaries.</p></li>\n <li>\n  <p><code>racket/match</code> is now significantly faster.</p></li>\n <li>\n  <p>The Racket documentations are built in parallel by default.</p></li>\n <li>\n  <p>The stepper is now compatible with programs using the Universe teachpack.</p></li>\n <li>\n  <p><code>2htdp/image</code>: pinholes are now supported in the library (if you don&rsquo;t use pinhole primitives you will not see them); a number of new triangle functions added; supports conversion of images to color lists and back. Also, cropping has been improved for scenes; see the documentation section on the nitty-gritty of pixels for details.</p></li>\n <li>\n  <p>Signatures have been moved to ASL, BSL, BSL+, ISL, and ISL+ (HtDP teaching languages) no longer support checked signatures.</p></li>\n <li>\n  <p>Student languages: one-armed <code>check-error</code> in all levels; ASL is extended with hash operations, and <code>define-datatype</code>.</p></li>\n <li>\n  <p>DMdA languages: Checking for parametric signatures is now eager. This catches errors earlier, but retains the asymptotic complexity properties; signatures for record types now have generators; <code>list-of</code> and <code>any</code> signatures are now provided.</p></li></ul>")) ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2008-11-24-simple-gnuplotting.md" . unix) f post (u . "Simple GnuPLoTting") (? . 109) 1467223812 (p+ #"/Users/MB/git/racket-lang-org/blog/2008/11/simple-gnuplotting.html" . unix) "/2008/11/simple-gnuplotting.html" (u . "2008-11-24T17:19:00.019-05:00") (? . 110) (? . 7) (c (u . "")) (u . "\n<p><em>posted by vyzo</em></p>\n\n<p><a href=\"http://www.gnuplot.info/\">gnuplot</a> is a very powerful and widely used interactive data plotting program. It can generate two-dimenational and three-dimensional surface plots, either on screen or print to files with a wide-array of supported formats. If you are not familiar with it, you can get an idea of its capabilities <a href=\"http://gnuplot.sourceforge.net/demo/\">here</a></p>\n\n<p>A new package, <a href=\"http://planet.plt-scheme.org/display.ss?package=gnuplot.plt&amp;amp;owner=vyzo\">gnuplot.plt</a>, is now available on planet which allows you to programmatically interact with gnuplot processes and generate plots on the fly. The package provides a simple interface that abstracts gnuplot&rsquo;s quirky syntax and takes care of data marshalling using temporary files.</p>\n\n<p>Without further ado, here is to every computer scientist&rsquo;s favorite growth curves:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">require</span> <span class=\"p\">(</span><span class=\"k\">planet</span> <span class=\"n\">vyzo/gnuplot</span><span class=\"p\">))</span>\n<span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"n\">gplot</span> <span class=\"p\">(</span><span class=\"n\">gnuplot-spawn</span><span class=\"p\">))</span>\n<span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"n\">data</span> \n  <span class=\"p\">(</span><span class=\"n\">gnuplot-data</span>\n   <span class=\"p\">(</span><span class=\"nb\">build-list</span> <span class=\"mi\">90</span>\n     <span class=\"p\">(</span><span class=\"k\">lambda</span> <span class=\"p\">(</span><span class=\"n\">x</span><span class=\"p\">)</span> \n       <span class=\"p\">(</span><span class=\"k\">let</span> <span class=\"p\">((</span><span class=\"n\">x</span> <span class=\"p\">(</span><span class=\"nb\">add1</span> <span class=\"p\">(</span><span class=\"nb\">/</span> <span class=\"n\">x</span> <span class=\"mf\">10.</span><span class=\"p\">))))</span>\n         <span class=\"p\">(</span><span class=\"nb\">list</span> <span class=\"n\">x</span> <span class=\"p\">(</span><span class=\"nb\">log</span> <span class=\"n\">x</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"nb\">*</span> <span class=\"n\">x</span> <span class=\"p\">(</span><span class=\"nb\">log</span> <span class=\"n\">x</span><span class=\"p\">))</span> <span class=\"p\">(</span><span class=\"nb\">expt</span> <span class=\"n\">x</span> <span class=\"mi\">2</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"nb\">expt</span> <span class=\"mi\">2</span> <span class=\"n\">x</span><span class=\"p\">)))))))</span>\n<span class=\"c1\">;; png output options</span>\n<span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"n\">png</span> <span class=\"o\">&#39;</span><span class=\"p\">(</span><span class=\"ss\">png</span> <span class=\"ss\">enhanced</span> <span class=\"ss\">transparent</span> <span class=\"ss\">font</span> <span class=\"p\">(</span><span class=\"ss\">str</span> <span class=\"ss\">arial</span><span class=\"p\">)))</span>\n<span class=\"c1\">;; on screen plot</span>\n<span class=\"p\">(</span><span class=\"n\">gnuplot-set</span> <span class=\"n\">gplot</span> <span class=\"o\">&#39;</span><span class=\"p\">(</span><span class=\"ss\">title</span> <span class=\"p\">(</span><span class=\"ss\">str</span> <span class=\"s2\">\"growth curves\"</span><span class=\"p\">)))</span>\n<span class=\"p\">(</span><span class=\"n\">gnuplot-plot</span> <span class=\"n\">gplot</span> \n  <span class=\"kd\">#:range</span> <span class=\"o\">&#39;</span><span class=\"p\">(()</span> <span class=\"p\">(</span><span class=\"mi\">1</span> <span class=\"mi\">1000</span><span class=\"p\">))</span>\n  <span class=\"p\">(</span><span class=\"n\">gnuplot-item</span> <span class=\"n\">data</span> <span class=\"o\">&#39;</span><span class=\"p\">(</span><span class=\"ss\">using</span> <span class=\"p\">(</span><span class=\"ss\">seq:</span> <span class=\"mi\">1</span> <span class=\"mi\">1</span><span class=\"p\">)</span> <span class=\"ss\">title</span> <span class=\"p\">(</span><span class=\"ss\">str</span> <span class=\"s2\">\"x\"</span><span class=\"p\">)</span> <span class=\"ss\">with</span> <span class=\"ss\">line</span><span class=\"p\">))</span>\n  <span class=\"p\">(</span><span class=\"n\">gnuplot-item</span> <span class=\"n\">data</span> <span class=\"o\">&#39;</span><span class=\"p\">(</span><span class=\"ss\">using</span> <span class=\"p\">(</span><span class=\"ss\">seq:</span> <span class=\"mi\">1</span> <span class=\"mi\">2</span><span class=\"p\">)</span> <span class=\"ss\">title</span> <span class=\"p\">(</span><span class=\"ss\">str</span> <span class=\"s2\">\"log(x)\"</span><span class=\"p\">)</span> <span class=\"ss\">with</span> <span class=\"ss\">line</span><span class=\"p\">))</span>\n  <span class=\"p\">(</span><span class=\"n\">gnuplot-item</span> <span class=\"n\">data</span> <span class=\"o\">&#39;</span><span class=\"p\">(</span><span class=\"ss\">using</span> <span class=\"p\">(</span><span class=\"ss\">seq:</span> <span class=\"mi\">1</span> <span class=\"mi\">3</span><span class=\"p\">)</span> <span class=\"ss\">title</span> <span class=\"p\">(</span><span class=\"ss\">str</span> <span class=\"s2\">\"xlog(x)\"</span><span class=\"p\">)</span> <span class=\"ss\">with</span> <span class=\"ss\">line</span><span class=\"p\">))</span>\n  <span class=\"p\">(</span><span class=\"n\">gnuplot-item</span> <span class=\"n\">data</span> <span class=\"o\">&#39;</span><span class=\"p\">(</span><span class=\"ss\">using</span> <span class=\"p\">(</span><span class=\"ss\">seq:</span> <span class=\"mi\">1</span> <span class=\"mi\">4</span><span class=\"p\">)</span> <span class=\"ss\">title</span> <span class=\"p\">(</span><span class=\"ss\">str</span> <span class=\"s2\">\"x^2\"</span><span class=\"p\">)</span> <span class=\"ss\">with</span> <span class=\"ss\">line</span><span class=\"p\">))</span>\n  <span class=\"p\">(</span><span class=\"n\">gnuplot-item</span> <span class=\"n\">data</span> <span class=\"o\">&#39;</span><span class=\"p\">(</span><span class=\"ss\">using</span> <span class=\"p\">(</span><span class=\"ss\">seq:</span> <span class=\"mi\">1</span> <span class=\"mi\">5</span><span class=\"p\">)</span> <span class=\"ss\">title</span> <span class=\"p\">(</span><span class=\"ss\">str</span> <span class=\"s2\">\"2^x\"</span><span class=\"p\">)</span> <span class=\"ss\">with</span> <span class=\"ss\">line</span><span class=\"p\">)))</span>\n<span class=\"c1\">;; replot to png</span>\n<span class=\"p\">(</span><span class=\"n\">gnuplot-hardcopy</span> <span class=\"n\">gplot</span> <span class=\"s2\">\"/tmp/grow.png\"</span> <span class=\"kd\">#:term</span> <span class=\"n\">png</span><span class=\"p\">)</span>\n<span class=\"c1\">;; redo with logscale</span>\n<span class=\"p\">(</span><span class=\"n\">gnuplot-set</span> <span class=\"n\">gplot</span> <span class=\"o\">&#39;</span><span class=\"p\">(</span><span class=\"ss\">logscale</span> <span class=\"ss\">y</span><span class=\"p\">))</span>\n<span class=\"p\">(</span><span class=\"n\">gnuplot-replot</span> <span class=\"n\">gplot</span><span class=\"p\">)</span>\n<span class=\"p\">(</span><span class=\"n\">gnuplot-hardcopy</span> <span class=\"n\">gplot</span> <span class=\"s2\">\"/tmp/loggrow.png\"</span> <span class=\"kd\">#:term</span> <span class=\"n\">png</span><span class=\"p\">)</span>\n</pre></div>\n\n</div>") #t (u . "\n<p><em>posted by vyzo</em></p>\n\n<p><a href=\"http://www.gnuplot.info/\">gnuplot</a> is a very powerful and widely used interactive data plotting program. It can generate two-dimenational and three-dimensional surface plots, either on screen or print to files with a wide-array of supported formats. If you are not familiar with it, you can get an idea of its capabilities <a href=\"http://gnuplot.sourceforge.net/demo/\">here</a></p>\n\n<p>A new package, <a href=\"http://planet.plt-scheme.org/display.ss?package=gnuplot.plt&amp;amp;owner=vyzo\">gnuplot.plt</a>, is now available on planet which allows you to programmatically interact with gnuplot processes and generate plots on the fly. The package provides a simple interface that abstracts gnuplot&rsquo;s quirky syntax and takes care of data marshalling using temporary files.</p>\n\n<p>Without further ado, here is to every computer scientist&rsquo;s favorite growth curves:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">require</span> <span class=\"p\">(</span><span class=\"k\">planet</span> <span class=\"n\">vyzo/gnuplot</span><span class=\"p\">))</span>\n<span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"n\">gplot</span> <span class=\"p\">(</span><span class=\"n\">gnuplot-spawn</span><span class=\"p\">))</span>\n<span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"n\">data</span> \n  <span class=\"p\">(</span><span class=\"n\">gnuplot-data</span>\n   <span class=\"p\">(</span><span class=\"nb\">build-list</span> <span class=\"mi\">90</span>\n     <span class=\"p\">(</span><span class=\"k\">lambda</span> <span class=\"p\">(</span><span class=\"n\">x</span><span class=\"p\">)</span> \n       <span class=\"p\">(</span><span class=\"k\">let</span> <span class=\"p\">((</span><span class=\"n\">x</span> <span class=\"p\">(</span><span class=\"nb\">add1</span> <span class=\"p\">(</span><span class=\"nb\">/</span> <span class=\"n\">x</span> <span class=\"mf\">10.</span><span class=\"p\">))))</span>\n         <span class=\"p\">(</span><span class=\"nb\">list</span> <span class=\"n\">x</span> <span class=\"p\">(</span><span class=\"nb\">log</span> <span class=\"n\">x</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"nb\">*</span> <span class=\"n\">x</span> <span class=\"p\">(</span><span class=\"nb\">log</span> <span class=\"n\">x</span><span class=\"p\">))</span> <span class=\"p\">(</span><span class=\"nb\">expt</span> <span class=\"n\">x</span> <span class=\"mi\">2</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"nb\">expt</span> <span class=\"mi\">2</span> <span class=\"n\">x</span><span class=\"p\">)))))))</span>\n<span class=\"c1\">;; png output options</span>\n<span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"n\">png</span> <span class=\"o\">&#39;</span><span class=\"p\">(</span><span class=\"ss\">png</span> <span class=\"ss\">enhanced</span> <span class=\"ss\">transparent</span> <span class=\"ss\">font</span> <span class=\"p\">(</span><span class=\"ss\">str</span> <span class=\"ss\">arial</span><span class=\"p\">)))</span>\n<span class=\"c1\">;; on screen plot</span>\n<span class=\"p\">(</span><span class=\"n\">gnuplot-set</span> <span class=\"n\">gplot</span> <span class=\"o\">&#39;</span><span class=\"p\">(</span><span class=\"ss\">title</span> <span class=\"p\">(</span><span class=\"ss\">str</span> <span class=\"s2\">\"growth curves\"</span><span class=\"p\">)))</span>\n<span class=\"p\">(</span><span class=\"n\">gnuplot-plot</span> <span class=\"n\">gplot</span> \n  <span class=\"kd\">#:range</span> <span class=\"o\">&#39;</span><span class=\"p\">(()</span> <span class=\"p\">(</span><span class=\"mi\">1</span> <span class=\"mi\">1000</span><span class=\"p\">))</span>\n  <span class=\"p\">(</span><span class=\"n\">gnuplot-item</span> <span class=\"n\">data</span> <span class=\"o\">&#39;</span><span class=\"p\">(</span><span class=\"ss\">using</span> <span class=\"p\">(</span><span class=\"ss\">seq:</span> <span class=\"mi\">1</span> <span class=\"mi\">1</span><span class=\"p\">)</span> <span class=\"ss\">title</span> <span class=\"p\">(</span><span class=\"ss\">str</span> <span class=\"s2\">\"x\"</span><span class=\"p\">)</span> <span class=\"ss\">with</span> <span class=\"ss\">line</span><span class=\"p\">))</span>\n  <span class=\"p\">(</span><span class=\"n\">gnuplot-item</span> <span class=\"n\">data</span> <span class=\"o\">&#39;</span><span class=\"p\">(</span><span class=\"ss\">using</span> <span class=\"p\">(</span><span class=\"ss\">seq:</span> <span class=\"mi\">1</span> <span class=\"mi\">2</span><span class=\"p\">)</span> <span class=\"ss\">title</span> <span class=\"p\">(</span><span class=\"ss\">str</span> <span class=\"s2\">\"log(x)\"</span><span class=\"p\">)</span> <span class=\"ss\">with</span> <span class=\"ss\">line</span><span class=\"p\">))</span>\n  <span class=\"p\">(</span><span class=\"n\">gnuplot-item</span> <span class=\"n\">data</span> <span class=\"o\">&#39;</span><span class=\"p\">(</span><span class=\"ss\">using</span> <span class=\"p\">(</span><span class=\"ss\">seq:</span> <span class=\"mi\">1</span> <span class=\"mi\">3</span><span class=\"p\">)</span> <span class=\"ss\">title</span> <span class=\"p\">(</span><span class=\"ss\">str</span> <span class=\"s2\">\"xlog(x)\"</span><span class=\"p\">)</span> <span class=\"ss\">with</span> <span class=\"ss\">line</span><span class=\"p\">))</span>\n  <span class=\"p\">(</span><span class=\"n\">gnuplot-item</span> <span class=\"n\">data</span> <span class=\"o\">&#39;</span><span class=\"p\">(</span><span class=\"ss\">using</span> <span class=\"p\">(</span><span class=\"ss\">seq:</span> <span class=\"mi\">1</span> <span class=\"mi\">4</span><span class=\"p\">)</span> <span class=\"ss\">title</span> <span class=\"p\">(</span><span class=\"ss\">str</span> <span class=\"s2\">\"x^2\"</span><span class=\"p\">)</span> <span class=\"ss\">with</span> <span class=\"ss\">line</span><span class=\"p\">))</span>\n  <span class=\"p\">(</span><span class=\"n\">gnuplot-item</span> <span class=\"n\">data</span> <span class=\"o\">&#39;</span><span class=\"p\">(</span><span class=\"ss\">using</span> <span class=\"p\">(</span><span class=\"ss\">seq:</span> <span class=\"mi\">1</span> <span class=\"mi\">5</span><span class=\"p\">)</span> <span class=\"ss\">title</span> <span class=\"p\">(</span><span class=\"ss\">str</span> <span class=\"s2\">\"2^x\"</span><span class=\"p\">)</span> <span class=\"ss\">with</span> <span class=\"ss\">line</span><span class=\"p\">)))</span>\n<span class=\"c1\">;; replot to png</span>\n<span class=\"p\">(</span><span class=\"n\">gnuplot-hardcopy</span> <span class=\"n\">gplot</span> <span class=\"s2\">\"/tmp/grow.png\"</span> <span class=\"kd\">#:term</span> <span class=\"n\">png</span><span class=\"p\">)</span>\n<span class=\"c1\">;; redo with logscale</span>\n<span class=\"p\">(</span><span class=\"n\">gnuplot-set</span> <span class=\"n\">gplot</span> <span class=\"o\">&#39;</span><span class=\"p\">(</span><span class=\"ss\">logscale</span> <span class=\"ss\">y</span><span class=\"p\">))</span>\n<span class=\"p\">(</span><span class=\"n\">gnuplot-replot</span> <span class=\"n\">gplot</span><span class=\"p\">)</span>\n<span class=\"p\">(</span><span class=\"n\">gnuplot-hardcopy</span> <span class=\"n\">gplot</span> <span class=\"s2\">\"/tmp/loggrow.png\"</span> <span class=\"kd\">#:term</span> <span class=\"n\">png</span><span class=\"p\">)</span>\n</pre></div>\n\n</div>\n<!-- more-->\n\n<hr />\n\n<p>Hi, perhaps this is a really stupid question, but which language was your code snippet written in? If I try and run it with DrScheme in ASL it throws an error on the require function. I can get it to execute with Essentials of Programming Languages 3rd language, but then I had to define add1 and build-list. After that, it still errors on the gnuploy-hardcopy, which I presume means this is the wrong language.</p>\n\n<p>— <em>Daniel, 23 December 2008</em></p>\n\n<hr />\n\n<p>Hi Daniel,</p>\n\n<p>Add the line</p>\n\n<pre><code>#lang scheme</code></pre>\n\n<p>and run it in the &ldquo;module&rdquo; language.</p>\n\n<p>Merry Christmas, Jens Axel</p>\n\n<p>— <em>Jens Axel Søgaard, 24 December 2008</em></p>\n\n<hr />\n\n<p>Thanks! I was about to code an interface to gnuplot, and I see you&rsquo;ve already done it. I owe you a beer (at least).</p>\n\n<p>— <em>Geoff Knauth, 27 October 2011</em></p>\n\n<hr />")) ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2011-08-16-racket-v513.md" . unix) f post (u . "Racket v5.1.3") (? . 111) 1467223812 (p+ #"/Users/MB/git/racket-lang-org/blog/2011/08/racket-v513.html" . unix) "/2011/08/racket-v513.html" (u . "2011-08-16T04:15:00.000-04:00") (? . 112) (? . 48) (c (u . "")) (u . "\n<p><em>posted by Eli Barzilay</em></p>\n\n<p>Racket version 5.1.3 is now available from <a href=\"http://racket-lang.org/\">http://racket-lang.org/</a>This is a bugfix release, resolving the DrRacket issue with the contour view. In addition, two tex files with problematic licensing were removed.</p>") #f (u . "\n<p><em>posted by Eli Barzilay</em></p>\n\n<p>Racket version 5.1.3 is now available from <a href=\"http://racket-lang.org/\">http://racket-lang.org/</a>This is a bugfix release, resolving the DrRacket issue with the contour view. In addition, two tex files with problematic licensing were removed.</p>")) ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2012-11-01-generics.md" . unix) f post (u . "Generics") (? . 113) 1467223812 (p+ #"/Users/MB/git/racket-lang-org/blog/2012/11/generics.html" . unix) "/2012/11/generics.html" (u . "2012-11-01T14:39:00.000-04:00") (? . 128) (? . 32) (c (u . "")) (u . "\n<p><em>posted by Asumu Takikawa</em></p>\n\n<p>Recently at <a href=\"http://con.racket-lang.org/\">RacketCon</a>, I gave a talk about the new Generics library that ships with Racket 5.3. In this blog post, I’ll offer a slightly expanded commentary about the new library. For the ten-minute video explanation, see the <a href=\"http://www.youtube.com/watch?v=MYtm9YG4tMM\">Youtube</a> video. The accompanying slides are available <a href=\"http://www.ccs.neu.edu/home/asumu/slides/racketcon-2012-generics.pdf\">here</a>.</p>\n\n<h2 id=\"introduction\">Introduction</h2>\n\n<p>Probably the first question that comes to your mind is: what are generics and what do we mean by generic programming? Let me illustrate with some example code:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"nb\">&gt;</span> <span class=\"p\">(</span><span class=\"n\">vector-ref#</span><span class=\"p\">(</span><span class=\"mi\">123</span><span class=\"p\">)</span><span class=\"mi\">2</span><span class=\"p\">)</span>\n<span class=\"mi\">3</span>\n<span class=\"nb\">&gt;</span> <span class=\"p\">(</span><span class=\"nb\">list-ref</span><span class=\"o\">&#39;</span><span class=\"p\">(</span><span class=\"mi\">123</span><span class=\"p\">)</span><span class=\"mi\">2</span><span class=\"p\">)</span>\n<span class=\"mi\">3</span>\n</pre></div>\n\n</div>\n\n<p>Both of the lines above operate on sequence-like datatypes, but for each of the datatypes we use different functions: <code>vector-ref</code> and <code>list-ref</code>. This is also the case with other datatypes like dictionary-like datatypes: <code>hash-ref</code>, <code>assoc</code>, etc. Or all the different kinds of equality: <code>string=?</code>, <code>boolean=?</code>, and <code>=</code>. These specialized operations may seem redundant. Ideally, we’d have generic functions that don’t care about the specific datatypes that we operate over.</p>\n\n<p>Thankfully, Racket does provide these. For dictionaries, we have functions like <code>dict-ref</code> and <code>dict-set</code> that operate over any kind of dictionary-like type. For sequences, <code>sequence-ref</code>, <code>sequence-append</code>, and so on. These generic interfaces are all built-in to the standard library. You might wonder, however, if you can define your own generic functions.</p>\n\n<p>As of version 5.3, you just need to (require racket/generic) to get all the tools you need to define your own generic interface. In the rest of the article I’ll show you how to define your own generic interface and how to use it. If you’ve seen Rust’s <a href=\"http://pcwalton.github.com/blog/2012/08/08/a-gentle-introduction-to-traits-in-rust\">traits</a> or Clojure’s <a href=\"http://clojure.org/protocols\">protocols</a>, our design will feel familiar.</p>\n\n<h2 id=\"examples\">Examples</h2>\n\n<p>The running example will be the implementation of a simple queue interface. Our queue will contain five operations: <code>queue-enqueue</code>, <code>queue-dequeue</code>, <code>queue-head</code>, <code>queue-empty?</code>, and <code>queue-length</code>.</p>\n\n<p>The first thing to do is to require the library:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"nb\">&gt;</span> <span class=\"p\">(</span><span class=\"n\">requireracket/generic</span><span class=\"p\">)</span>\n</pre></div>\n\n</div>\n\n<p>Then we use define-generics to define a generic interface:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"nb\">&gt;</span> <span class=\"p\">(</span><span class=\"n\">define-generics</span> <span class=\"n\">queue</span>\n    <span class=\"p\">[</span><span class=\"n\">queue-enqueue</span> <span class=\"n\">queue</span> <span class=\"n\">elem</span><span class=\"p\">]</span>\n    <span class=\"p\">[</span><span class=\"n\">queue-dequeue</span> <span class=\"n\">queue</span><span class=\"p\">]</span>\n    <span class=\"p\">[</span><span class=\"n\">queue-head</span> <span class=\"n\">queue</span><span class=\"p\">]</span>\n    <span class=\"p\">[</span><span class=\"n\">queue-empty?</span> <span class=\"n\">queue</span><span class=\"p\">]</span>\n    <span class=\"p\">[</span><span class=\"n\">queue-length</span> <span class=\"n\">queue</span><span class=\"p\">])</span>\n</pre></div>\n\n</div>\n\n<p>The method headers above define the methods that concrete implementations of the generic interface need to provide. Each header needs to contain at least one argument that matches the name of the interface; this argument will be used for dispatch. The form defines several identifiers: queue?, gen:queue, queue/c, and each of the generic functions. The first is a predicate that checks whether a given value implements the interface. The identifier prefixed with gen: is a binding that’s used to supply methods for the interface. The queue/c specifies a contract combinator for the interface, which I’ll describe later in the article.</p>\n\n<p>We now have the generic functions, but they’re not very useful without concrete implementations. To implement a generic interface, you first need to define a structure type. We’ll define a simple functional queue(Okasaki 1998, p.42) that uses two lists:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"nb\">&gt;</span> <span class=\"p\">(</span><span class=\"k\">struct</span> <span class=\"n\">simple-queue</span> <span class=\"p\">(</span><span class=\"n\">front</span> <span class=\"n\">back</span><span class=\"p\">)</span>\n    <span class=\"kd\">#:methods</span> <span class=\"n\">gen:queue</span>\n    <span class=\"p\">[</span><span class=\"c1\">; helper function to balance lists</span>\n     <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">check-front</span> <span class=\"n\">queue</span><span class=\"p\">)</span>\n       <span class=\"p\">(</span><span class=\"k\">match</span> <span class=\"n\">queue</span>\n         <span class=\"p\">[(</span><span class=\"n\">simple-queue</span> <span class=\"o\">&#39;</span><span class=\"p\">()</span> <span class=\"n\">back</span><span class=\"p\">)</span>\n          <span class=\"p\">(</span><span class=\"n\">simple-queue</span> <span class=\"p\">(</span><span class=\"nb\">reverse</span> <span class=\"n\">back</span><span class=\"p\">)</span> <span class=\"o\">&#39;</span><span class=\"p\">())]</span>\n         <span class=\"p\">[</span><span class=\"k\">_</span> <span class=\"n\">queue</span><span class=\"p\">]))</span>\n     <span class=\"c1\">; enqueue an element</span>\n     <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">queue-enqueue</span> <span class=\"n\">queue</span> <span class=\"n\">elem</span><span class=\"p\">)</span>\n       <span class=\"p\">(</span><span class=\"k\">match</span> <span class=\"n\">queue</span>\n         <span class=\"p\">[(</span><span class=\"n\">simple-queue</span> <span class=\"n\">front</span> <span class=\"n\">back</span><span class=\"p\">)</span>\n          <span class=\"p\">(</span><span class=\"n\">check-front</span> <span class=\"p\">(</span><span class=\"n\">simple-queue</span> <span class=\"n\">front</span> <span class=\"p\">(</span><span class=\"nb\">cons</span> <span class=\"n\">elem</span> <span class=\"n\">back</span><span class=\"p\">)))]))</span>\n     <span class=\"c1\">; dequeue an element</span>\n     <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">queue-dequeue</span> <span class=\"n\">queue</span><span class=\"p\">)</span>\n       <span class=\"p\">(</span><span class=\"k\">match</span> <span class=\"n\">queue</span>\n         <span class=\"p\">[(</span><span class=\"n\">simple-queue</span> <span class=\"p\">(</span><span class=\"nb\">cons</span> <span class=\"n\">x</span> <span class=\"n\">xs</span><span class=\"p\">)</span> <span class=\"n\">back</span><span class=\"p\">)</span>\n          <span class=\"p\">(</span><span class=\"n\">check-front</span> <span class=\"p\">(</span><span class=\"n\">simple-queue</span> <span class=\"n\">xs</span> <span class=\"n\">back</span><span class=\"p\">))]))</span>\n     <span class=\"c1\">; get the head of the queue</span>\n     <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">queue-head</span> <span class=\"n\">queue</span><span class=\"p\">)</span>\n       <span class=\"p\">(</span><span class=\"k\">match</span> <span class=\"n\">queue</span>\n         <span class=\"p\">[(</span><span class=\"n\">simple-queue</span> <span class=\"p\">(</span><span class=\"nb\">cons</span> <span class=\"n\">x</span> <span class=\"n\">xs</span><span class=\"p\">)</span> <span class=\"n\">back</span><span class=\"p\">)</span> <span class=\"n\">x</span><span class=\"p\">]))</span>\n     <span class=\"c1\">; check if the queue is empty</span>\n     <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">queue-empty?</span> <span class=\"n\">queue</span><span class=\"p\">)</span>\n       <span class=\"p\">(</span><span class=\"nb\">empty?</span> <span class=\"p\">(</span><span class=\"n\">simple-queue-front</span> <span class=\"n\">queue</span><span class=\"p\">)))</span>\n     <span class=\"c1\">; get the queue&#39;s length</span>\n     <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">queue-length</span> <span class=\"n\">queue</span><span class=\"p\">)</span>\n       <span class=\"p\">(</span><span class=\"nb\">+</span> <span class=\"p\">(</span><span class=\"nb\">length</span> <span class=\"p\">(</span><span class=\"n\">simple-queue-front</span> <span class=\"n\">queue</span><span class=\"p\">))</span>\n          <span class=\"p\">(</span><span class=\"nb\">length</span> <span class=\"p\">(</span><span class=\"n\">simple-queue-back</span> <span class=\"n\">queue</span><span class=\"p\">))))])</span>\n<span class=\"nb\">&gt;</span> <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"n\">empty-queue</span>\n    <span class=\"p\">(</span><span class=\"n\">simple-queue</span> <span class=\"o\">&#39;</span><span class=\"p\">()</span> <span class=\"o\">&#39;</span><span class=\"p\">()))</span>\n</pre></div>\n\n</div>\n\n<p>Using the #:methods keyword and the gen:queue binding, we can specify the methods that a simple-queue implements. Note that a #:methods block may also contain helper functions (like check-front) and definitions that are used to define the methods. Each method has the same method header as the corresponding headers in the interface definition.</p>\n\n<p>We can check that our new queue actually works with the generic functions:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"nb\">&gt;</span> <span class=\"p\">(</span><span class=\"n\">queue-head</span><span class=\"p\">(</span><span class=\"n\">queue-enqueueempty-queue5</span><span class=\"p\">))</span>\n<span class=\"mi\">5</span>\n<span class=\"nb\">&gt;</span> <span class=\"p\">(</span><span class=\"n\">queue-empty?empty-queue</span><span class=\"p\">)</span>\n<span class=\"no\">#t</span>\n<span class=\"nb\">&gt;</span> <span class=\"p\">(</span><span class=\"n\">queue-length</span><span class=\"p\">(</span><span class=\"n\">queue-enqueue</span><span class=\"p\">(</span><span class=\"n\">queue-enqueueempty-queue7</span><span class=\"p\">)</span><span class=\"mi\">5</span><span class=\"p\">))</span>\n<span class=\"mi\">2</span>\n</pre></div>\n\n</div>\n\n<p>It works! For any structure type, we can define methods in the same way. For example, we can define an efficient persistent queue(Okasaki 1998, p.64) that implements the same methods. This time, the implementation will use lazy evaluation with streams:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"nb\">&gt;</span> <span class=\"p\">(</span><span class=\"k\">struct</span> <span class=\"n\">persistent-queue</span> <span class=\"p\">(</span><span class=\"n\">front-len</span> <span class=\"n\">front</span> <span class=\"n\">back-len</span> <span class=\"n\">back</span><span class=\"p\">)</span>\n    <span class=\"kd\">#:methods</span> <span class=\"n\">gen:queue</span>\n    <span class=\"p\">[</span><span class=\"c1\">; helper function to balance lists</span>\n     <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">check</span> <span class=\"n\">queue</span><span class=\"p\">)</span>\n       <span class=\"p\">(</span><span class=\"k\">match</span> <span class=\"n\">queue</span>\n         <span class=\"p\">[(</span><span class=\"n\">persistent-queue</span> <span class=\"n\">front-len</span> <span class=\"n\">front</span> <span class=\"n\">back-len</span> <span class=\"n\">back</span><span class=\"p\">)</span>\n          <span class=\"p\">(</span><span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"nb\">&lt;=</span> <span class=\"n\">back-len</span> <span class=\"n\">front-len</span><span class=\"p\">)</span>\n              <span class=\"n\">queue</span>\n              <span class=\"p\">(</span><span class=\"n\">persistent-queue</span>\n               <span class=\"p\">(</span><span class=\"nb\">+</span> <span class=\"n\">front-len</span> <span class=\"n\">back-len</span><span class=\"p\">)</span>\n               <span class=\"p\">(</span><span class=\"nb\">stream-append</span> <span class=\"n\">front</span> <span class=\"p\">(</span><span class=\"n\">stream-reverse</span> <span class=\"n\">back</span><span class=\"p\">))</span>\n               <span class=\"mi\">0</span> <span class=\"n\">stream-null</span><span class=\"p\">))]))</span>\n     <span class=\"c1\">; enqueue an element</span>\n     <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">queue-enqueue</span> <span class=\"n\">queue</span> <span class=\"n\">elem</span><span class=\"p\">)</span>\n       <span class=\"p\">(</span><span class=\"k\">match</span> <span class=\"n\">queue</span>\n         <span class=\"p\">[(</span><span class=\"n\">persistent-queue</span> <span class=\"n\">front-len</span> <span class=\"n\">front</span> <span class=\"n\">back-len</span> <span class=\"n\">back</span><span class=\"p\">)</span>\n          <span class=\"p\">(</span><span class=\"n\">check</span> <span class=\"p\">(</span><span class=\"n\">persistent-queue</span>\n                  <span class=\"n\">front-len</span> <span class=\"n\">front</span>\n                  <span class=\"p\">(</span><span class=\"nb\">+</span> <span class=\"mi\">1</span> <span class=\"n\">back-len</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"k\">stream-cons</span> <span class=\"n\">elem</span> <span class=\"n\">back</span><span class=\"p\">)))]))</span>\n     <span class=\"c1\">; dequeue an element</span>\n     <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">queue-dequeue</span> <span class=\"n\">queue</span><span class=\"p\">)</span>\n       <span class=\"p\">(</span><span class=\"k\">match</span> <span class=\"n\">queue</span>\n         <span class=\"p\">[(</span><span class=\"n\">persistent-queue</span> <span class=\"n\">front-len</span> <span class=\"n\">front</span> <span class=\"n\">back-len</span> <span class=\"n\">back</span><span class=\"p\">)</span>\n          <span class=\"p\">(</span><span class=\"n\">check</span> <span class=\"p\">(</span><span class=\"n\">persistent-queue</span>\n                  <span class=\"p\">(</span><span class=\"nb\">-</span> <span class=\"n\">front-len</span> <span class=\"mi\">1</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"nb\">stream-rest</span> <span class=\"n\">front</span><span class=\"p\">)</span>\n                  <span class=\"n\">back-len</span> <span class=\"n\">back</span><span class=\"p\">))]))</span>\n     <span class=\"c1\">; get the head of the queue</span>\n     <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">queue-head</span> <span class=\"n\">queue</span><span class=\"p\">)</span>\n       <span class=\"p\">(</span><span class=\"k\">match</span> <span class=\"n\">queue</span>\n         <span class=\"p\">[(</span><span class=\"n\">persistent-queue</span> <span class=\"n\">front-len</span> <span class=\"n\">front</span> <span class=\"n\">back-len</span> <span class=\"n\">back</span><span class=\"p\">)</span>\n          <span class=\"p\">(</span><span class=\"nb\">stream-first</span> <span class=\"n\">front</span><span class=\"p\">)]))</span>\n     <span class=\"c1\">; check if the queue is empty</span>\n     <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">queue-empty?</span> <span class=\"n\">queue</span><span class=\"p\">)</span>\n       <span class=\"p\">(</span><span class=\"nb\">=</span> <span class=\"mi\">0</span> <span class=\"p\">(</span><span class=\"n\">persistent-queue-front-len</span> <span class=\"n\">queue</span><span class=\"p\">)))</span>\n     <span class=\"c1\">; get the queue&#39;s length</span>\n     <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">queue-length</span> <span class=\"n\">queue</span><span class=\"p\">)</span>\n       <span class=\"p\">(</span><span class=\"nb\">+</span> <span class=\"p\">(</span><span class=\"n\">persistent-queue-front-len</span> <span class=\"n\">queue</span><span class=\"p\">)</span>\n          <span class=\"p\">(</span><span class=\"n\">persistent-queue-back-len</span> <span class=\"n\">queue</span><span class=\"p\">)))])</span>\n<span class=\"nb\">&gt;</span> <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"n\">empty-persistent-queue</span>\n    <span class=\"p\">(</span><span class=\"n\">persistent-queue</span> <span class=\"mi\">0</span> <span class=\"n\">stream-null</span> <span class=\"mi\">0</span> <span class=\"n\">stream-null</span><span class=\"p\">))</span>\n</pre></div>\n\n</div>\n\n<p>Our operations from before work as expected:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"nb\">&gt;</span> <span class=\"p\">(</span><span class=\"n\">queue-head</span><span class=\"p\">(</span><span class=\"n\">queue-enqueueempty-persistent-queue5</span><span class=\"p\">))</span>\n<span class=\"mi\">5</span>\n<span class=\"nb\">&gt;</span> <span class=\"p\">(</span><span class=\"n\">queue-empty?empty-persistent-queue</span><span class=\"p\">)</span>\n<span class=\"no\">#t</span>\n<span class=\"nb\">&gt;</span> <span class=\"p\">(</span><span class=\"n\">queue-length</span><span class=\"p\">(</span><span class=\"n\">queue-enqueue</span><span class=\"p\">(</span><span class=\"n\">queue-enqueueempty-persistent-queue7</span><span class=\"p\">)</span><span class=\"mi\">5</span><span class=\"p\">))</span>\n<span class=\"mi\">2</span>\n</pre></div>\n\n</div>\n\n<h2 id=\"contracts\">Contracts</h2>\n\n<p>Earlier, I mentioned that the generic interface also comes with a contract form that’s automatically defined. You can use these to attach dynamic checks to your implementations.</p>\n\n<p>For example, we can write a contract that restricts our queues to only accept integers as data elements:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"nb\">&gt;</span> <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"n\">int-queue/c</span>\n    <span class=\"p\">(</span><span class=\"k\">recursive-contract</span>\n     <span class=\"p\">(</span><span class=\"n\">queue/c</span> <span class=\"p\">[</span><span class=\"n\">queue-enqueue</span> <span class=\"p\">(</span><span class=\"k\">-&gt;</span> <span class=\"n\">int-queue/c</span> <span class=\"nb\">integer?</span> <span class=\"n\">int-queue/c</span><span class=\"p\">)]</span>\n              <span class=\"p\">[</span><span class=\"n\">queue-dequeue</span> <span class=\"p\">(</span><span class=\"k\">-&gt;</span> <span class=\"n\">int-queue/c</span> <span class=\"n\">int-queue/c</span><span class=\"p\">)]</span>\n              <span class=\"p\">[</span><span class=\"n\">queue-head</span>    <span class=\"p\">(</span><span class=\"k\">-&gt;</span> <span class=\"n\">int-queue/c</span> <span class=\"nb\">integer?</span><span class=\"p\">)]</span>\n              <span class=\"p\">[</span><span class=\"n\">queue-empty?</span>  <span class=\"p\">(</span><span class=\"k\">-&gt;</span> <span class=\"n\">int-queue/c</span> <span class=\"nb\">boolean?</span><span class=\"p\">)]</span>\n              <span class=\"p\">[</span><span class=\"n\">queue-length</span>  <span class=\"p\">(</span><span class=\"k\">-&gt;</span> <span class=\"n\">int-queue/c</span> <span class=\"nb\">integer?</span><span class=\"p\">)])))</span>\n</pre></div>\n\n</div>\n\n<p>For the queue interface, the automatically defined queue/c combinator allows us to specify contracts on each of the methods in the interface. We also use a recursive contract here just so that we can reference the int-queue/c contract within itself.</p>\n\n<p>We can apply the contract to a particular queue:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"nb\">&gt;</span> <span class=\"p\">(</span><span class=\"k\">define/contract</span> <span class=\"n\">checked-queue</span>\n    <span class=\"n\">int-queue/c</span>\n    <span class=\"n\">empty-queue</span><span class=\"p\">)</span>\n<span class=\"nb\">&gt;</span> <span class=\"p\">(</span><span class=\"n\">queue-enqueue</span> <span class=\"n\">checked-queue</span> <span class=\"mi\">42</span><span class=\"p\">)</span>\n<span class=\"n\">#&lt;simple-queue&gt;</span>\n<span class=\"nb\">&gt;</span> <span class=\"p\">(</span><span class=\"n\">queue-enqueue</span> <span class=\"n\">checked-queue</span> <span class=\"s2\">\"not an integer\"</span><span class=\"p\">)</span>\n<span class=\"n\">checked-queue:</span> <span class=\"k\">contract</span> <span class=\"n\">violation</span>\n <span class=\"n\">expected:</span> <span class=\"nb\">integer?</span>\n <span class=\"n\">given:</span> <span class=\"s2\">\"not an integer\"</span>\n <span class=\"n\">in:</span> <span class=\"n\">the</span> <span class=\"n\">2nd</span> <span class=\"n\">argument</span> <span class=\"n\">of</span>\n     <span class=\"n\">the</span> <span class=\"n\">queue-enqueue</span> <span class=\"n\">method</span> <span class=\"n\">of</span>\n      <span class=\"p\">(</span><span class=\"k\">recursive-contract</span>\n       <span class=\"p\">(</span><span class=\"n\">queue/c</span>\n        <span class=\"p\">(</span><span class=\"n\">queue-enqueue</span>\n         <span class=\"p\">(</span><span class=\"k\">-&gt;</span> <span class=\"n\">int-queue/c</span> <span class=\"nb\">integer?</span> <span class=\"n\">int-queue/c</span><span class=\"p\">))</span>\n        <span class=\"p\">(</span><span class=\"n\">queue-dequeue</span>\n         <span class=\"p\">(</span><span class=\"k\">-&gt;</span> <span class=\"n\">int-queue/c</span> <span class=\"n\">int-queue/c</span><span class=\"p\">))</span>\n        <span class=\"p\">(</span><span class=\"n\">queue-head</span> <span class=\"p\">(</span><span class=\"k\">-&gt;</span> <span class=\"n\">int-queue/c</span> <span class=\"nb\">integer?</span><span class=\"p\">))</span>\n        <span class=\"p\">(</span><span class=\"n\">queue-empty?</span> <span class=\"p\">(</span><span class=\"k\">-&gt;</span> <span class=\"n\">int-queue/c</span> <span class=\"nb\">boolean?</span><span class=\"p\">))</span>\n        <span class=\"p\">(</span><span class=\"n\">queue-length</span> <span class=\"p\">(</span><span class=\"k\">-&gt;</span> <span class=\"n\">int-queue/c</span> <span class=\"nb\">integer?</span><span class=\"p\">))))</span>\n <span class=\"k\">contract</span> <span class=\"n\">from:</span> <span class=\"p\">(</span><span class=\"n\">definition</span> <span class=\"n\">checked-queue</span><span class=\"p\">)</span>\n <span class=\"n\">blaming:</span> <span class=\"n\">top-level</span>\n <span class=\"n\">at:</span> <span class=\"n\">eval:15.0</span>\n</pre></div>\n\n</div>\n\n<p>The second use of <code>queue-enqueue</code> causes a contract error as expected, since we can’t add a string to an integer queue. You can also provide a constructor for your integer queue that’s contracted to produce int-queue/cs. Any queues created with that constructor will be checked for integers.</p>\n\n<p>Also, you might have noticed that the queues we wrote above don’t protect against dequeueing or taking the head of empty queues. To prevent this, we can write contracts that ensure these operations raise contract errors on empty queues. Since we want to enforce this for all queues instead of just some of them, we apply contracts to the generic functions:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"nb\">&gt;</span> <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"n\">non-empty-queue/c</span>\n    <span class=\"p\">(</span><span class=\"nb\">flat-named-contract</span>\n     <span class=\"o\">&#39;</span><span class=\"ss\">non-empty-queue</span>\n     <span class=\"p\">(</span><span class=\"k\">λ</span> <span class=\"p\">(</span><span class=\"n\">q</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"k\">and</span> <span class=\"p\">(</span><span class=\"n\">queue?</span> <span class=\"n\">q</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"nb\">not</span> <span class=\"p\">(</span><span class=\"n\">queue-empty?</span> <span class=\"n\">q</span><span class=\"p\">))))))</span>\n<span class=\"nb\">&gt;</span> <span class=\"p\">(</span><span class=\"k\">define/contract</span> <span class=\"p\">(</span><span class=\"n\">checked-dequeue</span> <span class=\"n\">queue</span><span class=\"p\">)</span>\n    <span class=\"p\">(</span><span class=\"k\">-&gt;</span> <span class=\"n\">non-empty-queue/c</span> <span class=\"n\">queue?</span><span class=\"p\">)</span>\n    <span class=\"p\">(</span><span class=\"n\">queue-dequeue</span> <span class=\"n\">queue</span><span class=\"p\">))</span>\n<span class=\"nb\">&gt;</span> <span class=\"p\">(</span><span class=\"k\">define/contract</span> <span class=\"p\">(</span><span class=\"n\">checked-head</span> <span class=\"n\">queue</span><span class=\"p\">)</span>\n    <span class=\"p\">(</span><span class=\"k\">-&gt;</span> <span class=\"n\">non-empty-queue/c</span> <span class=\"nb\">any/c</span><span class=\"p\">)</span>\n    <span class=\"p\">(</span><span class=\"n\">queue-head</span> <span class=\"n\">queue</span><span class=\"p\">))</span>\n<span class=\"nb\">&gt;</span> <span class=\"p\">(</span><span class=\"n\">checked-head</span> <span class=\"n\">empty-persistent-queue</span><span class=\"p\">)</span>\n<span class=\"n\">checked-head:</span> <span class=\"k\">contract</span> <span class=\"n\">violation</span>\n <span class=\"n\">expected:</span> <span class=\"n\">non-empty-queue</span>\n <span class=\"n\">given:</span> <span class=\"n\">#&lt;persistent-queue&gt;</span>\n <span class=\"n\">in:</span> <span class=\"n\">the</span> <span class=\"n\">1st</span> <span class=\"n\">argument</span> <span class=\"n\">of</span>\n      <span class=\"p\">(</span><span class=\"k\">-&gt;</span> <span class=\"n\">non-empty-queue</span> <span class=\"nb\">any/c</span><span class=\"p\">)</span>\n <span class=\"k\">contract</span> <span class=\"n\">from:</span> <span class=\"p\">(</span><span class=\"n\">function</span> <span class=\"n\">checked-head</span><span class=\"p\">)</span>\n <span class=\"n\">blaming:</span> <span class=\"n\">top-level</span>\n <span class=\"n\">at:</span> <span class=\"n\">eval:20.0</span>\n</pre></div>\n\n</div>\n\n<p>The <code>checked-head</code> function raises a contract error as expected instead of an exception from a stream function. In a real implementation, you would just export the original generic functions with contracts attached using contract-out instead of defining checked versions like we did here.</p>\n\n<h2 id=\"summary\">Summary</h2>\n\n<p>Racket 5.3 has made the process of defining and using generic interfaces much easier. The new library is still under active development and we plan to experiment with additional features and performance improvements. The full code from this article can be found in the following gist: <a href=\"https://gist.github.com/3995200\">https://gist.github.com/3995200</a></p>\n\n<p>Bibliography:  Chris Okasaki. Purely Functional Data Structures. Cambridge University Press, 1998.</p>") #t (u . "\n<p><em>posted by Asumu Takikawa</em></p>\n\n<p>Recently at <a href=\"http://con.racket-lang.org/\">RacketCon</a>, I gave a talk about the new Generics library that ships with Racket 5.3. In this blog post, I’ll offer a slightly expanded commentary about the new library. For the ten-minute video explanation, see the <a href=\"http://www.youtube.com/watch?v=MYtm9YG4tMM\">Youtube</a> video. The accompanying slides are available <a href=\"http://www.ccs.neu.edu/home/asumu/slides/racketcon-2012-generics.pdf\">here</a>.</p>\n\n<h2 id=\"introduction\">Introduction</h2>\n\n<p>Probably the first question that comes to your mind is: what are generics and what do we mean by generic programming? Let me illustrate with some example code:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"nb\">&gt;</span> <span class=\"p\">(</span><span class=\"n\">vector-ref#</span><span class=\"p\">(</span><span class=\"mi\">123</span><span class=\"p\">)</span><span class=\"mi\">2</span><span class=\"p\">)</span>\n<span class=\"mi\">3</span>\n<span class=\"nb\">&gt;</span> <span class=\"p\">(</span><span class=\"nb\">list-ref</span><span class=\"o\">&#39;</span><span class=\"p\">(</span><span class=\"mi\">123</span><span class=\"p\">)</span><span class=\"mi\">2</span><span class=\"p\">)</span>\n<span class=\"mi\">3</span>\n</pre></div>\n\n</div>\n\n<p>Both of the lines above operate on sequence-like datatypes, but for each of the datatypes we use different functions: <code>vector-ref</code> and <code>list-ref</code>. This is also the case with other datatypes like dictionary-like datatypes: <code>hash-ref</code>, <code>assoc</code>, etc. Or all the different kinds of equality: <code>string=?</code>, <code>boolean=?</code>, and <code>=</code>. These specialized operations may seem redundant. Ideally, we’d have generic functions that don’t care about the specific datatypes that we operate over.</p>\n\n<p>Thankfully, Racket does provide these. For dictionaries, we have functions like <code>dict-ref</code> and <code>dict-set</code> that operate over any kind of dictionary-like type. For sequences, <code>sequence-ref</code>, <code>sequence-append</code>, and so on. These generic interfaces are all built-in to the standard library. You might wonder, however, if you can define your own generic functions.</p>\n\n<p>As of version 5.3, you just need to (require racket/generic) to get all the tools you need to define your own generic interface. In the rest of the article I’ll show you how to define your own generic interface and how to use it. If you’ve seen Rust’s <a href=\"http://pcwalton.github.com/blog/2012/08/08/a-gentle-introduction-to-traits-in-rust\">traits</a> or Clojure’s <a href=\"http://clojure.org/protocols\">protocols</a>, our design will feel familiar.</p>\n\n<h2 id=\"examples\">Examples</h2>\n\n<p>The running example will be the implementation of a simple queue interface. Our queue will contain five operations: <code>queue-enqueue</code>, <code>queue-dequeue</code>, <code>queue-head</code>, <code>queue-empty?</code>, and <code>queue-length</code>.</p>\n\n<p>The first thing to do is to require the library:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"nb\">&gt;</span> <span class=\"p\">(</span><span class=\"n\">requireracket/generic</span><span class=\"p\">)</span>\n</pre></div>\n\n</div>\n\n<p>Then we use define-generics to define a generic interface:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"nb\">&gt;</span> <span class=\"p\">(</span><span class=\"n\">define-generics</span> <span class=\"n\">queue</span>\n    <span class=\"p\">[</span><span class=\"n\">queue-enqueue</span> <span class=\"n\">queue</span> <span class=\"n\">elem</span><span class=\"p\">]</span>\n    <span class=\"p\">[</span><span class=\"n\">queue-dequeue</span> <span class=\"n\">queue</span><span class=\"p\">]</span>\n    <span class=\"p\">[</span><span class=\"n\">queue-head</span> <span class=\"n\">queue</span><span class=\"p\">]</span>\n    <span class=\"p\">[</span><span class=\"n\">queue-empty?</span> <span class=\"n\">queue</span><span class=\"p\">]</span>\n    <span class=\"p\">[</span><span class=\"n\">queue-length</span> <span class=\"n\">queue</span><span class=\"p\">])</span>\n</pre></div>\n\n</div>\n\n<p>The method headers above define the methods that concrete implementations of the generic interface need to provide. Each header needs to contain at least one argument that matches the name of the interface; this argument will be used for dispatch. The form defines several identifiers: queue?, gen:queue, queue/c, and each of the generic functions. The first is a predicate that checks whether a given value implements the interface. The identifier prefixed with gen: is a binding that’s used to supply methods for the interface. The queue/c specifies a contract combinator for the interface, which I’ll describe later in the article.</p>\n\n<p>We now have the generic functions, but they’re not very useful without concrete implementations. To implement a generic interface, you first need to define a structure type. We’ll define a simple functional queue(Okasaki 1998, p.42) that uses two lists:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"nb\">&gt;</span> <span class=\"p\">(</span><span class=\"k\">struct</span> <span class=\"n\">simple-queue</span> <span class=\"p\">(</span><span class=\"n\">front</span> <span class=\"n\">back</span><span class=\"p\">)</span>\n    <span class=\"kd\">#:methods</span> <span class=\"n\">gen:queue</span>\n    <span class=\"p\">[</span><span class=\"c1\">; helper function to balance lists</span>\n     <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">check-front</span> <span class=\"n\">queue</span><span class=\"p\">)</span>\n       <span class=\"p\">(</span><span class=\"k\">match</span> <span class=\"n\">queue</span>\n         <span class=\"p\">[(</span><span class=\"n\">simple-queue</span> <span class=\"o\">&#39;</span><span class=\"p\">()</span> <span class=\"n\">back</span><span class=\"p\">)</span>\n          <span class=\"p\">(</span><span class=\"n\">simple-queue</span> <span class=\"p\">(</span><span class=\"nb\">reverse</span> <span class=\"n\">back</span><span class=\"p\">)</span> <span class=\"o\">&#39;</span><span class=\"p\">())]</span>\n         <span class=\"p\">[</span><span class=\"k\">_</span> <span class=\"n\">queue</span><span class=\"p\">]))</span>\n     <span class=\"c1\">; enqueue an element</span>\n     <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">queue-enqueue</span> <span class=\"n\">queue</span> <span class=\"n\">elem</span><span class=\"p\">)</span>\n       <span class=\"p\">(</span><span class=\"k\">match</span> <span class=\"n\">queue</span>\n         <span class=\"p\">[(</span><span class=\"n\">simple-queue</span> <span class=\"n\">front</span> <span class=\"n\">back</span><span class=\"p\">)</span>\n          <span class=\"p\">(</span><span class=\"n\">check-front</span> <span class=\"p\">(</span><span class=\"n\">simple-queue</span> <span class=\"n\">front</span> <span class=\"p\">(</span><span class=\"nb\">cons</span> <span class=\"n\">elem</span> <span class=\"n\">back</span><span class=\"p\">)))]))</span>\n     <span class=\"c1\">; dequeue an element</span>\n     <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">queue-dequeue</span> <span class=\"n\">queue</span><span class=\"p\">)</span>\n       <span class=\"p\">(</span><span class=\"k\">match</span> <span class=\"n\">queue</span>\n         <span class=\"p\">[(</span><span class=\"n\">simple-queue</span> <span class=\"p\">(</span><span class=\"nb\">cons</span> <span class=\"n\">x</span> <span class=\"n\">xs</span><span class=\"p\">)</span> <span class=\"n\">back</span><span class=\"p\">)</span>\n          <span class=\"p\">(</span><span class=\"n\">check-front</span> <span class=\"p\">(</span><span class=\"n\">simple-queue</span> <span class=\"n\">xs</span> <span class=\"n\">back</span><span class=\"p\">))]))</span>\n     <span class=\"c1\">; get the head of the queue</span>\n     <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">queue-head</span> <span class=\"n\">queue</span><span class=\"p\">)</span>\n       <span class=\"p\">(</span><span class=\"k\">match</span> <span class=\"n\">queue</span>\n         <span class=\"p\">[(</span><span class=\"n\">simple-queue</span> <span class=\"p\">(</span><span class=\"nb\">cons</span> <span class=\"n\">x</span> <span class=\"n\">xs</span><span class=\"p\">)</span> <span class=\"n\">back</span><span class=\"p\">)</span> <span class=\"n\">x</span><span class=\"p\">]))</span>\n     <span class=\"c1\">; check if the queue is empty</span>\n     <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">queue-empty?</span> <span class=\"n\">queue</span><span class=\"p\">)</span>\n       <span class=\"p\">(</span><span class=\"nb\">empty?</span> <span class=\"p\">(</span><span class=\"n\">simple-queue-front</span> <span class=\"n\">queue</span><span class=\"p\">)))</span>\n     <span class=\"c1\">; get the queue&#39;s length</span>\n     <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">queue-length</span> <span class=\"n\">queue</span><span class=\"p\">)</span>\n       <span class=\"p\">(</span><span class=\"nb\">+</span> <span class=\"p\">(</span><span class=\"nb\">length</span> <span class=\"p\">(</span><span class=\"n\">simple-queue-front</span> <span class=\"n\">queue</span><span class=\"p\">))</span>\n          <span class=\"p\">(</span><span class=\"nb\">length</span> <span class=\"p\">(</span><span class=\"n\">simple-queue-back</span> <span class=\"n\">queue</span><span class=\"p\">))))])</span>\n<span class=\"nb\">&gt;</span> <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"n\">empty-queue</span>\n    <span class=\"p\">(</span><span class=\"n\">simple-queue</span> <span class=\"o\">&#39;</span><span class=\"p\">()</span> <span class=\"o\">&#39;</span><span class=\"p\">()))</span>\n</pre></div>\n\n</div>\n\n<p>Using the #:methods keyword and the gen:queue binding, we can specify the methods that a simple-queue implements. Note that a #:methods block may also contain helper functions (like check-front) and definitions that are used to define the methods. Each method has the same method header as the corresponding headers in the interface definition.</p>\n\n<p>We can check that our new queue actually works with the generic functions:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"nb\">&gt;</span> <span class=\"p\">(</span><span class=\"n\">queue-head</span><span class=\"p\">(</span><span class=\"n\">queue-enqueueempty-queue5</span><span class=\"p\">))</span>\n<span class=\"mi\">5</span>\n<span class=\"nb\">&gt;</span> <span class=\"p\">(</span><span class=\"n\">queue-empty?empty-queue</span><span class=\"p\">)</span>\n<span class=\"no\">#t</span>\n<span class=\"nb\">&gt;</span> <span class=\"p\">(</span><span class=\"n\">queue-length</span><span class=\"p\">(</span><span class=\"n\">queue-enqueue</span><span class=\"p\">(</span><span class=\"n\">queue-enqueueempty-queue7</span><span class=\"p\">)</span><span class=\"mi\">5</span><span class=\"p\">))</span>\n<span class=\"mi\">2</span>\n</pre></div>\n\n</div>\n\n<p>It works! For any structure type, we can define methods in the same way. For example, we can define an efficient persistent queue(Okasaki 1998, p.64) that implements the same methods. This time, the implementation will use lazy evaluation with streams:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"nb\">&gt;</span> <span class=\"p\">(</span><span class=\"k\">struct</span> <span class=\"n\">persistent-queue</span> <span class=\"p\">(</span><span class=\"n\">front-len</span> <span class=\"n\">front</span> <span class=\"n\">back-len</span> <span class=\"n\">back</span><span class=\"p\">)</span>\n    <span class=\"kd\">#:methods</span> <span class=\"n\">gen:queue</span>\n    <span class=\"p\">[</span><span class=\"c1\">; helper function to balance lists</span>\n     <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">check</span> <span class=\"n\">queue</span><span class=\"p\">)</span>\n       <span class=\"p\">(</span><span class=\"k\">match</span> <span class=\"n\">queue</span>\n         <span class=\"p\">[(</span><span class=\"n\">persistent-queue</span> <span class=\"n\">front-len</span> <span class=\"n\">front</span> <span class=\"n\">back-len</span> <span class=\"n\">back</span><span class=\"p\">)</span>\n          <span class=\"p\">(</span><span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"nb\">&lt;=</span> <span class=\"n\">back-len</span> <span class=\"n\">front-len</span><span class=\"p\">)</span>\n              <span class=\"n\">queue</span>\n              <span class=\"p\">(</span><span class=\"n\">persistent-queue</span>\n               <span class=\"p\">(</span><span class=\"nb\">+</span> <span class=\"n\">front-len</span> <span class=\"n\">back-len</span><span class=\"p\">)</span>\n               <span class=\"p\">(</span><span class=\"nb\">stream-append</span> <span class=\"n\">front</span> <span class=\"p\">(</span><span class=\"n\">stream-reverse</span> <span class=\"n\">back</span><span class=\"p\">))</span>\n               <span class=\"mi\">0</span> <span class=\"n\">stream-null</span><span class=\"p\">))]))</span>\n     <span class=\"c1\">; enqueue an element</span>\n     <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">queue-enqueue</span> <span class=\"n\">queue</span> <span class=\"n\">elem</span><span class=\"p\">)</span>\n       <span class=\"p\">(</span><span class=\"k\">match</span> <span class=\"n\">queue</span>\n         <span class=\"p\">[(</span><span class=\"n\">persistent-queue</span> <span class=\"n\">front-len</span> <span class=\"n\">front</span> <span class=\"n\">back-len</span> <span class=\"n\">back</span><span class=\"p\">)</span>\n          <span class=\"p\">(</span><span class=\"n\">check</span> <span class=\"p\">(</span><span class=\"n\">persistent-queue</span>\n                  <span class=\"n\">front-len</span> <span class=\"n\">front</span>\n                  <span class=\"p\">(</span><span class=\"nb\">+</span> <span class=\"mi\">1</span> <span class=\"n\">back-len</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"k\">stream-cons</span> <span class=\"n\">elem</span> <span class=\"n\">back</span><span class=\"p\">)))]))</span>\n     <span class=\"c1\">; dequeue an element</span>\n     <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">queue-dequeue</span> <span class=\"n\">queue</span><span class=\"p\">)</span>\n       <span class=\"p\">(</span><span class=\"k\">match</span> <span class=\"n\">queue</span>\n         <span class=\"p\">[(</span><span class=\"n\">persistent-queue</span> <span class=\"n\">front-len</span> <span class=\"n\">front</span> <span class=\"n\">back-len</span> <span class=\"n\">back</span><span class=\"p\">)</span>\n          <span class=\"p\">(</span><span class=\"n\">check</span> <span class=\"p\">(</span><span class=\"n\">persistent-queue</span>\n                  <span class=\"p\">(</span><span class=\"nb\">-</span> <span class=\"n\">front-len</span> <span class=\"mi\">1</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"nb\">stream-rest</span> <span class=\"n\">front</span><span class=\"p\">)</span>\n                  <span class=\"n\">back-len</span> <span class=\"n\">back</span><span class=\"p\">))]))</span>\n     <span class=\"c1\">; get the head of the queue</span>\n     <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">queue-head</span> <span class=\"n\">queue</span><span class=\"p\">)</span>\n       <span class=\"p\">(</span><span class=\"k\">match</span> <span class=\"n\">queue</span>\n         <span class=\"p\">[(</span><span class=\"n\">persistent-queue</span> <span class=\"n\">front-len</span> <span class=\"n\">front</span> <span class=\"n\">back-len</span> <span class=\"n\">back</span><span class=\"p\">)</span>\n          <span class=\"p\">(</span><span class=\"nb\">stream-first</span> <span class=\"n\">front</span><span class=\"p\">)]))</span>\n     <span class=\"c1\">; check if the queue is empty</span>\n     <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">queue-empty?</span> <span class=\"n\">queue</span><span class=\"p\">)</span>\n       <span class=\"p\">(</span><span class=\"nb\">=</span> <span class=\"mi\">0</span> <span class=\"p\">(</span><span class=\"n\">persistent-queue-front-len</span> <span class=\"n\">queue</span><span class=\"p\">)))</span>\n     <span class=\"c1\">; get the queue&#39;s length</span>\n     <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">queue-length</span> <span class=\"n\">queue</span><span class=\"p\">)</span>\n       <span class=\"p\">(</span><span class=\"nb\">+</span> <span class=\"p\">(</span><span class=\"n\">persistent-queue-front-len</span> <span class=\"n\">queue</span><span class=\"p\">)</span>\n          <span class=\"p\">(</span><span class=\"n\">persistent-queue-back-len</span> <span class=\"n\">queue</span><span class=\"p\">)))])</span>\n<span class=\"nb\">&gt;</span> <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"n\">empty-persistent-queue</span>\n    <span class=\"p\">(</span><span class=\"n\">persistent-queue</span> <span class=\"mi\">0</span> <span class=\"n\">stream-null</span> <span class=\"mi\">0</span> <span class=\"n\">stream-null</span><span class=\"p\">))</span>\n</pre></div>\n\n</div>\n\n<p>Our operations from before work as expected:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"nb\">&gt;</span> <span class=\"p\">(</span><span class=\"n\">queue-head</span><span class=\"p\">(</span><span class=\"n\">queue-enqueueempty-persistent-queue5</span><span class=\"p\">))</span>\n<span class=\"mi\">5</span>\n<span class=\"nb\">&gt;</span> <span class=\"p\">(</span><span class=\"n\">queue-empty?empty-persistent-queue</span><span class=\"p\">)</span>\n<span class=\"no\">#t</span>\n<span class=\"nb\">&gt;</span> <span class=\"p\">(</span><span class=\"n\">queue-length</span><span class=\"p\">(</span><span class=\"n\">queue-enqueue</span><span class=\"p\">(</span><span class=\"n\">queue-enqueueempty-persistent-queue7</span><span class=\"p\">)</span><span class=\"mi\">5</span><span class=\"p\">))</span>\n<span class=\"mi\">2</span>\n</pre></div>\n\n</div>\n\n<h2 id=\"contracts\">Contracts</h2>\n\n<p>Earlier, I mentioned that the generic interface also comes with a contract form that’s automatically defined. You can use these to attach dynamic checks to your implementations.</p>\n\n<p>For example, we can write a contract that restricts our queues to only accept integers as data elements:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"nb\">&gt;</span> <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"n\">int-queue/c</span>\n    <span class=\"p\">(</span><span class=\"k\">recursive-contract</span>\n     <span class=\"p\">(</span><span class=\"n\">queue/c</span> <span class=\"p\">[</span><span class=\"n\">queue-enqueue</span> <span class=\"p\">(</span><span class=\"k\">-&gt;</span> <span class=\"n\">int-queue/c</span> <span class=\"nb\">integer?</span> <span class=\"n\">int-queue/c</span><span class=\"p\">)]</span>\n              <span class=\"p\">[</span><span class=\"n\">queue-dequeue</span> <span class=\"p\">(</span><span class=\"k\">-&gt;</span> <span class=\"n\">int-queue/c</span> <span class=\"n\">int-queue/c</span><span class=\"p\">)]</span>\n              <span class=\"p\">[</span><span class=\"n\">queue-head</span>    <span class=\"p\">(</span><span class=\"k\">-&gt;</span> <span class=\"n\">int-queue/c</span> <span class=\"nb\">integer?</span><span class=\"p\">)]</span>\n              <span class=\"p\">[</span><span class=\"n\">queue-empty?</span>  <span class=\"p\">(</span><span class=\"k\">-&gt;</span> <span class=\"n\">int-queue/c</span> <span class=\"nb\">boolean?</span><span class=\"p\">)]</span>\n              <span class=\"p\">[</span><span class=\"n\">queue-length</span>  <span class=\"p\">(</span><span class=\"k\">-&gt;</span> <span class=\"n\">int-queue/c</span> <span class=\"nb\">integer?</span><span class=\"p\">)])))</span>\n</pre></div>\n\n</div>\n\n<p>For the queue interface, the automatically defined queue/c combinator allows us to specify contracts on each of the methods in the interface. We also use a recursive contract here just so that we can reference the int-queue/c contract within itself.</p>\n\n<p>We can apply the contract to a particular queue:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"nb\">&gt;</span> <span class=\"p\">(</span><span class=\"k\">define/contract</span> <span class=\"n\">checked-queue</span>\n    <span class=\"n\">int-queue/c</span>\n    <span class=\"n\">empty-queue</span><span class=\"p\">)</span>\n<span class=\"nb\">&gt;</span> <span class=\"p\">(</span><span class=\"n\">queue-enqueue</span> <span class=\"n\">checked-queue</span> <span class=\"mi\">42</span><span class=\"p\">)</span>\n<span class=\"n\">#&lt;simple-queue&gt;</span>\n<span class=\"nb\">&gt;</span> <span class=\"p\">(</span><span class=\"n\">queue-enqueue</span> <span class=\"n\">checked-queue</span> <span class=\"s2\">\"not an integer\"</span><span class=\"p\">)</span>\n<span class=\"n\">checked-queue:</span> <span class=\"k\">contract</span> <span class=\"n\">violation</span>\n <span class=\"n\">expected:</span> <span class=\"nb\">integer?</span>\n <span class=\"n\">given:</span> <span class=\"s2\">\"not an integer\"</span>\n <span class=\"n\">in:</span> <span class=\"n\">the</span> <span class=\"n\">2nd</span> <span class=\"n\">argument</span> <span class=\"n\">of</span>\n     <span class=\"n\">the</span> <span class=\"n\">queue-enqueue</span> <span class=\"n\">method</span> <span class=\"n\">of</span>\n      <span class=\"p\">(</span><span class=\"k\">recursive-contract</span>\n       <span class=\"p\">(</span><span class=\"n\">queue/c</span>\n        <span class=\"p\">(</span><span class=\"n\">queue-enqueue</span>\n         <span class=\"p\">(</span><span class=\"k\">-&gt;</span> <span class=\"n\">int-queue/c</span> <span class=\"nb\">integer?</span> <span class=\"n\">int-queue/c</span><span class=\"p\">))</span>\n        <span class=\"p\">(</span><span class=\"n\">queue-dequeue</span>\n         <span class=\"p\">(</span><span class=\"k\">-&gt;</span> <span class=\"n\">int-queue/c</span> <span class=\"n\">int-queue/c</span><span class=\"p\">))</span>\n        <span class=\"p\">(</span><span class=\"n\">queue-head</span> <span class=\"p\">(</span><span class=\"k\">-&gt;</span> <span class=\"n\">int-queue/c</span> <span class=\"nb\">integer?</span><span class=\"p\">))</span>\n        <span class=\"p\">(</span><span class=\"n\">queue-empty?</span> <span class=\"p\">(</span><span class=\"k\">-&gt;</span> <span class=\"n\">int-queue/c</span> <span class=\"nb\">boolean?</span><span class=\"p\">))</span>\n        <span class=\"p\">(</span><span class=\"n\">queue-length</span> <span class=\"p\">(</span><span class=\"k\">-&gt;</span> <span class=\"n\">int-queue/c</span> <span class=\"nb\">integer?</span><span class=\"p\">))))</span>\n <span class=\"k\">contract</span> <span class=\"n\">from:</span> <span class=\"p\">(</span><span class=\"n\">definition</span> <span class=\"n\">checked-queue</span><span class=\"p\">)</span>\n <span class=\"n\">blaming:</span> <span class=\"n\">top-level</span>\n <span class=\"n\">at:</span> <span class=\"n\">eval:15.0</span>\n</pre></div>\n\n</div>\n\n<p>The second use of <code>queue-enqueue</code> causes a contract error as expected, since we can’t add a string to an integer queue. You can also provide a constructor for your integer queue that’s contracted to produce int-queue/cs. Any queues created with that constructor will be checked for integers.</p>\n\n<p>Also, you might have noticed that the queues we wrote above don’t protect against dequeueing or taking the head of empty queues. To prevent this, we can write contracts that ensure these operations raise contract errors on empty queues. Since we want to enforce this for all queues instead of just some of them, we apply contracts to the generic functions:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"nb\">&gt;</span> <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"n\">non-empty-queue/c</span>\n    <span class=\"p\">(</span><span class=\"nb\">flat-named-contract</span>\n     <span class=\"o\">&#39;</span><span class=\"ss\">non-empty-queue</span>\n     <span class=\"p\">(</span><span class=\"k\">λ</span> <span class=\"p\">(</span><span class=\"n\">q</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"k\">and</span> <span class=\"p\">(</span><span class=\"n\">queue?</span> <span class=\"n\">q</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"nb\">not</span> <span class=\"p\">(</span><span class=\"n\">queue-empty?</span> <span class=\"n\">q</span><span class=\"p\">))))))</span>\n<span class=\"nb\">&gt;</span> <span class=\"p\">(</span><span class=\"k\">define/contract</span> <span class=\"p\">(</span><span class=\"n\">checked-dequeue</span> <span class=\"n\">queue</span><span class=\"p\">)</span>\n    <span class=\"p\">(</span><span class=\"k\">-&gt;</span> <span class=\"n\">non-empty-queue/c</span> <span class=\"n\">queue?</span><span class=\"p\">)</span>\n    <span class=\"p\">(</span><span class=\"n\">queue-dequeue</span> <span class=\"n\">queue</span><span class=\"p\">))</span>\n<span class=\"nb\">&gt;</span> <span class=\"p\">(</span><span class=\"k\">define/contract</span> <span class=\"p\">(</span><span class=\"n\">checked-head</span> <span class=\"n\">queue</span><span class=\"p\">)</span>\n    <span class=\"p\">(</span><span class=\"k\">-&gt;</span> <span class=\"n\">non-empty-queue/c</span> <span class=\"nb\">any/c</span><span class=\"p\">)</span>\n    <span class=\"p\">(</span><span class=\"n\">queue-head</span> <span class=\"n\">queue</span><span class=\"p\">))</span>\n<span class=\"nb\">&gt;</span> <span class=\"p\">(</span><span class=\"n\">checked-head</span> <span class=\"n\">empty-persistent-queue</span><span class=\"p\">)</span>\n<span class=\"n\">checked-head:</span> <span class=\"k\">contract</span> <span class=\"n\">violation</span>\n <span class=\"n\">expected:</span> <span class=\"n\">non-empty-queue</span>\n <span class=\"n\">given:</span> <span class=\"n\">#&lt;persistent-queue&gt;</span>\n <span class=\"n\">in:</span> <span class=\"n\">the</span> <span class=\"n\">1st</span> <span class=\"n\">argument</span> <span class=\"n\">of</span>\n      <span class=\"p\">(</span><span class=\"k\">-&gt;</span> <span class=\"n\">non-empty-queue</span> <span class=\"nb\">any/c</span><span class=\"p\">)</span>\n <span class=\"k\">contract</span> <span class=\"n\">from:</span> <span class=\"p\">(</span><span class=\"n\">function</span> <span class=\"n\">checked-head</span><span class=\"p\">)</span>\n <span class=\"n\">blaming:</span> <span class=\"n\">top-level</span>\n <span class=\"n\">at:</span> <span class=\"n\">eval:20.0</span>\n</pre></div>\n\n</div>\n\n<p>The <code>checked-head</code> function raises a contract error as expected instead of an exception from a stream function. In a real implementation, you would just export the original generic functions with contracts attached using contract-out instead of defining checked versions like we did here.</p>\n\n<h2 id=\"summary\">Summary</h2>\n\n<p>Racket 5.3 has made the process of defining and using generic interfaces much easier. The new library is still under active development and we plan to experiment with additional features and performance improvements. The full code from this article can be found in the following gist: <a href=\"https://gist.github.com/3995200\">https://gist.github.com/3995200</a></p>\n\n<p>Bibliography:  Chris Okasaki. Purely Functional Data Structures. Cambridge University Press, 1998.</p>\n<!-- more-->\n\n<hr />\n\n<p>Interesting stuff. These days I find data + interfaces all I really need to in terms of &ldquo;object orientation&rdquo;.</p>\n\n<p>Given all this, is it possible to define new sequence methods in a similar way?</p>\n\n<p>— <em>Unknown, 15 January 2014</em></p>\n\n<hr />")) ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2008-02-23-dirty-looking-hygiene.md" . unix) f post (u . "Dirty Looking Hygiene") (? . 40) 1467223812 (p+ #"/Users/MB/git/racket-lang-org/blog/2008/02/dirty-looking-hygiene.html" . unix) "/2008/02/dirty-looking-hygiene.html" (u . "2008-02-23T01:20:00.002-05:00") (? . 15) (? . 54) (c (u . "")) (u . "\n<p><em>posted by Eli Barzilay</em></p>\n\n<p>With the recent release of <a href=\"http://arclanguage.com/\">Arc</a>, there has been some discussion over hygienic macros. Yes, hygienic macros are usually very convenient, but they can become messy in some &lsquo;corner&rsquo; cases. People who learn about macros in Scheme usually start with <code>syntax-rules</code>, and being the limited tool that it is, they often get the impression that for advanced uses (like a macro that captures an identifier) you need to use <code>syntax-case</code> which is this &ldquo;really obscure thing&rdquo;.</p>\n\n<p>For example, say that we want to implement an <code>if</code> form that is similar to Arc&rsquo;s <code>if</code>. This is pretty easy using <code>syntax-rules</code>:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">define-syntax</span> <span class=\"n\">if*</span>\n    <span class=\"p\">(</span><span class=\"k\">syntax-rules</span> <span class=\"p\">()</span>\n      <span class=\"p\">[(</span><span class=\"n\">if*</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"nb\">void</span><span class=\"p\">)]</span>\n      <span class=\"p\">[(</span><span class=\"n\">if*</span> <span class=\"n\">X</span><span class=\"p\">)</span> <span class=\"n\">X</span><span class=\"p\">]</span>\n      <span class=\"p\">[(</span><span class=\"n\">if*</span> <span class=\"n\">C</span> <span class=\"n\">X</span> <span class=\"n\">more</span> <span class=\"k\">...</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"k\">if</span> <span class=\"n\">C</span> <span class=\"n\">X</span> <span class=\"p\">(</span><span class=\"n\">if*</span> <span class=\"n\">more</span> <span class=\"k\">...</span><span class=\"p\">))]))</span>\n</pre></div>\n\n</div>\n\n<p>But more important than being easy to write: it is also easy to read. In fact, the nice thing about <code>syntax-rules</code> is that you write more or less the specification of your transformation. Compare this to the specification of Arc&rsquo;s <code>if</code>, which appears in a comment before the definition of <code>ac-if</code> in \"<code>ac.scm</code>\":</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre>  <span class=\"c1\">; (if) -&gt; nil</span>\n  <span class=\"c1\">; (if x) -&gt; x</span>\n  <span class=\"c1\">; (if t a ...) -&gt; a</span>\n  <span class=\"c1\">; (if nil a b) -&gt; b</span>\n  <span class=\"c1\">; (if nil a b c) -&gt; (if b c)</span>\n</pre></div>\n\n</div>\n\n<p>(Except that the comment mixes up the syntactic specification and the semantic evaluation.)</p>\n\n<p>As a side note, now that we have this definition, it is easy to construct a new language that is just like MzScheme, except for its <code>if</code> that behaves like the above:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">module</span> <span class=\"n\">arc-like</span> <span class=\"n\">mzscheme</span>\n    <span class=\"p\">(</span><span class=\"k\">define-syntax</span> <span class=\"n\">if*</span> <span class=\"n\">..._the</span> <span class=\"n\">above</span> <span class=\"n\">definition_...</span><span class=\"p\">)</span>\n    <span class=\"p\">(</span><span class=\"k\">provide</span> <span class=\"p\">(</span><span class=\"n\">all-from-except</span> <span class=\"n\">mzscheme</span> <span class=\"k\">if</span><span class=\"p\">)</span>\n             <span class=\"p\">(</span><span class=\"k\">rename</span> <span class=\"n\">if*</span> <span class=\"k\">if</span><span class=\"p\">)))</span>\n</pre></div>\n\n</div>\n\n<p>You can now write code that uses <code>\"arc-like.scm\"</code> as its language, using the new <code>if</code>. There is no problem in accommodating two languages with two different <code>if</code>&rsquo;s: the new form is compiled to the old one, and there is no confusion in which version you use in any module.</p>\n\n<p>Back to the macro issue: as I said above, you run into problems if you want to capture names, right? For example, if you want to implement Arc&rsquo;s <code>aif</code>. The usual <code>syntax-case</code> solution is to construct an identifier that has the lexical context of the input syntax. It&rsquo;s easy to abstract over all this &mdash; I posted a <a href=\"http://www.arclanguage.org/item?id=841\">message</a> on the Arc forum showing how to define a <a href=\"http://tmp.barzilay.org/defmac.ss\">defmac</a> macro that has the simplicity of <code>syntax-rules</code> with the added convenience of specifying keywords and captured names. This works for <em>some</em> cases, but there are still some <a href=\"http://download.plt-scheme.org/doc/372/html/mzscheme/mzscheme-Z-H-12.html#node_sec_12.2.1.1\">subtle corner cases</a>.</p>\n\n<p>But there&rsquo;s a better solution in PLT Scheme, one that follows Paul Graham&rsquo;s intuition when he <a href=\"http://www.arclanguage.org/item?id=2526\">says</a>: &ldquo;captured symbols are kind of freaky.&rdquo; The basic idea is a change of perspective: instead of (unhygienically) binding individual occurrences of <code>it</code> whenever <code>aif</code> is used, you define <code>it</code> once as a thing in its own right &mdash; a special context-dependent piece of syntax. Outside of an <code>aif</code> form, <code>it</code> has no meaning: we simply make it throw a syntax error. Uses of <code>aif</code> provide a meaning for <code>it</code> by locally changing its meaning (its expansion) to something useful: the binding that holds the result of evaluating the condition expression. (&ldquo;Locally&rdquo; means within a piece of syntax, so the new meaning is valid in a lexical-scope.)</p>\n\n<p>In PLT Scheme, the &ldquo;special context-dependent piece of syntax&rdquo; are <em>syntax parameters</em>, and you change them locally with <code>syntax-parameterize</code>.</p>\n\n<p>To continue the above example, here&rsquo;s how we make our <code>if*</code> anaphoric:</p>\n\n<ul>\n <li>\n  <p>require the <code>(lib \"stxparam.ss\" \"mzlib\")</code> library,</p></li>\n <li>\n  <p>define <code>it</code> as a syntax using <code>define-syntax-parameter</code>, and have it raise an error by default,</p></li>\n <li>\n  <p>bind a temporary variable to the result of evaluating the condition,</p></li>\n <li>\n  <p>wrap the positive branch with <code>syntax-parameterize</code>, using <code>make-rename-transformer</code>, which is a convenient way to make a macro that behaves like the new variable.</p></li></ul>\n\n<p>The implementation looks like this:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre>  <span class=\"p\">(</span><span class=\"k\">require</span> <span class=\"p\">(</span><span class=\"k\">lib</span> <span class=\"s2\">\"stxparam.ss\"</span> <span class=\"s2\">\"mzlib\"</span><span class=\"p\">))</span>\n  <span class=\"p\">(</span><span class=\"n\">define-syntax-parameter</span> <span class=\"n\">it</span>\n    <span class=\"p\">(</span><span class=\"k\">lambda</span> <span class=\"p\">(</span><span class=\"n\">stx</span><span class=\"p\">)</span>\n      <span class=\"p\">(</span><span class=\"nb\">raise-syntax-error</span> <span class=\"no\">#f</span> <span class=\"s2\">\"can only be used inside `if&#39;\"</span> <span class=\"n\">stx</span><span class=\"p\">)))</span>\n  <span class=\"p\">(</span><span class=\"k\">define-syntax</span> <span class=\"n\">if*</span>\n    <span class=\"p\">(</span><span class=\"k\">syntax-rules</span> <span class=\"p\">()</span>\n      <span class=\"p\">[(</span><span class=\"n\">if*</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"nb\">void</span><span class=\"p\">)]</span>\n      <span class=\"p\">[(</span><span class=\"n\">if*</span> <span class=\"n\">X</span><span class=\"p\">)</span> <span class=\"n\">X</span><span class=\"p\">]</span>\n      <span class=\"p\">[(</span><span class=\"n\">if*</span> <span class=\"n\">C</span> <span class=\"n\">X</span> <span class=\"n\">more</span> <span class=\"k\">...</span><span class=\"p\">)</span>\n       <span class=\"p\">(</span><span class=\"k\">let</span> <span class=\"p\">([</span><span class=\"n\">b</span> <span class=\"n\">C</span><span class=\"p\">])</span>\n         <span class=\"p\">(</span><span class=\"k\">if</span> <span class=\"n\">b</span>\n           <span class=\"p\">(</span><span class=\"n\">syntax-parameterize</span> <span class=\"p\">([</span><span class=\"n\">it</span> <span class=\"p\">(</span><span class=\"nb\">make-rename-transformer</span> <span class=\"o\">#&#39;</span><span class=\"n\">b</span><span class=\"p\">)])</span> <span class=\"n\">X</span><span class=\"p\">)</span>\n           <span class=\"p\">(</span><span class=\"n\">if*</span> <span class=\"n\">more</span> <span class=\"k\">...</span><span class=\"p\">)))]))</span>\n</pre></div>\n\n</div>\n\n<p>The resulting macro does not break hygiene. For example, <code>(let ([it 3]) (if #t it))</code> evaluates to <code>3</code>, because it shadows the global <code>it</code> that <code>if</code> changes. This is a change from a real unhygienic macro &mdash; but that&rsquo;s the whole point: we (the macro author) do not interfere with scopes in the user code.</p>\n\n<p>Note that <code>(if 1 (if 2 it))</code> still evaluates to <code>2</code>, because the outer <code>if</code> does not really bind <code>it</code> &mdash; it is not captured, just changed locally &mdash; so the inner <code>if</code> changes it again. Also, <code>(if #f it it)</code> raises the usual context error, since our macro changes <code>it</code> only in the positive branch.</p>") #t (u . "\n<p><em>posted by Eli Barzilay</em></p>\n\n<p>With the recent release of <a href=\"http://arclanguage.com/\">Arc</a>, there has been some discussion over hygienic macros. Yes, hygienic macros are usually very convenient, but they can become messy in some &lsquo;corner&rsquo; cases. People who learn about macros in Scheme usually start with <code>syntax-rules</code>, and being the limited tool that it is, they often get the impression that for advanced uses (like a macro that captures an identifier) you need to use <code>syntax-case</code> which is this &ldquo;really obscure thing&rdquo;.</p>\n\n<p>For example, say that we want to implement an <code>if</code> form that is similar to Arc&rsquo;s <code>if</code>. This is pretty easy using <code>syntax-rules</code>:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">define-syntax</span> <span class=\"n\">if*</span>\n    <span class=\"p\">(</span><span class=\"k\">syntax-rules</span> <span class=\"p\">()</span>\n      <span class=\"p\">[(</span><span class=\"n\">if*</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"nb\">void</span><span class=\"p\">)]</span>\n      <span class=\"p\">[(</span><span class=\"n\">if*</span> <span class=\"n\">X</span><span class=\"p\">)</span> <span class=\"n\">X</span><span class=\"p\">]</span>\n      <span class=\"p\">[(</span><span class=\"n\">if*</span> <span class=\"n\">C</span> <span class=\"n\">X</span> <span class=\"n\">more</span> <span class=\"k\">...</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"k\">if</span> <span class=\"n\">C</span> <span class=\"n\">X</span> <span class=\"p\">(</span><span class=\"n\">if*</span> <span class=\"n\">more</span> <span class=\"k\">...</span><span class=\"p\">))]))</span>\n</pre></div>\n\n</div>\n\n<p>But more important than being easy to write: it is also easy to read. In fact, the nice thing about <code>syntax-rules</code> is that you write more or less the specification of your transformation. Compare this to the specification of Arc&rsquo;s <code>if</code>, which appears in a comment before the definition of <code>ac-if</code> in \"<code>ac.scm</code>\":</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre>  <span class=\"c1\">; (if) -&gt; nil</span>\n  <span class=\"c1\">; (if x) -&gt; x</span>\n  <span class=\"c1\">; (if t a ...) -&gt; a</span>\n  <span class=\"c1\">; (if nil a b) -&gt; b</span>\n  <span class=\"c1\">; (if nil a b c) -&gt; (if b c)</span>\n</pre></div>\n\n</div>\n\n<p>(Except that the comment mixes up the syntactic specification and the semantic evaluation.)</p>\n\n<p>As a side note, now that we have this definition, it is easy to construct a new language that is just like MzScheme, except for its <code>if</code> that behaves like the above:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">module</span> <span class=\"n\">arc-like</span> <span class=\"n\">mzscheme</span>\n    <span class=\"p\">(</span><span class=\"k\">define-syntax</span> <span class=\"n\">if*</span> <span class=\"n\">..._the</span> <span class=\"n\">above</span> <span class=\"n\">definition_...</span><span class=\"p\">)</span>\n    <span class=\"p\">(</span><span class=\"k\">provide</span> <span class=\"p\">(</span><span class=\"n\">all-from-except</span> <span class=\"n\">mzscheme</span> <span class=\"k\">if</span><span class=\"p\">)</span>\n             <span class=\"p\">(</span><span class=\"k\">rename</span> <span class=\"n\">if*</span> <span class=\"k\">if</span><span class=\"p\">)))</span>\n</pre></div>\n\n</div>\n\n<p>You can now write code that uses <code>\"arc-like.scm\"</code> as its language, using the new <code>if</code>. There is no problem in accommodating two languages with two different <code>if</code>&rsquo;s: the new form is compiled to the old one, and there is no confusion in which version you use in any module.</p>\n\n<p>Back to the macro issue: as I said above, you run into problems if you want to capture names, right? For example, if you want to implement Arc&rsquo;s <code>aif</code>. The usual <code>syntax-case</code> solution is to construct an identifier that has the lexical context of the input syntax. It&rsquo;s easy to abstract over all this &mdash; I posted a <a href=\"http://www.arclanguage.org/item?id=841\">message</a> on the Arc forum showing how to define a <a href=\"http://tmp.barzilay.org/defmac.ss\">defmac</a> macro that has the simplicity of <code>syntax-rules</code> with the added convenience of specifying keywords and captured names. This works for <em>some</em> cases, but there are still some <a href=\"http://download.plt-scheme.org/doc/372/html/mzscheme/mzscheme-Z-H-12.html#node_sec_12.2.1.1\">subtle corner cases</a>.</p>\n\n<p>But there&rsquo;s a better solution in PLT Scheme, one that follows Paul Graham&rsquo;s intuition when he <a href=\"http://www.arclanguage.org/item?id=2526\">says</a>: &ldquo;captured symbols are kind of freaky.&rdquo; The basic idea is a change of perspective: instead of (unhygienically) binding individual occurrences of <code>it</code> whenever <code>aif</code> is used, you define <code>it</code> once as a thing in its own right &mdash; a special context-dependent piece of syntax. Outside of an <code>aif</code> form, <code>it</code> has no meaning: we simply make it throw a syntax error. Uses of <code>aif</code> provide a meaning for <code>it</code> by locally changing its meaning (its expansion) to something useful: the binding that holds the result of evaluating the condition expression. (&ldquo;Locally&rdquo; means within a piece of syntax, so the new meaning is valid in a lexical-scope.)</p>\n\n<p>In PLT Scheme, the &ldquo;special context-dependent piece of syntax&rdquo; are <em>syntax parameters</em>, and you change them locally with <code>syntax-parameterize</code>.</p>\n\n<p>To continue the above example, here&rsquo;s how we make our <code>if*</code> anaphoric:</p>\n\n<ul>\n <li>\n  <p>require the <code>(lib \"stxparam.ss\" \"mzlib\")</code> library,</p></li>\n <li>\n  <p>define <code>it</code> as a syntax using <code>define-syntax-parameter</code>, and have it raise an error by default,</p></li>\n <li>\n  <p>bind a temporary variable to the result of evaluating the condition,</p></li>\n <li>\n  <p>wrap the positive branch with <code>syntax-parameterize</code>, using <code>make-rename-transformer</code>, which is a convenient way to make a macro that behaves like the new variable.</p></li></ul>\n\n<p>The implementation looks like this:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre>  <span class=\"p\">(</span><span class=\"k\">require</span> <span class=\"p\">(</span><span class=\"k\">lib</span> <span class=\"s2\">\"stxparam.ss\"</span> <span class=\"s2\">\"mzlib\"</span><span class=\"p\">))</span>\n  <span class=\"p\">(</span><span class=\"n\">define-syntax-parameter</span> <span class=\"n\">it</span>\n    <span class=\"p\">(</span><span class=\"k\">lambda</span> <span class=\"p\">(</span><span class=\"n\">stx</span><span class=\"p\">)</span>\n      <span class=\"p\">(</span><span class=\"nb\">raise-syntax-error</span> <span class=\"no\">#f</span> <span class=\"s2\">\"can only be used inside `if&#39;\"</span> <span class=\"n\">stx</span><span class=\"p\">)))</span>\n  <span class=\"p\">(</span><span class=\"k\">define-syntax</span> <span class=\"n\">if*</span>\n    <span class=\"p\">(</span><span class=\"k\">syntax-rules</span> <span class=\"p\">()</span>\n      <span class=\"p\">[(</span><span class=\"n\">if*</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"nb\">void</span><span class=\"p\">)]</span>\n      <span class=\"p\">[(</span><span class=\"n\">if*</span> <span class=\"n\">X</span><span class=\"p\">)</span> <span class=\"n\">X</span><span class=\"p\">]</span>\n      <span class=\"p\">[(</span><span class=\"n\">if*</span> <span class=\"n\">C</span> <span class=\"n\">X</span> <span class=\"n\">more</span> <span class=\"k\">...</span><span class=\"p\">)</span>\n       <span class=\"p\">(</span><span class=\"k\">let</span> <span class=\"p\">([</span><span class=\"n\">b</span> <span class=\"n\">C</span><span class=\"p\">])</span>\n         <span class=\"p\">(</span><span class=\"k\">if</span> <span class=\"n\">b</span>\n           <span class=\"p\">(</span><span class=\"n\">syntax-parameterize</span> <span class=\"p\">([</span><span class=\"n\">it</span> <span class=\"p\">(</span><span class=\"nb\">make-rename-transformer</span> <span class=\"o\">#&#39;</span><span class=\"n\">b</span><span class=\"p\">)])</span> <span class=\"n\">X</span><span class=\"p\">)</span>\n           <span class=\"p\">(</span><span class=\"n\">if*</span> <span class=\"n\">more</span> <span class=\"k\">...</span><span class=\"p\">)))]))</span>\n</pre></div>\n\n</div>\n\n<p>The resulting macro does not break hygiene. For example, <code>(let ([it 3]) (if #t it))</code> evaluates to <code>3</code>, because it shadows the global <code>it</code> that <code>if</code> changes. This is a change from a real unhygienic macro &mdash; but that&rsquo;s the whole point: we (the macro author) do not interfere with scopes in the user code.</p>\n\n<p>Note that <code>(if 1 (if 2 it))</code> still evaluates to <code>2</code>, because the outer <code>if</code> does not really bind <code>it</code> &mdash; it is not captured, just changed locally &mdash; so the inner <code>if</code> changes it again. Also, <code>(if #f it it)</code> raises the usual context error, since our macro changes <code>it</code> only in the positive branch.</p>\n<!-- more-->\n\n<hr />\n\n<p>The specification atop the macro reminds me of the quip that &ldquo;any sufficiently well-commented lisp program contains an ML program in its comments&rdquo; (:</p>\n\n<p>— <em>Martin DeMello, 28 April 2008</em></p>\n\n<hr />")) ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2010-06-07-racket.md" . unix) f post (u . "Racket") (? . 50) 1467223812 (p+ #"/Users/MB/git/racket-lang-org/blog/2010/06/racket.html" . unix) "/2010/06/racket.html" (u . "2010-06-07T14:50:00.004-04:00") (? . 35) (? . 49) (c (u . "")) (u . "\n<p><em>posted by Eli Barzilay</em></p>\n\n<p>PLT is happy to announce the release of Racket, available from  <a href=\"http://racket-lang.org/\"><code>http://racket-lang.org/</code></a></p>\n\n<p>With Racket, you can script command shells and web servers; you can quickly prototype animations and complex GUIs; regexps and threads are here to serve you. To organize your systems, you can mix and match classes, modules or components. Best of all, you start without writing down types. If you later wish to turn your script into a program, equip your Racket modules with explicit type declarations as you wish. And Racket doesn&rsquo;t just come as a typed variant; you can also write your modules in a purely functional and lazy dialect.</p>\n\n<p>Racket comes in so many flavors because Racket is much more than a standard scripting language or a plain programming language. Racket supports language extensibility to an unequaled degree. A Racket programmer knows that making up a new language is as easy as writing a new library.</p>\n\n<p>To help you start quickly, Racket includes batteries in all shapes and sizes, most importantly, extensive documentation and all kinds of libraries.</p>\n\n<p>Racket occupies a unique position between research and practice. It inherits many major ideas from language research, among them type safety (when the type system says that x is a number, then at runtime it always is a number) and memory safety (when some memory is reclaimed by the garbage collector it is impossible to still have a reference to it). At the same time, user demand governs rigid adherence to purely theoretical principles.</p>\n\n<p>Racket, formerly PLT Scheme, is a product of over 15 years of development. Although Racket starts with a mature software base and an established user community, its new name reflects our view that this is just the beginning of Racket&rsquo;s evolution.</p>") #t (u . "\n<p><em>posted by Eli Barzilay</em></p>\n\n<p>PLT is happy to announce the release of Racket, available from  <a href=\"http://racket-lang.org/\"><code>http://racket-lang.org/</code></a></p>\n\n<p>With Racket, you can script command shells and web servers; you can quickly prototype animations and complex GUIs; regexps and threads are here to serve you. To organize your systems, you can mix and match classes, modules or components. Best of all, you start without writing down types. If you later wish to turn your script into a program, equip your Racket modules with explicit type declarations as you wish. And Racket doesn&rsquo;t just come as a typed variant; you can also write your modules in a purely functional and lazy dialect.</p>\n\n<p>Racket comes in so many flavors because Racket is much more than a standard scripting language or a plain programming language. Racket supports language extensibility to an unequaled degree. A Racket programmer knows that making up a new language is as easy as writing a new library.</p>\n\n<p>To help you start quickly, Racket includes batteries in all shapes and sizes, most importantly, extensive documentation and all kinds of libraries.</p>\n\n<p>Racket occupies a unique position between research and practice. It inherits many major ideas from language research, among them type safety (when the type system says that x is a number, then at runtime it always is a number) and memory safety (when some memory is reclaimed by the garbage collector it is impossible to still have a reference to it). At the same time, user demand governs rigid adherence to purely theoretical principles.</p>\n\n<p>Racket, formerly PLT Scheme, is a product of over 15 years of development. Although Racket starts with a mature software base and an established user community, its new name reflects our view that this is just the beginning of Racket&rsquo;s evolution.</p>\n<!-- more-->\n\n<hr />\n\n<p>Why call it Racket?</p>\n\n<p>— <em>Steve Knight, 8 June 2010</em></p>\n\n<hr />\n\n<p>http://www.racket-lang.org/new-name.html</p>\n\n<p>— <em>Robby, 8 June 2010</em></p>\n\n<hr />\n\n<p>I don&rsquo;t mind the name change per se, but typing &ldquo;racket&rdquo; in Google understandably returns links to tennis and sports. :-) (Yeah, I know &ldquo;plt racket&rdquo; works better.)</p>\n\n<p>Now if they just decide to add a grid widget and cross-platform ODBC support, I&rsquo;d be a happy camper&hellip;</p>\n\n<p>— <em>robwalker01, 8 June 2010</em></p>\n\n<hr />\n\n<p>Besides the name, what is diferent from version 4.5?</p>\n\n<p>— <em>claudio.naoto, 8 June 2010</em></p>\n\n<hr />\n\n<p>There were the usual bug fixes here and there, but you&rsquo;re right that this release cycle was mostly the work of renaming things. (4.2.5 was the previous release, tho).</p>\n\n<p>— <em>Robby, 8 June 2010</em></p>\n\n<hr />\n\n<p>Racket is just an organized scheme. The name still brings up connotations of something nefarious. What is in a name? I&rsquo;m good with it if it continues to run on a proper OpenBSD platform. Will Apple let something, so expressive as ‘Racket’, the honor of being available from their apps store, for use with the iPad? Now that would be the app to write, however, unless Apple has changed their minds, no interpretive languages, that I&rsquo;m aware of, have made it to iTunes. I wonder if they would allow a syntax informed code editor to be offered for the iPad. If they actually could keep folks from hacking their product, then they might have my support; but they can&rsquo;t put enough restraints on their SDK, to adequatelty maintain system security, so why bother with the silly attempts at maintaining control. I believe the answer can be seen with clarity if one looks at a five year chart of Apple stock. If you wish to call it Racket, then let&rsquo;s make some noise with it. You really do need to offer for sale Racket logo&rsquo;d posters, cups, t-shirts, baseball hats, and stickers for my four year old son.</p>\n\n<p>&mdash;kyle</p>\n\n<p>— <em>Kyle Smith, 17 June 2010</em></p>\n\n<hr />")) ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2007-08-02-relationally-parametric-polymorphic-contracts.md" . unix) f post (u . "Relationally-Parametric Polymorphic Contracts") (? . 90) 1467223812 (p+ #"/Users/MB/git/racket-lang-org/blog/2007/08/relationally-parametric-polymorphic-contracts.html" . unix) "/2007/08/relationally-parametric-polymorphic-contracts.html" (u . "2007-08-02T18:03:00.000-04:00") (? . 62) (? . 114) (c (u . "")) (u . "\n<p><em>posted by Shriram Krishnamurthi</em></p>\n\n<p>We&rsquo;ve been making progress on the connection between types and contracts. This paper is a step towards answering the question,  “What would polymorphic types (a la Standard ML) look like in a contract world?” If you haven&rsquo;t thought much about polymorphic types, you may find the answer has some subtlety; if you have, hopefully you will find the answer reasonable.</p>\n\n<p>Arjun and I want to point out that some of the work in this paper was already in an earlier paper that Jacob and Robby wrote, but the material was excised from the public version, so we weren&rsquo;t aware of it. But there is some fresh material here as well, and anyway Robby and I have been gabbing about this question for years.</p>") #f (u . "\n<p><em>posted by Shriram Krishnamurthi</em></p>\n\n<p>We&rsquo;ve been making progress on the connection between types and contracts. This paper is a step towards answering the question,  “What would polymorphic types (a la Standard ML) look like in a contract world?” If you haven&rsquo;t thought much about polymorphic types, you may find the answer has some subtlety; if you have, hopefully you will find the answer reasonable.</p>\n\n<p>Arjun and I want to point out that some of the work in this paper was already in an earlier paper that Jacob and Robby wrote, but the material was excised from the public version, so we weren&rsquo;t aware of it. But there is some fresh material here as well, and anyway Robby and I have been gabbing about this question for years.</p>")) ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2009-05-06-what-is-sendsuspend.md" . unix) f post (u . "What is `send/suspend`?") (? . 58) 1467223812 (p+ #"/Users/MB/git/racket-lang-org/blog/2009/05/what-is-sendsuspend.html" . unix) "/2009/05/what-is-sendsuspend.html" (u . "2009-05-06T08:58:00.001-04:00") (? . 56) (? . 55) (c (u . "")) (u . "\n<p><em>posted by Jay McCarthy</em></p>\n\n<p>I often ponder what <a href=\"http://docs.plt-scheme.org/web-server/servlet.html#(def._((lib._web-server/servlet/web..ss)._send/suspend))\"><code>send/suspend</code></a> really is. It is a lot like <code>call/cc</code>, but has the curious property that the continuation escapes in a single way and is only called in a particular context. I often wonder if there is something weaker than <code>call/cc</code> that implements <code>send/suspend</code>.</p>\n\n<p>Today I wrote a little dispatcher that uses threads to implement <code>send/suspend</code>. In this implementation, _send_ing truly _suspend_s the computation.</p>\n\n<p>Here&rsquo;s the code: <a href=\"http://www.copypastecode.com/codes/view/5003\">http://www.copypastecode.com/codes/view/5003</a></p>\n\n<p>The trick is to have channels for communicating responses and requests. When you run this example, you should be able to add two numbers. But, in contrast to the normal <code>send/suspend</code>, all the URLs are one-shots, because once the computation is resumed, it moves forward&hellip; it is never saved.</p>\n\n<p>This implementation technique also precludes clever implementations of <code>send/suspend/dispatch</code>, like:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">send/suspend/dispatch</span> <span class=\"n\">mk-page</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"k\">let/cc</span> <span class=\"n\">k0</span>\n    <span class=\"p\">(</span><span class=\"n\">send/back</span>\n     <span class=\"p\">(</span><span class=\"n\">mk-page</span>\n      <span class=\"p\">(</span><span class=\"k\">lambda</span> <span class=\"p\">(</span><span class=\"n\">handler</span><span class=\"p\">)</span>\n        <span class=\"p\">(</span><span class=\"k\">let/ec</span> <span class=\"n\">k1</span> \n          <span class=\"p\">(</span><span class=\"n\">k0</span> <span class=\"p\">(</span><span class=\"n\">handler</span> <span class=\"p\">(</span><span class=\"n\">send/suspend</span> <span class=\"n\">k1</span><span class=\"p\">)))))))))</span>\n</pre></div>\n\n</div>") #t (u . "\n<p><em>posted by Jay McCarthy</em></p>\n\n<p>I often ponder what <a href=\"http://docs.plt-scheme.org/web-server/servlet.html#(def._((lib._web-server/servlet/web..ss)._send/suspend))\"><code>send/suspend</code></a> really is. It is a lot like <code>call/cc</code>, but has the curious property that the continuation escapes in a single way and is only called in a particular context. I often wonder if there is something weaker than <code>call/cc</code> that implements <code>send/suspend</code>.</p>\n\n<p>Today I wrote a little dispatcher that uses threads to implement <code>send/suspend</code>. In this implementation, _send_ing truly _suspend_s the computation.</p>\n\n<p>Here&rsquo;s the code: <a href=\"http://www.copypastecode.com/codes/view/5003\">http://www.copypastecode.com/codes/view/5003</a></p>\n\n<p>The trick is to have channels for communicating responses and requests. When you run this example, you should be able to add two numbers. But, in contrast to the normal <code>send/suspend</code>, all the URLs are one-shots, because once the computation is resumed, it moves forward&hellip; it is never saved.</p>\n\n<p>This implementation technique also precludes clever implementations of <code>send/suspend/dispatch</code>, like:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">send/suspend/dispatch</span> <span class=\"n\">mk-page</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"k\">let/cc</span> <span class=\"n\">k0</span>\n    <span class=\"p\">(</span><span class=\"n\">send/back</span>\n     <span class=\"p\">(</span><span class=\"n\">mk-page</span>\n      <span class=\"p\">(</span><span class=\"k\">lambda</span> <span class=\"p\">(</span><span class=\"n\">handler</span><span class=\"p\">)</span>\n        <span class=\"p\">(</span><span class=\"k\">let/ec</span> <span class=\"n\">k1</span> \n          <span class=\"p\">(</span><span class=\"n\">k0</span> <span class=\"p\">(</span><span class=\"n\">handler</span> <span class=\"p\">(</span><span class=\"n\">send/suspend</span> <span class=\"n\">k1</span><span class=\"p\">)))))))))</span>\n</pre></div>\n\n</div>\n<!-- more-->\n\n<hr />\n\n<p>As Shriram pointed out in email, he and I conjectured that there was an intimate relationship between s/s and call/cc in 2002. When I then gave my Oxford lecture, some German attendees (from Mike&rsquo;s or Peter&rsquo;s group, I believe) implemented call/cc via s/s. Question is what this really means.</p>\n\n<p>— <em>matthias, 6 May 2009</em></p>\n\n<hr />")) ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2012-08-25-dynamic-programming-versus-memoization.md" . unix) f post (u . "Dynamic Programming versus Memoization") (? . 30) 1467223812 (p+ #"/Users/MB/git/racket-lang-org/blog/2012/08/dynamic-programming-versus-memoization.html" . unix) "/2012/08/dynamic-programming-versus-memoization.html" (u . "2012-08-25T20:23:00.000-04:00") (? . 115) (? . 116) (c (u . "")) (u . "\n<p><em>posted by Shriram Krishnamurthi</em></p>\n\n<p>[Edit on 2012&ndash;08&ndash;27, 12:31EDT: added code and pictures below. 2012&ndash;08&ndash;27, 13:10EDT: also incorporated some comments.]</p>\n\n<p>I wrote this on the Racket educators&rsquo; mailing list, and Eli Barzilay</p>\n\n<p>suggested I post it here as well.</p>\n\n<p>The article is about the difference between <strong>memoization</strong> and <strong>dynamic programming</strong> (DP). Before you read on, you should stop and ask yourself: <em>Do I think these two are the same concept?</em>; if you think they are different, <em>How do I think they differ?</em>; and for that matter, <em>Do I even think of them as related?</em></p>\n\n<p>Did you think? Okay, then read on.</p>\n\n<p>They most certainly are related, because they are both mechanisms for optimizing a computation by replacing repeated sub-computations with the storage and reuse of the result of those sub-computations. (That is, both trade off space for time.) In that description is already implicit an assumption: that the sub-computation will return the same result every time (or else you can&rsquo;t replace the computation with its value on subsequent invocations). You&rsquo;ve almost certainly heard of DP from an algorithms class. You&rsquo;ve probably heard of memoization if you&rsquo;re a member of this language&rsquo;s community, but many undergrads simply never see it because algorithms textbooks ignore it; and when they do mention it they demonstrate fundamental misunderstandings (as Algorithms by Dasgupta, Papadimitriou, and Vazirani does).</p>\n\n<p>Therefore, let&rsquo;s set aside precedent. I&rsquo;ll tell you how to think about them.</p>\n\n<p>Memoization is fundamentally a top-down computation and DP is fundamentally bottom-up. In memoization, we observe that a computational <em>tree</em> can actually be represented as a computational <em>DAG</em> (a directed acyclic graph: the single most underrated data structure in computer science); we then use a black-box to turn the tree into a DAG. But it allows the top-down description of the problem to remain unchanged. (As I left unstated originally but commenter23 below rightly intuited, the nodes are function calls, edges are call dependencies, and the arrows are directed from caller to callee. See the pictures later in this article.)</p>\n\n<p>In DP, we make the same observation, but construct the DAG from the bottom-up. That means we have to rewrite the computation to express the delta from each computational tree/DAG node to its parents. We also need a means for addressing/naming those parents (which we did not need in the top-down case, since this was implicit in the recursive call stack). This leads to inventions like DP tables, but people often fail to understand why they exist: it&rsquo;s primarily as a <em>naming mechanism</em> (and while we&rsquo;re at it, why not make it efficient to find a named element, ergo arrays and matrices).</p>\n\n<p>In both cases, there is the potential for space wastage. In memoization, it is very difficult to get rid of this waste (you could have custom, space-saving memoizers, as Vclav Pech points out in his comment below, but then the programmer risks using the wrong one&hellip;which to me destroys the beauty of memoization in the first place). In contrast, in DP it&rsquo;s easier to save space because you can just look at the delta function to see how far &ldquo;back&rdquo; it reaches; beyond there lies garbage, and you can come up with a cleverer representation that stores just the relevant part (the &ldquo;fringe&rdquo;). Once you understand this, you realize that the classic textbook linear, iterative computation of the fibonacci is just an extreme example of DP, where the entire &ldquo;table&rdquo; has been reduced to two iteration variables. (Did your algorithms textbook tell you that?)</p>\n\n<p>In my class, we work through some of the canonical DP algorithms as memoization problems instead, just so when students later encounter these as &ldquo;DP problems&rdquo; in algorithms classes, they (a) realize there is nothing canonical about this presentation, and (b) can be wise-asses about it.</p>\n\n<p>There are many trade-offs between memoization and DP that should drive the choice of which one to use.</p>\n\n<p><strong>Memoization</strong>:</p>\n\n<ul>\n <li>\n  <p>leaves computational description unchanged (black-box)</p></li>\n <li>\n  <p>avoids unnecessary sub-computations (i.e., saves time, and some space with it)</p></li>\n <li>\n  <p>hard to save space absent a strategy for what sub-computations to dispose of</p></li>\n <li>\n  <p>must alway check whether a sub-computation has already been done before doing it (which incurs a small cost)</p></li>\n <li>\n  <p>has a time complexity that depends on picking a smart computation name lookup strategy In direct contrast, <strong>DP</strong>:</p></li>\n <li>\n  <p>forces change in desription of the algorithm, which may introduce errors and certainly introduces some maintenance overhead</p></li>\n <li>\n  <p>cannot avoid unnecessary sub-computations (and may waste the space associated with storing those results)</p></li>\n <li>\n  <p>can more easily save space by disposing of unnecessary sub-computation results</p></li>\n <li>\n  <p>has no need to check whether a computation has been done before doing it&mdash;the computation is rewritten to ensure this isn&rsquo;t necessary</p></li>\n <li>\n  <p>has a space complexity that depends on picking a smart data storage strategy [NB: Small edits to the above list thanks to an exchange with Prabhakar Ragde.]</p></li></ul>\n\n<p>I therefore tell my students: first write the computation and observe whether it fits the DAG pattern; if it does, use memoization. Only if the space proves to be a problem and a specialized memo strategy won&rsquo;t help&mdash;or, even less likely, the cost of &ldquo;has it already been computed&rdquo; is also a problem&mdash;should you think about converting to DP. And when you do, do so in a methodical way, retaining structural similarity to the original. Every subsequent programmer who has to maintain your code will thank you.</p>\n\n<p>I&rsquo;ll end with a short quiz that I always pose to my class.</p>\n\n<p>Memoization is an optimization of a top-down, depth-first computation for an answer. DP is an optimization of a bottom-up, breadth-first computation for an answer. We should naturally ask, what about</p>\n\n<ul>\n <li>\n  <p>top-down, breadth-first</p></li>\n <li>\n  <p>bottom-up, depth-first Where do they fit into the space of techniques for avoiding recomputation by trading off space for time?</p></li>\n <li>\n  <p>Do we already have names for them? If so, what?, or</p></li>\n <li>\n  <p>Have we been missing one or two important tricks?, or</p></li>\n <li>\n  <p>Is there a reason we don&rsquo;t have names for these?</p></li></ul>\n\n<h2 id=\"wheres-the-code\">Where&rsquo;s the Code?</h2>\n\n<p>I&rsquo;ve been criticized for not including code, which is a fair complaint. First, please see the comment number 4 below by simli. For another, let me contrast the two versions of computing Levenshtein distance. For the dynamic programming version, see <a href=\"http://en.wikipedia.org/wiki/Levenshtein_distance\">Wikipedia</a>, which provides pseudocode and memo tables as of this date (2012&ndash;08&ndash;27). Here&rsquo;s the Racket version:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"n\">levenshtein</span>\n  <span class=\"p\">(</span><span class=\"k\">lambda</span> <span class=\"p\">(</span><span class=\"n\">s</span> <span class=\"n\">t</span><span class=\"p\">)</span>\n    <span class=\"p\">(</span><span class=\"k\">cond</span>\n     <span class=\"p\">[(</span><span class=\"k\">and</span> <span class=\"p\">(</span><span class=\"nb\">empty?</span> <span class=\"n\">s</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"nb\">empty?</span> <span class=\"n\">t</span><span class=\"p\">))</span> <span class=\"mi\">0</span><span class=\"p\">]</span>\n     <span class=\"p\">[(</span><span class=\"nb\">empty?</span> <span class=\"n\">s</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"nb\">length</span> <span class=\"n\">t</span><span class=\"p\">)]</span>\n     <span class=\"p\">[(</span><span class=\"nb\">empty?</span> <span class=\"n\">t</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"nb\">length</span> <span class=\"n\">s</span><span class=\"p\">)]</span>\n     <span class=\"p\">[</span><span class=\"k\">else</span>\n      <span class=\"p\">(</span><span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"nb\">equal?</span> <span class=\"p\">(</span><span class=\"nb\">first</span> <span class=\"n\">s</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"nb\">first</span> <span class=\"n\">t</span><span class=\"p\">))</span>\n   <span class=\"p\">(</span><span class=\"n\">levenshtein</span> <span class=\"p\">(</span><span class=\"nb\">rest</span> <span class=\"n\">s</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"nb\">rest</span> <span class=\"n\">t</span><span class=\"p\">))</span>\n   <span class=\"p\">(</span><span class=\"nb\">min</span> <span class=\"p\">(</span><span class=\"nb\">add1</span> <span class=\"p\">(</span><span class=\"n\">levenshtein</span> <span class=\"p\">(</span><span class=\"nb\">rest</span> <span class=\"n\">s</span><span class=\"p\">)</span> <span class=\"n\">t</span><span class=\"p\">))</span>\n        <span class=\"p\">(</span><span class=\"nb\">add1</span> <span class=\"p\">(</span><span class=\"n\">levenshtein</span> <span class=\"n\">s</span> <span class=\"p\">(</span><span class=\"nb\">rest</span> <span class=\"n\">t</span><span class=\"p\">)))</span>\n        <span class=\"p\">(</span><span class=\"nb\">add1</span> <span class=\"p\">(</span><span class=\"n\">levenshtein</span> <span class=\"p\">(</span><span class=\"nb\">rest</span> <span class=\"n\">s</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"nb\">rest</span> <span class=\"n\">t</span><span class=\"p\">)))))])))</span>\n</pre></div>\n\n</div>\n\n<p>The fact that <em>this</em> is not considered the more straightforward, reference implementation by the Wikipedia author is, I think, symptomatic of the lack of understanding that this post is about.</p>\n\n<p>Now let&rsquo;s memoize it (assuming a two-argument <code>memoize</code>):</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"n\">levenshtein</span>\n  <span class=\"p\">(</span><span class=\"n\">memoize</span>\n    <span class=\"p\">(</span><span class=\"k\">lambda</span> <span class=\"p\">(</span><span class=\"n\">s</span> <span class=\"n\">t</span><span class=\"p\">)</span>\n      <span class=\"p\">(</span><span class=\"k\">cond</span>\n       <span class=\"p\">[(</span><span class=\"k\">and</span> <span class=\"p\">(</span><span class=\"nb\">empty?</span> <span class=\"n\">s</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"nb\">empty?</span> <span class=\"n\">t</span><span class=\"p\">))</span> <span class=\"mi\">0</span><span class=\"p\">]</span>\n       <span class=\"p\">[(</span><span class=\"nb\">empty?</span> <span class=\"n\">s</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"nb\">length</span> <span class=\"n\">t</span><span class=\"p\">)]</span>\n       <span class=\"p\">[(</span><span class=\"nb\">empty?</span> <span class=\"n\">t</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"nb\">length</span> <span class=\"n\">s</span><span class=\"p\">)]</span>\n       <span class=\"p\">[</span><span class=\"k\">else</span>\n <span class=\"p\">(</span><span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"nb\">equal?</span> <span class=\"p\">(</span><span class=\"nb\">first</span> <span class=\"n\">s</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"nb\">first</span> <span class=\"n\">t</span><span class=\"p\">))</span>\n     <span class=\"p\">(</span><span class=\"n\">levenshtein</span> <span class=\"p\">(</span><span class=\"nb\">rest</span> <span class=\"n\">s</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"nb\">rest</span> <span class=\"n\">t</span><span class=\"p\">))</span>\n     <span class=\"p\">(</span><span class=\"nb\">min</span> <span class=\"p\">(</span><span class=\"nb\">add1</span> <span class=\"p\">(</span><span class=\"n\">levenshtein</span> <span class=\"p\">(</span><span class=\"nb\">rest</span> <span class=\"n\">s</span><span class=\"p\">)</span> <span class=\"n\">t</span><span class=\"p\">))</span>\n   <span class=\"p\">(</span><span class=\"nb\">add1</span> <span class=\"p\">(</span><span class=\"n\">levenshtein</span> <span class=\"n\">s</span> <span class=\"p\">(</span><span class=\"nb\">rest</span> <span class=\"n\">t</span><span class=\"p\">)))</span>\n   <span class=\"p\">(</span><span class=\"nb\">add1</span> <span class=\"p\">(</span><span class=\"n\">levenshtein</span> <span class=\"p\">(</span><span class=\"nb\">rest</span> <span class=\"n\">s</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"nb\">rest</span> <span class=\"n\">t</span><span class=\"p\">)))))]))))</span>\n</pre></div>\n\n</div>\n\n<p>All that changed is the insertion of the second line.</p>\n\n<h2 id=\"bring-on-the-pitchers\">Bring on the Pitchers!</h2>\n\n<p>The easiest way to illustrate the tree-to-DAG conversion visually is via the Fibonacci computation. Here&rsquo;s a picture of the computational tree:</p>\n\n<p>Now let&rsquo;s see it with memoization. The calls are still the same, but the dashed ovals are the ones that don&rsquo;t compute but whose values are instead looked up, and their emergent arrows show which computation&rsquo;s value was returned by the memoizer.</p>\n\n<p><strong>Important</strong>: The above example is misleading because it suggests that memoization <em>linearizes</em> the computation, which in general it does not. If you want to truly understand the process, I suggest hand-tracing the Levenshtein computation with memoization. And to truly understand the <em>relationship</em> to DP, compare that hand-traced Levenshtein computation with the DP version. (Hint: you can save some manual tracing effort by lightly instrumenting your memoizer to print inputs and outputs. Also, make the memo table a global variable so you can observe it grow.)</p>") #t (u . "\n<p><em>posted by Shriram Krishnamurthi</em></p>\n\n<p>[Edit on 2012&ndash;08&ndash;27, 12:31EDT: added code and pictures below. 2012&ndash;08&ndash;27, 13:10EDT: also incorporated some comments.]</p>\n\n<p>I wrote this on the Racket educators&rsquo; mailing list, and Eli Barzilay</p>\n\n<p>suggested I post it here as well.</p>\n\n<p>The article is about the difference between <strong>memoization</strong> and <strong>dynamic programming</strong> (DP). Before you read on, you should stop and ask yourself: <em>Do I think these two are the same concept?</em>; if you think they are different, <em>How do I think they differ?</em>; and for that matter, <em>Do I even think of them as related?</em></p>\n\n<p>Did you think? Okay, then read on.</p>\n\n<p>They most certainly are related, because they are both mechanisms for optimizing a computation by replacing repeated sub-computations with the storage and reuse of the result of those sub-computations. (That is, both trade off space for time.) In that description is already implicit an assumption: that the sub-computation will return the same result every time (or else you can&rsquo;t replace the computation with its value on subsequent invocations). You&rsquo;ve almost certainly heard of DP from an algorithms class. You&rsquo;ve probably heard of memoization if you&rsquo;re a member of this language&rsquo;s community, but many undergrads simply never see it because algorithms textbooks ignore it; and when they do mention it they demonstrate fundamental misunderstandings (as Algorithms by Dasgupta, Papadimitriou, and Vazirani does).</p>\n\n<p>Therefore, let&rsquo;s set aside precedent. I&rsquo;ll tell you how to think about them.</p>\n\n<p>Memoization is fundamentally a top-down computation and DP is fundamentally bottom-up. In memoization, we observe that a computational <em>tree</em> can actually be represented as a computational <em>DAG</em> (a directed acyclic graph: the single most underrated data structure in computer science); we then use a black-box to turn the tree into a DAG. But it allows the top-down description of the problem to remain unchanged. (As I left unstated originally but commenter23 below rightly intuited, the nodes are function calls, edges are call dependencies, and the arrows are directed from caller to callee. See the pictures later in this article.)</p>\n\n<p>In DP, we make the same observation, but construct the DAG from the bottom-up. That means we have to rewrite the computation to express the delta from each computational tree/DAG node to its parents. We also need a means for addressing/naming those parents (which we did not need in the top-down case, since this was implicit in the recursive call stack). This leads to inventions like DP tables, but people often fail to understand why they exist: it&rsquo;s primarily as a <em>naming mechanism</em> (and while we&rsquo;re at it, why not make it efficient to find a named element, ergo arrays and matrices).</p>\n\n<p>In both cases, there is the potential for space wastage. In memoization, it is very difficult to get rid of this waste (you could have custom, space-saving memoizers, as Vclav Pech points out in his comment below, but then the programmer risks using the wrong one&hellip;which to me destroys the beauty of memoization in the first place). In contrast, in DP it&rsquo;s easier to save space because you can just look at the delta function to see how far &ldquo;back&rdquo; it reaches; beyond there lies garbage, and you can come up with a cleverer representation that stores just the relevant part (the &ldquo;fringe&rdquo;). Once you understand this, you realize that the classic textbook linear, iterative computation of the fibonacci is just an extreme example of DP, where the entire &ldquo;table&rdquo; has been reduced to two iteration variables. (Did your algorithms textbook tell you that?)</p>\n\n<p>In my class, we work through some of the canonical DP algorithms as memoization problems instead, just so when students later encounter these as &ldquo;DP problems&rdquo; in algorithms classes, they (a) realize there is nothing canonical about this presentation, and (b) can be wise-asses about it.</p>\n\n<p>There are many trade-offs between memoization and DP that should drive the choice of which one to use.</p>\n\n<p><strong>Memoization</strong>:</p>\n\n<ul>\n <li>\n  <p>leaves computational description unchanged (black-box)</p></li>\n <li>\n  <p>avoids unnecessary sub-computations (i.e., saves time, and some space with it)</p></li>\n <li>\n  <p>hard to save space absent a strategy for what sub-computations to dispose of</p></li>\n <li>\n  <p>must alway check whether a sub-computation has already been done before doing it (which incurs a small cost)</p></li>\n <li>\n  <p>has a time complexity that depends on picking a smart computation name lookup strategy In direct contrast, <strong>DP</strong>:</p></li>\n <li>\n  <p>forces change in desription of the algorithm, which may introduce errors and certainly introduces some maintenance overhead</p></li>\n <li>\n  <p>cannot avoid unnecessary sub-computations (and may waste the space associated with storing those results)</p></li>\n <li>\n  <p>can more easily save space by disposing of unnecessary sub-computation results</p></li>\n <li>\n  <p>has no need to check whether a computation has been done before doing it&mdash;the computation is rewritten to ensure this isn&rsquo;t necessary</p></li>\n <li>\n  <p>has a space complexity that depends on picking a smart data storage strategy [NB: Small edits to the above list thanks to an exchange with Prabhakar Ragde.]</p></li></ul>\n\n<p>I therefore tell my students: first write the computation and observe whether it fits the DAG pattern; if it does, use memoization. Only if the space proves to be a problem and a specialized memo strategy won&rsquo;t help&mdash;or, even less likely, the cost of &ldquo;has it already been computed&rdquo; is also a problem&mdash;should you think about converting to DP. And when you do, do so in a methodical way, retaining structural similarity to the original. Every subsequent programmer who has to maintain your code will thank you.</p>\n\n<p>I&rsquo;ll end with a short quiz that I always pose to my class.</p>\n\n<p>Memoization is an optimization of a top-down, depth-first computation for an answer. DP is an optimization of a bottom-up, breadth-first computation for an answer. We should naturally ask, what about</p>\n\n<ul>\n <li>\n  <p>top-down, breadth-first</p></li>\n <li>\n  <p>bottom-up, depth-first Where do they fit into the space of techniques for avoiding recomputation by trading off space for time?</p></li>\n <li>\n  <p>Do we already have names for them? If so, what?, or</p></li>\n <li>\n  <p>Have we been missing one or two important tricks?, or</p></li>\n <li>\n  <p>Is there a reason we don&rsquo;t have names for these?</p></li></ul>\n\n<h2 id=\"wheres-the-code\">Where&rsquo;s the Code?</h2>\n\n<p>I&rsquo;ve been criticized for not including code, which is a fair complaint. First, please see the comment number 4 below by simli. For another, let me contrast the two versions of computing Levenshtein distance. For the dynamic programming version, see <a href=\"http://en.wikipedia.org/wiki/Levenshtein_distance\">Wikipedia</a>, which provides pseudocode and memo tables as of this date (2012&ndash;08&ndash;27). Here&rsquo;s the Racket version:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"n\">levenshtein</span>\n  <span class=\"p\">(</span><span class=\"k\">lambda</span> <span class=\"p\">(</span><span class=\"n\">s</span> <span class=\"n\">t</span><span class=\"p\">)</span>\n    <span class=\"p\">(</span><span class=\"k\">cond</span>\n     <span class=\"p\">[(</span><span class=\"k\">and</span> <span class=\"p\">(</span><span class=\"nb\">empty?</span> <span class=\"n\">s</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"nb\">empty?</span> <span class=\"n\">t</span><span class=\"p\">))</span> <span class=\"mi\">0</span><span class=\"p\">]</span>\n     <span class=\"p\">[(</span><span class=\"nb\">empty?</span> <span class=\"n\">s</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"nb\">length</span> <span class=\"n\">t</span><span class=\"p\">)]</span>\n     <span class=\"p\">[(</span><span class=\"nb\">empty?</span> <span class=\"n\">t</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"nb\">length</span> <span class=\"n\">s</span><span class=\"p\">)]</span>\n     <span class=\"p\">[</span><span class=\"k\">else</span>\n      <span class=\"p\">(</span><span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"nb\">equal?</span> <span class=\"p\">(</span><span class=\"nb\">first</span> <span class=\"n\">s</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"nb\">first</span> <span class=\"n\">t</span><span class=\"p\">))</span>\n   <span class=\"p\">(</span><span class=\"n\">levenshtein</span> <span class=\"p\">(</span><span class=\"nb\">rest</span> <span class=\"n\">s</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"nb\">rest</span> <span class=\"n\">t</span><span class=\"p\">))</span>\n   <span class=\"p\">(</span><span class=\"nb\">min</span> <span class=\"p\">(</span><span class=\"nb\">add1</span> <span class=\"p\">(</span><span class=\"n\">levenshtein</span> <span class=\"p\">(</span><span class=\"nb\">rest</span> <span class=\"n\">s</span><span class=\"p\">)</span> <span class=\"n\">t</span><span class=\"p\">))</span>\n        <span class=\"p\">(</span><span class=\"nb\">add1</span> <span class=\"p\">(</span><span class=\"n\">levenshtein</span> <span class=\"n\">s</span> <span class=\"p\">(</span><span class=\"nb\">rest</span> <span class=\"n\">t</span><span class=\"p\">)))</span>\n        <span class=\"p\">(</span><span class=\"nb\">add1</span> <span class=\"p\">(</span><span class=\"n\">levenshtein</span> <span class=\"p\">(</span><span class=\"nb\">rest</span> <span class=\"n\">s</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"nb\">rest</span> <span class=\"n\">t</span><span class=\"p\">)))))])))</span>\n</pre></div>\n\n</div>\n\n<p>The fact that <em>this</em> is not considered the more straightforward, reference implementation by the Wikipedia author is, I think, symptomatic of the lack of understanding that this post is about.</p>\n\n<p>Now let&rsquo;s memoize it (assuming a two-argument <code>memoize</code>):</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"n\">levenshtein</span>\n  <span class=\"p\">(</span><span class=\"n\">memoize</span>\n    <span class=\"p\">(</span><span class=\"k\">lambda</span> <span class=\"p\">(</span><span class=\"n\">s</span> <span class=\"n\">t</span><span class=\"p\">)</span>\n      <span class=\"p\">(</span><span class=\"k\">cond</span>\n       <span class=\"p\">[(</span><span class=\"k\">and</span> <span class=\"p\">(</span><span class=\"nb\">empty?</span> <span class=\"n\">s</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"nb\">empty?</span> <span class=\"n\">t</span><span class=\"p\">))</span> <span class=\"mi\">0</span><span class=\"p\">]</span>\n       <span class=\"p\">[(</span><span class=\"nb\">empty?</span> <span class=\"n\">s</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"nb\">length</span> <span class=\"n\">t</span><span class=\"p\">)]</span>\n       <span class=\"p\">[(</span><span class=\"nb\">empty?</span> <span class=\"n\">t</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"nb\">length</span> <span class=\"n\">s</span><span class=\"p\">)]</span>\n       <span class=\"p\">[</span><span class=\"k\">else</span>\n <span class=\"p\">(</span><span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"nb\">equal?</span> <span class=\"p\">(</span><span class=\"nb\">first</span> <span class=\"n\">s</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"nb\">first</span> <span class=\"n\">t</span><span class=\"p\">))</span>\n     <span class=\"p\">(</span><span class=\"n\">levenshtein</span> <span class=\"p\">(</span><span class=\"nb\">rest</span> <span class=\"n\">s</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"nb\">rest</span> <span class=\"n\">t</span><span class=\"p\">))</span>\n     <span class=\"p\">(</span><span class=\"nb\">min</span> <span class=\"p\">(</span><span class=\"nb\">add1</span> <span class=\"p\">(</span><span class=\"n\">levenshtein</span> <span class=\"p\">(</span><span class=\"nb\">rest</span> <span class=\"n\">s</span><span class=\"p\">)</span> <span class=\"n\">t</span><span class=\"p\">))</span>\n   <span class=\"p\">(</span><span class=\"nb\">add1</span> <span class=\"p\">(</span><span class=\"n\">levenshtein</span> <span class=\"n\">s</span> <span class=\"p\">(</span><span class=\"nb\">rest</span> <span class=\"n\">t</span><span class=\"p\">)))</span>\n   <span class=\"p\">(</span><span class=\"nb\">add1</span> <span class=\"p\">(</span><span class=\"n\">levenshtein</span> <span class=\"p\">(</span><span class=\"nb\">rest</span> <span class=\"n\">s</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"nb\">rest</span> <span class=\"n\">t</span><span class=\"p\">)))))]))))</span>\n</pre></div>\n\n</div>\n\n<p>All that changed is the insertion of the second line.</p>\n\n<h2 id=\"bring-on-the-pitchers\">Bring on the Pitchers!</h2>\n\n<p>The easiest way to illustrate the tree-to-DAG conversion visually is via the Fibonacci computation. Here&rsquo;s a picture of the computational tree:</p>\n\n<p>Now let&rsquo;s see it with memoization. The calls are still the same, but the dashed ovals are the ones that don&rsquo;t compute but whose values are instead looked up, and their emergent arrows show which computation&rsquo;s value was returned by the memoizer.</p>\n\n<p><strong>Important</strong>: The above example is misleading because it suggests that memoization <em>linearizes</em> the computation, which in general it does not. If you want to truly understand the process, I suggest hand-tracing the Levenshtein computation with memoization. And to truly understand the <em>relationship</em> to DP, compare that hand-traced Levenshtein computation with the DP version. (Hint: you can save some manual tracing effort by lightly instrumenting your memoizer to print inputs and outputs. Also, make the memo table a global variable so you can observe it grow.)</p>\n<!-- more-->\n\n<hr />\n\n<p>Nice teaser blog, but dry. Where is the code to explain such broad statements?</p>\n\n<p>It sounds as if you have a point - Enough to make me want to see examples but there is nothing beneath to chew on.</p>\n\n<p>— <em>Paddy3118, 26 August 2012</em></p>\n\n<hr />\n\n<p>Thank you for such a nice generalization of the concept. I elaborated on a specific task in one of my earlier posts (http://www.jroller.com/vaclav/entry/memoize_groovy_functions_with_gpars), where by simply adding memoization on top of a recursive Fibonacci function I end-up with linear time complexity. Since Groovy supports space-limited variants of memoize, getting down to constant space complexity (exactly two values) was easily achievable, too.</p>\n\n<p>— <em>Václav Pech, 26 August 2012</em></p>\n\n<hr />\n\n<p>@Paddy3118: The simplest example I can think of is the Fibonacci sequence. The implementations in Javascript can be as follows.  function FIB_MEMO(num) {  var cache = { 1: 1, 2: 1 };  function innerFib(x) {  if(cache[x]) { return cache[x]; }  cache[x] = (innerFib(x&ndash;1) + innerFib(x&ndash;2));  return cache[x];  }  return innerFib(num); } function FIB_DP(num) {  var a = 1, b = 1, i = 3, tmp;  while(i &lt;= num) {  tmp = a;  a = b;  b = tmp + b;  i++;  }  return b; } It can be seen that the Memoization version &ldquo;leaves computational description unchanged&rdquo;. And the DP version &ldquo;forces change in desription of the algorithm&rdquo;. Also note that the Memoization version can take a lot of stack space if you try to call the function with a large number. The trade-offs mentioned at the end of the article can easily be seen in these implementations.</p>\n\n<p>— <em>simil, 26 August 2012</em></p>\n\n<hr />\n\n<p>A small note from someone who was initially confused - it was hard to parse what you meant by converting a DAG into a tree as the article didn&rsquo;t mention what the nodes and edges signify. Presumably the nodes are function calls and edges indicate one call needing another. And the direction of the arrows point from the caller to the callee? It would be more clear if this was mentioned before the DAG to tree statement.  Nevertheless, a good article.</p>\n\n<p>— <em>commenter23, 26 August 2012</em></p>\n\n<hr />\n\n<p>Inserting the line &ldquo;memoize&rdquo; may work beautifully, but it doesn&rsquo;t really illuminate what&rsquo;s going on. Would there be any point adding a version that expands that into explicitly checking and updating a table?</p>\n\n<p>— <em>sbloch, 27 August 2012</em></p>\n\n<hr />\n\n<p>1) I completely agree that pedagogically it&rsquo;s much better to teach memoization first before dynamic programming. The latter has <em>two</em> stumbling blocks for students: one the very idea of decomposing of a problem in terms of similar sub-problems, and the other the idea of filling up a table bottom-up, and it&rsquo;s best to introduce them one-by-one. Then you can say &ldquo;dynamic programming is doing the memoization bottom-up&rdquo;. As an aside, for students who know mathematical induction, it sometimes helps them to say &ldquo;dynamic programming is somewhat like induction&rdquo;.</p>\n\n<p>2) What are the fundamental misunderstandings in the Algorithms book? (I haven&rsquo;t seen it.)</p>\n\n<p>3) One issue with memoization that you didn&rsquo;t mention is stack overflow. Because of its depth-first nature, solving a problem for N can result in a stack depth of nearly N (even worse for problems where answers are to be computed for multiple dimensions like (M,N)); this can be an issue when stack size is small.</p>\n\n<p>— <em>shreevatsa, 28 August 2012</em></p>\n\n<hr />\n\n<p>Stephen (sbloch), sorry, but no time to do that right now. You&rsquo;re right that that would help, but I was assuming the reader had some knowledge of memoization to begin with, or could look it up.</p>\n\n<p>— <em>Shriram Krishnamurthi, 29 August 2012</em></p>\n\n<hr />\n\n<p>shreevatsa, +1 to everything you said.</p>\n\n<p>I can&rsquo;t locate the comment in <em>Algorithms</em> right now, but it was basically deprecating memoization by writing not particularly enlightened remarks about &ldquo;recursion&rdquo;.</p>\n\n<p>One slight counter to your comment #2: if depth of recursion really is a problem, one could systematically eliminate it using techniques like CPS. Thus the solution can still be expressed as base functionality + functional abstractions + program transformations. This would be easier to read and to maintain.</p>\n\n<p>— <em>Shriram Krishnamurthi, 29 August 2012</em></p>\n\n<hr />\n\n<p>Shriram and sbloch,</p>\n\n<p>About to talk memoization to a class today. Here&rsquo;s a Racket memoize that should work for any number of args on the memoized function:</p>\n\n<p>(define (memoize f)   (local ([define table (make-hash)])     (lambda args       ;; Look up the arguments.       ;; If they&rsquo;re present, just give back the stored result.       ;; If they&rsquo;re not present, calculate and store the result.       ;; Note that the calculation will not be expensive as long        ;; as f uses this memoized version for its recursive call,        ;; which is the natural way to write it!       (dict-ref! table args                  (lambda ()                    (apply f args))))))</p>\n\n<p>— <em>wolf, 19 September 2012</em></p>\n\n<hr />\n\n<p>@wolf, nice, thanks. Keep in mind that different uses might want different kinds of equality comparisons (equal? vs eq?, say). May be good to remind your class of that. They could generalize your memoize to be parameterized over that (even in each position, if they want to go wild).</p>\n\n<p>— <em>Shriram Krishnamurthi, 19 September 2012</em></p>\n\n<hr />\n\n<p>Got here from your parsing G+ post.</p>\n\n<p>You are unfair towards Algorithms. The statement they make is: &ldquo;However, the constant factor in this big-O notation is substantially larger because of the overhead of recursion.&rdquo; That was true of hardware from more than 20 years ago; It&rsquo;s not true today, as far as I know. Although you can make the case that with DP it&rsquo;s easier to control cache locality, and cache locality still matters, a lot.</p>\n\n<p>If you view these remarks as trying to say something about what memoization is, then they are wrong. But, they aren&rsquo;t supposed to be remarks about what memoization is. They are simply practical considerations that are related to memoization.</p>\n\n<p>Imagine someone says: &ldquo;DFS might be more appropriate than BFS in this case, because space might be an issue; but be careful &mdash; most hardware takes a lot longer to execute a &lsquo;call&rsquo; as compared to a &lsquo;jmp&rsquo;.&rdquo; Is this statement a mis-informed indictment of DFS? Not really. You can do DFS without calls. For that matter, you can do memoization without &rsquo;call&rsquo;s. (Oh, wait, you already mentioned CPS. :) )</p>\n\n<p>— <em>Radu Grigore, 2 December 2013</em></p>\n\n<hr />\n\n<p>Radu, okay, my remark may be a bit too harsh. Sure. But I can throw in other criticisms too: the fact that it appears so late in the book, only as a sidebar, and is then called a &ldquo;trick&rdquo;, as if the DP version of the algorithm were somehow fundamental! Of course, the next criticism would be, &ldquo;Hey, they at least mentioned it &mdash; most algorithms textbooks don&rsquo;t do even that!&rdquo; So at the end of the day, it&rsquo;s all just damning with faint praise.</p>\n\n<p>— <em>Shriram Krishnamurthi, 2 December 2013</em></p>\n\n<hr />\n\n<p>Also, Radu, I&rsquo;m curious why it&rsquo;s fine for a book written in 2006 to say things you believe were out of date for at least 13 years at that point. (-:</p>\n\n<p>— <em>Shriram Krishnamurthi, 2 December 2013</em></p>\n\n<hr />\n\n<p>The statement they make about constant factors is about how hardware works, not about a fundamental issue. This is my point.</p>\n\n<p>I&rsquo;ll try to show you why your criticism is unfair, by temporarily putting you at the other end of a similar line of attack. So, please indulge me, and don&rsquo;t get too annoyed.</p>\n\n<p>&mdash; start &mdash;</p>\n\n<p>Your omission of cache locality from the comparison demonstrates a fundamental misunderstanding. OK maybe that is a bit too harsh. However, it does show that you haven&rsquo;t actually benchmarked your levenshtein implementation against a DP version that keeps only the fringe, so you don&rsquo;t know what&rsquo;s the difference in performance. But, how could anyone believe that not knowing this is OK?</p>\n\n<p>&mdash; stop &mdash;</p>\n\n<p>I believe that the above criticism of your post is unfair, and similar to your criticism of the book.</p>\n\n<p>The book is a small jewel, with emphasis on small. It is packed with cool tricks (where &ldquo;trick&rdquo; is to be understood as something good). Too bad they wrote that book after I learned those tricks the tedious way.</p>\n\n<p>Your post is pretty good too. I especially liked the quiz at the end.</p>\n\n<p>— <em>Radu Grigore, 3 December 2013</em></p>\n\n<hr />\n\n<p>Shriram: I wasn&rsquo;t sure whether they are right about the &ldquo;overhead of recursion&rdquo;. I thought they are wrong, but I did some experiments and it seems they are right-ish: http://rgrig.blogspot.com/2013/12/edit-distance-benchmarks.html</p>\n\n<p>— <em>Radu Grigore, 11 December 2013</em></p>\n\n<hr />\n\n<p>Thanks. I did some experiments with using the same data structure in both cases, and I got a slight gain from the memoized version.</p>\n\n<p>Note that my DP version uses an option type to prevent accidental use of an uninitialized slot, because if you truly want to compare the two, you should make sure you have the same safety characteristics.</p>\n\n<p>Remove that and I believe the DP version is indeed a bit faster, but now you&rsquo;re comparing a safe and unsafe implementation of a problem. That&rsquo;s not a fair comparison and the difference can&rsquo;t be attributed entirely to the calling mechanism.</p>\n\n<p>Also, whether or not you use a &ldquo;safe&rdquo; DP, in the memoized version you also have to check for whether the problem has already been solved. How do you know that the overhead you&rsquo;re seeing is entirely due to recursion, and not due to this?</p>\n\n<p>— <em>Shriram Krishnamurthi, 12 December 2013</em></p>\n\n<hr />\n\n<p>I will have to disagree with what you call a fair comparison. But I want to use as a starting point a statement on which we probably agree: Memoization is more clear, more elegant, and safer.</p>\n\n<p>But things like memoization and dynamic programming do not live in a totally ordered universe. There are multiple dimensions across which they can be compared, such as correctness and efficiency. Clarity, elegance and safety all have to do with correctness.</p>\n\n<p>When you say that it isn&rsquo;t fair to implement dp without options, that sounds to me like saying it isn&rsquo;t fair to compare a program with an optimized version of itself. For example, like saying that comparing a program with array bounds checks against the version without bounds checks isn&rsquo;t fair. And I can&rsquo;t agree with this.</p>\n\n<p>What wouldn&rsquo;t be fair would be to not acknowledge that there is a trade-off involved: you gain efficiency, but you lose safety. The latter means that the programmer needs to do more work to achieve correctness. And yes, almost always this is a bad trade-off.</p>\n\n<p>In summary, comparing memoization with a patched up version of dp that tries to recover some safety looks very odd to me.</p>\n\n<p>&ldquo;I believe the DP version is indeed a bit faster&rdquo;</p>\n\n<p>If by &ldquo;a bit faster&rdquo; you mean &ldquo;about twice as fast&rdquo;, then I agree. Otherwise, I&rsquo;m tempted to ask to see your code. :)</p>\n\n<p>&ldquo;How do you know that the overhead you&rsquo;re seeing is entirely due to recursion, and not due to [checking whether a result is already available]?&rdquo;</p>\n\n<p>I could add the checking overhead to dp and see how big it is. But why would I? The number you really care about when comparing efficiency is the overall time.</p>\n\n<p>— <em>Radu Grigore, 19 December 2013</em></p>\n\n<hr />")) ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2011-04-04-writing-syntax-case-macros.md" . unix) f post (u . "Writing `syntax-case` Macros") (? . 18) 1467223812 (p+ #"/Users/MB/git/racket-lang-org/blog/2011/04/writing-syntax-case-macros.html" . unix) "/2011/04/writing-syntax-case-macros.html" (u . "2011-04-04T14:00:00.001-04:00") (? . 47) (? . 1) (c (u . "")) (u . "\n<p><em>posted by Eli Barzilay</em></p>\n\n<p>Disclaimer: This is not really a tutorial on macros, it&rsquo;s more of a quick introduction to using Racket&rsquo;s <code>syntax-case</code>-based macros for people who are familiar with symbolic macros and miss their “simplicity”. It&rsquo;s also not comprehensive or thorough or complete, it&rsquo;s just intended to provide a rough quick overview of how to write macros. It was originally posted on comp.lang.scheme in a thread called “Idiot&rsquo;s guide to Scheme macros”, but I avoided that title here, since it&rsquo;s not a general purpose guide. (Also, it&rsquo;s yet another attempt to dispel the irrational “macrophobia” some people have when it gets to hygienic macros, leading them back to using <code>defmacro</code> with all its problems.)</p>\n\n<p>The main idea with Racket&rsquo;s macro system (and with other <code>syntax-case</code> systems) is that macros are syntax-to-syntax functions, just like the case of <code>defmacro</code>, except that instead of raw S-expressions you&rsquo;re dealing with syntax objects. This becomes very noticeable when identifiers are handled: instead of dealing with plain symbols, you&rsquo;re dealing with these syntax values (called “identifiers” in this case) that are essentially a symbol and <em>some opaque information</em> that represents the lexical scope for its source. In several <code>syntax-case</code> systems this is the only difference from <code>defmacro</code> macros, but in the Racket case this applies to everything — identifiers, numbers, other immediate constants, and even function applications, etc — they are all the same S-expression values that you&rsquo;re used to, except wrapped with additional information. Another thing that is unique to Racket is the extra information: in addition to the opaque lexical context, there is also source information and arbitrary properties (there are also certificates, but that&rsquo;s ignorable for this text).</p>\n\n<p>With this in mind, explaining the rest is not too difficult:</p>\n\n<ul>\n <li>\n  <p><code>(syntax-source stx)</code>, <code>(syntax-position stx)</code>, <code>(syntax-line stx)</code>, <code>(syntax-column stx)</code> — retrieve parts of the source location information.</p></li>\n <li>\n  <p><code>(syntax-e stx)</code> — takes a syntax value and returns the value it “wraps”. For example, if <code>stx</code> is an identifier you&rsquo;d get a symbol, and if it&rsquo;s a number you&rsquo;d get the number. If it&rsquo;s a simple parenthesized form, you&rsquo;d get a list of syntax values for the subforms. Note that the list can be improper, with the last element being a syntax object that contains a proper list. (But the list will actually be improper if the original syntax was a dotted list.)</p></li>\n <li>\n  <p><code>(syntax-&gt;datum stx)</code> — takes a syntax value and returns the plain S-expression that it holds. This is done by recursive uses of <code>syntax-e</code>. (It would be a simple definition that does what you&rsquo;d think it should do.)</p></li>\n <li>\n  <p><code>(syntax-&gt;list stx)</code> — sometimes you want to pull out the list of syntax values from a given parenthesized syntax, but <code>syntax-e</code> does too little (can still return an improper list) and <code>syntax-&gt;datum</code> does too much (gives you back raw S-expressions). <code>syntax-&gt;list</code> is a utility function that uses <code>syntax-e</code> as many times as needed to get back a proper list of syntax values. If that&rsquo;s not possible (if the input syntax was not a proper list), it returns <code>#f</code>, so it serves as a predicate too.</p></li>\n <li>\n  <p><code>(syntax-property stx prop)</code> — returns the given property value from stx, if any, and <code>#f</code> if none. For example, try</p></li></ul>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"nb\">syntax-property</span> <span class=\"o\">#&#39;</span><span class=\"p\">[</span><span class=\"n\">foo</span><span class=\"p\">]</span> <span class=\"o\">&#39;</span><span class=\"ss\">paren-shape</span><span class=\"p\">)</span>\n</pre></div>\n\n</div>\n\n<p>(The <code>#'</code> is similar to a quote, but for syntax values — I&rsquo;ll get to that later on.)</p>\n\n<ul>\n <li>\n  <p>Note that there is <em>no</em> accessor for the opaque lexical scope, and as you&rsquo;ll see next, you don&rsquo;t need one.</p></li>\n <li>\n  <p>To create a piece of syntax you use <code>datum-&gt;syntax</code>, and you give it an S-expression which will be the “contents” of the resulting syntax object. (The input can contain syntax values, which are left as is.) But when you do that you need to give it the other bits — including the lexical context thing, which you have no access to. The way that&rsquo;s done is:</p></li></ul>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"nb\">datum-&gt;syntax</span> <span class=\"n\">context-stx</span> <span class=\"n\">input-sexpr</span><span class=\"p\">)</span> \n</pre></div>\n\n</div>\n\n<p>This returns a syntax value that wraps the <code>input-sexpr</code> value, using the lexical scope from <code>context-stx</code>. A common way to “break hygiene” and create a binding that is visible to the macro user&rsquo;s code is:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"nb\">datum-&gt;syntax</span> <span class=\"n\">stx</span> <span class=\"o\">&#39;</span><span class=\"ss\">foo</span><span class=\"p\">)</span>\n</pre></div>\n\n</div>\n\n<p>where <code>stx</code> is some syntax value that you get from the user input to the macro. It returns a <code>foo</code> identifier that has the same lexical context information as <code>stx</code>, so it&rsquo;s as if it came from there.</p>\n\n<p>Note that there is actually another optional argument that specifies the source (either using another syntax object, or as an explicit list), and another for copying the properties from — so an alternative to the above would be:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"nb\">datum-&gt;syntax</span> <span class=\"n\">stx</span> <span class=\"o\">&#39;</span><span class=\"ss\">foo</span> <span class=\"n\">stx</span> <span class=\"n\">stx</span><span class=\"p\">)</span>\n</pre></div>\n\n</div>\n\n<p>which also makes the source information and the properties be the same as those of <code>stx</code> (for example, this can matter in case of syntax errors).</p>\n\n<ul>\n <li>\n  <p>There is also <code>(quote-syntax blah)</code> which creates a quoted syntax, with its lexical source from the place it appears.</p></li>\n <li>\n  <p>Finally, <code>define-syntax</code> does the magic of tying a name with a transformer function.</p></li></ul>\n\n<p>And that&rsquo;s almost everything that you need in order to write hygienic (and non-hygienic) macros. Very inconveniently.</p>\n\n<p>For example, here&rsquo;s a simple <code>while</code> macro (use this in a file that starts with <code>#lang racket</code>):</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">define-syntax</span> <span class=\"p\">(</span><span class=\"n\">while</span> <span class=\"n\">stx</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"n\">subs</span> <span class=\"p\">(</span><span class=\"nb\">syntax-&gt;list</span> <span class=\"n\">stx</span><span class=\"p\">))</span>\n  <span class=\"p\">(</span><span class=\"nb\">datum-&gt;syntax</span>\n   <span class=\"n\">stx</span>\n   <span class=\"o\">`</span><span class=\"p\">(</span><span class=\"ss\">let</span> <span class=\"ss\">loop</span> <span class=\"p\">()</span>\n      <span class=\"p\">(</span><span class=\"ss\">when</span> <span class=\"o\">,</span><span class=\"p\">(</span><span class=\"nb\">cadr</span> <span class=\"n\">subs</span><span class=\"p\">)</span>\n        <span class=\"o\">,@</span><span class=\"p\">(</span><span class=\"nb\">cddr</span> <span class=\"n\">subs</span><span class=\"p\">)</span>\n        <span class=\"p\">(</span><span class=\"ss\">loop</span><span class=\"p\">)))</span>\n   <span class=\"n\">stx</span><span class=\"p\">))</span>\n</pre></div>\n\n</div>\n\n<p>which breaks like this:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"n\">x</span> <span class=\"mi\">2</span><span class=\"p\">)</span>\n<span class=\"p\">(</span><span class=\"k\">let</span> <span class=\"p\">([</span><span class=\"k\">let</span> <span class=\"mi\">5</span><span class=\"p\">])</span>\n  <span class=\"p\">(</span><span class=\"n\">while</span> <span class=\"p\">(</span><span class=\"nb\">&lt;</span> <span class=\"n\">x</span> <span class=\"mi\">10</span><span class=\"p\">)</span>\n    <span class=\"p\">(</span><span class=\"nb\">printf</span> <span class=\"s2\">\"x = ~s</span><span class=\"se\">\\n</span><span class=\"s2\">\"</span> <span class=\"n\">x</span><span class=\"p\">)</span>\n    <span class=\"p\">(</span><span class=\"k\">set!</span> <span class=\"n\">x</span> <span class=\"p\">(</span><span class=\"nb\">add1</span> <span class=\"n\">x</span><span class=\"p\">))))</span>\n</pre></div>\n\n</div>\n\n<p>The problem is that all of those quoted names are getting the context of the user input, which is not the right thing (it&rsquo;s close to a <code>defmacro</code>). To fix this, you need to <code>quote-syntax</code> all of these identifiers, so they&rsquo;ll have the macro source instead of the input source:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">define-syntax</span> <span class=\"p\">(</span><span class=\"n\">while</span> <span class=\"n\">stx</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"n\">subs</span> <span class=\"p\">(</span><span class=\"nb\">syntax-&gt;list</span> <span class=\"n\">stx</span><span class=\"p\">))</span>\n  <span class=\"p\">(</span><span class=\"nb\">datum-&gt;syntax</span>\n   <span class=\"n\">stx</span>\n   <span class=\"o\">`</span><span class=\"p\">(</span><span class=\"o\">,</span><span class=\"p\">(</span><span class=\"k\">quote-syntax</span> <span class=\"k\">let</span><span class=\"p\">)</span> <span class=\"o\">,</span><span class=\"p\">(</span><span class=\"k\">quote-syntax</span> <span class=\"n\">loop</span><span class=\"p\">)</span> <span class=\"p\">()</span>\n     <span class=\"p\">(</span><span class=\"o\">,</span><span class=\"p\">(</span><span class=\"k\">quote-syntax</span> <span class=\"k\">when</span><span class=\"p\">)</span> <span class=\"o\">,</span><span class=\"p\">(</span><span class=\"nb\">cadr</span> <span class=\"n\">subs</span><span class=\"p\">)</span>\n      <span class=\"o\">,@</span><span class=\"p\">(</span><span class=\"nb\">cddr</span> <span class=\"n\">subs</span><span class=\"p\">)</span>\n      <span class=\"p\">(</span><span class=\"o\">,</span><span class=\"p\">(</span><span class=\"k\">quote-syntax</span> <span class=\"n\">loop</span><span class=\"p\">))))</span>\n   <span class=\"n\">stx</span><span class=\"p\">))</span>\n</pre></div>\n\n</div>\n\n<p>But that&rsquo;s clearly insane&hellip; More than being tedious, it&rsquo;s still incorrect since all of those function application parens will have the user&rsquo;s lexical context (Racket has a special implicit <code>#%app</code> macro that gets used in all function applications, and in this case the context of this application will make it unhygienic). Instead of doing this, a better approach would be to create the resulting syntax with the lexical context of the macro source by changing just that argument:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">define-syntax</span> <span class=\"p\">(</span><span class=\"n\">while</span> <span class=\"n\">stx</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"n\">subs</span> <span class=\"p\">(</span><span class=\"nb\">syntax-&gt;list</span> <span class=\"n\">stx</span><span class=\"p\">))</span>\n  <span class=\"p\">(</span><span class=\"nb\">datum-&gt;syntax</span>\n   <span class=\"p\">(</span><span class=\"k\">quote-syntax</span> <span class=\"n\">here</span><span class=\"p\">)</span>\n   <span class=\"o\">`</span><span class=\"p\">(</span><span class=\"ss\">let</span> <span class=\"ss\">loop</span> <span class=\"p\">()</span>\n      <span class=\"p\">(</span><span class=\"ss\">when</span> <span class=\"o\">,</span><span class=\"p\">(</span><span class=\"nb\">cadr</span> <span class=\"n\">subs</span><span class=\"p\">)</span>\n        <span class=\"o\">,@</span><span class=\"p\">(</span><span class=\"nb\">cddr</span> <span class=\"n\">subs</span><span class=\"p\">)</span>\n        <span class=\"p\">(</span><span class=\"ss\">loop</span><span class=\"p\">)))</span>\n   <span class=\"n\">stx</span><span class=\"p\">))</span>\n</pre></div>\n\n</div>\n\n<p>And that&rsquo;s simple again, and works fine now.</p>\n\n<p>The problem is that it&rsquo;s tedious wrt to deconstructing the input (which happens to be trivial in this case), and wrt slapping together an output value — and that&rsquo;s where <code>syntax-case</code> comes in. It addresses the both by using pattern matching, where identifiers in patterns are bound as “syntax patterns”. A new form is added — <code>syntax</code> — which is similar to a <code>quote</code>, except that (a) it actually quotes things similarly to <code>quote-syntax</code>, with the lexical context of the <code>syntax</code> form; and (b) pattern variables are substituted with what they matched. With this, the above macro becomes much easier:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">define-syntax</span> <span class=\"p\">(</span><span class=\"n\">while</span> <span class=\"n\">stx</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"k\">syntax-case</span> <span class=\"n\">stx</span> <span class=\"p\">()</span>\n    <span class=\"p\">[(</span><span class=\"k\">_</span> <span class=\"n\">test</span> <span class=\"n\">body</span> <span class=\"k\">...</span><span class=\"p\">)</span>\n     <span class=\"p\">(</span><span class=\"k\">syntax</span> <span class=\"p\">(</span><span class=\"k\">let</span> <span class=\"n\">loop</span> <span class=\"p\">()</span>\n               <span class=\"p\">(</span><span class=\"k\">when</span> <span class=\"n\">test</span>\n                 <span class=\"n\">body</span> <span class=\"k\">...</span>\n                 <span class=\"p\">(</span><span class=\"n\">loop</span><span class=\"p\">))))]))</span>\n</pre></div>\n\n</div>\n\n<p>The first line specifies that you want to match the <code>stx</code> input syntax, and that you have no “keywords” (in the same sense as in <code>syntax-rules</code>). The second line is the pattern that is matched against this input — with two pattern variables that match the second subexpression and the sequence of expressions from the third and on. (The first subexpression is matched against <code>_</code> which is a wild-card that matches anything without binding a pattern variable — the head part is often not needed, since it&rsquo;s just the macro name.) The last line is the output, specified using <code>syntax</code>, which means that it&rsquo;s very similar to the previous version where everything is given the lexical context of the macro and the two pattern variables are replaced with the two matches (so <code>body</code> gets spliced into the resulting syntax).</p>\n\n<p>Now, say that you want an unhygienic user-visible piece of syntax. For example, bind the always entertaining <code>it</code> thing to the test result. This:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">define-syntax</span> <span class=\"p\">(</span><span class=\"n\">while</span> <span class=\"n\">stx</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"k\">syntax-case</span> <span class=\"n\">stx</span> <span class=\"p\">()</span>\n    <span class=\"p\">[(</span><span class=\"k\">_</span> <span class=\"n\">test</span> <span class=\"n\">body</span> <span class=\"k\">...</span><span class=\"p\">)</span>\n     <span class=\"p\">(</span><span class=\"k\">syntax</span> <span class=\"p\">(</span><span class=\"k\">let</span> <span class=\"n\">loop</span> <span class=\"p\">()</span>\n               <span class=\"p\">(</span><span class=\"k\">let</span> <span class=\"p\">([</span><span class=\"n\">it</span> <span class=\"n\">test</span><span class=\"p\">])</span>\n                 <span class=\"p\">(</span><span class=\"k\">when</span> <span class=\"n\">it</span>\n                   <span class=\"n\">body</span> <span class=\"k\">...</span>\n                   <span class=\"p\">(</span><span class=\"n\">loop</span><span class=\"p\">)))))]))</span>\n</pre></div>\n\n</div>\n\n<p>won&rsquo;t work because <code>it</code> has the macro source — it&rsquo;s hygienic and therefore not visible. Instead, you need to use <code>datum-&gt;syntax</code> with the user syntax:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">define-syntax</span> <span class=\"p\">(</span><span class=\"n\">while</span> <span class=\"n\">stx</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"k\">syntax-case</span> <span class=\"n\">stx</span> <span class=\"p\">()</span>\n    <span class=\"p\">[(</span><span class=\"k\">_</span> <span class=\"n\">test</span> <span class=\"n\">body</span> <span class=\"k\">...</span><span class=\"p\">)</span>\n     <span class=\"p\">(</span><span class=\"k\">let</span> <span class=\"p\">([</span><span class=\"n\">it</span> <span class=\"p\">(</span><span class=\"nb\">datum-&gt;syntax</span> <span class=\"n\">stx</span> <span class=\"o\">&#39;</span><span class=\"ss\">it</span><span class=\"p\">)])</span>\n       <span class=\"p\">(</span><span class=\"k\">syntax</span> <span class=\"p\">(</span><span class=\"k\">let</span> <span class=\"n\">loop</span> <span class=\"p\">()</span>\n                 <span class=\"p\">(</span><span class=\"k\">let</span> <span class=\"p\">([</span><span class=\"n\">it</span> <span class=\"n\">test</span><span class=\"p\">])</span>\n                   <span class=\"p\">(</span><span class=\"k\">when</span> <span class=\"n\">it</span>\n                     <span class=\"n\">body</span> <span class=\"k\">...</span>\n                     <span class=\"p\">(</span><span class=\"n\">loop</span><span class=\"p\">))))))]))</span>\n</pre></div>\n\n</div>\n\n<p>But this doesn&rsquo;t really work since <code>it</code> needs to be bound as a pattern variable rather than a plain binding. <code>syntax-case</code> can be used here again: <code>(syntax-case &lt;name&gt; () [foo &lt;body&gt;])</code> will match <code>foo</code> against the <code>&lt;name&gt;</code> syntax, and if it&rsquo;s a name then it will be bound as a pattern variable in the <code>&lt;body&gt;</code>.</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">define-syntax</span> <span class=\"p\">(</span><span class=\"n\">while</span> <span class=\"n\">stx</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"k\">syntax-case</span> <span class=\"n\">stx</span> <span class=\"p\">()</span>\n    <span class=\"p\">[(</span><span class=\"k\">_</span> <span class=\"n\">test</span> <span class=\"n\">body</span> <span class=\"k\">...</span><span class=\"p\">)</span>\n     <span class=\"p\">(</span><span class=\"k\">syntax-case</span> <span class=\"p\">(</span><span class=\"nb\">datum-&gt;syntax</span> <span class=\"n\">stx</span> <span class=\"o\">&#39;</span><span class=\"ss\">it</span><span class=\"p\">)</span> <span class=\"p\">()</span>\n       <span class=\"p\">[</span><span class=\"n\">it</span> <span class=\"p\">(</span><span class=\"k\">syntax</span> <span class=\"p\">(</span><span class=\"k\">let</span> <span class=\"n\">loop</span> <span class=\"p\">()</span>\n                     <span class=\"p\">(</span><span class=\"k\">let</span> <span class=\"p\">([</span><span class=\"n\">it</span> <span class=\"n\">test</span><span class=\"p\">])</span>\n                       <span class=\"p\">(</span><span class=\"k\">when</span> <span class=\"n\">it</span>\n                         <span class=\"n\">body</span> <span class=\"k\">...</span>\n                         <span class=\"p\">(</span><span class=\"n\">loop</span><span class=\"p\">)))))])]))</span>\n</pre></div>\n\n</div>\n\n<p>Note that since <code>it</code> is a pattern variable, it doesn&rsquo;t need to be unquoted — <code>syntax</code> will do that.</p>\n\n<p>Finally, there are some more conveniences. First, <code>with-syntax</code> is a macro that binds pattern variables (by a similar translation to <code>syntax-case</code>):</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">define-syntax</span> <span class=\"p\">(</span><span class=\"n\">while</span> <span class=\"n\">stx</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"k\">syntax-case</span> <span class=\"n\">stx</span> <span class=\"p\">()</span>\n    <span class=\"p\">[(</span><span class=\"k\">_</span> <span class=\"n\">test</span> <span class=\"n\">body</span> <span class=\"k\">...</span><span class=\"p\">)</span>\n     <span class=\"p\">(</span><span class=\"k\">with-syntax</span> <span class=\"p\">([</span><span class=\"n\">it</span> <span class=\"p\">(</span><span class=\"nb\">datum-&gt;syntax</span> <span class=\"n\">stx</span> <span class=\"o\">&#39;</span><span class=\"ss\">it</span><span class=\"p\">)])</span>\n       <span class=\"p\">(</span><span class=\"k\">syntax</span> <span class=\"p\">(</span><span class=\"k\">let</span> <span class=\"n\">loop</span> <span class=\"p\">()</span>\n                 <span class=\"p\">(</span><span class=\"k\">let</span> <span class=\"p\">([</span><span class=\"n\">it</span> <span class=\"n\">test</span><span class=\"p\">])</span>\n                   <span class=\"p\">(</span><span class=\"k\">when</span> <span class=\"n\">it</span>\n                     <span class=\"n\">body</span> <span class=\"k\">...</span>\n                     <span class=\"p\">(</span><span class=\"n\">loop</span><span class=\"p\">))))))]))</span>\n</pre></div>\n\n</div>\n\n<p>and there&rsquo;s the <code>#'</code> reader macro for <code>syntax</code>:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">define-syntax</span> <span class=\"p\">(</span><span class=\"n\">while</span> <span class=\"n\">stx</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"k\">syntax-case</span> <span class=\"n\">stx</span> <span class=\"p\">()</span>\n    <span class=\"p\">[(</span><span class=\"k\">_</span> <span class=\"n\">test</span> <span class=\"n\">body</span> <span class=\"k\">...</span><span class=\"p\">)</span>\n     <span class=\"p\">(</span><span class=\"k\">with-syntax</span> <span class=\"p\">([</span><span class=\"n\">it</span> <span class=\"p\">(</span><span class=\"nb\">datum-&gt;syntax</span> <span class=\"n\">stx</span> <span class=\"o\">&#39;</span><span class=\"ss\">it</span><span class=\"p\">)])</span>\n       <span class=\"o\">#&#39;</span><span class=\"p\">(</span><span class=\"k\">let</span> <span class=\"n\">loop</span> <span class=\"p\">()</span>\n           <span class=\"p\">(</span><span class=\"k\">let</span> <span class=\"p\">([</span><span class=\"n\">it</span> <span class=\"n\">test</span><span class=\"p\">])</span>\n             <span class=\"p\">(</span><span class=\"k\">when</span> <span class=\"n\">it</span>\n               <span class=\"n\">body</span> <span class=\"k\">...</span>\n               <span class=\"p\">(</span><span class=\"n\">loop</span><span class=\"p\">)))))]))</span>\n</pre></div>\n\n</div>\n\n<p> and there are also <code>#`</code> and <code>#,</code> and <code>#,@</code> which are implemented by translating them to uses of <code>with-syntax</code>.</p>\n\n<p> Note that the last example uses the lexical context of the whole form for the new identifier, but that&rsquo;s not only the option. You could use any other part of the macro input — for example, you could use the macro keyword:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">define-syntax</span> <span class=\"p\">(</span><span class=\"n\">while</span> <span class=\"n\">stx</span><span class=\"p\">)</span>\n<span class=\"p\">(</span><span class=\"k\">syntax-case</span> <span class=\"n\">stx</span> <span class=\"p\">()</span>\n  <span class=\"p\">[(</span><span class=\"n\">hd</span> <span class=\"n\">test</span> <span class=\"n\">body</span> <span class=\"k\">...</span><span class=\"p\">)</span> <span class=\"c1\">; need the head now</span>\n   <span class=\"p\">(</span><span class=\"k\">with-syntax</span> <span class=\"p\">([</span><span class=\"n\">it</span> <span class=\"p\">(</span><span class=\"nb\">datum-&gt;syntax</span> <span class=\"o\">#&#39;</span><span class=\"n\">hd</span> <span class=\"o\">&#39;</span><span class=\"ss\">it</span><span class=\"p\">)])</span>\n     <span class=\"k\">...</span> <span class=\"n\">same</span> <span class=\"k\">...</span><span class=\"p\">)]))</span>\n</pre></div>\n\n</div>\n\n<p> or the test expression (use <code>#'test</code>). Each of these choices has subtle differences that are especially important when you&rsquo;re composing macros (for example, using a second macro that <em>expands</em> to a <code>while</code>, where the test expression comes from that macro rather than the user code). Demonstrating these things is a popular way to pass the time in some circles, but I&rsquo;ll avoid it here. In fact, a great way to avoid this whole thing altogether is not create unhygienic bindings in the first place. It sounds like doing so excludes cases where you <em>really</em> want to have a new binding visible in user code, but Racket provides “syntax parameters” that can be used more conveniently (and less confusingly) — see <a href=\"../../2008/02/dirty-looking-hygiene.html\">an earlier post</a> for a description of that. As a side note, these options are a good hint that a hygienic macro system is more expressive than a symbolic <code>defmacro</code> system, where no such choices exist. Creating such macros using <code>defmacro</code> can appear easier simply because of this lack of choice — in the same way that CPP-style string-based macros are “simpler” than <code>defmacro</code> since they&rsquo;re less expressive (just appending lexical tokens, no structural information).</p>\n\n<p> There are other important aspects of the Racket macro system that are not covered here. The most obvious of them is worth mentioning here: Racket separates the “runtime phase” from the “syntax phase”. For example, if you want to try these examples with “<code>#lang racket/base</code>”, you&rsquo;ll need to add <code>(require (for-syntax racket/base))</code> since the <code>racket/base</code> language doesn&rsquo;t have a full language in its syntax phase.</p>\n\n<p> Roughly speaking, this makes sure that source code is deterministically compilable by having each level live in its own world, limiting macros to deal only with the input syntax only and not runtime values. (For example, a CLOS implementation in this system cannot check the value of an identifier bound to a class to determine how some macro should expand.) This results in reliable compilations that do not depend on how things were loaded, or whatever happened on the REPL.</p>\n\n<p> The important bottom line here is that you get to write macros with the full language available — and phase separation means that Racket is explicitly designed to make running code at the macro level and using it by the compiler as robust as possible, so you don&rsquo;t have to worry about using any complex system as part of your macro. You just need to keep in mind that the macro world is completely separate from the runtime, and the direct benefit of not worrying about weird interactions with compilation and file loading orders.</p>") #f (u . "\n<p><em>posted by Eli Barzilay</em></p>\n\n<p>Disclaimer: This is not really a tutorial on macros, it&rsquo;s more of a quick introduction to using Racket&rsquo;s <code>syntax-case</code>-based macros for people who are familiar with symbolic macros and miss their “simplicity”. It&rsquo;s also not comprehensive or thorough or complete, it&rsquo;s just intended to provide a rough quick overview of how to write macros. It was originally posted on comp.lang.scheme in a thread called “Idiot&rsquo;s guide to Scheme macros”, but I avoided that title here, since it&rsquo;s not a general purpose guide. (Also, it&rsquo;s yet another attempt to dispel the irrational “macrophobia” some people have when it gets to hygienic macros, leading them back to using <code>defmacro</code> with all its problems.)</p>\n\n<p>The main idea with Racket&rsquo;s macro system (and with other <code>syntax-case</code> systems) is that macros are syntax-to-syntax functions, just like the case of <code>defmacro</code>, except that instead of raw S-expressions you&rsquo;re dealing with syntax objects. This becomes very noticeable when identifiers are handled: instead of dealing with plain symbols, you&rsquo;re dealing with these syntax values (called “identifiers” in this case) that are essentially a symbol and <em>some opaque information</em> that represents the lexical scope for its source. In several <code>syntax-case</code> systems this is the only difference from <code>defmacro</code> macros, but in the Racket case this applies to everything — identifiers, numbers, other immediate constants, and even function applications, etc — they are all the same S-expression values that you&rsquo;re used to, except wrapped with additional information. Another thing that is unique to Racket is the extra information: in addition to the opaque lexical context, there is also source information and arbitrary properties (there are also certificates, but that&rsquo;s ignorable for this text).</p>\n\n<p>With this in mind, explaining the rest is not too difficult:</p>\n\n<ul>\n <li>\n  <p><code>(syntax-source stx)</code>, <code>(syntax-position stx)</code>, <code>(syntax-line stx)</code>, <code>(syntax-column stx)</code> — retrieve parts of the source location information.</p></li>\n <li>\n  <p><code>(syntax-e stx)</code> — takes a syntax value and returns the value it “wraps”. For example, if <code>stx</code> is an identifier you&rsquo;d get a symbol, and if it&rsquo;s a number you&rsquo;d get the number. If it&rsquo;s a simple parenthesized form, you&rsquo;d get a list of syntax values for the subforms. Note that the list can be improper, with the last element being a syntax object that contains a proper list. (But the list will actually be improper if the original syntax was a dotted list.)</p></li>\n <li>\n  <p><code>(syntax-&gt;datum stx)</code> — takes a syntax value and returns the plain S-expression that it holds. This is done by recursive uses of <code>syntax-e</code>. (It would be a simple definition that does what you&rsquo;d think it should do.)</p></li>\n <li>\n  <p><code>(syntax-&gt;list stx)</code> — sometimes you want to pull out the list of syntax values from a given parenthesized syntax, but <code>syntax-e</code> does too little (can still return an improper list) and <code>syntax-&gt;datum</code> does too much (gives you back raw S-expressions). <code>syntax-&gt;list</code> is a utility function that uses <code>syntax-e</code> as many times as needed to get back a proper list of syntax values. If that&rsquo;s not possible (if the input syntax was not a proper list), it returns <code>#f</code>, so it serves as a predicate too.</p></li>\n <li>\n  <p><code>(syntax-property stx prop)</code> — returns the given property value from stx, if any, and <code>#f</code> if none. For example, try</p></li></ul>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"nb\">syntax-property</span> <span class=\"o\">#&#39;</span><span class=\"p\">[</span><span class=\"n\">foo</span><span class=\"p\">]</span> <span class=\"o\">&#39;</span><span class=\"ss\">paren-shape</span><span class=\"p\">)</span>\n</pre></div>\n\n</div>\n\n<p>(The <code>#'</code> is similar to a quote, but for syntax values — I&rsquo;ll get to that later on.)</p>\n\n<ul>\n <li>\n  <p>Note that there is <em>no</em> accessor for the opaque lexical scope, and as you&rsquo;ll see next, you don&rsquo;t need one.</p></li>\n <li>\n  <p>To create a piece of syntax you use <code>datum-&gt;syntax</code>, and you give it an S-expression which will be the “contents” of the resulting syntax object. (The input can contain syntax values, which are left as is.) But when you do that you need to give it the other bits — including the lexical context thing, which you have no access to. The way that&rsquo;s done is:</p></li></ul>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"nb\">datum-&gt;syntax</span> <span class=\"n\">context-stx</span> <span class=\"n\">input-sexpr</span><span class=\"p\">)</span> \n</pre></div>\n\n</div>\n\n<p>This returns a syntax value that wraps the <code>input-sexpr</code> value, using the lexical scope from <code>context-stx</code>. A common way to “break hygiene” and create a binding that is visible to the macro user&rsquo;s code is:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"nb\">datum-&gt;syntax</span> <span class=\"n\">stx</span> <span class=\"o\">&#39;</span><span class=\"ss\">foo</span><span class=\"p\">)</span>\n</pre></div>\n\n</div>\n\n<p>where <code>stx</code> is some syntax value that you get from the user input to the macro. It returns a <code>foo</code> identifier that has the same lexical context information as <code>stx</code>, so it&rsquo;s as if it came from there.</p>\n\n<p>Note that there is actually another optional argument that specifies the source (either using another syntax object, or as an explicit list), and another for copying the properties from — so an alternative to the above would be:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"nb\">datum-&gt;syntax</span> <span class=\"n\">stx</span> <span class=\"o\">&#39;</span><span class=\"ss\">foo</span> <span class=\"n\">stx</span> <span class=\"n\">stx</span><span class=\"p\">)</span>\n</pre></div>\n\n</div>\n\n<p>which also makes the source information and the properties be the same as those of <code>stx</code> (for example, this can matter in case of syntax errors).</p>\n\n<ul>\n <li>\n  <p>There is also <code>(quote-syntax blah)</code> which creates a quoted syntax, with its lexical source from the place it appears.</p></li>\n <li>\n  <p>Finally, <code>define-syntax</code> does the magic of tying a name with a transformer function.</p></li></ul>\n\n<p>And that&rsquo;s almost everything that you need in order to write hygienic (and non-hygienic) macros. Very inconveniently.</p>\n\n<p>For example, here&rsquo;s a simple <code>while</code> macro (use this in a file that starts with <code>#lang racket</code>):</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">define-syntax</span> <span class=\"p\">(</span><span class=\"n\">while</span> <span class=\"n\">stx</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"n\">subs</span> <span class=\"p\">(</span><span class=\"nb\">syntax-&gt;list</span> <span class=\"n\">stx</span><span class=\"p\">))</span>\n  <span class=\"p\">(</span><span class=\"nb\">datum-&gt;syntax</span>\n   <span class=\"n\">stx</span>\n   <span class=\"o\">`</span><span class=\"p\">(</span><span class=\"ss\">let</span> <span class=\"ss\">loop</span> <span class=\"p\">()</span>\n      <span class=\"p\">(</span><span class=\"ss\">when</span> <span class=\"o\">,</span><span class=\"p\">(</span><span class=\"nb\">cadr</span> <span class=\"n\">subs</span><span class=\"p\">)</span>\n        <span class=\"o\">,@</span><span class=\"p\">(</span><span class=\"nb\">cddr</span> <span class=\"n\">subs</span><span class=\"p\">)</span>\n        <span class=\"p\">(</span><span class=\"ss\">loop</span><span class=\"p\">)))</span>\n   <span class=\"n\">stx</span><span class=\"p\">))</span>\n</pre></div>\n\n</div>\n\n<p>which breaks like this:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"n\">x</span> <span class=\"mi\">2</span><span class=\"p\">)</span>\n<span class=\"p\">(</span><span class=\"k\">let</span> <span class=\"p\">([</span><span class=\"k\">let</span> <span class=\"mi\">5</span><span class=\"p\">])</span>\n  <span class=\"p\">(</span><span class=\"n\">while</span> <span class=\"p\">(</span><span class=\"nb\">&lt;</span> <span class=\"n\">x</span> <span class=\"mi\">10</span><span class=\"p\">)</span>\n    <span class=\"p\">(</span><span class=\"nb\">printf</span> <span class=\"s2\">\"x = ~s</span><span class=\"se\">\\n</span><span class=\"s2\">\"</span> <span class=\"n\">x</span><span class=\"p\">)</span>\n    <span class=\"p\">(</span><span class=\"k\">set!</span> <span class=\"n\">x</span> <span class=\"p\">(</span><span class=\"nb\">add1</span> <span class=\"n\">x</span><span class=\"p\">))))</span>\n</pre></div>\n\n</div>\n\n<p>The problem is that all of those quoted names are getting the context of the user input, which is not the right thing (it&rsquo;s close to a <code>defmacro</code>). To fix this, you need to <code>quote-syntax</code> all of these identifiers, so they&rsquo;ll have the macro source instead of the input source:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">define-syntax</span> <span class=\"p\">(</span><span class=\"n\">while</span> <span class=\"n\">stx</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"n\">subs</span> <span class=\"p\">(</span><span class=\"nb\">syntax-&gt;list</span> <span class=\"n\">stx</span><span class=\"p\">))</span>\n  <span class=\"p\">(</span><span class=\"nb\">datum-&gt;syntax</span>\n   <span class=\"n\">stx</span>\n   <span class=\"o\">`</span><span class=\"p\">(</span><span class=\"o\">,</span><span class=\"p\">(</span><span class=\"k\">quote-syntax</span> <span class=\"k\">let</span><span class=\"p\">)</span> <span class=\"o\">,</span><span class=\"p\">(</span><span class=\"k\">quote-syntax</span> <span class=\"n\">loop</span><span class=\"p\">)</span> <span class=\"p\">()</span>\n     <span class=\"p\">(</span><span class=\"o\">,</span><span class=\"p\">(</span><span class=\"k\">quote-syntax</span> <span class=\"k\">when</span><span class=\"p\">)</span> <span class=\"o\">,</span><span class=\"p\">(</span><span class=\"nb\">cadr</span> <span class=\"n\">subs</span><span class=\"p\">)</span>\n      <span class=\"o\">,@</span><span class=\"p\">(</span><span class=\"nb\">cddr</span> <span class=\"n\">subs</span><span class=\"p\">)</span>\n      <span class=\"p\">(</span><span class=\"o\">,</span><span class=\"p\">(</span><span class=\"k\">quote-syntax</span> <span class=\"n\">loop</span><span class=\"p\">))))</span>\n   <span class=\"n\">stx</span><span class=\"p\">))</span>\n</pre></div>\n\n</div>\n\n<p>But that&rsquo;s clearly insane&hellip; More than being tedious, it&rsquo;s still incorrect since all of those function application parens will have the user&rsquo;s lexical context (Racket has a special implicit <code>#%app</code> macro that gets used in all function applications, and in this case the context of this application will make it unhygienic). Instead of doing this, a better approach would be to create the resulting syntax with the lexical context of the macro source by changing just that argument:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">define-syntax</span> <span class=\"p\">(</span><span class=\"n\">while</span> <span class=\"n\">stx</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"n\">subs</span> <span class=\"p\">(</span><span class=\"nb\">syntax-&gt;list</span> <span class=\"n\">stx</span><span class=\"p\">))</span>\n  <span class=\"p\">(</span><span class=\"nb\">datum-&gt;syntax</span>\n   <span class=\"p\">(</span><span class=\"k\">quote-syntax</span> <span class=\"n\">here</span><span class=\"p\">)</span>\n   <span class=\"o\">`</span><span class=\"p\">(</span><span class=\"ss\">let</span> <span class=\"ss\">loop</span> <span class=\"p\">()</span>\n      <span class=\"p\">(</span><span class=\"ss\">when</span> <span class=\"o\">,</span><span class=\"p\">(</span><span class=\"nb\">cadr</span> <span class=\"n\">subs</span><span class=\"p\">)</span>\n        <span class=\"o\">,@</span><span class=\"p\">(</span><span class=\"nb\">cddr</span> <span class=\"n\">subs</span><span class=\"p\">)</span>\n        <span class=\"p\">(</span><span class=\"ss\">loop</span><span class=\"p\">)))</span>\n   <span class=\"n\">stx</span><span class=\"p\">))</span>\n</pre></div>\n\n</div>\n\n<p>And that&rsquo;s simple again, and works fine now.</p>\n\n<p>The problem is that it&rsquo;s tedious wrt to deconstructing the input (which happens to be trivial in this case), and wrt slapping together an output value — and that&rsquo;s where <code>syntax-case</code> comes in. It addresses the both by using pattern matching, where identifiers in patterns are bound as “syntax patterns”. A new form is added — <code>syntax</code> — which is similar to a <code>quote</code>, except that (a) it actually quotes things similarly to <code>quote-syntax</code>, with the lexical context of the <code>syntax</code> form; and (b) pattern variables are substituted with what they matched. With this, the above macro becomes much easier:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">define-syntax</span> <span class=\"p\">(</span><span class=\"n\">while</span> <span class=\"n\">stx</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"k\">syntax-case</span> <span class=\"n\">stx</span> <span class=\"p\">()</span>\n    <span class=\"p\">[(</span><span class=\"k\">_</span> <span class=\"n\">test</span> <span class=\"n\">body</span> <span class=\"k\">...</span><span class=\"p\">)</span>\n     <span class=\"p\">(</span><span class=\"k\">syntax</span> <span class=\"p\">(</span><span class=\"k\">let</span> <span class=\"n\">loop</span> <span class=\"p\">()</span>\n               <span class=\"p\">(</span><span class=\"k\">when</span> <span class=\"n\">test</span>\n                 <span class=\"n\">body</span> <span class=\"k\">...</span>\n                 <span class=\"p\">(</span><span class=\"n\">loop</span><span class=\"p\">))))]))</span>\n</pre></div>\n\n</div>\n\n<p>The first line specifies that you want to match the <code>stx</code> input syntax, and that you have no “keywords” (in the same sense as in <code>syntax-rules</code>). The second line is the pattern that is matched against this input — with two pattern variables that match the second subexpression and the sequence of expressions from the third and on. (The first subexpression is matched against <code>_</code> which is a wild-card that matches anything without binding a pattern variable — the head part is often not needed, since it&rsquo;s just the macro name.) The last line is the output, specified using <code>syntax</code>, which means that it&rsquo;s very similar to the previous version where everything is given the lexical context of the macro and the two pattern variables are replaced with the two matches (so <code>body</code> gets spliced into the resulting syntax).</p>\n\n<p>Now, say that you want an unhygienic user-visible piece of syntax. For example, bind the always entertaining <code>it</code> thing to the test result. This:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">define-syntax</span> <span class=\"p\">(</span><span class=\"n\">while</span> <span class=\"n\">stx</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"k\">syntax-case</span> <span class=\"n\">stx</span> <span class=\"p\">()</span>\n    <span class=\"p\">[(</span><span class=\"k\">_</span> <span class=\"n\">test</span> <span class=\"n\">body</span> <span class=\"k\">...</span><span class=\"p\">)</span>\n     <span class=\"p\">(</span><span class=\"k\">syntax</span> <span class=\"p\">(</span><span class=\"k\">let</span> <span class=\"n\">loop</span> <span class=\"p\">()</span>\n               <span class=\"p\">(</span><span class=\"k\">let</span> <span class=\"p\">([</span><span class=\"n\">it</span> <span class=\"n\">test</span><span class=\"p\">])</span>\n                 <span class=\"p\">(</span><span class=\"k\">when</span> <span class=\"n\">it</span>\n                   <span class=\"n\">body</span> <span class=\"k\">...</span>\n                   <span class=\"p\">(</span><span class=\"n\">loop</span><span class=\"p\">)))))]))</span>\n</pre></div>\n\n</div>\n\n<p>won&rsquo;t work because <code>it</code> has the macro source — it&rsquo;s hygienic and therefore not visible. Instead, you need to use <code>datum-&gt;syntax</code> with the user syntax:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">define-syntax</span> <span class=\"p\">(</span><span class=\"n\">while</span> <span class=\"n\">stx</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"k\">syntax-case</span> <span class=\"n\">stx</span> <span class=\"p\">()</span>\n    <span class=\"p\">[(</span><span class=\"k\">_</span> <span class=\"n\">test</span> <span class=\"n\">body</span> <span class=\"k\">...</span><span class=\"p\">)</span>\n     <span class=\"p\">(</span><span class=\"k\">let</span> <span class=\"p\">([</span><span class=\"n\">it</span> <span class=\"p\">(</span><span class=\"nb\">datum-&gt;syntax</span> <span class=\"n\">stx</span> <span class=\"o\">&#39;</span><span class=\"ss\">it</span><span class=\"p\">)])</span>\n       <span class=\"p\">(</span><span class=\"k\">syntax</span> <span class=\"p\">(</span><span class=\"k\">let</span> <span class=\"n\">loop</span> <span class=\"p\">()</span>\n                 <span class=\"p\">(</span><span class=\"k\">let</span> <span class=\"p\">([</span><span class=\"n\">it</span> <span class=\"n\">test</span><span class=\"p\">])</span>\n                   <span class=\"p\">(</span><span class=\"k\">when</span> <span class=\"n\">it</span>\n                     <span class=\"n\">body</span> <span class=\"k\">...</span>\n                     <span class=\"p\">(</span><span class=\"n\">loop</span><span class=\"p\">))))))]))</span>\n</pre></div>\n\n</div>\n\n<p>But this doesn&rsquo;t really work since <code>it</code> needs to be bound as a pattern variable rather than a plain binding. <code>syntax-case</code> can be used here again: <code>(syntax-case &lt;name&gt; () [foo &lt;body&gt;])</code> will match <code>foo</code> against the <code>&lt;name&gt;</code> syntax, and if it&rsquo;s a name then it will be bound as a pattern variable in the <code>&lt;body&gt;</code>.</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">define-syntax</span> <span class=\"p\">(</span><span class=\"n\">while</span> <span class=\"n\">stx</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"k\">syntax-case</span> <span class=\"n\">stx</span> <span class=\"p\">()</span>\n    <span class=\"p\">[(</span><span class=\"k\">_</span> <span class=\"n\">test</span> <span class=\"n\">body</span> <span class=\"k\">...</span><span class=\"p\">)</span>\n     <span class=\"p\">(</span><span class=\"k\">syntax-case</span> <span class=\"p\">(</span><span class=\"nb\">datum-&gt;syntax</span> <span class=\"n\">stx</span> <span class=\"o\">&#39;</span><span class=\"ss\">it</span><span class=\"p\">)</span> <span class=\"p\">()</span>\n       <span class=\"p\">[</span><span class=\"n\">it</span> <span class=\"p\">(</span><span class=\"k\">syntax</span> <span class=\"p\">(</span><span class=\"k\">let</span> <span class=\"n\">loop</span> <span class=\"p\">()</span>\n                     <span class=\"p\">(</span><span class=\"k\">let</span> <span class=\"p\">([</span><span class=\"n\">it</span> <span class=\"n\">test</span><span class=\"p\">])</span>\n                       <span class=\"p\">(</span><span class=\"k\">when</span> <span class=\"n\">it</span>\n                         <span class=\"n\">body</span> <span class=\"k\">...</span>\n                         <span class=\"p\">(</span><span class=\"n\">loop</span><span class=\"p\">)))))])]))</span>\n</pre></div>\n\n</div>\n\n<p>Note that since <code>it</code> is a pattern variable, it doesn&rsquo;t need to be unquoted — <code>syntax</code> will do that.</p>\n\n<p>Finally, there are some more conveniences. First, <code>with-syntax</code> is a macro that binds pattern variables (by a similar translation to <code>syntax-case</code>):</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">define-syntax</span> <span class=\"p\">(</span><span class=\"n\">while</span> <span class=\"n\">stx</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"k\">syntax-case</span> <span class=\"n\">stx</span> <span class=\"p\">()</span>\n    <span class=\"p\">[(</span><span class=\"k\">_</span> <span class=\"n\">test</span> <span class=\"n\">body</span> <span class=\"k\">...</span><span class=\"p\">)</span>\n     <span class=\"p\">(</span><span class=\"k\">with-syntax</span> <span class=\"p\">([</span><span class=\"n\">it</span> <span class=\"p\">(</span><span class=\"nb\">datum-&gt;syntax</span> <span class=\"n\">stx</span> <span class=\"o\">&#39;</span><span class=\"ss\">it</span><span class=\"p\">)])</span>\n       <span class=\"p\">(</span><span class=\"k\">syntax</span> <span class=\"p\">(</span><span class=\"k\">let</span> <span class=\"n\">loop</span> <span class=\"p\">()</span>\n                 <span class=\"p\">(</span><span class=\"k\">let</span> <span class=\"p\">([</span><span class=\"n\">it</span> <span class=\"n\">test</span><span class=\"p\">])</span>\n                   <span class=\"p\">(</span><span class=\"k\">when</span> <span class=\"n\">it</span>\n                     <span class=\"n\">body</span> <span class=\"k\">...</span>\n                     <span class=\"p\">(</span><span class=\"n\">loop</span><span class=\"p\">))))))]))</span>\n</pre></div>\n\n</div>\n\n<p>and there&rsquo;s the <code>#'</code> reader macro for <code>syntax</code>:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">define-syntax</span> <span class=\"p\">(</span><span class=\"n\">while</span> <span class=\"n\">stx</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"k\">syntax-case</span> <span class=\"n\">stx</span> <span class=\"p\">()</span>\n    <span class=\"p\">[(</span><span class=\"k\">_</span> <span class=\"n\">test</span> <span class=\"n\">body</span> <span class=\"k\">...</span><span class=\"p\">)</span>\n     <span class=\"p\">(</span><span class=\"k\">with-syntax</span> <span class=\"p\">([</span><span class=\"n\">it</span> <span class=\"p\">(</span><span class=\"nb\">datum-&gt;syntax</span> <span class=\"n\">stx</span> <span class=\"o\">&#39;</span><span class=\"ss\">it</span><span class=\"p\">)])</span>\n       <span class=\"o\">#&#39;</span><span class=\"p\">(</span><span class=\"k\">let</span> <span class=\"n\">loop</span> <span class=\"p\">()</span>\n           <span class=\"p\">(</span><span class=\"k\">let</span> <span class=\"p\">([</span><span class=\"n\">it</span> <span class=\"n\">test</span><span class=\"p\">])</span>\n             <span class=\"p\">(</span><span class=\"k\">when</span> <span class=\"n\">it</span>\n               <span class=\"n\">body</span> <span class=\"k\">...</span>\n               <span class=\"p\">(</span><span class=\"n\">loop</span><span class=\"p\">)))))]))</span>\n</pre></div>\n\n</div>\n\n<p> and there are also <code>#`</code> and <code>#,</code> and <code>#,@</code> which are implemented by translating them to uses of <code>with-syntax</code>.</p>\n\n<p> Note that the last example uses the lexical context of the whole form for the new identifier, but that&rsquo;s not only the option. You could use any other part of the macro input — for example, you could use the macro keyword:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">define-syntax</span> <span class=\"p\">(</span><span class=\"n\">while</span> <span class=\"n\">stx</span><span class=\"p\">)</span>\n<span class=\"p\">(</span><span class=\"k\">syntax-case</span> <span class=\"n\">stx</span> <span class=\"p\">()</span>\n  <span class=\"p\">[(</span><span class=\"n\">hd</span> <span class=\"n\">test</span> <span class=\"n\">body</span> <span class=\"k\">...</span><span class=\"p\">)</span> <span class=\"c1\">; need the head now</span>\n   <span class=\"p\">(</span><span class=\"k\">with-syntax</span> <span class=\"p\">([</span><span class=\"n\">it</span> <span class=\"p\">(</span><span class=\"nb\">datum-&gt;syntax</span> <span class=\"o\">#&#39;</span><span class=\"n\">hd</span> <span class=\"o\">&#39;</span><span class=\"ss\">it</span><span class=\"p\">)])</span>\n     <span class=\"k\">...</span> <span class=\"n\">same</span> <span class=\"k\">...</span><span class=\"p\">)]))</span>\n</pre></div>\n\n</div>\n\n<p> or the test expression (use <code>#'test</code>). Each of these choices has subtle differences that are especially important when you&rsquo;re composing macros (for example, using a second macro that <em>expands</em> to a <code>while</code>, where the test expression comes from that macro rather than the user code). Demonstrating these things is a popular way to pass the time in some circles, but I&rsquo;ll avoid it here. In fact, a great way to avoid this whole thing altogether is not create unhygienic bindings in the first place. It sounds like doing so excludes cases where you <em>really</em> want to have a new binding visible in user code, but Racket provides “syntax parameters” that can be used more conveniently (and less confusingly) — see <a href=\"../../2008/02/dirty-looking-hygiene.html\">an earlier post</a> for a description of that. As a side note, these options are a good hint that a hygienic macro system is more expressive than a symbolic <code>defmacro</code> system, where no such choices exist. Creating such macros using <code>defmacro</code> can appear easier simply because of this lack of choice — in the same way that CPP-style string-based macros are “simpler” than <code>defmacro</code> since they&rsquo;re less expressive (just appending lexical tokens, no structural information).</p>\n\n<p> There are other important aspects of the Racket macro system that are not covered here. The most obvious of them is worth mentioning here: Racket separates the “runtime phase” from the “syntax phase”. For example, if you want to try these examples with “<code>#lang racket/base</code>”, you&rsquo;ll need to add <code>(require (for-syntax racket/base))</code> since the <code>racket/base</code> language doesn&rsquo;t have a full language in its syntax phase.</p>\n\n<p> Roughly speaking, this makes sure that source code is deterministically compilable by having each level live in its own world, limiting macros to deal only with the input syntax only and not runtime values. (For example, a CLOS implementation in this system cannot check the value of an identifier bound to a class to determine how some macro should expand.) This results in reliable compilations that do not depend on how things were loaded, or whatever happened on the REPL.</p>\n\n<p> The important bottom line here is that you get to write macros with the full language available — and phase separation means that Racket is explicitly designed to make running code at the macro level and using it by the compiler as robust as possible, so you don&rsquo;t have to worry about using any complex system as part of your macro. You just need to keep in mind that the macro world is completely separate from the runtime, and the direct benefit of not worrying about weird interactions with compilation and file loading orders.</p>")) ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2008-11-21-plt-scheme-v413.md" . unix) f post (u . "PLT Scheme v4.1.3") (? . 110) 1467223812 (p+ #"/Users/MB/git/racket-lang-org/blog/2008/11/plt-scheme-v413.html" . unix) "/2008/11/plt-scheme-v413.html" (u . "2008-11-21T11:04:00.001-05:00") (? . 117) (? . 109) (c (u . "")) (u . "\n<p><em>posted by Eli Barzilay</em></p>\n\n<p>PLT Scheme version 4.1.3 is now available from  <a href=\"http://plt-scheme.org/\">http://plt-scheme.org/</a> This is a bug-fix release.</p>\n\n<p>Notable changes:</p>\n\n<ul>\n <li>Web Server:</li>\n <li>Documentation rewritten to separate servlet APIs and server extension APIs</li>\n <li>HTTPS supported on the &ldquo;plt-web-server&rdquo; command-line with \"&mdash;ssl\" option</li>\n <li>Stateless servlets supported in default configuration through &rsquo;stateless interface-version</li>\n <li>`web-server/servlet-env&rsquo; supports top-level servlets through #:servlet-path</li>\n <li>Servlets are served from anywhere in the htdocs directory by default</li>\n <li>A template system based on the Scribble syntax has been added, see web-server/templates in the documentationAnd many other internal modifications to make extension easier!</li></ul>\n\n<p>[Note that mirror sites can take a while to catch up with the new downloads.]</p>\n\n<p>Feedback Welcome.</p>") #t (u . "\n<p><em>posted by Eli Barzilay</em></p>\n\n<p>PLT Scheme version 4.1.3 is now available from  <a href=\"http://plt-scheme.org/\">http://plt-scheme.org/</a> This is a bug-fix release.</p>\n\n<p>Notable changes:</p>\n\n<ul>\n <li>Web Server:</li>\n <li>Documentation rewritten to separate servlet APIs and server extension APIs</li>\n <li>HTTPS supported on the &ldquo;plt-web-server&rdquo; command-line with \"&mdash;ssl\" option</li>\n <li>Stateless servlets supported in default configuration through &rsquo;stateless interface-version</li>\n <li>`web-server/servlet-env&rsquo; supports top-level servlets through #:servlet-path</li>\n <li>Servlets are served from anywhere in the htdocs directory by default</li>\n <li>A template system based on the Scribble syntax has been added, see web-server/templates in the documentationAnd many other internal modifications to make extension easier!</li></ul>\n\n<p>[Note that mirror sites can take a while to catch up with the new downloads.]</p>\n\n<p>Feedback Welcome.</p>\n<!-- more-->\n\n<hr />\n\n<p>Very usefull, i will use this&hellip; But i&rsquo;m searching in documentation of Dr Scheme a tool to comunicate with paralel port of my computer. Can this possible?</p>\n\n<p>— <em>W4r10, 1 December 2008</em></p>\n\n<hr />\n\n<p>Which operating system?</p>\n\n<p>— <em>Jens Axel Søgaard, 1 December 2008</em></p>\n\n<hr />")) ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2010-02-28-dags-vs-trees.md" . unix) f post (u . "DAGs vs Trees") (? . 118) 1467223812 (p+ #"/Users/MB/git/racket-lang-org/blog/2010/02/dags-vs-trees.html" . unix) "/2010/02/dags-vs-trees.html" (u . "2010-02-28T20:16:00.006-05:00") (? . 119) (? . 34) (c (u . "")) (u . "\n<p><em>posted by Robby Findler</em></p>\n\n<p>As I wondering whether or not there is a better layout algorithm for the module browser window, I looked into <a href=\"http://www.cs.umd.edu/hcil/treemap-history/\">tree maps</a>. Of course, the modules in a program form a DAG, not a tree, so I wondered just how big the tree would get if all of the shared structure in the DAG were replicated. Hey, I figured, if a tree map can handle showing me my entire filesystem, maybe that could work.</p>\n\n<p>&hellip; yeah, no. Turns out to be hopeless. In the spirit of a geeky take off on a jelly bean counting contest, lets see if you can guess just how big these things get. Consider the module graph from the program <code>#lang scheme</code> (ie, the graph that just contains an empty program). This program loads 170 modules with 917 connections between modules (counting the main file that just contains the <code>#lang scheme</code>).</p>\n\n<p>So, the question: how many nodes are there in the unsharified tree? First one to come within 1 billion of the right answer gets all of the fame and glory that this blog brings to bear (har har). I&rsquo;ll post the answer in the comments in a few days (and no fair cheating, those of you that know enough to be able to get your hands on the DAG).</p>") #t (u . "\n<p><em>posted by Robby Findler</em></p>\n\n<p>As I wondering whether or not there is a better layout algorithm for the module browser window, I looked into <a href=\"http://www.cs.umd.edu/hcil/treemap-history/\">tree maps</a>. Of course, the modules in a program form a DAG, not a tree, so I wondered just how big the tree would get if all of the shared structure in the DAG were replicated. Hey, I figured, if a tree map can handle showing me my entire filesystem, maybe that could work.</p>\n\n<p>&hellip; yeah, no. Turns out to be hopeless. In the spirit of a geeky take off on a jelly bean counting contest, lets see if you can guess just how big these things get. Consider the module graph from the program <code>#lang scheme</code> (ie, the graph that just contains an empty program). This program loads 170 modules with 917 connections between modules (counting the main file that just contains the <code>#lang scheme</code>).</p>\n\n<p>So, the question: how many nodes are there in the unsharified tree? First one to come within 1 billion of the right answer gets all of the fame and glory that this blog brings to bear (har har). I&rsquo;ll post the answer in the comments in a few days (and no fair cheating, those of you that know enough to be able to get your hands on the DAG).</p>\n<!-- more-->\n\n<hr />\n\n<p>Okay, I&rsquo;ll give it a go on the scale you indicate: &hellip; 282 billion? (9^12)</p>\n\n<p>— <em>Kohath, 1 March 2010</em></p>\n\n<hr />\n\n<p>Sadly, not close. Lets make this easier. If you&rsquo;re within a trillion of the correct answer, you win.</p>\n\n<p>— <em>Robby, 2 March 2010</em></p>\n\n<hr />\n\n<p>There are 102,295,446,100,979 nodes. Which is a lot. If we somehow used only a single pixel per node (at the standard 72dpi) that would require a monitor that was more that 2 miles square to display the entire thing.</p>\n\n<p>— <em>Robby, 3 March 2010</em></p>\n\n<hr />")) ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2014-03-12-the-new-racket-home-page.md" . unix) f post (u . "The new Racket home page") (? . 87) 1467223812 (p+ #"/Users/MB/git/racket-lang-org/blog/2014/03/the-new-racket-home-page.html" . unix) "/2014/03/the-new-racket-home-page.html" (u . "2014-03-12T10:09:00.001-04:00") (? . 85) (? . 120) (c (u . "")) (u . "\n<p><em>posted by Asumu Takikawa</em></p>\n\n<p>Racket now has a new look for its web presence. You can see it at<a href=\"http://racket-lang.org/\"> http://racket-lang.org</a> (modulo DNS propagation).</p>\n\n<p>The new pages improve on the old in several ways:</p>\n\n<ul>\n <li>\n  <p>More information is now on the front page.</p></li>\n <li>\n  <p>The site works much better small devices, such as phones.</p></li>\n <li>\n  <p>It&rsquo;s easier to find important parts of the site, like the package directory.</p></li>\n <li>\n  <p>The download process is more streamlined &mdash; now it&rsquo;s only 2 clicks.</p></li></ul>\n\n<p>We also wanted to have a new look, and a description that talks about why Racket is exciting.</p>\n\n<p>Finally, we&rsquo;ve taken this opportunity to shift our web hosting entirely to Amazon S3, for which Greg Hendershott&rsquo;s <a href=\"https://github.com/greghendershott/aws\">aws</a> package has been very helpful.</p>\n\n<p>While the new pages have been under development for quite a while, we&rsquo;re still happy to take bug reports, suggestions and (especially) patches: all of the site can be found here:</p>\n\n<p> <a href=\"https://github.com/plt/racket/tree/master/pkgs/plt-services/meta/new-web\">https://github.com/plt/racket/tree/master/pkgs/plt-services/meta/new-web</a></p>\n\n<p>with the framework for building the site here:</p>\n\n<p> <a href=\"https://github.com/plt/racket/tree/master/pkgs/plt-web-pkgs\">https://github.com/plt/racket/tree/master/pkgs/plt-web-pkgs</a></p>\n\n<p>The site is built using Eli&rsquo;s <a href=\"http://www.cs.utah.edu/plt/snapshots/current/doc/scribble-pp/html.html\">scribble/html</a> library, which is very nice to use.</p>\n\n<p>I&rsquo;d especially like to thank Eli and Matthew for their help with this &mdash; going from my hacked-up HTML prototype to the smooth-building and well-organized code we have now has taken lots of work.</p>\n\n<p>Sam</p>") #f (u . "\n<p><em>posted by Asumu Takikawa</em></p>\n\n<p>Racket now has a new look for its web presence. You can see it at<a href=\"http://racket-lang.org/\"> http://racket-lang.org</a> (modulo DNS propagation).</p>\n\n<p>The new pages improve on the old in several ways:</p>\n\n<ul>\n <li>\n  <p>More information is now on the front page.</p></li>\n <li>\n  <p>The site works much better small devices, such as phones.</p></li>\n <li>\n  <p>It&rsquo;s easier to find important parts of the site, like the package directory.</p></li>\n <li>\n  <p>The download process is more streamlined &mdash; now it&rsquo;s only 2 clicks.</p></li></ul>\n\n<p>We also wanted to have a new look, and a description that talks about why Racket is exciting.</p>\n\n<p>Finally, we&rsquo;ve taken this opportunity to shift our web hosting entirely to Amazon S3, for which Greg Hendershott&rsquo;s <a href=\"https://github.com/greghendershott/aws\">aws</a> package has been very helpful.</p>\n\n<p>While the new pages have been under development for quite a while, we&rsquo;re still happy to take bug reports, suggestions and (especially) patches: all of the site can be found here:</p>\n\n<p> <a href=\"https://github.com/plt/racket/tree/master/pkgs/plt-services/meta/new-web\">https://github.com/plt/racket/tree/master/pkgs/plt-services/meta/new-web</a></p>\n\n<p>with the framework for building the site here:</p>\n\n<p> <a href=\"https://github.com/plt/racket/tree/master/pkgs/plt-web-pkgs\">https://github.com/plt/racket/tree/master/pkgs/plt-web-pkgs</a></p>\n\n<p>The site is built using Eli&rsquo;s <a href=\"http://www.cs.utah.edu/plt/snapshots/current/doc/scribble-pp/html.html\">scribble/html</a> library, which is very nice to use.</p>\n\n<p>I&rsquo;d especially like to thank Eli and Matthew for their help with this &mdash; going from my hacked-up HTML prototype to the smooth-building and well-organized code we have now has taken lots of work.</p>\n\n<p>Sam</p>")) ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2008-10-06-web-application-development-in-plt-scheme.md" . unix) f post (u . "Web Application Development in PLT Scheme") (? . 12) 1467223812 (p+ #"/Users/MB/git/racket-lang-org/blog/2008/10/web-application-development-in-plt-scheme.html" . unix) "/2008/10/web-application-development-in-plt-scheme.html" (u . "2008-10-06T15:33:00.006-04:00") (? . 53) (? . 117) (c (u . "")) (u . "\n<p><em>posted by Jay McCarthy</em></p>\n\n<p>Many users often post to the <code>plt-scheme</code> mailing list asking for introductions to Web application development in PLT Scheme. They&rsquo;ve heard of the continuation-based PLT Web Server and want a gentle introduction. Unfortunately, there has been a distinct lack of good documentation and tutorials for the server. Taking the cue from two users: <a href=\"http://www.scheme.dk/blog/2007/01/introduction-to-web-development-with.html\">Jens Axel Soegaard</a> and <a href=\"http://alwaysmovefast.com/category/plt-scheme/\">David Reynolds</a>, we&rsquo;ve written a tutorial with Danny Yoo.</p>\n\n<p>The tutorial is available at <a href=\"http://docs.plt-scheme.org/continue/index.html\">http://docs.plt-scheme.org/continue/index.html</a>. It walks through the creation of a blog application, introducing features slowly and culminates in an SQL-backed database for the posts. Of particular interest, is the <a href=\"http://docs.plt-scheme.org/web-server/insta.html\">fast start servlet setup</a> based on the Instaservlet package from <a href=\"http://www.untyped.com/\">Untyped</a>.</p>\n\n<p>Please take a look and pass along this as a pointer to those who may be interested in PLT Scheme.</p>") #t (u . "\n<p><em>posted by Jay McCarthy</em></p>\n\n<p>Many users often post to the <code>plt-scheme</code> mailing list asking for introductions to Web application development in PLT Scheme. They&rsquo;ve heard of the continuation-based PLT Web Server and want a gentle introduction. Unfortunately, there has been a distinct lack of good documentation and tutorials for the server. Taking the cue from two users: <a href=\"http://www.scheme.dk/blog/2007/01/introduction-to-web-development-with.html\">Jens Axel Soegaard</a> and <a href=\"http://alwaysmovefast.com/category/plt-scheme/\">David Reynolds</a>, we&rsquo;ve written a tutorial with Danny Yoo.</p>\n\n<p>The tutorial is available at <a href=\"http://docs.plt-scheme.org/continue/index.html\">http://docs.plt-scheme.org/continue/index.html</a>. It walks through the creation of a blog application, introducing features slowly and culminates in an SQL-backed database for the posts. Of particular interest, is the <a href=\"http://docs.plt-scheme.org/web-server/insta.html\">fast start servlet setup</a> based on the Instaservlet package from <a href=\"http://www.untyped.com/\">Untyped</a>.</p>\n\n<p>Please take a look and pass along this as a pointer to those who may be interested in PLT Scheme.</p>\n<!-- more-->\n\n<hr />\n\n<p>Hi. Just trying to find simply-scheme.ss teachpack for DrScheme&hellip;.was hoping you could point me in the right direction. Thanks.</p>\n\n<p>— <em>Jerome, 17 October 2008</em></p>\n\n<hr />\n\n<p>If it is what I&rsquo;m thinking, then you can get it at PLaneT. Search for it or its author, Danny Yoo (dyoo).</p>\n\n<p>— <em>Jay McCarthy, 17 October 2008</em></p>\n\n<hr />")) ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2009-02-24-call-for-participation-writing-typed-scheme-wrapper-modules.md" . unix) f post (u . "Call for Participation: Writing Typed Scheme wrapper modules") (? . 69) 1467223812 (p+ #"/Users/MB/git/racket-lang-org/blog/2009/02/call-for-participation-writing-typed-scheme-wrapper-modules.html" . unix) "/2009/02/call-for-participation-writing-typed-scheme-wrapper-modules.html" (u . "2009-02-24T16:06:00.004-05:00") (? . 61) (? . 68) (c (u . "")) (u . "\n<p><em>posted by Sam Tobin-Hochstadt</em></p>\n\n<p>Typed Scheme is a language for writing PLT Scheme programs that are statically checked for type errors. Right now, Typed Scheme handles a large portion of the PLT Scheme language. However, to use Typed Scheme effectively, we need libraries that work with it. For this task, we&rsquo;re looking for help.</p>\n\n<p>We&rsquo;d like volunteers for writing wrapper modules that adapt untyped libraries to Typed Scheme. This task is very easy for the smallest libraries, but can be much more complicated for larger, complex libraries.</p>\n\n<p>There&rsquo;s a preliminary guide for conversion <a href=\"http://www.ccs.neu.edu/home/samth/adapt/\">here</a> and a list of modules to adapt, and their current status is available <a href=\"http://www.ccs.neu.edu/home/samth/adapt/Current_Status.html\">here</a>.</p>\n\n<p>Questions about this project, and about developing with Typed Scheme in general, can be asked on <a href=\"mailto:plt-dev@list.cs.brown.edu\">plt-dev@list.cs.brown.edu</a> , and questions or comments can be sent directly to me.</p>\n\n<p>We hope to continue making Typed Scheme into a useful tool for PLT Scheme programmers.</p>\n\n<p>Thanks,</p>\n\n<p>Sam, Stevie, and Matthias</p>") #f (u . "\n<p><em>posted by Sam Tobin-Hochstadt</em></p>\n\n<p>Typed Scheme is a language for writing PLT Scheme programs that are statically checked for type errors. Right now, Typed Scheme handles a large portion of the PLT Scheme language. However, to use Typed Scheme effectively, we need libraries that work with it. For this task, we&rsquo;re looking for help.</p>\n\n<p>We&rsquo;d like volunteers for writing wrapper modules that adapt untyped libraries to Typed Scheme. This task is very easy for the smallest libraries, but can be much more complicated for larger, complex libraries.</p>\n\n<p>There&rsquo;s a preliminary guide for conversion <a href=\"http://www.ccs.neu.edu/home/samth/adapt/\">here</a> and a list of modules to adapt, and their current status is available <a href=\"http://www.ccs.neu.edu/home/samth/adapt/Current_Status.html\">here</a>.</p>\n\n<p>Questions about this project, and about developing with Typed Scheme in general, can be asked on <a href=\"mailto:plt-dev@list.cs.brown.edu\">plt-dev@list.cs.brown.edu</a> , and questions or comments can be sent directly to me.</p>\n\n<p>We hope to continue making Typed Scheme into a useful tool for PLT Scheme programmers.</p>\n\n<p>Thanks,</p>\n\n<p>Sam, Stevie, and Matthias</p>")) ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2015-08-11-modules-packages-and-collections.md" . unix) f post (u . "Modules, Packages and Collections") (? . 29) 1467223812 (p+ #"/Users/MB/git/racket-lang-org/blog/2015/08/modules-packages-and-collections.html" . unix) "/2015/08/modules-packages-and-collections.html" (u . "2015-08-11T14:33:00.000-04:00") (? . 14) (? . 103) (c (u . "")) (u . "\n<p><em>posted by Vincent St-Amour</em></p>\n\n<p>Racket, the Racket docs and Racketeers use a number of terms to refer to various units of Racket code. Of those, module, package and collection refer to related but distinct concepts. Their exact relations and distinctions can be confusing for new users. This is an attempt at explaining those concepts, what they are for, and how they relate to each other.</p>\n\n<p>To begin with the smallest of the three, a file that begins with #lang and the name of a language is a module. There are also other ways to construct modules, but let&rsquo;s not worry about those.</p>\n\n<p>A module is the basic unit of functionality for Racket code.</p>\n\n<p>Once your Racket programs get larger, though, you&rsquo;ll want to split them over multiple modules. This allows you to organize your source better, enables separate compilation, and makes it possible for you to mix and match modules written in different Racket languages (<a href=\"http://docs.racket-lang.org/guide/index.html\">Racket</a>, <a href=\"http://docs.racket-lang.org/ts-guide/index.html\">Typed Racket</a>, <a href=\"http://docs.racket-lang.org/datalog/index.html\">Datalog</a>, <a href=\"http://docs.racket-lang.org/scribble/index.html\">Scribble</a>, etc.).</p>\n\n<p>That&rsquo;s where packages and collections come in. They help you organize your modules.</p>\n\n<p>A package is an group of modules that you can install together, and that usually provide one piece of functionality. To pick a random example, take the <a href=\"http://pkg-build.racket-lang.org/doc/pict3d/index.html\">pict3d</a> package from <a href=\"http://pkgs.racket-lang.org/\">pkgs.racket-lang.org</a>. That package is a collection of modules which together implement a functional 3D engine. You can install it using raco pkg install pict3d, or via the graphical package manager in DrRacket.</p>\n\n<p>So, to sum up, packages are units of code distribution.</p>\n\n<p>A collection is a group of modules whose functionality is related to the same topic, for example data structures (the data collection), or wrapper libraries for use with Typed Racket (the typed collection). Modules are referred to and required using collection paths. For example, when you require racket/class, you&rsquo;re requiring the class module from the racket collection.</p>\n\n<p>Modules within a collection do not necessarily come from the same package, and may not be developed together. For example, some data structures in the data collection are provided as part of the core of Racket, such as the integer sets in <a href=\"http://docs.racket-lang.org/data/integer-set.html\"><code>data/integer-set</code></a>. Other data structures are provided by additional packages which you may need to install separately, such as the hash-array-mapped tries in <code>data/hamt</code>, which are provided by the <a href=\"http://pkg-build.racket-lang.org/doc/hamt/index.html\"><code>hamt</code></a> package. Having both of those in the data collection signals that they both provide data structures. If you develop your own data structures, putting them in the data collection is probably the right thing to do.</p>\n\n<p>Many packages, however, provide functionality that does not fall under existing categories, and provide their own, new collection. For example, the <code>pict3d</code> package we discussed above puts its modules in the <code>pict3d</code> collection. For that reason, the distinction between package and collection is sometimes a bit blurred.</p>\n\n<p>So, to sum up, collections are units of code classification.</p>\n\n<p>The term library does not have a technical meaning in Racket. We usually use it to refer to a package, or to a set of packages that are developed together. For example, the <a href=\"http://docs.racket-lang.org/rackunit/index.html\">Rackunit</a> library is split across multiple packages: <code>rackunit</code>, <code>rackunit-lib</code>, <code>rackunit-gui</code>, <code>rackunit-plugin-lib</code>, <code>rackunit-doc</code> and <code>rackunit-test</code>. This allows packages to only depend on part of Rackunit. For example, a package for a string-processing library probably should not depend on the <a href=\"http://docs.racket-lang.org/gui/index.html\">Racket GUI library</a> (to be deployed on headless servers, for example), and so should depend on the <code>rackunit-lib</code> package for its testing, instead of on the full <code>rackunit</code> package, which brings in GUI support via the <code>rackunit-gui</code> package, and would introduce a dependency to Racket&rsquo;s GUI library.</p>\n\n<p>Hopefully, this clarifies the Racket code organization terminology a bit.</p>") #t (u . "\n<p><em>posted by Vincent St-Amour</em></p>\n\n<p>Racket, the Racket docs and Racketeers use a number of terms to refer to various units of Racket code. Of those, module, package and collection refer to related but distinct concepts. Their exact relations and distinctions can be confusing for new users. This is an attempt at explaining those concepts, what they are for, and how they relate to each other.</p>\n\n<p>To begin with the smallest of the three, a file that begins with #lang and the name of a language is a module. There are also other ways to construct modules, but let&rsquo;s not worry about those.</p>\n\n<p>A module is the basic unit of functionality for Racket code.</p>\n\n<p>Once your Racket programs get larger, though, you&rsquo;ll want to split them over multiple modules. This allows you to organize your source better, enables separate compilation, and makes it possible for you to mix and match modules written in different Racket languages (<a href=\"http://docs.racket-lang.org/guide/index.html\">Racket</a>, <a href=\"http://docs.racket-lang.org/ts-guide/index.html\">Typed Racket</a>, <a href=\"http://docs.racket-lang.org/datalog/index.html\">Datalog</a>, <a href=\"http://docs.racket-lang.org/scribble/index.html\">Scribble</a>, etc.).</p>\n\n<p>That&rsquo;s where packages and collections come in. They help you organize your modules.</p>\n\n<p>A package is an group of modules that you can install together, and that usually provide one piece of functionality. To pick a random example, take the <a href=\"http://pkg-build.racket-lang.org/doc/pict3d/index.html\">pict3d</a> package from <a href=\"http://pkgs.racket-lang.org/\">pkgs.racket-lang.org</a>. That package is a collection of modules which together implement a functional 3D engine. You can install it using raco pkg install pict3d, or via the graphical package manager in DrRacket.</p>\n\n<p>So, to sum up, packages are units of code distribution.</p>\n\n<p>A collection is a group of modules whose functionality is related to the same topic, for example data structures (the data collection), or wrapper libraries for use with Typed Racket (the typed collection). Modules are referred to and required using collection paths. For example, when you require racket/class, you&rsquo;re requiring the class module from the racket collection.</p>\n\n<p>Modules within a collection do not necessarily come from the same package, and may not be developed together. For example, some data structures in the data collection are provided as part of the core of Racket, such as the integer sets in <a href=\"http://docs.racket-lang.org/data/integer-set.html\"><code>data/integer-set</code></a>. Other data structures are provided by additional packages which you may need to install separately, such as the hash-array-mapped tries in <code>data/hamt</code>, which are provided by the <a href=\"http://pkg-build.racket-lang.org/doc/hamt/index.html\"><code>hamt</code></a> package. Having both of those in the data collection signals that they both provide data structures. If you develop your own data structures, putting them in the data collection is probably the right thing to do.</p>\n\n<p>Many packages, however, provide functionality that does not fall under existing categories, and provide their own, new collection. For example, the <code>pict3d</code> package we discussed above puts its modules in the <code>pict3d</code> collection. For that reason, the distinction between package and collection is sometimes a bit blurred.</p>\n\n<p>So, to sum up, collections are units of code classification.</p>\n\n<p>The term library does not have a technical meaning in Racket. We usually use it to refer to a package, or to a set of packages that are developed together. For example, the <a href=\"http://docs.racket-lang.org/rackunit/index.html\">Rackunit</a> library is split across multiple packages: <code>rackunit</code>, <code>rackunit-lib</code>, <code>rackunit-gui</code>, <code>rackunit-plugin-lib</code>, <code>rackunit-doc</code> and <code>rackunit-test</code>. This allows packages to only depend on part of Rackunit. For example, a package for a string-processing library probably should not depend on the <a href=\"http://docs.racket-lang.org/gui/index.html\">Racket GUI library</a> (to be deployed on headless servers, for example), and so should depend on the <code>rackunit-lib</code> package for its testing, instead of on the full <code>rackunit</code> package, which brings in GUI support via the <code>rackunit-gui</code> package, and would introduce a dependency to Racket&rsquo;s GUI library.</p>\n\n<p>Hopefully, this clarifies the Racket code organization terminology a bit.</p>\n<!-- more-->\n\n<hr />\n\n<p>Why was there no mention of &ldquo;units&rdquo; http://docs.racket-lang.org/reference/mzlib_unit.html ?</p>\n\n<p>— <em>Franklin Chen, 11 August 2015</em></p>\n\n<hr />\n\n<p>Units are also a modularity mechanism, but at a more local level. That is, they&rsquo;re used to organize code at and below the module-level, rather than above the module level, as collections and packages do.</p>\n\n<p>Units, in modern Racket, are also a &ldquo;niche&rdquo; feature, that&rsquo;s useful in very specific situations. In contrast, most Racket programmers writing programs that don&rsquo;t fit in a single file will end up working with packages and collections, whether they realize it or not.</p>\n\n<p>But to say a few words about them, units are first-class module-like values. Unlike Racket modules, they allow recursive linking, which allows for circular dependencies. They also allow dynamic linking, which makes it possible to &ldquo;swap in&rdquo; different implementations of the same signature. Dynamic linking also makes units useful for implementing plug-in systems, like the one in DrRacket, which can dynamically link in new plug-ins.</p>\n\n<p>— <em>Vincent St-Amour, 13 August 2015</em></p>\n\n<hr />\n\n<p>Thanks Vincent for an illuminating post. Regarding units, is it useful to think of modules as units with automatically generated signatures bounded together with the code?</p>\n\n<p>Modules cannot be recursively linked because they are values that are evaluated at compile/run time, while units can be because they can be represented by signature values that can be linked to arbitrary units satisfying the signatures. Is that a reasonable phrasing of the difference between modules and units?</p>\n\n<p>I&rsquo;m curious, what are the disadvantages of organizing code using only units versus using modules?</p>\n\n<p>— <em>Alexander McLin, 14 August 2015</em></p>\n\n<hr />\n\n<p>Alexander,</p>\n\n<p>The main thing modules and units have in common is that they are code containers that import and export names. Beyond that, the two systems are different enough that I don&rsquo;t think trying to understand one in terms of the other is helpful. Modules are static, while units are dynamic. Units are values, whereas modules are not. Modules interact nicely with macros, but units don&rsquo;t.</p>\n\n<p>Some of the disadvantages of using units instead of modules are: * units do not support importing / exporting macros * linking errors happen at run-time instead of compile-time * units are syntactically more heavyweight * the dynamic nature of units prevents some optimizations That said, units are the right tool for some use cases, but modules are what you want most of the time.</p>\n\n<p>Because units predate modules in Racket&rsquo;s history, there&rsquo;s a fair amount of code out there (including in the main distribution) that uses units in places where we&rsquo;d use modules today, e.g., parts of the net collection. That code is doing roughly what you&rsquo;re describing, so you may be interested in looking at the result. :)</p>\n\n<p>— <em>Vincent St-Amour, 16 August 2015</em></p>\n\n<hr />\n\n<p>Thank you Vincent!</p>\n\n<p>— <em>Alexander McLin, 17 August 2015</em></p>\n\n<hr />")) ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2013-03-25-200.md" . unix) f post (u . "200!") (? . 70) 1467223812 (p+ #"/Users/MB/git/racket-lang-org/blog/2013/03/200.html" . unix) "/2013/03/200.html" (u . "2013-03-25T14:00:00.000-04:00") (? . 84) (? . 97) (c (u . "")) (u . "\n<p><em>posted by Asumu Takikawa</em></p>\n\n<p>About a month ago, inspired by a mailing list post by Tim Brown, Racketeers started to write more solutions to <a href=\"http://rosettacode.org/wiki/Rosetta_Code\">Rosetta Code</a> tasks for Racket. Just today, we&rsquo;ve reached 200 entries in the <a href=\"http://rosettacode.org/wiki/Category:Racket\">Racket category</a>!</p>\n\n<p>This is a nice milestone, but we still have a ways to go. At 200 entries, Racket comes in at around 54th in the <a href=\"http://rosettacode.org/wiki/RC_POP.OUT\">popularity</a> rankings. So if you&rsquo;re looking to practice your Racketeering skills, don&rsquo;t hesitate to work on some of the <a href=\"http://rosettacode.org/wiki/Reports:Tasks_not_implemented_in_Racket\">remaining tasks</a>.</p>\n\n<p>To give you a taste of the kinds of solutions we have so far, here are some examples.</p>\n\n<p>Mandelbrot:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">iterations</span> <span class=\"n\">a</span> <span class=\"n\">z</span> <span class=\"n\">i</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"n\">z′</span> <span class=\"p\">(</span><span class=\"nb\">+</span> <span class=\"p\">(</span><span class=\"nb\">*</span> <span class=\"n\">z</span> <span class=\"n\">z</span><span class=\"p\">)</span> <span class=\"n\">a</span><span class=\"p\">))</span>\n  <span class=\"p\">(</span><span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"k\">or</span> <span class=\"p\">(</span><span class=\"nb\">=</span> <span class=\"n\">i</span> <span class=\"mi\">255</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"nb\">&gt;</span> <span class=\"p\">(</span><span class=\"nb\">magnitude</span> <span class=\"n\">z′</span><span class=\"p\">)</span> <span class=\"mi\">2</span><span class=\"p\">))</span>\n      <span class=\"n\">i</span>\n      <span class=\"p\">(</span><span class=\"n\">iterations</span> <span class=\"n\">a</span> <span class=\"n\">z′</span> <span class=\"p\">(</span><span class=\"nb\">add1</span> <span class=\"n\">i</span><span class=\"p\">))))</span>\n \n<span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">iter-&gt;color</span> <span class=\"n\">i</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"nb\">=</span> <span class=\"n\">i</span> <span class=\"mi\">255</span><span class=\"p\">)</span>\n      <span class=\"p\">(</span><span class=\"nb\">make-object</span> <span class=\"n\">color%</span> <span class=\"s2\">\"black\"</span><span class=\"p\">)</span>\n      <span class=\"p\">(</span><span class=\"nb\">make-object</span> <span class=\"n\">color%</span> \n        <span class=\"p\">(</span><span class=\"nb\">*</span> <span class=\"mi\">5</span> <span class=\"p\">(</span><span class=\"nb\">modulo</span> <span class=\"n\">i</span> <span class=\"mi\">15</span><span class=\"p\">))</span> <span class=\"p\">(</span><span class=\"nb\">*</span> <span class=\"mi\">32</span> <span class=\"p\">(</span><span class=\"nb\">modulo</span> <span class=\"n\">i</span> <span class=\"mi\">7</span><span class=\"p\">))</span> \n          <span class=\"p\">(</span><span class=\"nb\">*</span> <span class=\"mi\">8</span> <span class=\"p\">(</span><span class=\"nb\">modulo</span> <span class=\"n\">i</span> <span class=\"mi\">31</span><span class=\"p\">)))))</span>\n \n<span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">mandelbrot</span> <span class=\"n\">width</span> <span class=\"n\">height</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"n\">target</span> <span class=\"p\">(</span><span class=\"n\">make-screen-bitmap</span> <span class=\"n\">width</span> <span class=\"n\">height</span><span class=\"p\">))</span>\n  <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"n\">dc</span> <span class=\"p\">(</span><span class=\"k\">new</span> <span class=\"n\">bitmap-dc%</span> <span class=\"p\">[</span><span class=\"n\">bitmap</span> <span class=\"n\">target</span><span class=\"p\">]))</span>\n  <span class=\"p\">(</span><span class=\"k\">for*</span> <span class=\"p\">([</span><span class=\"n\">x</span> <span class=\"n\">width</span><span class=\"p\">]</span> <span class=\"p\">[</span><span class=\"n\">y</span> <span class=\"n\">height</span><span class=\"p\">])</span>\n    <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"n\">real-x</span> <span class=\"p\">(</span><span class=\"nb\">-</span> <span class=\"p\">(</span><span class=\"nb\">*</span> <span class=\"mf\">3.0</span> <span class=\"p\">(</span><span class=\"nb\">/</span> <span class=\"n\">x</span> <span class=\"n\">width</span><span class=\"p\">))</span> <span class=\"mf\">2.25</span><span class=\"p\">))</span>\n    <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"n\">real-y</span> <span class=\"p\">(</span><span class=\"nb\">-</span> <span class=\"p\">(</span><span class=\"nb\">*</span> <span class=\"mf\">2.5</span> <span class=\"p\">(</span><span class=\"nb\">/</span> <span class=\"n\">y</span> <span class=\"n\">height</span><span class=\"p\">))</span> <span class=\"mf\">1.25</span><span class=\"p\">))</span>\n    <span class=\"p\">(</span><span class=\"k\">send</span> <span class=\"n\">dc</span> <span class=\"n\">set-pen</span> \n      <span class=\"p\">(</span><span class=\"n\">iter-&gt;color</span> \n        <span class=\"p\">(</span><span class=\"n\">iterations</span> \n          <span class=\"p\">(</span><span class=\"nb\">make-rectangular</span> <span class=\"n\">real-x</span> <span class=\"n\">real-y</span><span class=\"p\">)</span> <span class=\"mi\">0</span> <span class=\"mi\">0</span><span class=\"p\">))</span> <span class=\"mi\">1</span> <span class=\"o\">&#39;</span><span class=\"ss\">solid</span><span class=\"p\">)</span>\n    <span class=\"p\">(</span><span class=\"k\">send</span> <span class=\"n\">dc</span> <span class=\"n\">draw-point</span> <span class=\"n\">x</span> <span class=\"n\">y</span><span class=\"p\">))</span>\n  <span class=\"n\">target</span><span class=\"p\">)</span>\n\n<span class=\"nb\">&gt;</span> <span class=\"p\">(</span><span class=\"n\">mandelbrot300200</span><span class=\"p\">)</span>\n</pre></div>\n\n</div>\n\n<p>Yin and Yang:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">yin-yang</span> <span class=\"n\">d</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"n\">base</span>\n    <span class=\"p\">(</span><span class=\"n\">hc-append</span> <span class=\"p\">(</span><span class=\"n\">inset/clip</span> <span class=\"p\">(</span><span class=\"n\">circle</span> <span class=\"n\">d</span><span class=\"p\">)</span> <span class=\"mi\">0</span> <span class=\"mi\">0</span> <span class=\"p\">(</span><span class=\"nb\">-</span> <span class=\"p\">(</span><span class=\"nb\">/</span> <span class=\"n\">d</span> <span class=\"mi\">2</span><span class=\"p\">))</span> <span class=\"mi\">0</span><span class=\"p\">)</span>\n               <span class=\"p\">(</span><span class=\"n\">inset/clip</span> <span class=\"p\">(</span><span class=\"n\">disk</span> <span class=\"n\">d</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"nb\">-</span> <span class=\"p\">(</span><span class=\"nb\">/</span> <span class=\"n\">d</span> <span class=\"mi\">2</span><span class=\"p\">))</span> <span class=\"mi\">0</span> <span class=\"mi\">0</span> <span class=\"mi\">0</span><span class=\"p\">)))</span>\n  <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"n\">with-top</span>\n    <span class=\"p\">(</span><span class=\"n\">ct-superimpose</span>\n     <span class=\"n\">base</span>\n     <span class=\"p\">(</span><span class=\"n\">cc-superimpose</span> <span class=\"p\">(</span><span class=\"n\">colorize</span> <span class=\"p\">(</span><span class=\"n\">disk</span> <span class=\"p\">(</span><span class=\"nb\">/</span> <span class=\"n\">d</span> <span class=\"mi\">2</span><span class=\"p\">))</span> <span class=\"s2\">\"white\"</span><span class=\"p\">)</span>\n                     <span class=\"p\">(</span><span class=\"n\">disk</span> <span class=\"p\">(</span><span class=\"nb\">/</span> <span class=\"n\">d</span> <span class=\"mi\">8</span><span class=\"p\">)))))</span>\n  <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"n\">with-bottom</span>\n    <span class=\"p\">(</span><span class=\"n\">cb-superimpose</span>\n     <span class=\"n\">with-top</span>\n     <span class=\"p\">(</span><span class=\"n\">cc-superimpose</span> <span class=\"p\">(</span><span class=\"n\">disk</span> <span class=\"p\">(</span><span class=\"nb\">/</span> <span class=\"n\">d</span> <span class=\"mi\">2</span><span class=\"p\">))</span>\n                     <span class=\"p\">(</span><span class=\"n\">colorize</span> <span class=\"p\">(</span><span class=\"n\">disk</span> <span class=\"p\">(</span><span class=\"nb\">/</span> <span class=\"n\">d</span> <span class=\"mi\">8</span><span class=\"p\">))</span> <span class=\"s2\">\"white\"</span><span class=\"p\">))))</span>\n  <span class=\"p\">(</span><span class=\"n\">cc-superimpose</span> <span class=\"n\">with-bottom</span> <span class=\"p\">(</span><span class=\"n\">circle</span> <span class=\"n\">d</span><span class=\"p\">)))</span>\n \n\n<span class=\"nb\">&gt;</span> <span class=\"p\">(</span><span class=\"n\">yin-yang</span> <span class=\"mi\">200</span><span class=\"p\">)</span>\n</pre></div>\n\n</div>\n\n<p>Animate a pendulum:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"kn\">#lang </span><span class=\"nn\">racket</span>\n \n<span class=\"p\">(</span><span class=\"k\">require</span> <span class=\"n\">2htdp/image</span>\n         <span class=\"n\">2htdp/universe</span><span class=\"p\">)</span>\n \n<span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">pendulum</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">accel</span> <span class=\"n\">θ</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"nb\">-</span> <span class=\"p\">(</span><span class=\"nb\">sin</span> <span class=\"n\">θ</span><span class=\"p\">)))</span>\n  <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"n\">θ</span> <span class=\"p\">(</span><span class=\"nb\">/</span> <span class=\"nb\">pi</span> <span class=\"mf\">2.5</span><span class=\"p\">))</span>\n  <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"n\">θ′</span> <span class=\"mi\">0</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"n\">θ′′</span> <span class=\"p\">(</span><span class=\"n\">accel</span> <span class=\"p\">(</span><span class=\"nb\">/</span> <span class=\"nb\">pi</span> <span class=\"mf\">2.5</span><span class=\"p\">)))</span>\n  <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">x</span> <span class=\"n\">θ</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"nb\">+</span> <span class=\"mi\">200</span> <span class=\"p\">(</span><span class=\"nb\">*</span> <span class=\"mi\">150</span> <span class=\"p\">(</span><span class=\"nb\">sin</span> <span class=\"n\">θ</span><span class=\"p\">))))</span>\n  <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">y</span> <span class=\"n\">θ</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"nb\">*</span> <span class=\"mi\">150</span> <span class=\"p\">(</span><span class=\"nb\">cos</span> <span class=\"n\">θ</span><span class=\"p\">)))</span>\n  <span class=\"p\">(</span><span class=\"k\">λ</span> <span class=\"p\">(</span><span class=\"n\">n</span><span class=\"p\">)</span>\n    <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"n\">p-image</span> \n      <span class=\"p\">(</span><span class=\"n\">underlay/xy</span> \n        <span class=\"p\">(</span><span class=\"n\">add-line</span> \n          <span class=\"p\">(</span><span class=\"n\">empty-scene</span> <span class=\"mi\">400</span> <span class=\"mi\">200</span><span class=\"p\">)</span> <span class=\"mi\">200</span> <span class=\"mi\">0</span> <span class=\"p\">(</span><span class=\"n\">x</span> <span class=\"n\">θ</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"n\">y</span> <span class=\"n\">θ</span><span class=\"p\">)</span> <span class=\"s2\">\"black\"</span><span class=\"p\">)</span>\n            <span class=\"p\">(</span><span class=\"nb\">-</span> <span class=\"p\">(</span><span class=\"n\">x</span> <span class=\"n\">θ</span><span class=\"p\">)</span> <span class=\"mi\">5</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"nb\">-</span> <span class=\"p\">(</span><span class=\"n\">y</span> <span class=\"n\">θ</span><span class=\"p\">)</span> <span class=\"mi\">5</span><span class=\"p\">)</span> \n              <span class=\"p\">(</span><span class=\"n\">circle</span> <span class=\"mi\">5</span> <span class=\"s2\">\"solid\"</span> <span class=\"s2\">\"blue\"</span><span class=\"p\">)))</span>\n    <span class=\"p\">(</span><span class=\"k\">set!</span> <span class=\"n\">θ</span> <span class=\"p\">(</span><span class=\"nb\">+</span> <span class=\"n\">θ</span> <span class=\"p\">(</span><span class=\"nb\">*</span> <span class=\"n\">θ′</span> <span class=\"mf\">0.04</span><span class=\"p\">)))</span>\n    <span class=\"p\">(</span><span class=\"k\">set!</span> <span class=\"n\">θ′</span> <span class=\"p\">(</span><span class=\"nb\">+</span> <span class=\"n\">θ′</span> <span class=\"p\">(</span><span class=\"nb\">*</span> <span class=\"p\">(</span><span class=\"n\">accel</span> <span class=\"n\">θ</span><span class=\"p\">)</span> <span class=\"mf\">0.04</span><span class=\"p\">)))</span>\n    <span class=\"n\">p-image</span><span class=\"p\">))</span>\n \n<span class=\"p\">(</span><span class=\"n\">animate</span> <span class=\"p\">(</span><span class=\"n\">pendulum</span><span class=\"p\">))</span>\n\n\n<span class=\"n\">Jensen</span><span class=\"o\">&#39;</span><span class=\"ss\">s</span> <span class=\"n\">Device:</span>\n\n<span class=\"o\">```</span><span class=\"ss\">racket</span>\n<span class=\"kn\">#lang </span><span class=\"nn\">algol60</span>\n<span class=\"k\">begin</span>\n   <span class=\"n\">integer</span> <span class=\"n\">i</span><span class=\"c1\">;</span>\n   <span class=\"n\">real</span> <span class=\"n\">procedure</span> <span class=\"n\">sum</span> <span class=\"p\">(</span><span class=\"n\">i</span><span class=\"o\">,</span> <span class=\"n\">lo</span><span class=\"o\">,</span> <span class=\"n\">hi</span><span class=\"o\">,</span> <span class=\"n\">term</span><span class=\"p\">)</span><span class=\"c1\">;</span>\n      <span class=\"n\">value</span> <span class=\"n\">lo</span><span class=\"o\">,</span> <span class=\"n\">hi</span><span class=\"c1\">;</span>\n      <span class=\"n\">integer</span> <span class=\"n\">i</span><span class=\"o\">,</span> <span class=\"n\">lo</span><span class=\"o\">,</span> <span class=\"n\">hi</span><span class=\"c1\">;</span>\n      <span class=\"n\">real</span> <span class=\"n\">term</span><span class=\"c1\">;</span>\n      <span class=\"n\">comment</span> <span class=\"n\">term</span> <span class=\"n\">is</span> <span class=\"n\">passed</span> <span class=\"n\">by-name</span><span class=\"o\">,</span> <span class=\"k\">and</span> <span class=\"n\">so</span> <span class=\"n\">is</span> <span class=\"n\">i</span><span class=\"c1\">;</span>\n   <span class=\"k\">begin</span>\n      <span class=\"n\">real</span> <span class=\"n\">temp</span><span class=\"c1\">;</span>\n      <span class=\"n\">temp</span> <span class=\"n\">:=</span> <span class=\"mi\">0</span><span class=\"c1\">;</span>\n      <span class=\"k\">for</span> <span class=\"n\">i</span> <span class=\"n\">:=</span> <span class=\"n\">lo</span> <span class=\"n\">step</span> <span class=\"mi\">1</span> <span class=\"n\">until</span> <span class=\"n\">hi</span> <span class=\"k\">do</span>\n         <span class=\"n\">temp</span> <span class=\"n\">:=</span> <span class=\"n\">temp</span> <span class=\"nb\">+</span> <span class=\"n\">term</span><span class=\"c1\">;</span>\n      <span class=\"n\">sum</span> <span class=\"n\">:=</span> <span class=\"n\">temp</span>\n   <span class=\"n\">end</span><span class=\"c1\">;</span>\n   <span class=\"n\">comment</span> <span class=\"n\">note</span> <span class=\"n\">the</span> <span class=\"n\">correspondence</span> <span class=\"n\">between</span> \n   <span class=\"n\">the</span> <span class=\"n\">mathematical</span> <span class=\"n\">notation</span> <span class=\"k\">and</span> <span class=\"n\">the</span> <span class=\"n\">call</span> <span class=\"n\">to</span> <span class=\"n\">sum</span><span class=\"c1\">;</span>\n   <span class=\"n\">printnln</span> <span class=\"p\">(</span><span class=\"n\">sum</span> <span class=\"p\">(</span><span class=\"n\">i</span><span class=\"o\">,</span> <span class=\"mi\">1</span><span class=\"o\">,</span> <span class=\"mi\">100</span><span class=\"o\">,</span> <span class=\"n\">1/i</span><span class=\"p\">))</span>\n<span class=\"n\">end</span>\n</pre></div>\n\n</div>\n\n<p>Thanks to all of the people who have contributed solutions so far!</p>") #t (u . "\n<p><em>posted by Asumu Takikawa</em></p>\n\n<p>About a month ago, inspired by a mailing list post by Tim Brown, Racketeers started to write more solutions to <a href=\"http://rosettacode.org/wiki/Rosetta_Code\">Rosetta Code</a> tasks for Racket. Just today, we&rsquo;ve reached 200 entries in the <a href=\"http://rosettacode.org/wiki/Category:Racket\">Racket category</a>!</p>\n\n<p>This is a nice milestone, but we still have a ways to go. At 200 entries, Racket comes in at around 54th in the <a href=\"http://rosettacode.org/wiki/RC_POP.OUT\">popularity</a> rankings. So if you&rsquo;re looking to practice your Racketeering skills, don&rsquo;t hesitate to work on some of the <a href=\"http://rosettacode.org/wiki/Reports:Tasks_not_implemented_in_Racket\">remaining tasks</a>.</p>\n\n<p>To give you a taste of the kinds of solutions we have so far, here are some examples.</p>\n\n<p>Mandelbrot:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">iterations</span> <span class=\"n\">a</span> <span class=\"n\">z</span> <span class=\"n\">i</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"n\">z′</span> <span class=\"p\">(</span><span class=\"nb\">+</span> <span class=\"p\">(</span><span class=\"nb\">*</span> <span class=\"n\">z</span> <span class=\"n\">z</span><span class=\"p\">)</span> <span class=\"n\">a</span><span class=\"p\">))</span>\n  <span class=\"p\">(</span><span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"k\">or</span> <span class=\"p\">(</span><span class=\"nb\">=</span> <span class=\"n\">i</span> <span class=\"mi\">255</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"nb\">&gt;</span> <span class=\"p\">(</span><span class=\"nb\">magnitude</span> <span class=\"n\">z′</span><span class=\"p\">)</span> <span class=\"mi\">2</span><span class=\"p\">))</span>\n      <span class=\"n\">i</span>\n      <span class=\"p\">(</span><span class=\"n\">iterations</span> <span class=\"n\">a</span> <span class=\"n\">z′</span> <span class=\"p\">(</span><span class=\"nb\">add1</span> <span class=\"n\">i</span><span class=\"p\">))))</span>\n \n<span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">iter-&gt;color</span> <span class=\"n\">i</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"nb\">=</span> <span class=\"n\">i</span> <span class=\"mi\">255</span><span class=\"p\">)</span>\n      <span class=\"p\">(</span><span class=\"nb\">make-object</span> <span class=\"n\">color%</span> <span class=\"s2\">\"black\"</span><span class=\"p\">)</span>\n      <span class=\"p\">(</span><span class=\"nb\">make-object</span> <span class=\"n\">color%</span> \n        <span class=\"p\">(</span><span class=\"nb\">*</span> <span class=\"mi\">5</span> <span class=\"p\">(</span><span class=\"nb\">modulo</span> <span class=\"n\">i</span> <span class=\"mi\">15</span><span class=\"p\">))</span> <span class=\"p\">(</span><span class=\"nb\">*</span> <span class=\"mi\">32</span> <span class=\"p\">(</span><span class=\"nb\">modulo</span> <span class=\"n\">i</span> <span class=\"mi\">7</span><span class=\"p\">))</span> \n          <span class=\"p\">(</span><span class=\"nb\">*</span> <span class=\"mi\">8</span> <span class=\"p\">(</span><span class=\"nb\">modulo</span> <span class=\"n\">i</span> <span class=\"mi\">31</span><span class=\"p\">)))))</span>\n \n<span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">mandelbrot</span> <span class=\"n\">width</span> <span class=\"n\">height</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"n\">target</span> <span class=\"p\">(</span><span class=\"n\">make-screen-bitmap</span> <span class=\"n\">width</span> <span class=\"n\">height</span><span class=\"p\">))</span>\n  <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"n\">dc</span> <span class=\"p\">(</span><span class=\"k\">new</span> <span class=\"n\">bitmap-dc%</span> <span class=\"p\">[</span><span class=\"n\">bitmap</span> <span class=\"n\">target</span><span class=\"p\">]))</span>\n  <span class=\"p\">(</span><span class=\"k\">for*</span> <span class=\"p\">([</span><span class=\"n\">x</span> <span class=\"n\">width</span><span class=\"p\">]</span> <span class=\"p\">[</span><span class=\"n\">y</span> <span class=\"n\">height</span><span class=\"p\">])</span>\n    <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"n\">real-x</span> <span class=\"p\">(</span><span class=\"nb\">-</span> <span class=\"p\">(</span><span class=\"nb\">*</span> <span class=\"mf\">3.0</span> <span class=\"p\">(</span><span class=\"nb\">/</span> <span class=\"n\">x</span> <span class=\"n\">width</span><span class=\"p\">))</span> <span class=\"mf\">2.25</span><span class=\"p\">))</span>\n    <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"n\">real-y</span> <span class=\"p\">(</span><span class=\"nb\">-</span> <span class=\"p\">(</span><span class=\"nb\">*</span> <span class=\"mf\">2.5</span> <span class=\"p\">(</span><span class=\"nb\">/</span> <span class=\"n\">y</span> <span class=\"n\">height</span><span class=\"p\">))</span> <span class=\"mf\">1.25</span><span class=\"p\">))</span>\n    <span class=\"p\">(</span><span class=\"k\">send</span> <span class=\"n\">dc</span> <span class=\"n\">set-pen</span> \n      <span class=\"p\">(</span><span class=\"n\">iter-&gt;color</span> \n        <span class=\"p\">(</span><span class=\"n\">iterations</span> \n          <span class=\"p\">(</span><span class=\"nb\">make-rectangular</span> <span class=\"n\">real-x</span> <span class=\"n\">real-y</span><span class=\"p\">)</span> <span class=\"mi\">0</span> <span class=\"mi\">0</span><span class=\"p\">))</span> <span class=\"mi\">1</span> <span class=\"o\">&#39;</span><span class=\"ss\">solid</span><span class=\"p\">)</span>\n    <span class=\"p\">(</span><span class=\"k\">send</span> <span class=\"n\">dc</span> <span class=\"n\">draw-point</span> <span class=\"n\">x</span> <span class=\"n\">y</span><span class=\"p\">))</span>\n  <span class=\"n\">target</span><span class=\"p\">)</span>\n\n<span class=\"nb\">&gt;</span> <span class=\"p\">(</span><span class=\"n\">mandelbrot300200</span><span class=\"p\">)</span>\n</pre></div>\n\n</div>\n\n<p>Yin and Yang:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">yin-yang</span> <span class=\"n\">d</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"n\">base</span>\n    <span class=\"p\">(</span><span class=\"n\">hc-append</span> <span class=\"p\">(</span><span class=\"n\">inset/clip</span> <span class=\"p\">(</span><span class=\"n\">circle</span> <span class=\"n\">d</span><span class=\"p\">)</span> <span class=\"mi\">0</span> <span class=\"mi\">0</span> <span class=\"p\">(</span><span class=\"nb\">-</span> <span class=\"p\">(</span><span class=\"nb\">/</span> <span class=\"n\">d</span> <span class=\"mi\">2</span><span class=\"p\">))</span> <span class=\"mi\">0</span><span class=\"p\">)</span>\n               <span class=\"p\">(</span><span class=\"n\">inset/clip</span> <span class=\"p\">(</span><span class=\"n\">disk</span> <span class=\"n\">d</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"nb\">-</span> <span class=\"p\">(</span><span class=\"nb\">/</span> <span class=\"n\">d</span> <span class=\"mi\">2</span><span class=\"p\">))</span> <span class=\"mi\">0</span> <span class=\"mi\">0</span> <span class=\"mi\">0</span><span class=\"p\">)))</span>\n  <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"n\">with-top</span>\n    <span class=\"p\">(</span><span class=\"n\">ct-superimpose</span>\n     <span class=\"n\">base</span>\n     <span class=\"p\">(</span><span class=\"n\">cc-superimpose</span> <span class=\"p\">(</span><span class=\"n\">colorize</span> <span class=\"p\">(</span><span class=\"n\">disk</span> <span class=\"p\">(</span><span class=\"nb\">/</span> <span class=\"n\">d</span> <span class=\"mi\">2</span><span class=\"p\">))</span> <span class=\"s2\">\"white\"</span><span class=\"p\">)</span>\n                     <span class=\"p\">(</span><span class=\"n\">disk</span> <span class=\"p\">(</span><span class=\"nb\">/</span> <span class=\"n\">d</span> <span class=\"mi\">8</span><span class=\"p\">)))))</span>\n  <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"n\">with-bottom</span>\n    <span class=\"p\">(</span><span class=\"n\">cb-superimpose</span>\n     <span class=\"n\">with-top</span>\n     <span class=\"p\">(</span><span class=\"n\">cc-superimpose</span> <span class=\"p\">(</span><span class=\"n\">disk</span> <span class=\"p\">(</span><span class=\"nb\">/</span> <span class=\"n\">d</span> <span class=\"mi\">2</span><span class=\"p\">))</span>\n                     <span class=\"p\">(</span><span class=\"n\">colorize</span> <span class=\"p\">(</span><span class=\"n\">disk</span> <span class=\"p\">(</span><span class=\"nb\">/</span> <span class=\"n\">d</span> <span class=\"mi\">8</span><span class=\"p\">))</span> <span class=\"s2\">\"white\"</span><span class=\"p\">))))</span>\n  <span class=\"p\">(</span><span class=\"n\">cc-superimpose</span> <span class=\"n\">with-bottom</span> <span class=\"p\">(</span><span class=\"n\">circle</span> <span class=\"n\">d</span><span class=\"p\">)))</span>\n \n\n<span class=\"nb\">&gt;</span> <span class=\"p\">(</span><span class=\"n\">yin-yang</span> <span class=\"mi\">200</span><span class=\"p\">)</span>\n</pre></div>\n\n</div>\n\n<p>Animate a pendulum:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"kn\">#lang </span><span class=\"nn\">racket</span>\n \n<span class=\"p\">(</span><span class=\"k\">require</span> <span class=\"n\">2htdp/image</span>\n         <span class=\"n\">2htdp/universe</span><span class=\"p\">)</span>\n \n<span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">pendulum</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">accel</span> <span class=\"n\">θ</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"nb\">-</span> <span class=\"p\">(</span><span class=\"nb\">sin</span> <span class=\"n\">θ</span><span class=\"p\">)))</span>\n  <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"n\">θ</span> <span class=\"p\">(</span><span class=\"nb\">/</span> <span class=\"nb\">pi</span> <span class=\"mf\">2.5</span><span class=\"p\">))</span>\n  <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"n\">θ′</span> <span class=\"mi\">0</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"n\">θ′′</span> <span class=\"p\">(</span><span class=\"n\">accel</span> <span class=\"p\">(</span><span class=\"nb\">/</span> <span class=\"nb\">pi</span> <span class=\"mf\">2.5</span><span class=\"p\">)))</span>\n  <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">x</span> <span class=\"n\">θ</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"nb\">+</span> <span class=\"mi\">200</span> <span class=\"p\">(</span><span class=\"nb\">*</span> <span class=\"mi\">150</span> <span class=\"p\">(</span><span class=\"nb\">sin</span> <span class=\"n\">θ</span><span class=\"p\">))))</span>\n  <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">y</span> <span class=\"n\">θ</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"nb\">*</span> <span class=\"mi\">150</span> <span class=\"p\">(</span><span class=\"nb\">cos</span> <span class=\"n\">θ</span><span class=\"p\">)))</span>\n  <span class=\"p\">(</span><span class=\"k\">λ</span> <span class=\"p\">(</span><span class=\"n\">n</span><span class=\"p\">)</span>\n    <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"n\">p-image</span> \n      <span class=\"p\">(</span><span class=\"n\">underlay/xy</span> \n        <span class=\"p\">(</span><span class=\"n\">add-line</span> \n          <span class=\"p\">(</span><span class=\"n\">empty-scene</span> <span class=\"mi\">400</span> <span class=\"mi\">200</span><span class=\"p\">)</span> <span class=\"mi\">200</span> <span class=\"mi\">0</span> <span class=\"p\">(</span><span class=\"n\">x</span> <span class=\"n\">θ</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"n\">y</span> <span class=\"n\">θ</span><span class=\"p\">)</span> <span class=\"s2\">\"black\"</span><span class=\"p\">)</span>\n            <span class=\"p\">(</span><span class=\"nb\">-</span> <span class=\"p\">(</span><span class=\"n\">x</span> <span class=\"n\">θ</span><span class=\"p\">)</span> <span class=\"mi\">5</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"nb\">-</span> <span class=\"p\">(</span><span class=\"n\">y</span> <span class=\"n\">θ</span><span class=\"p\">)</span> <span class=\"mi\">5</span><span class=\"p\">)</span> \n              <span class=\"p\">(</span><span class=\"n\">circle</span> <span class=\"mi\">5</span> <span class=\"s2\">\"solid\"</span> <span class=\"s2\">\"blue\"</span><span class=\"p\">)))</span>\n    <span class=\"p\">(</span><span class=\"k\">set!</span> <span class=\"n\">θ</span> <span class=\"p\">(</span><span class=\"nb\">+</span> <span class=\"n\">θ</span> <span class=\"p\">(</span><span class=\"nb\">*</span> <span class=\"n\">θ′</span> <span class=\"mf\">0.04</span><span class=\"p\">)))</span>\n    <span class=\"p\">(</span><span class=\"k\">set!</span> <span class=\"n\">θ′</span> <span class=\"p\">(</span><span class=\"nb\">+</span> <span class=\"n\">θ′</span> <span class=\"p\">(</span><span class=\"nb\">*</span> <span class=\"p\">(</span><span class=\"n\">accel</span> <span class=\"n\">θ</span><span class=\"p\">)</span> <span class=\"mf\">0.04</span><span class=\"p\">)))</span>\n    <span class=\"n\">p-image</span><span class=\"p\">))</span>\n \n<span class=\"p\">(</span><span class=\"n\">animate</span> <span class=\"p\">(</span><span class=\"n\">pendulum</span><span class=\"p\">))</span>\n\n\n<span class=\"n\">Jensen</span><span class=\"o\">&#39;</span><span class=\"ss\">s</span> <span class=\"n\">Device:</span>\n\n<span class=\"o\">```</span><span class=\"ss\">racket</span>\n<span class=\"kn\">#lang </span><span class=\"nn\">algol60</span>\n<span class=\"k\">begin</span>\n   <span class=\"n\">integer</span> <span class=\"n\">i</span><span class=\"c1\">;</span>\n   <span class=\"n\">real</span> <span class=\"n\">procedure</span> <span class=\"n\">sum</span> <span class=\"p\">(</span><span class=\"n\">i</span><span class=\"o\">,</span> <span class=\"n\">lo</span><span class=\"o\">,</span> <span class=\"n\">hi</span><span class=\"o\">,</span> <span class=\"n\">term</span><span class=\"p\">)</span><span class=\"c1\">;</span>\n      <span class=\"n\">value</span> <span class=\"n\">lo</span><span class=\"o\">,</span> <span class=\"n\">hi</span><span class=\"c1\">;</span>\n      <span class=\"n\">integer</span> <span class=\"n\">i</span><span class=\"o\">,</span> <span class=\"n\">lo</span><span class=\"o\">,</span> <span class=\"n\">hi</span><span class=\"c1\">;</span>\n      <span class=\"n\">real</span> <span class=\"n\">term</span><span class=\"c1\">;</span>\n      <span class=\"n\">comment</span> <span class=\"n\">term</span> <span class=\"n\">is</span> <span class=\"n\">passed</span> <span class=\"n\">by-name</span><span class=\"o\">,</span> <span class=\"k\">and</span> <span class=\"n\">so</span> <span class=\"n\">is</span> <span class=\"n\">i</span><span class=\"c1\">;</span>\n   <span class=\"k\">begin</span>\n      <span class=\"n\">real</span> <span class=\"n\">temp</span><span class=\"c1\">;</span>\n      <span class=\"n\">temp</span> <span class=\"n\">:=</span> <span class=\"mi\">0</span><span class=\"c1\">;</span>\n      <span class=\"k\">for</span> <span class=\"n\">i</span> <span class=\"n\">:=</span> <span class=\"n\">lo</span> <span class=\"n\">step</span> <span class=\"mi\">1</span> <span class=\"n\">until</span> <span class=\"n\">hi</span> <span class=\"k\">do</span>\n         <span class=\"n\">temp</span> <span class=\"n\">:=</span> <span class=\"n\">temp</span> <span class=\"nb\">+</span> <span class=\"n\">term</span><span class=\"c1\">;</span>\n      <span class=\"n\">sum</span> <span class=\"n\">:=</span> <span class=\"n\">temp</span>\n   <span class=\"n\">end</span><span class=\"c1\">;</span>\n   <span class=\"n\">comment</span> <span class=\"n\">note</span> <span class=\"n\">the</span> <span class=\"n\">correspondence</span> <span class=\"n\">between</span> \n   <span class=\"n\">the</span> <span class=\"n\">mathematical</span> <span class=\"n\">notation</span> <span class=\"k\">and</span> <span class=\"n\">the</span> <span class=\"n\">call</span> <span class=\"n\">to</span> <span class=\"n\">sum</span><span class=\"c1\">;</span>\n   <span class=\"n\">printnln</span> <span class=\"p\">(</span><span class=\"n\">sum</span> <span class=\"p\">(</span><span class=\"n\">i</span><span class=\"o\">,</span> <span class=\"mi\">1</span><span class=\"o\">,</span> <span class=\"mi\">100</span><span class=\"o\">,</span> <span class=\"n\">1/i</span><span class=\"p\">))</span>\n<span class=\"n\">end</span>\n</pre></div>\n\n</div>\n\n<p>Thanks to all of the people who have contributed solutions so far!</p>\n<!-- more-->\n\n<hr />\n\n<p>Racket is climbing the rankings &hellip;</p>\n\n<p>http://timb.net/popular-languages.html</p>\n\n<p>— <em>Daniel Prager, 7 June 2013</em></p>\n\n<hr />")) ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2007-05-16-looking-for-small-scheme-scripts.md" . unix) f post (u . "Looking for small Scheme scripts") (? . 121) 1467223812 (p+ #"/Users/MB/git/racket-lang-org/blog/2007/05/looking-for-small-scheme-scripts.html" . unix) "/2007/05/looking-for-small-scheme-scripts.html" (u . "2007-05-16T17:34:00.000-04:00") (? . 101) (? . 122) (c (u . "")) (u . "\n<p><em>posted by Sam Tobin-Hochstadt</em></p>\n\n<p>As part of the <a href=\"http://www.ccs.neu.edu/%7Esamth/typed-scheme.html\">Typed Scheme</a> project, we are looking for small Scheme scripts that we can port from PLT Scheme to Typed Scheme. We would like to investigate if Typed Scheme is capable of checking idiomatic PLT Scheme code, as represented by scripts written by members of the PLT Scheme community.</p>\n\n<p>Therefore, if you have a simple PLT Scheme program which handles a scripting/processing task, and you are willing to share it with us for the improvement of Typed Scheme, please let <a href=\"mailto:samth@ccs.neu.edu\">me</a> know. Typed Scheme currently handles all of &lsquo;core&rsquo; MzScheme, as well as many of the collections (the major exceptions are the class and unit systems).</p>\n\n<p>In return, we will inform you of any bugs that we discover during the port.</p>\n\n<p>More information about Typed Scheme is available from the webpage: http://www.ccs.neu.edu/~samth/typed-scheme.html</p>") #t (u . "\n<p><em>posted by Sam Tobin-Hochstadt</em></p>\n\n<p>As part of the <a href=\"http://www.ccs.neu.edu/%7Esamth/typed-scheme.html\">Typed Scheme</a> project, we are looking for small Scheme scripts that we can port from PLT Scheme to Typed Scheme. We would like to investigate if Typed Scheme is capable of checking idiomatic PLT Scheme code, as represented by scripts written by members of the PLT Scheme community.</p>\n\n<p>Therefore, if you have a simple PLT Scheme program which handles a scripting/processing task, and you are willing to share it with us for the improvement of Typed Scheme, please let <a href=\"mailto:samth@ccs.neu.edu\">me</a> know. Typed Scheme currently handles all of &lsquo;core&rsquo; MzScheme, as well as many of the collections (the major exceptions are the class and unit systems).</p>\n\n<p>In return, we will inform you of any bugs that we discover during the port.</p>\n\n<p>More information about Typed Scheme is available from the webpage: http://www.ccs.neu.edu/~samth/typed-scheme.html</p>\n<!-- more-->\n\n<hr />\n\n<p>The link is broken in this article, please fix.</p>\n\n<p>— <em>Julian, 19 April 2009</em></p>\n\n<hr />\n\n<p>I see three links (two to the typed scheme main page and one to Sam&rsquo;s email). They all seem okay to me.</p>\n\n<p>— <em>Robby, 19 April 2009</em></p>\n\n<hr />")) ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2009-12-01-plt-scheme-v423.md" . unix) f post (u . "PLT Scheme v4.2.3") (? . 123) 1467223812 (p+ #"/Users/MB/git/racket-lang-org/blog/2009/12/plt-scheme-v423.html" . unix) "/2009/12/plt-scheme-v423.html" (u . "2009-12-01T06:03:00.001-05:00") (? . 124) (? . 5) (c (u . "")) (u . "\n<p><em>posted by Eli Barzilay</em></p>\n\n<p>PLT Scheme version 4.2.3 is now available from <a href=\"http://plt-scheme.org/\"><code>http://plt-scheme.org/</code></a></p>\n\n<ul>\n <li>\n  <p>The unit test framework for the teaching languages provides <code>check-member-of</code> and <code>check-range</code> for checking &ldquo;random functions&rdquo;, i.e., &ldquo;functions&rdquo; that may produce several different results for one and the same argument.</p></li>\n <li>\n  <p>Added a new image library, <code>2htdp/image</code>. Significant changes from <code>htdp/image</code>:</p></li>\n <li>\n  <p>copying and pasting does not introduce jaggies</p></li>\n <li>\n  <p><code>equal?</code> comparisons are more efficient</p></li>\n <li>\n  <p>added rotation &amp; scaling</p></li>\n <li>\n  <p>got rid of pinholes (new overlay, beside, above functions based on bounding boxes)</p></li>\n <li>\n  <p>The <code>scheme/vector</code> library provides common vector operations (also reprovided by <code>scheme</code>).</p></li>\n <li>\n  <p>The <code>scheme/promise</code> library provides several new kinds of promises with alternatives execution strategies.</p></li>\n <li>\n  <p>New port-reading utilities: <code>in-port</code>, <code>port-&gt;list</code>, <code>file-&gt;list</code>.</p></li>\n <li>\n  <p>A new require-macro, <code>path-up</code>, for  requiring a file that is higher in the directory tree.</p></li></ul>") #f (u . "\n<p><em>posted by Eli Barzilay</em></p>\n\n<p>PLT Scheme version 4.2.3 is now available from <a href=\"http://plt-scheme.org/\"><code>http://plt-scheme.org/</code></a></p>\n\n<ul>\n <li>\n  <p>The unit test framework for the teaching languages provides <code>check-member-of</code> and <code>check-range</code> for checking &ldquo;random functions&rdquo;, i.e., &ldquo;functions&rdquo; that may produce several different results for one and the same argument.</p></li>\n <li>\n  <p>Added a new image library, <code>2htdp/image</code>. Significant changes from <code>htdp/image</code>:</p></li>\n <li>\n  <p>copying and pasting does not introduce jaggies</p></li>\n <li>\n  <p><code>equal?</code> comparisons are more efficient</p></li>\n <li>\n  <p>added rotation &amp; scaling</p></li>\n <li>\n  <p>got rid of pinholes (new overlay, beside, above functions based on bounding boxes)</p></li>\n <li>\n  <p>The <code>scheme/vector</code> library provides common vector operations (also reprovided by <code>scheme</code>).</p></li>\n <li>\n  <p>The <code>scheme/promise</code> library provides several new kinds of promises with alternatives execution strategies.</p></li>\n <li>\n  <p>New port-reading utilities: <code>in-port</code>, <code>port-&gt;list</code>, <code>file-&gt;list</code>.</p></li>\n <li>\n  <p>A new require-macro, <code>path-up</code>, for  requiring a file that is higher in the directory tree.</p></li></ul>")) ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2015-04-20-scheme-workshop-2015.md" . unix) f post (u . "Scheme Workshop 2015") (? . 81) 1467223812 (p+ #"/Users/MB/git/racket-lang-org/blog/2015/04/scheme-workshop-2015.html" . unix) "/2015/04/scheme-workshop-2015.html" (u . "2015-04-20T13:44:00.000-04:00") (? . 79) (? . 19) (c (u . "")) (u . "\n<p><em>posted by Ryan Culpepper</em></p>\n\n<p>Call For Papers:</p>\n\n<p>Scheme and Functional Programming Workshop 2015</p>\n\n<p>Vancouver, British Columbia, Canada</p>\n\n<p>(Co-located with ICFP 2015)</p>\n\n<p><a href=\"http://andykeep.com/SchemeWorkshop2015/\">http://andykeep.com/SchemeWorkshop2015/</a></p>\n\n<p>Submissions related to Scheme, Racket, Clojure, and functional programming are welcome and encouraged. Topics of interest include but are not limited to:</p>\n\n<ul>\n <li>\n  <p>Program-development environments, debugging, testing</p></li>\n <li>\n  <p>Implementation (interpreters, compilers, tools, benchmarks, etc.)</p></li>\n <li>\n  <p>Syntax, macros, hygiene</p></li>\n <li>\n  <p>Distributed computing, concurrency, parallelism</p></li>\n <li>\n  <p>Interoperability with other languages, FFIs</p></li>\n <li>\n  <p>Continuations, modules, object systems, types</p></li>\n <li>\n  <p>Theory, formal semantics, correctness</p></li>\n <li>\n  <p>History, evolution and standardization of Scheme</p></li>\n <li>\n  <p>Applications, experience and industrial uses of Scheme</p></li>\n <li>\n  <p>Education</p></li>\n <li>\n  <p>Scheme pearls (elegant, instructive uses of Scheme)</p></li></ul>\n\n<p>We also welcome submissions related to dynamic or multiparadigmatic languages and programming techniques.</p>\n\n<p>Important Dates:</p>\n\n<p>May 22nd, 2015 - Paper deadline</p>\n\n<p>June 26th, 2015 - Author notification</p>\n\n<p>July 19th, 2015 - Camera-ready deadline</p>\n\n<p>September 4th, 2015 - Workshop</p>\n\n<p>Submissions must be in ACM proceedings format, no smaller than 9-point type (10-point type preferred). Microsoft Word and LaTeX templates for this format are available at: <a href=\"http://www.acm.org/sigs/sigplan/authorInformation.htm\">http://www.acm.org/sigs/sigplan/authorInformation.htm</a></p>\n\n<p>Submissions should be in PDF and printable on US Letter.</p>\n\n<p>To encourage authors to submit their best work, this year we are encouraging shorter papers (around 6 pages, excluding references). This is to allow authors to submit longer, revised versions of their papers to archival conferences or journals. Longer papers (10&mdash;12 pages) are also acceptable, if the extra space is needed. There is no maximum length limit on submissions, but good submissions will likely be in the range of 6 to 12 pages.</p>\n\n<p>More information available at: <a href=\"http://andykeep.com/SchemeWorkshop2015/\">http://andykeep.com/SchemeWorkshop2015/</a></p>\n\n<p>Organizers:</p>\n\n<p>Andy Keep, Cisco Systems Inc. (General Chair)</p>\n\n<p>Ryan Culpepper, Northeastern University (Program Chair)</p>\n\n<p>(Apologies for duplications from cross-posting.)</p>") #f (u . "\n<p><em>posted by Ryan Culpepper</em></p>\n\n<p>Call For Papers:</p>\n\n<p>Scheme and Functional Programming Workshop 2015</p>\n\n<p>Vancouver, British Columbia, Canada</p>\n\n<p>(Co-located with ICFP 2015)</p>\n\n<p><a href=\"http://andykeep.com/SchemeWorkshop2015/\">http://andykeep.com/SchemeWorkshop2015/</a></p>\n\n<p>Submissions related to Scheme, Racket, Clojure, and functional programming are welcome and encouraged. Topics of interest include but are not limited to:</p>\n\n<ul>\n <li>\n  <p>Program-development environments, debugging, testing</p></li>\n <li>\n  <p>Implementation (interpreters, compilers, tools, benchmarks, etc.)</p></li>\n <li>\n  <p>Syntax, macros, hygiene</p></li>\n <li>\n  <p>Distributed computing, concurrency, parallelism</p></li>\n <li>\n  <p>Interoperability with other languages, FFIs</p></li>\n <li>\n  <p>Continuations, modules, object systems, types</p></li>\n <li>\n  <p>Theory, formal semantics, correctness</p></li>\n <li>\n  <p>History, evolution and standardization of Scheme</p></li>\n <li>\n  <p>Applications, experience and industrial uses of Scheme</p></li>\n <li>\n  <p>Education</p></li>\n <li>\n  <p>Scheme pearls (elegant, instructive uses of Scheme)</p></li></ul>\n\n<p>We also welcome submissions related to dynamic or multiparadigmatic languages and programming techniques.</p>\n\n<p>Important Dates:</p>\n\n<p>May 22nd, 2015 - Paper deadline</p>\n\n<p>June 26th, 2015 - Author notification</p>\n\n<p>July 19th, 2015 - Camera-ready deadline</p>\n\n<p>September 4th, 2015 - Workshop</p>\n\n<p>Submissions must be in ACM proceedings format, no smaller than 9-point type (10-point type preferred). Microsoft Word and LaTeX templates for this format are available at: <a href=\"http://www.acm.org/sigs/sigplan/authorInformation.htm\">http://www.acm.org/sigs/sigplan/authorInformation.htm</a></p>\n\n<p>Submissions should be in PDF and printable on US Letter.</p>\n\n<p>To encourage authors to submit their best work, this year we are encouraging shorter papers (around 6 pages, excluding references). This is to allow authors to submit longer, revised versions of their papers to archival conferences or journals. Longer papers (10&mdash;12 pages) are also acceptable, if the extra space is needed. There is no maximum length limit on submissions, but good submissions will likely be in the range of 6 to 12 pages.</p>\n\n<p>More information available at: <a href=\"http://andykeep.com/SchemeWorkshop2015/\">http://andykeep.com/SchemeWorkshop2015/</a></p>\n\n<p>Organizers:</p>\n\n<p>Andy Keep, Cisco Systems Inc. (General Chair)</p>\n\n<p>Ryan Culpepper, Northeastern University (Program Chair)</p>\n\n<p>(Apologies for duplications from cross-posting.)</p>")) ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2007-09-06-how-many-occurrences-of-car-in-the-plt-source-code.md" . unix) f post (u . "How many occurrences of car in the PLT source code?") (? . 125) 1467223812 (p+ #"/Users/MB/git/racket-lang-org/blog/2007/09/how-many-occurrences-of-car-in-the-plt-source-code.html" . unix) "/2007/09/how-many-occurrences-of-car-in-the-plt-source-code.html" (u . "2007-09-06T10:30:00.000-04:00") (? . 106) (? . 126) (c (u . "")) (u . "\n<p><em>posted by Robby Findler</em></p>\n\n<p>Lets play a guessing game. See who can guess:</p>\n\n<ul>\n <li>\n  <p>How many occurrences of the identifier <code>car</code> there are in the PLT tree (when using <code>read</code> and just counting the symbols that come out)?</p></li>\n <li>\n  <p>Where does <code>car</code> rank on the list of the most commonly used identifiers?</p></li>\n <li>\n  <p>What is the most common identifier, and how many occurrences of it are there?</p></li></ul>\n\n<p>UPDATE: The two files <code>raw-hattori</code> and <code>raw-kajitani.ss</code> are generated files containing solutions to <a href=\"http://en.wikipedia.org/wiki/Nonogram\">Paint by Numbers</a> problems and about 30,000 occurrences of <code>x</code> and <code>o</code>. Discounting them, this is the list of the top ten identifiers and the number of occurrences:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">((</span><span class=\"k\">define</span> <span class=\"mi\">25294</span><span class=\"p\">)</span>\n <span class=\"p\">(</span><span class=\"k\">quote</span> <span class=\"mi\">24101</span><span class=\"p\">)</span>\n <span class=\"p\">(</span><span class=\"k\">lambda</span> <span class=\"mi\">18883</span><span class=\"p\">)</span>\n <span class=\"p\">(</span><span class=\"k\">let</span> <span class=\"mi\">14796</span><span class=\"p\">)</span>\n <span class=\"p\">(</span><span class=\"k\">send</span> <span class=\"mi\">14349</span><span class=\"p\">)</span>\n <span class=\"p\">(</span><span class=\"n\">x</span> <span class=\"mi\">11877</span><span class=\"p\">)</span>\n <span class=\"p\">(</span><span class=\"k\">if</span> <span class=\"mi\">11118</span><span class=\"p\">)</span>\n <span class=\"p\">(</span><span class=\"k\">...</span> <span class=\"mi\">8474</span><span class=\"p\">)</span>\n <span class=\"p\">(</span><span class=\"nb\">car</span> <span class=\"mi\">7610</span><span class=\"p\">)</span>\n <span class=\"p\">(</span><span class=\"k\">syntax</span> <span class=\"mi\">6537</span><span class=\"p\">))</span>\n</pre></div>\n\n</div>\n\n<p>The identifier <code>cdr</code> ranks 21st with 5,259 occurrences, <code>let*</code> has 3,066 which, when combined with <code>let</code> comes out at 17,862, still not enough to pass <code>lambda</code>. Speaking of combining, <code>λ</code> has 2,271 occurrences, which is also not enough to move <code>lambda</code>. Finally <code>map</code> comes in 32nd with 3,853 occurrences and <code>foldl</code> beats out <code>foldr</code> (1168th place with 75 occurrences vs 1451st place with 58 occurrences).</p>") #t (u . "\n<p><em>posted by Robby Findler</em></p>\n\n<p>Lets play a guessing game. See who can guess:</p>\n\n<ul>\n <li>\n  <p>How many occurrences of the identifier <code>car</code> there are in the PLT tree (when using <code>read</code> and just counting the symbols that come out)?</p></li>\n <li>\n  <p>Where does <code>car</code> rank on the list of the most commonly used identifiers?</p></li>\n <li>\n  <p>What is the most common identifier, and how many occurrences of it are there?</p></li></ul>\n\n<p>UPDATE: The two files <code>raw-hattori</code> and <code>raw-kajitani.ss</code> are generated files containing solutions to <a href=\"http://en.wikipedia.org/wiki/Nonogram\">Paint by Numbers</a> problems and about 30,000 occurrences of <code>x</code> and <code>o</code>. Discounting them, this is the list of the top ten identifiers and the number of occurrences:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">((</span><span class=\"k\">define</span> <span class=\"mi\">25294</span><span class=\"p\">)</span>\n <span class=\"p\">(</span><span class=\"k\">quote</span> <span class=\"mi\">24101</span><span class=\"p\">)</span>\n <span class=\"p\">(</span><span class=\"k\">lambda</span> <span class=\"mi\">18883</span><span class=\"p\">)</span>\n <span class=\"p\">(</span><span class=\"k\">let</span> <span class=\"mi\">14796</span><span class=\"p\">)</span>\n <span class=\"p\">(</span><span class=\"k\">send</span> <span class=\"mi\">14349</span><span class=\"p\">)</span>\n <span class=\"p\">(</span><span class=\"n\">x</span> <span class=\"mi\">11877</span><span class=\"p\">)</span>\n <span class=\"p\">(</span><span class=\"k\">if</span> <span class=\"mi\">11118</span><span class=\"p\">)</span>\n <span class=\"p\">(</span><span class=\"k\">...</span> <span class=\"mi\">8474</span><span class=\"p\">)</span>\n <span class=\"p\">(</span><span class=\"nb\">car</span> <span class=\"mi\">7610</span><span class=\"p\">)</span>\n <span class=\"p\">(</span><span class=\"k\">syntax</span> <span class=\"mi\">6537</span><span class=\"p\">))</span>\n</pre></div>\n\n</div>\n\n<p>The identifier <code>cdr</code> ranks 21st with 5,259 occurrences, <code>let*</code> has 3,066 which, when combined with <code>let</code> comes out at 17,862, still not enough to pass <code>lambda</code>. Speaking of combining, <code>λ</code> has 2,271 occurrences, which is also not enough to move <code>lambda</code>. Finally <code>map</code> comes in 32nd with 3,853 occurrences and <code>foldl</code> beats out <code>foldr</code> (1168th place with 75 occurrences vs 1451st place with 58 occurrences).</p>\n<!-- more-->\n\n<hr />\n\n<p>I remember reading in Lisp In Small Pieces that CDR is statistically more often encountered that CAR&hellip; So my final answer is &ldquo;less CARs than CDRs in the source code of PLT&rdquo;</p>\n\n<p>— <em>Adrien, 6 September 2007</em></p>\n\n<hr />\n\n<p>That is a good guess, but it turns out not to be the case. Maybe we just write code where we say (car l) several times in the loop body but only recur in one place, so there&rsquo;s only one (cdr l) but multiple (car l)s. I know some would call that blasphemous programming &hellip;</p>\n\n<p>— <em>Robby, 6 September 2007</em></p>\n\n<hr />\n\n<p>Ok, I&rsquo;ll bite&hellip;</p>\n\n<p>My first thought was: probably some generic variable name, like x. But when I look at a few source fies of my own, I don&rsquo;t see a lot of xs.</p>\n\n<p>I do see a lot more quotes than I expected, though. So, I&rsquo;ll guess quote, though I think it&rsquo;s not a very good guess.</p>\n\n<p>I wouldn&rsquo;t think that car shows up much at all, actually. Maybe a few hundred times?</p>\n\n<p>— <em>Matthew Flatt, 6 September 2007</em></p>\n\n<hr />\n\n<p>quote is not a bad guess. Its up there. x isn&rsquo;t bad either. Neither are at the very top, tho.</p>\n\n<p>— <em>Robby, 6 September 2007</em></p>\n\n<hr />\n\n<p>Urr&hellip; &ldquo;let&rdquo;? Unfortunately, the &ldquo;let\"s are probably going to be diluted by the presence of \"let*&rdquo;. I would probably cast my vote for &ldquo;list&rdquo; or maybe even&hellip; &ldquo;map&rdquo;? No, no, probably not. Okay, my best (bad) guess is &ldquo;list&rdquo;.</p>\n\n<p>— <em>John Clements, 6 September 2007</em></p>\n\n<hr />\n\n<p>let is pretty high but, surprisingly enough, if you add let*&rsquo;s numbers to let, then let does not move in the list! list is a bit lower. Still fairly frequent, but not up there with let or quote. map is even lower than list.</p>\n\n<p>— <em>Robby, 6 September 2007</em></p>\n\n<hr />\n\n<p>My guess would be for <code>define' and</code>quote&rsquo;. But when I run a count I get <code>set!' in the first place.\n\n— *Eli, 6 September 2007*\n\n* * *\n\nYes, that was a joke.  But my count must be different because I got</code>x&rsquo; in the lead. (With a good gap behind it.)</p>\n\n<p>— <em>Eli, 6 September 2007</em></p>\n\n<hr />\n\n<p>Cheater!</p>\n\n<p>Guesses only, please!</p>\n\n<p>— <em>Robby, 6 September 2007</em></p>\n\n<hr />\n\n<p>My (pre-counting) guess was <code>define' or</code>quote&rsquo;. My count showed `x&rsquo; which is Matthew&rsquo;s guess.</p>\n\n<p>— <em>Eli, 6 September 2007</em></p>\n\n<hr />\n\n<p>Okay, we have a winner, then! define tops the list and quote is next.</p>\n\n<p>I&rsquo;ll not reveal the actual numbers yet in case someone actually wants to try to guess them or to guess where car shows up.</p>\n\n<p>— <em>Robby, 6 September 2007</em></p>\n\n<hr />\n\n<p>Ok, I&rsquo;ll guess the car is quite far down the list. Maybe 1% of identifiers, or so. I think with map/fold/etc. and pattern matching car is used quite infrequently.</p>\n\n<p>— <em>Noel, 7 September 2007</em></p>\n\n<hr />\n\n<p>I hadn&rsquo;t thought to count percentages. You&rsquo;re 1/2 right &hellip;. the top of the list is already in the 2% range! Indeed, once you&rsquo;re past define and quote, everything is 1.x percent or less.</p>\n\n<p>car is well above map and none of the folds crack the top 100.</p>\n\n<p>— <em>Robby, 7 September 2007</em></p>\n\n<hr />\n\n<p>Haaa! I lost because of blasphemous programming! :D</p>\n\n<p>— <em>Adrien, 9 September 2007</em></p>\n\n<hr />\n\n<p>:)</p>\n\n<p>You might want to try to verify that hypothesis &mdash; see if there are multiple (car l)s on the same identifier. I&rsquo;m sure one could write a script to count such things&hellip;</p>\n\n<p>— <em>Robby, 9 September 2007</em></p>\n\n<hr />\n\n<p>I presume that the count for quote includes &rsquo;; I can hardly imagine writing quote as an identifier any more, except perhaps in the context &rsquo;quote.</p>\n\n<p>In addition, it&rsquo;s not surprising that foldl beats foldr in an eager language.</p>\n\n<p>— <em>John Cowan, 26 January 2008</em></p>\n\n<hr />\n\n<p>Yes, that&rsquo;s right quote refers to uses to &rsquo; as we all (quote &hellip;)</p>\n\n<p>— <em>Robby, 26 January 2008</em></p>\n\n<hr />")) ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2012-12-22-simple-test-coverage-a-macro-with-line-numbers-and-lifting.md" . unix) f post (u . "Simple Test Coverage: A Macro with Line Numbers and Lifting") (? . 83) 1467223812 (p+ #"/Users/MB/git/racket-lang-org/blog/2012/12/simple-test-coverage-a-macro-with-line-numbers-and-lifting.html" . unix) "/2012/12/simple-test-coverage-a-macro-with-line-numbers-and-lifting.html" (u . "2012-12-22T11:03:00.001-05:00") (? . 127) (? . 82) (c (u . "")) (u . "\n<p><em>posted by Robby Findler</em></p>\n\n<p>Racket&rsquo;s macro system makes it easy to roll your own low-tech line coverage tool. In this post, I&rsquo;ll show how, in 15 lines of code, you can implement a simple test-coverage tool. Using this code is simple: put <code>(line-of-interest)</code> on each line that should be covered.</p>\n\n<p>To start the implementation, we put the code in a module and define two sets:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"kn\">#lang </span><span class=\"nn\">racket</span>\n<span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"n\">candidate-lines</span> <span class=\"p\">(</span><span class=\"nb\">set</span><span class=\"p\">))</span>\n<span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"n\">touched-lines</span> <span class=\"p\">(</span><span class=\"nb\">set</span><span class=\"p\">))</span>\n</pre></div>\n\n</div>\n\n<p>The first set holds the line numbers where <code>(line-of-interest)</code> is written in the source and the second holds the set of line numbers where <code>(line-of-interest)</code> has been executed.</p>\n\n<p>Each use of <code>(line-of-interest)</code> is going to expand into a call to visited with the line number for the source location of that use of <code>(line-of-interest)</code>.</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">visited</span> <span class=\"n\">line</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"k\">unless</span> <span class=\"p\">(</span><span class=\"nb\">set-member?</span> <span class=\"n\">touched-lines</span> <span class=\"n\">line</span><span class=\"p\">)</span>\n    <span class=\"p\">(</span><span class=\"k\">set!</span> <span class=\"n\">touched-lines</span> <span class=\"p\">(</span><span class=\"nb\">set-add</span> <span class=\"n\">touched-lines</span> <span class=\"n\">line</span><span class=\"p\">))</span>\n    <span class=\"p\">(</span><span class=\"nb\">displayln</span>\n     <span class=\"p\">(</span><span class=\"nb\">sort</span> <span class=\"p\">(</span><span class=\"nb\">set-&gt;list</span>\n            <span class=\"p\">(</span><span class=\"nb\">set-subtract</span> <span class=\"n\">candidate-lines</span> <span class=\"n\">touched-lines</span><span class=\"p\">))</span>\n           <span class=\"nb\">&lt;</span><span class=\"p\">))))</span>\n</pre></div>\n\n</div>\n\n<p>This function simply checks to see if this line has been executed before and, if not, removes that line number from touched-lines and prints out the current status.</p>\n\n<p>The interesting part of this code is in the definition of line-of-interest itself:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">define-syntax</span> <span class=\"p\">(</span><span class=\"n\">line-of-interest</span> <span class=\"n\">stx</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"k\">with-syntax</span> <span class=\"p\">([</span><span class=\"n\">line</span> <span class=\"p\">(</span><span class=\"nb\">syntax-line</span> <span class=\"n\">stx</span><span class=\"p\">)])</span>\n    <span class=\"p\">(</span><span class=\"nb\">syntax-local-lift-expression</span>\n     <span class=\"o\">#&#39;</span><span class=\"p\">(</span><span class=\"k\">set!</span> <span class=\"n\">candidate-lines</span> <span class=\"p\">(</span><span class=\"nb\">set-add</span> <span class=\"n\">candidate-lines</span> <span class=\"n\">line</span><span class=\"p\">)))</span>\n    <span class=\"o\">#&#39;</span><span class=\"p\">(</span><span class=\"n\">visited</span> <span class=\"n\">line</span><span class=\"p\">)))</span>\n</pre></div>\n\n</div>\n\n<p>The macro first extracts the line number from stx, which gives the source location for the use of <code>(line-of-interest)</code>. This number is then bound to line for use in building later syntax objects. Then the macro calls syntax-local-lift-expression with a syntax object that updates candidate-lines. Expressions passed to syntax-local-lift-expression are lifted to the top-level of the enclosing module making sure that, in this case, each line number is added exactly once without having to execute the code where <code>(line-of-interest)</code> appears. The macro then discards the result of syntax-local-lift-expression and returns a call to the visited function. That&rsquo;s all there is to it!</p>\n\n<p>I originally used this macro to test some changes to DrRacket. I was working on a set of complex GUI interactions and kept losing track of which ones had been tested and which ones hadn&rsquo;t. Here&rsquo;s a simpler program in the same spirit so you can try it out.</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"kn\">#lang </span><span class=\"nn\">racket/gui</span>\n<span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"n\">candidate-lines</span> <span class=\"p\">(</span><span class=\"nb\">set</span><span class=\"p\">))</span>\n<span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"n\">touched-lines</span> <span class=\"p\">(</span><span class=\"nb\">set</span><span class=\"p\">))</span>\n<span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">visited</span> <span class=\"n\">line</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"k\">unless</span> <span class=\"p\">(</span><span class=\"nb\">set-member?</span> <span class=\"n\">touched-lines</span> <span class=\"n\">line</span><span class=\"p\">)</span>\n    <span class=\"p\">(</span><span class=\"k\">set!</span> <span class=\"n\">touched-lines</span> <span class=\"p\">(</span><span class=\"nb\">set-add</span> <span class=\"n\">touched-lines</span> <span class=\"n\">line</span><span class=\"p\">))</span>\n    <span class=\"p\">(</span><span class=\"nb\">displayln</span>\n     <span class=\"p\">(</span><span class=\"nb\">sort</span> <span class=\"p\">(</span><span class=\"nb\">set-&gt;list</span>\n            <span class=\"p\">(</span><span class=\"nb\">set-subtract</span> <span class=\"n\">candidate-lines</span> <span class=\"n\">touched-lines</span><span class=\"p\">))</span>\n           <span class=\"nb\">&lt;</span><span class=\"p\">))))</span>\n<span class=\"p\">(</span><span class=\"k\">define-syntax</span> <span class=\"p\">(</span><span class=\"n\">line-of-interest</span> <span class=\"n\">stx</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"k\">with-syntax</span> <span class=\"p\">([</span><span class=\"n\">line</span> <span class=\"p\">(</span><span class=\"nb\">syntax-line</span> <span class=\"n\">stx</span><span class=\"p\">)])</span>\n    <span class=\"p\">(</span><span class=\"nb\">syntax-local-lift-expression</span>\n     <span class=\"o\">#&#39;</span><span class=\"p\">(</span><span class=\"k\">set!</span> <span class=\"n\">candidate-lines</span> <span class=\"p\">(</span><span class=\"nb\">set-add</span> <span class=\"n\">candidate-lines</span> <span class=\"n\">line</span><span class=\"p\">)))</span>\n    <span class=\"o\">#&#39;</span><span class=\"p\">(</span><span class=\"n\">visited</span> <span class=\"n\">line</span><span class=\"p\">)))</span>\n \n<span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"n\">f</span> <span class=\"p\">(</span><span class=\"k\">new</span> <span class=\"n\">frame%</span> <span class=\"p\">[</span><span class=\"n\">label</span> <span class=\"s2\">\"\"</span><span class=\"p\">]))</span>\n \n<span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"n\">b1</span> <span class=\"p\">(</span><span class=\"k\">new</span> <span class=\"n\">button%</span>\n                <span class=\"p\">[</span><span class=\"n\">label</span> <span class=\"s2\">\"1\"</span><span class=\"p\">]</span>\n                <span class=\"p\">[</span><span class=\"n\">parent</span> <span class=\"n\">f</span><span class=\"p\">]</span>\n                <span class=\"p\">[</span><span class=\"n\">callback</span>\n                 <span class=\"p\">(</span><span class=\"k\">λ</span> <span class=\"p\">(</span><span class=\"n\">a</span> <span class=\"n\">b</span><span class=\"p\">)</span>\n                   <span class=\"p\">(</span><span class=\"k\">case</span> <span class=\"p\">(</span><span class=\"nb\">random</span> <span class=\"mi\">3</span><span class=\"p\">)</span>\n                     <span class=\"p\">[(</span><span class=\"mi\">0</span><span class=\"p\">)</span>\n                      <span class=\"p\">(</span><span class=\"n\">line-of-interest</span><span class=\"p\">)</span>\n                      <span class=\"p\">(</span><span class=\"k\">send</span> <span class=\"n\">b1</span> <span class=\"n\">set-label</span> <span class=\"s2\">\"one\"</span><span class=\"p\">)]</span>\n                     <span class=\"p\">[(</span><span class=\"mi\">1</span><span class=\"p\">)</span>\n                      <span class=\"p\">(</span><span class=\"n\">line-of-interest</span><span class=\"p\">)</span>\n                      <span class=\"p\">(</span><span class=\"k\">send</span> <span class=\"n\">b1</span> <span class=\"n\">set-label</span> <span class=\"s2\">\"uno\"</span><span class=\"p\">)]</span>\n                     <span class=\"p\">[(</span><span class=\"mi\">2</span><span class=\"p\">)</span>\n                      <span class=\"p\">(</span><span class=\"n\">line-of-interest</span><span class=\"p\">)</span>\n                      <span class=\"p\">(</span><span class=\"k\">send</span> <span class=\"n\">b1</span> <span class=\"n\">set-label</span> <span class=\"s2\">\"一\"</span><span class=\"p\">)]))]))</span>\n \n<span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"n\">b2</span> <span class=\"p\">(</span><span class=\"k\">new</span> <span class=\"n\">button%</span>\n                <span class=\"p\">[</span><span class=\"n\">label</span> <span class=\"s2\">\"2\"</span><span class=\"p\">]</span>\n                <span class=\"p\">[</span><span class=\"n\">parent</span> <span class=\"n\">f</span><span class=\"p\">]</span>\n                <span class=\"p\">[</span><span class=\"n\">callback</span>\n                 <span class=\"p\">(</span><span class=\"k\">λ</span> <span class=\"p\">(</span><span class=\"n\">a</span> <span class=\"n\">b</span><span class=\"p\">)</span>\n                   <span class=\"p\">(</span><span class=\"k\">case</span> <span class=\"p\">(</span><span class=\"nb\">random</span> <span class=\"mi\">3</span><span class=\"p\">)</span>\n                     <span class=\"p\">[(</span><span class=\"mi\">0</span><span class=\"p\">)</span>\n                      <span class=\"p\">(</span><span class=\"n\">line-of-interest</span><span class=\"p\">)</span>\n                      <span class=\"p\">(</span><span class=\"k\">send</span> <span class=\"n\">b2</span> <span class=\"n\">set-label</span> <span class=\"s2\">\"two\"</span><span class=\"p\">)]</span>\n                     <span class=\"p\">[(</span><span class=\"mi\">1</span><span class=\"p\">)</span>\n                      <span class=\"p\">(</span><span class=\"n\">line-of-interest</span><span class=\"p\">)</span>\n                      <span class=\"p\">(</span><span class=\"k\">send</span> <span class=\"n\">b2</span> <span class=\"n\">set-label</span> <span class=\"s2\">\"dos\"</span><span class=\"p\">)]</span>\n                     <span class=\"p\">[(</span><span class=\"mi\">2</span><span class=\"p\">)</span>\n                      <span class=\"p\">(</span><span class=\"n\">line-of-interest</span><span class=\"p\">)</span>\n                      <span class=\"p\">(</span><span class=\"k\">send</span> <span class=\"n\">b2</span> <span class=\"n\">set-label</span> <span class=\"s2\">\"二\"</span><span class=\"p\">)]))]))</span>\n<span class=\"p\">(</span><span class=\"k\">send</span> <span class=\"n\">f</span> <span class=\"n\">show</span> <span class=\"no\">#t</span><span class=\"p\">)</span>\n</pre></div>\n\n</div>") #f (u . "\n<p><em>posted by Robby Findler</em></p>\n\n<p>Racket&rsquo;s macro system makes it easy to roll your own low-tech line coverage tool. In this post, I&rsquo;ll show how, in 15 lines of code, you can implement a simple test-coverage tool. Using this code is simple: put <code>(line-of-interest)</code> on each line that should be covered.</p>\n\n<p>To start the implementation, we put the code in a module and define two sets:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"kn\">#lang </span><span class=\"nn\">racket</span>\n<span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"n\">candidate-lines</span> <span class=\"p\">(</span><span class=\"nb\">set</span><span class=\"p\">))</span>\n<span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"n\">touched-lines</span> <span class=\"p\">(</span><span class=\"nb\">set</span><span class=\"p\">))</span>\n</pre></div>\n\n</div>\n\n<p>The first set holds the line numbers where <code>(line-of-interest)</code> is written in the source and the second holds the set of line numbers where <code>(line-of-interest)</code> has been executed.</p>\n\n<p>Each use of <code>(line-of-interest)</code> is going to expand into a call to visited with the line number for the source location of that use of <code>(line-of-interest)</code>.</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">visited</span> <span class=\"n\">line</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"k\">unless</span> <span class=\"p\">(</span><span class=\"nb\">set-member?</span> <span class=\"n\">touched-lines</span> <span class=\"n\">line</span><span class=\"p\">)</span>\n    <span class=\"p\">(</span><span class=\"k\">set!</span> <span class=\"n\">touched-lines</span> <span class=\"p\">(</span><span class=\"nb\">set-add</span> <span class=\"n\">touched-lines</span> <span class=\"n\">line</span><span class=\"p\">))</span>\n    <span class=\"p\">(</span><span class=\"nb\">displayln</span>\n     <span class=\"p\">(</span><span class=\"nb\">sort</span> <span class=\"p\">(</span><span class=\"nb\">set-&gt;list</span>\n            <span class=\"p\">(</span><span class=\"nb\">set-subtract</span> <span class=\"n\">candidate-lines</span> <span class=\"n\">touched-lines</span><span class=\"p\">))</span>\n           <span class=\"nb\">&lt;</span><span class=\"p\">))))</span>\n</pre></div>\n\n</div>\n\n<p>This function simply checks to see if this line has been executed before and, if not, removes that line number from touched-lines and prints out the current status.</p>\n\n<p>The interesting part of this code is in the definition of line-of-interest itself:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">define-syntax</span> <span class=\"p\">(</span><span class=\"n\">line-of-interest</span> <span class=\"n\">stx</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"k\">with-syntax</span> <span class=\"p\">([</span><span class=\"n\">line</span> <span class=\"p\">(</span><span class=\"nb\">syntax-line</span> <span class=\"n\">stx</span><span class=\"p\">)])</span>\n    <span class=\"p\">(</span><span class=\"nb\">syntax-local-lift-expression</span>\n     <span class=\"o\">#&#39;</span><span class=\"p\">(</span><span class=\"k\">set!</span> <span class=\"n\">candidate-lines</span> <span class=\"p\">(</span><span class=\"nb\">set-add</span> <span class=\"n\">candidate-lines</span> <span class=\"n\">line</span><span class=\"p\">)))</span>\n    <span class=\"o\">#&#39;</span><span class=\"p\">(</span><span class=\"n\">visited</span> <span class=\"n\">line</span><span class=\"p\">)))</span>\n</pre></div>\n\n</div>\n\n<p>The macro first extracts the line number from stx, which gives the source location for the use of <code>(line-of-interest)</code>. This number is then bound to line for use in building later syntax objects. Then the macro calls syntax-local-lift-expression with a syntax object that updates candidate-lines. Expressions passed to syntax-local-lift-expression are lifted to the top-level of the enclosing module making sure that, in this case, each line number is added exactly once without having to execute the code where <code>(line-of-interest)</code> appears. The macro then discards the result of syntax-local-lift-expression and returns a call to the visited function. That&rsquo;s all there is to it!</p>\n\n<p>I originally used this macro to test some changes to DrRacket. I was working on a set of complex GUI interactions and kept losing track of which ones had been tested and which ones hadn&rsquo;t. Here&rsquo;s a simpler program in the same spirit so you can try it out.</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"kn\">#lang </span><span class=\"nn\">racket/gui</span>\n<span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"n\">candidate-lines</span> <span class=\"p\">(</span><span class=\"nb\">set</span><span class=\"p\">))</span>\n<span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"n\">touched-lines</span> <span class=\"p\">(</span><span class=\"nb\">set</span><span class=\"p\">))</span>\n<span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">visited</span> <span class=\"n\">line</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"k\">unless</span> <span class=\"p\">(</span><span class=\"nb\">set-member?</span> <span class=\"n\">touched-lines</span> <span class=\"n\">line</span><span class=\"p\">)</span>\n    <span class=\"p\">(</span><span class=\"k\">set!</span> <span class=\"n\">touched-lines</span> <span class=\"p\">(</span><span class=\"nb\">set-add</span> <span class=\"n\">touched-lines</span> <span class=\"n\">line</span><span class=\"p\">))</span>\n    <span class=\"p\">(</span><span class=\"nb\">displayln</span>\n     <span class=\"p\">(</span><span class=\"nb\">sort</span> <span class=\"p\">(</span><span class=\"nb\">set-&gt;list</span>\n            <span class=\"p\">(</span><span class=\"nb\">set-subtract</span> <span class=\"n\">candidate-lines</span> <span class=\"n\">touched-lines</span><span class=\"p\">))</span>\n           <span class=\"nb\">&lt;</span><span class=\"p\">))))</span>\n<span class=\"p\">(</span><span class=\"k\">define-syntax</span> <span class=\"p\">(</span><span class=\"n\">line-of-interest</span> <span class=\"n\">stx</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"k\">with-syntax</span> <span class=\"p\">([</span><span class=\"n\">line</span> <span class=\"p\">(</span><span class=\"nb\">syntax-line</span> <span class=\"n\">stx</span><span class=\"p\">)])</span>\n    <span class=\"p\">(</span><span class=\"nb\">syntax-local-lift-expression</span>\n     <span class=\"o\">#&#39;</span><span class=\"p\">(</span><span class=\"k\">set!</span> <span class=\"n\">candidate-lines</span> <span class=\"p\">(</span><span class=\"nb\">set-add</span> <span class=\"n\">candidate-lines</span> <span class=\"n\">line</span><span class=\"p\">)))</span>\n    <span class=\"o\">#&#39;</span><span class=\"p\">(</span><span class=\"n\">visited</span> <span class=\"n\">line</span><span class=\"p\">)))</span>\n \n<span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"n\">f</span> <span class=\"p\">(</span><span class=\"k\">new</span> <span class=\"n\">frame%</span> <span class=\"p\">[</span><span class=\"n\">label</span> <span class=\"s2\">\"\"</span><span class=\"p\">]))</span>\n \n<span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"n\">b1</span> <span class=\"p\">(</span><span class=\"k\">new</span> <span class=\"n\">button%</span>\n                <span class=\"p\">[</span><span class=\"n\">label</span> <span class=\"s2\">\"1\"</span><span class=\"p\">]</span>\n                <span class=\"p\">[</span><span class=\"n\">parent</span> <span class=\"n\">f</span><span class=\"p\">]</span>\n                <span class=\"p\">[</span><span class=\"n\">callback</span>\n                 <span class=\"p\">(</span><span class=\"k\">λ</span> <span class=\"p\">(</span><span class=\"n\">a</span> <span class=\"n\">b</span><span class=\"p\">)</span>\n                   <span class=\"p\">(</span><span class=\"k\">case</span> <span class=\"p\">(</span><span class=\"nb\">random</span> <span class=\"mi\">3</span><span class=\"p\">)</span>\n                     <span class=\"p\">[(</span><span class=\"mi\">0</span><span class=\"p\">)</span>\n                      <span class=\"p\">(</span><span class=\"n\">line-of-interest</span><span class=\"p\">)</span>\n                      <span class=\"p\">(</span><span class=\"k\">send</span> <span class=\"n\">b1</span> <span class=\"n\">set-label</span> <span class=\"s2\">\"one\"</span><span class=\"p\">)]</span>\n                     <span class=\"p\">[(</span><span class=\"mi\">1</span><span class=\"p\">)</span>\n                      <span class=\"p\">(</span><span class=\"n\">line-of-interest</span><span class=\"p\">)</span>\n                      <span class=\"p\">(</span><span class=\"k\">send</span> <span class=\"n\">b1</span> <span class=\"n\">set-label</span> <span class=\"s2\">\"uno\"</span><span class=\"p\">)]</span>\n                     <span class=\"p\">[(</span><span class=\"mi\">2</span><span class=\"p\">)</span>\n                      <span class=\"p\">(</span><span class=\"n\">line-of-interest</span><span class=\"p\">)</span>\n                      <span class=\"p\">(</span><span class=\"k\">send</span> <span class=\"n\">b1</span> <span class=\"n\">set-label</span> <span class=\"s2\">\"一\"</span><span class=\"p\">)]))]))</span>\n \n<span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"n\">b2</span> <span class=\"p\">(</span><span class=\"k\">new</span> <span class=\"n\">button%</span>\n                <span class=\"p\">[</span><span class=\"n\">label</span> <span class=\"s2\">\"2\"</span><span class=\"p\">]</span>\n                <span class=\"p\">[</span><span class=\"n\">parent</span> <span class=\"n\">f</span><span class=\"p\">]</span>\n                <span class=\"p\">[</span><span class=\"n\">callback</span>\n                 <span class=\"p\">(</span><span class=\"k\">λ</span> <span class=\"p\">(</span><span class=\"n\">a</span> <span class=\"n\">b</span><span class=\"p\">)</span>\n                   <span class=\"p\">(</span><span class=\"k\">case</span> <span class=\"p\">(</span><span class=\"nb\">random</span> <span class=\"mi\">3</span><span class=\"p\">)</span>\n                     <span class=\"p\">[(</span><span class=\"mi\">0</span><span class=\"p\">)</span>\n                      <span class=\"p\">(</span><span class=\"n\">line-of-interest</span><span class=\"p\">)</span>\n                      <span class=\"p\">(</span><span class=\"k\">send</span> <span class=\"n\">b2</span> <span class=\"n\">set-label</span> <span class=\"s2\">\"two\"</span><span class=\"p\">)]</span>\n                     <span class=\"p\">[(</span><span class=\"mi\">1</span><span class=\"p\">)</span>\n                      <span class=\"p\">(</span><span class=\"n\">line-of-interest</span><span class=\"p\">)</span>\n                      <span class=\"p\">(</span><span class=\"k\">send</span> <span class=\"n\">b2</span> <span class=\"n\">set-label</span> <span class=\"s2\">\"dos\"</span><span class=\"p\">)]</span>\n                     <span class=\"p\">[(</span><span class=\"mi\">2</span><span class=\"p\">)</span>\n                      <span class=\"p\">(</span><span class=\"n\">line-of-interest</span><span class=\"p\">)</span>\n                      <span class=\"p\">(</span><span class=\"k\">send</span> <span class=\"n\">b2</span> <span class=\"n\">set-label</span> <span class=\"s2\">\"二\"</span><span class=\"p\">)]))]))</span>\n<span class=\"p\">(</span><span class=\"k\">send</span> <span class=\"n\">f</span> <span class=\"n\">show</span> <span class=\"no\">#t</span><span class=\"p\">)</span>\n</pre></div>\n\n</div>")) ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2010-01-29-benchmarks.md" . unix) f post (u . "Benchmarks") (? . 119) 1467223812 (p+ #"/Users/MB/git/racket-lang-org/blog/2010/01/benchmarks.html" . unix) "/2010/01/benchmarks.html" (u . "2010-01-29T12:57:00.005-05:00") (? . 63) (? . 118) (c (u . "")) (u . "\n<p><em>posted by Matthew Flatt</em></p>\n\n<p>First, the usual disclaimer:</p>\n\n<p>That said, I&rsquo;ve run the latest version of PLT Scheme on two sets of benchmarks:</p>\n\n<ul>\n <li>\n  <p><a href=\"http://www.cs.utah.edu/%7Emflatt/benchmarks-20100126/log3/Benchmarks.html\">Benchmarks in the PLT sources</a> – vs. Bigloo, Chicken, Gambit, Guile, Ikarus, Larceny, MIT Scheme, and Scheme48; safe operations and generic arithmetic only</p></li>\n <li>\n  <p><a href=\"http://www.cs.utah.edu/%7Emflatt/benchmarks-20100126/log1/Gambit_20benchmarks.html\">Benchmarks in the Gambit sources</a> – vs. Bigloo and Gambit; generic vs. fixnum-/flonum-specific arithmetic, safe vs. unsafe operationsThe second set is why I started running benchmarks. Fixnum-/flonum-specific arithmetic and unsafe operations are new in PLT Scheme 4.2.4. The benchmark results suggest that the new operations in PLT Scheme offer roughly the same performance benefits as in Bigloo and Gambit. There&rsquo;s room for improvement, but it&rsquo;s a good first cut.</p></li></ul>\n\n<p>For the other results: PLT Scheme is rarely the fastest implementation on a given benchmark. For most purposes, though, it&rsquo;s in the same ballpark – except for programs that spend all their time capturing and invoking continuations.</p>\n\n<p>It&rsquo;s fun to run benchmarks occasionally. Now, back to working on language design, libraries, documentation, usability&hellip;</p>") #t (u . "\n<p><em>posted by Matthew Flatt</em></p>\n\n<p>First, the usual disclaimer:</p>\n\n<p>That said, I&rsquo;ve run the latest version of PLT Scheme on two sets of benchmarks:</p>\n\n<ul>\n <li>\n  <p><a href=\"http://www.cs.utah.edu/%7Emflatt/benchmarks-20100126/log3/Benchmarks.html\">Benchmarks in the PLT sources</a> – vs. Bigloo, Chicken, Gambit, Guile, Ikarus, Larceny, MIT Scheme, and Scheme48; safe operations and generic arithmetic only</p></li>\n <li>\n  <p><a href=\"http://www.cs.utah.edu/%7Emflatt/benchmarks-20100126/log1/Gambit_20benchmarks.html\">Benchmarks in the Gambit sources</a> – vs. Bigloo and Gambit; generic vs. fixnum-/flonum-specific arithmetic, safe vs. unsafe operationsThe second set is why I started running benchmarks. Fixnum-/flonum-specific arithmetic and unsafe operations are new in PLT Scheme 4.2.4. The benchmark results suggest that the new operations in PLT Scheme offer roughly the same performance benefits as in Bigloo and Gambit. There&rsquo;s room for improvement, but it&rsquo;s a good first cut.</p></li></ul>\n\n<p>For the other results: PLT Scheme is rarely the fastest implementation on a given benchmark. For most purposes, though, it&rsquo;s in the same ballpark – except for programs that spend all their time capturing and invoking continuations.</p>\n\n<p>It&rsquo;s fun to run benchmarks occasionally. Now, back to working on language design, libraries, documentation, usability&hellip;</p>\n<!-- more-->\n\n<hr />\n\n<p>Could it be possible to add Guile 1.9.7 to that list?</p>\n\n<p>— <em>dales@vxitech.com, 29 January 2010</em></p>\n\n<hr />\n\n<p>Although I don&rsquo;t want to stay in the benchmark-running business, Guile 1.9.7 does seem to be much faster than 1.8.7. So, I&rsquo;ve replaced 1.8.7 with 1.9.7 in the benchmark results.</p>\n\n<p>— <em>Matthew Flatt, 29 January 2010</em></p>\n\n<hr />\n\n<p>Thanks for adding Guile 1.9.7. I wonder though, did you include the runtime for the first Guile run? Guile will compile files the first time they&rsquo;re run, and then used the cached object file later.</p>\n\n<p>I ask because my old slow laptop is getting better times than the ones you list. Perhaps you inadvertantly included that first compilation time.</p>\n\n<p>In any case, congrats on those great PLT results! :)</p>\n\n<p>Happy hacking,</p>\n\n<p>Andy</p>\n\n<p>— <em>Andy Wingo, 30 January 2010</em></p>\n\n<hr />\n\n<p>I don&rsquo;t think that compilation time is included, since run time is measured within the program using <code>(times)'. Also, clearing out the cache before running doesn't seem to give different results than running a second time.\n\n— *Matthew Flatt, 30 January 2010*\n\n* * *\n\nGood point regarding the use of</code>time&rsquo;. Ah well, a Lisp is never finished, is it. Thanks for the response, and happy hacking :)</p>\n\n<p>— <em>Andy Wingo, 30 January 2010</em></p>\n\n<hr />")) ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2009-10-04-plt-scheme-v422.md" . unix) f post (u . "PLT Scheme v4.2.2") (? . 124) 1467223812 (p+ #"/Users/MB/git/racket-lang-org/blog/2009/10/plt-scheme-v422.html" . unix) "/2009/10/plt-scheme-v422.html" (u . "2009-10-04T16:29:00.001-04:00") (? . 98) (? . 123) (c (u . "")) (u . "\n<p><em>posted by Eli Barzilay</em></p>\n\n<p>PLT Scheme version 4.2.2 is now available from <a href=\"http://plt-scheme.org/\"><code>http://plt-scheme.org/</code></a></p>\n\n<ul>\n <li>\n  <p>DrScheme now, by default, compiles all of the files that are loaded when it runs a program and saves the compiled files in the filesystem. This should lead to faster load times (not faster runtimes) since it avoids re-compiling files whose dependencies have not changed.</p></li>\n <li>\n  <p>New Scribble libraries and documentation make it easier to get started with Scribble, especially for uses other than PLT documentation. DrScheme now has better indentation and syntax coloring support for Scribble languages (and generally all @-exp based languages).</p></li>\n <li>\n  <p>The new <code>syntax/keyword</code> library provides support for macros with keyword options. A new quick start guide has been added to the documentation for the <code>syntax/parse</code> library.</p></li>\n <li>\n  <p>Added support for abstract contracts via the #:exists keywords. This is an experiment to add support for data hiding to the contract system.</p></li>\n <li>\n  <p>Added <code>in-producer</code>: a sequence expression makes it easy to iterate over producer functions (e.g., <code>read</code>). A new <code>scheme/generator</code> library creates generators that can use a (parameterized) yield function.</p></li>\n <li>\n  <p>HtDP langs: several primitives now consume 0 and 1 arguments in ISL (and up), including <code>append</code>, <code>+</code> and <code>*</code>. In addition, <code>make-list</code> was added to the primitives.</p></li>\n <li>\n  <p>The API to Universe has a number of new constructs. All Universe programs should run unchanged. The most important change is the addition of <code>animate</code> as an alternative name for <code>run-simulation</code>. In addition, adding the clause <code>(state true)</code> to a world description now pretty-prints the state of the world into a separate canvas.</p></li>\n <li>\n  <p>A number of changes were made to the DeinProgramm / DMdA language levels: The <code>check-property</code> and <code>contract</code> forms were added, <code>define-record-procedures-parametric</code> has changed. See the documentation for details.</p></li>\n <li>\n  <p>The test engine in the HtDP languages no longer warns programmers when the Definitions window has no tests.</p></li>\n <li>\n  <p>ProfessorJ (and related code) is no longer included in the PLT distributions. It may re-appear in the future as a PLaneT package.</p></li></ul>") #f (u . "\n<p><em>posted by Eli Barzilay</em></p>\n\n<p>PLT Scheme version 4.2.2 is now available from <a href=\"http://plt-scheme.org/\"><code>http://plt-scheme.org/</code></a></p>\n\n<ul>\n <li>\n  <p>DrScheme now, by default, compiles all of the files that are loaded when it runs a program and saves the compiled files in the filesystem. This should lead to faster load times (not faster runtimes) since it avoids re-compiling files whose dependencies have not changed.</p></li>\n <li>\n  <p>New Scribble libraries and documentation make it easier to get started with Scribble, especially for uses other than PLT documentation. DrScheme now has better indentation and syntax coloring support for Scribble languages (and generally all @-exp based languages).</p></li>\n <li>\n  <p>The new <code>syntax/keyword</code> library provides support for macros with keyword options. A new quick start guide has been added to the documentation for the <code>syntax/parse</code> library.</p></li>\n <li>\n  <p>Added support for abstract contracts via the #:exists keywords. This is an experiment to add support for data hiding to the contract system.</p></li>\n <li>\n  <p>Added <code>in-producer</code>: a sequence expression makes it easy to iterate over producer functions (e.g., <code>read</code>). A new <code>scheme/generator</code> library creates generators that can use a (parameterized) yield function.</p></li>\n <li>\n  <p>HtDP langs: several primitives now consume 0 and 1 arguments in ISL (and up), including <code>append</code>, <code>+</code> and <code>*</code>. In addition, <code>make-list</code> was added to the primitives.</p></li>\n <li>\n  <p>The API to Universe has a number of new constructs. All Universe programs should run unchanged. The most important change is the addition of <code>animate</code> as an alternative name for <code>run-simulation</code>. In addition, adding the clause <code>(state true)</code> to a world description now pretty-prints the state of the world into a separate canvas.</p></li>\n <li>\n  <p>A number of changes were made to the DeinProgramm / DMdA language levels: The <code>check-property</code> and <code>contract</code> forms were added, <code>define-record-procedures-parametric</code> has changed. See the documentation for details.</p></li>\n <li>\n  <p>The test engine in the HtDP languages no longer warns programmers when the Definitions window has no tests.</p></li>\n <li>\n  <p>ProfessorJ (and related code) is no longer included in the PLT distributions. It may re-appear in the future as a PLaneT package.</p></li></ul>")) ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2007-08-18-plt-scheme-v371.md" . unix) f post (u . "PLT Scheme v371") (? . 105) 1467223812 (p+ #"/Users/MB/git/racket-lang-org/blog/2007/08/plt-scheme-v371.html" . unix) "/2007/08/plt-scheme-v371.html" (u . "2007-08-18T04:00:00.000-04:00") (? . 65) (? . 104) (c (u . "")) (u . "\n<p><em>posted by Eli Barzilay</em></p>\n\n<p>PLT Scheme version 371 is now available from</p>\n\n<p> <a href=\"http://download.plt-scheme.org/\">http://download.plt-scheme.org/</a></p>\n\n<p>This is mostly a bug-fix release.</p>\n\n<p>Changes:</p>\n\n<ul>\n <li>The debugger now works across multiple files and supports &ldquo;step over&rdquo; and &ldquo;step out&rdquo; operations.</li>\n <li>HtDP teachpacks: the world.ss teachpack now exports two add-line functions: one from image.ss and one for adding lines to scenes.</li>\n <li>ProfessorJ now includes a language level between Intermediate and Advanced, Intermediate + access, that includes all of Intermediate and introduces access modifiers and overloading. The language manuals contain the complete details.Feedback Welcome.</li></ul>") #f (u . "\n<p><em>posted by Eli Barzilay</em></p>\n\n<p>PLT Scheme version 371 is now available from</p>\n\n<p> <a href=\"http://download.plt-scheme.org/\">http://download.plt-scheme.org/</a></p>\n\n<p>This is mostly a bug-fix release.</p>\n\n<p>Changes:</p>\n\n<ul>\n <li>The debugger now works across multiple files and supports &ldquo;step over&rdquo; and &ldquo;step out&rdquo; operations.</li>\n <li>HtDP teachpacks: the world.ss teachpack now exports two add-line functions: one from image.ss and one for adding lines to scenes.</li>\n <li>ProfessorJ now includes a language level between Intermediate and Advanced, Intermediate + access, that includes all of Intermediate and introduces access modifiers and overloading. The language manuals contain the complete details.Feedback Welcome.</li></ul>")) ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2009-05-24-explicit-renaming-macros-implicitly.md" . unix) f post (u . "Explicit Renaming Macros; Implicitly") (? . 76) 1467223812 (p+ #"/Users/MB/git/racket-lang-org/blog/2009/05/explicit-renaming-macros-implicitly.html" . unix) "/2009/05/explicit-renaming-macros-implicitly.html" (u . "2009-05-24T03:17:00.004-04:00") (? . 28) (? . 75) (c (u . "")) (u . "\n<p><em>posted by Eli Barzilay</em></p>\n\n<p>It&rsquo;s been one too many times that I hear respectable Schemers talk about how they like explicit renaming macros — not because they&rsquo;re more powerful, but because using them is close to using simple <code>defmacro</code>s. In this post I&rsquo;ll show how you can easily write ER-like macros in PLT, just so I won&rsquo;t need to explain the same thing once again.</p>\n\n<p>Disclaimers:</p>\n\n<ul>\n <li>\n  <p>If you&rsquo;re not interested in ER-macros, then you shouldn&rsquo;t read this.</p></li>\n <li>\n  <p>I&rsquo;m not claiming that ER macros are not respectable, I&rsquo;m just surprised at the knee jerk reaction to <code>syntax-case</code>.</p></li>\n <li>\n  <p>This is not an attempt at providing some portable library or even a PLT library. The intention is to show that <code>syntax-case</code>-style macros are &ldquo;as convenient&rdquo; as ER macros, if you really want to get down to that level.</p></li>\n <li>\n  <p>This is also not an attempt at any kind of formal claim of equivalence in any direction, only a demonstration that you can get the same kind of convenience.</p></li>\n <li>\n  <p>The bottom line here should be just the convenience point, addressed at people who like ER macros for that, and who think that <code>syntax-case</code> macros are somehow magical or that you lose the ability to play with S-expressions.</p></li></ul>\n\n<p>The important fact here is that while PLT&rsquo;s <code>syntax-case</code> macro system does not give you raw S-expressions, what you get is a simple wrapper holding them. A macro is a syntax transformer: a function that consumes a syntax value and returns one. For example:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">define-syntax</span> <span class=\"p\">(</span><span class=\"n\">foo</span> <span class=\"n\">stx</span><span class=\"p\">)</span>\n    <span class=\"o\">#&#39;</span><span class=\"mi\">123</span><span class=\"p\">)</span>\n</pre></div>\n\n</div>\n\n<p>is a macro that always expands to 123 (with <code>#'123</code> being the usual shorthand for <code>(syntax 123)</code>).</p>\n\n<p>A syntax object in PLT Scheme (the input to macro functions) is an S-expression, with some lexical information added — this includes the lexical context (in an opaque form), source location, and a few more things. To be more precise, a syntax value is a nested structure of wrappers holding lists and pairs, holding more wrappers, with identifiers at the leaves, where an identifier is a wrapper holding a symbol. It&rsquo;s easy to strip off all wrappers using <code>syntax-&gt;datum</code> if you like to work with S-expressions, but you <em>don&rsquo;t</em> want to strip it off of identifiers, since that will lose the important gravy. (In fact, the <code>defmacro</code> library works by stripping off all information, even from identifiers, then reconstructing it by trying to match names in the output form with the original input.)</p>\n\n<p>Instead of throwing away all information, what we want to do is preserve identifiers. We can use <code>syntax-&gt;list</code> for this: this is a function that takes a syntax value that contains a list, and strips off the top-level extra information leaving you with a list of syntaxes for the sub-expressions (returning <code>#f</code> if the input syntax does not hold a list). Once we have such a list, we can do the usual kind of processing with it, and when we&rsquo;re done turn the result back into a syntax using <code>datum-&gt;syntax</code> (which &ldquo;borrows&rdquo; the original input expression&rsquo;s information). For example,</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">define-syntax</span> <span class=\"p\">(</span><span class=\"nb\">add1</span> <span class=\"n\">stx</span><span class=\"p\">)</span>\n    <span class=\"p\">(</span><span class=\"k\">let</span> <span class=\"p\">([</span><span class=\"nb\">+</span> <span class=\"o\">#&#39;</span><span class=\"nb\">+</span><span class=\"p\">])</span>\n      <span class=\"p\">(</span><span class=\"nb\">datum-&gt;syntax</span> <span class=\"n\">stx</span> <span class=\"o\">`</span><span class=\"p\">(</span><span class=\"o\">,</span><span class=\"nb\">+</span> <span class=\"mi\">1</span> <span class=\"o\">,@</span><span class=\"p\">(</span><span class=\"nb\">cdr</span> <span class=\"p\">(</span><span class=\"nb\">syntax-&gt;list</span> <span class=\"n\">stx</span><span class=\"p\">)))</span> <span class=\"n\">stx</span><span class=\"p\">)))</span>\n</pre></div>\n\n</div>\n\n<p>That&rsquo;s a very simple example though; if you try something a little more complicated, you quickly find out that all this unwrapping is inconvenient:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">define-syntax</span> <span class=\"p\">(</span><span class=\"n\">mylet</span> <span class=\"n\">stx</span><span class=\"p\">)</span>\n    <span class=\"p\">(</span><span class=\"k\">let</span> <span class=\"p\">([</span><span class=\"n\">*lambda</span> <span class=\"o\">#&#39;</span><span class=\"k\">lambda</span><span class=\"p\">])</span>\n      <span class=\"p\">(</span><span class=\"nb\">datum-&gt;syntax</span>\n       <span class=\"n\">stx</span>\n       <span class=\"o\">`</span><span class=\"p\">((</span><span class=\"o\">,</span><span class=\"n\">*lambda</span> <span class=\"o\">,</span><span class=\"p\">(</span><span class=\"nb\">map</span> <span class=\"p\">(</span><span class=\"k\">lambda</span> <span class=\"p\">(</span><span class=\"n\">x</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"nb\">car</span> <span class=\"p\">(</span><span class=\"nb\">syntax-&gt;list</span> <span class=\"n\">x</span><span class=\"p\">)))</span>\n                         <span class=\"p\">(</span><span class=\"nb\">syntax-&gt;list</span> <span class=\"p\">(</span><span class=\"nb\">cadr</span> <span class=\"p\">(</span><span class=\"nb\">syntax-&gt;list</span> <span class=\"n\">stx</span><span class=\"p\">))))</span>\n                   <span class=\"o\">,@</span><span class=\"p\">(</span><span class=\"nb\">cddr</span> <span class=\"p\">(</span><span class=\"nb\">syntax-&gt;list</span> <span class=\"n\">stx</span><span class=\"p\">)))</span>\n         <span class=\"o\">,@</span><span class=\"p\">(</span><span class=\"nb\">map</span> <span class=\"p\">(</span><span class=\"k\">lambda</span> <span class=\"p\">(</span><span class=\"n\">x</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"nb\">cadr</span> <span class=\"p\">(</span><span class=\"nb\">syntax-&gt;list</span> <span class=\"n\">x</span><span class=\"p\">)))</span>\n                <span class=\"p\">(</span><span class=\"nb\">syntax-&gt;list</span> <span class=\"p\">(</span><span class=\"nb\">cadr</span> <span class=\"p\">(</span><span class=\"nb\">syntax-&gt;list</span> <span class=\"n\">stx</span><span class=\"p\">)))))</span>\n       <span class=\"n\">stx</span><span class=\"p\">)))</span>\n</pre></div>\n\n</div>\n\n<p>(Note also the <code>*lambda</code> that is used to avoid the <code>lambda</code> expressions used in the meta-code.)</p>\n\n<p>What can help here is some helper function that receive a syntax value as its input, and turn all wrapped lists into real lists recursively, but will leave identifiers intact:</p>\n\n<div class=\"brush: (begin-for-syntax\">\n <div class=\"pygments\">\n  <pre>    (define (strip stx)\n      (let ([maybe-list (syntax-&gt;list stx)])\n        ;; syntax-&gt;list returns #f if the syntax is not a list\n        (if maybe-list (map strip maybe-list) stx))))\n</pre></div>\n\n</div>\n\n<p>But as long as we&rsquo;re writing a syntax utility, we can make it do a litte more work: feed the resulting tree to <em>your</em> transformer, grab its result, and do the necessary <code>datum-&gt;syntax</code> voodoo on it:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">begin-for-syntax</span>\n    <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">er-like-transformer</span> <span class=\"n\">transformer</span><span class=\"p\">)</span>\n      <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">strip</span> <span class=\"n\">stx</span><span class=\"p\">)</span>\n        <span class=\"p\">(</span><span class=\"k\">let</span> <span class=\"p\">([</span><span class=\"n\">maybe-list</span> <span class=\"p\">(</span><span class=\"nb\">syntax-&gt;list</span> <span class=\"n\">stx</span><span class=\"p\">)])</span>\n          <span class=\"c1\">;; syntax-&gt;list returns #f if the syntax is not a list</span>\n          <span class=\"p\">(</span><span class=\"k\">if</span> <span class=\"n\">maybe-list</span> <span class=\"p\">(</span><span class=\"nb\">map</span> <span class=\"n\">strip</span> <span class=\"n\">maybe-list</span><span class=\"p\">)</span> <span class=\"n\">stx</span><span class=\"p\">)))</span>\n      <span class=\"p\">(</span><span class=\"k\">lambda</span> <span class=\"p\">(</span><span class=\"n\">stx</span><span class=\"p\">)</span>\n        <span class=\"p\">(</span><span class=\"nb\">datum-&gt;syntax</span> <span class=\"n\">stx</span> <span class=\"p\">(</span><span class=\"n\">transformer</span> <span class=\"p\">(</span><span class=\"n\">strip</span> <span class=\"n\">stx</span><span class=\"p\">))</span> <span class=\"n\">stx</span><span class=\"p\">))))</span>\n</pre></div>\n\n</div>\n\n<p>With this utility defined, the above macro becomes much easier to deal with:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">define-syntax</span> <span class=\"n\">mylet</span>\n    <span class=\"p\">(</span><span class=\"n\">er-like-transformer</span>\n     <span class=\"p\">(</span><span class=\"k\">lambda</span> <span class=\"p\">(</span><span class=\"nb\">exp</span><span class=\"p\">)</span>\n       <span class=\"p\">(</span><span class=\"k\">let</span> <span class=\"p\">((</span><span class=\"n\">vars</span>  <span class=\"p\">(</span><span class=\"nb\">map</span> <span class=\"nb\">car</span> <span class=\"p\">(</span><span class=\"nb\">cadr</span> <span class=\"nb\">exp</span><span class=\"p\">)))</span>\n             <span class=\"p\">(</span><span class=\"n\">inits</span> <span class=\"p\">(</span><span class=\"nb\">map</span> <span class=\"nb\">cadr</span> <span class=\"p\">(</span><span class=\"nb\">cadr</span> <span class=\"nb\">exp</span><span class=\"p\">)))</span>\n             <span class=\"p\">(</span><span class=\"n\">body</span>  <span class=\"p\">(</span><span class=\"nb\">cddr</span> <span class=\"nb\">exp</span><span class=\"p\">)))</span>\n         <span class=\"o\">`</span><span class=\"p\">((</span><span class=\"o\">,</span><span class=\"p\">(</span><span class=\"k\">syntax</span> <span class=\"k\">lambda</span><span class=\"p\">)</span> <span class=\"o\">,</span><span class=\"n\">vars</span> <span class=\"o\">,@</span><span class=\"n\">body</span><span class=\"p\">)</span>\n           <span class=\"o\">,@</span><span class=\"n\">inits</span><span class=\"p\">)))))</span>\n <span class=\"o\">```</span>\n\n <span class=\"ss\">...and</span> <span class=\"k\">this</span> <span class=\"n\">is</span> <span class=\"n\">almost</span> <span class=\"n\">identical</span> <span class=\"n\">to</span> <span class=\"n\">the</span> <span class=\"n\">explicit</span> <span class=\"n\">renaming</span> <span class=\"nb\">version</span> <span class=\"n\">of</span> <span class=\"n\">the</span> <span class=\"n\">macro</span><span class=\"c1\">; for example, compare it with the sample code in the [MIT-Scheme manual](http://groups.csail.mit.edu/mac/projects/scheme/documentation/scheme_3.html#SEC49).  The only change is that `(rename &#39;lambda)` is replaced with `(syntax lambda)`.</span>\n\n<span class=\"n\">Obviously</span><span class=\"o\">,</span> <span class=\"k\">this</span> <span class=\"n\">is</span> <span class=\"n\">very</span> <span class=\"n\">close</span><span class=\"o\">,</span> <span class=\"n\">but</span> <span class=\"n\">doesn</span><span class=\"o\">&#39;</span><span class=\"ss\">t</span> <span class=\"n\">show</span> <span class=\"n\">intentional</span> <span class=\"n\">captures.</span>  <span class=\"n\">So</span> <span class=\"n\">I</span> <span class=\"n\">just</span> <span class=\"n\">grabbed</span> <span class=\"n\">the</span> <span class=\"o\">`</span><span class=\"ss\">loop</span><span class=\"o\">`</span> <span class=\"ss\">example</span> <span class=\"n\">from</span> <span class=\"n\">the</span> <span class=\"n\">same</span> <span class=\"n\">page</span><span class=\"o\">,</span> <span class=\"k\">and</span> <span class=\"n\">did</span> <span class=\"n\">the</span> <span class=\"n\">same</span> <span class=\"n\">change</span> <span class=\"n\">—</span> <span class=\"k\">only</span> <span class=\"k\">this</span> <span class=\"k\">time</span> <span class=\"n\">I</span> <span class=\"n\">used</span> <span class=\"o\">`#&#39;</span><span class=\"ss\">foo</span><span class=\"o\">`</span> <span class=\"ss\">instead</span> <span class=\"n\">of</span> <span class=\"o\">`</span><span class=\"p\">(</span><span class=\"ss\">syntax</span> <span class=\"ss\">foo</span><span class=\"p\">)</span><span class=\"o\">`</span> <span class=\"p\">(</span><span class=\"ss\">and</span> <span class=\"ss\">I</span> <span class=\"ss\">also</span> <span class=\"ss\">changed</span> <span class=\"ss\">the</span> <span class=\"ss\">one-sided</span> <span class=\"o\">`</span><span class=\"ss\">if</span><span class=\"o\">`</span> <span class=\"ss\">to</span> <span class=\"ss\">a</span> <span class=\"o\">`</span><span class=\"ss\">when</span><span class=\"o\">`</span><span class=\"p\">)</span><span class=\"o\">.</span>  <span class=\"n\">The</span> <span class=\"n\">resulting</span> <span class=\"n\">macro</span> <span class=\"n\">works</span> <span class=\"n\">fine:</span>  \n\n<span class=\"o\">```</span><span class=\"ss\">racket</span>\n<span class=\"p\">(</span><span class=\"k\">define-syntax</span> <span class=\"n\">loop</span>\n    <span class=\"p\">(</span><span class=\"n\">er-like-transformer</span>\n     <span class=\"p\">(</span><span class=\"k\">lambda</span> <span class=\"p\">(</span><span class=\"n\">x</span><span class=\"p\">)</span>\n       <span class=\"p\">(</span><span class=\"k\">let</span> <span class=\"p\">((</span><span class=\"n\">body</span> <span class=\"p\">(</span><span class=\"nb\">cdr</span> <span class=\"n\">x</span><span class=\"p\">)))</span>\n         <span class=\"o\">`</span><span class=\"p\">(</span><span class=\"o\">,#&#39;</span><span class=\"nb\">call-with-current-continuation</span>\n           <span class=\"p\">(</span><span class=\"o\">,#&#39;</span><span class=\"k\">lambda</span> <span class=\"p\">(</span><span class=\"ss\">exit</span><span class=\"p\">)</span>\n            <span class=\"p\">(</span><span class=\"o\">,#&#39;</span><span class=\"k\">let</span> <span class=\"o\">,#&#39;</span><span class=\"n\">f</span> <span class=\"p\">()</span> <span class=\"o\">,@</span><span class=\"n\">body</span> <span class=\"p\">(</span><span class=\"o\">,#&#39;</span><span class=\"n\">f</span><span class=\"p\">))))))))</span>\n  \n  <span class=\"p\">(</span><span class=\"k\">define-syntax</span> <span class=\"n\">while</span>\n    <span class=\"p\">(</span><span class=\"k\">syntax-rules</span> <span class=\"p\">()</span>\n      <span class=\"p\">((</span><span class=\"n\">while</span> <span class=\"n\">test</span> <span class=\"n\">body</span> <span class=\"k\">...</span><span class=\"p\">)</span>\n       <span class=\"p\">(</span><span class=\"n\">loop</span> <span class=\"p\">(</span><span class=\"k\">when</span> <span class=\"p\">(</span><span class=\"nb\">not</span> <span class=\"n\">test</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"nb\">exit</span> <span class=\"no\">#f</span><span class=\"p\">))</span>\n             <span class=\"n\">body</span> <span class=\"k\">...</span><span class=\"p\">))))</span>\n  \n  <span class=\"p\">(</span><span class=\"k\">let</span> <span class=\"p\">((</span><span class=\"n\">x</span> <span class=\"mi\">10</span><span class=\"p\">))</span>\n    <span class=\"p\">(</span><span class=\"n\">while</span> <span class=\"p\">(</span><span class=\"nb\">&gt;</span> <span class=\"n\">x</span> <span class=\"mi\">0</span><span class=\"p\">)</span>\n      <span class=\"p\">(</span><span class=\"nb\">printf</span> <span class=\"s2\">\"~s</span><span class=\"se\">\\n</span><span class=\"s2\">\"</span> <span class=\"n\">x</span><span class=\"p\">)</span>\n      <span class=\"p\">(</span><span class=\"k\">set!</span> <span class=\"n\">x</span> <span class=\"p\">(</span><span class=\"nb\">-</span> <span class=\"n\">x</span> <span class=\"mi\">1</span><span class=\"p\">))))</span>\n</pre></div>\n\n</div>\n\n<p>This is pretty close to a library, and indeed, as I was writing this text I found <a href=\"http://www.mail-archive.com/larceny-users@lists.ccs.neu.edu/msg00097.html\">a post by Andre van Tonder</a> on the Larceny mailing list that uses a very similar approach and <em>does</em> make a library out of it. This is done by adding two arguments to the expected ER-transformation function — one is a <code>rename</code> function (since the above method uses <code>syntax</code> it is limited to immediate identifiers), and the other is always passed as <code>free-identifier=?</code>. Such a compatibility library is, however, not the purpose of this post.</p>\n\n<p>Finally, there is still a minor issue with this — PLT has an implicit <code>#%app</code> which is used wherever there are parentheses that stand for a function application — and in this code they are used unhygienically. This is usually not a noticeable problem, and if it is, you can add explicit <code>#%app</code>s. It might also be possible to find a more proper solution (e.g., use a hash table to keep track of lists that were disassembled by the client transformer), but at this point it might be better to just use the more natural <code>syntax-case</code> anyway.</p>") #t (u . "\n<p><em>posted by Eli Barzilay</em></p>\n\n<p>It&rsquo;s been one too many times that I hear respectable Schemers talk about how they like explicit renaming macros — not because they&rsquo;re more powerful, but because using them is close to using simple <code>defmacro</code>s. In this post I&rsquo;ll show how you can easily write ER-like macros in PLT, just so I won&rsquo;t need to explain the same thing once again.</p>\n\n<p>Disclaimers:</p>\n\n<ul>\n <li>\n  <p>If you&rsquo;re not interested in ER-macros, then you shouldn&rsquo;t read this.</p></li>\n <li>\n  <p>I&rsquo;m not claiming that ER macros are not respectable, I&rsquo;m just surprised at the knee jerk reaction to <code>syntax-case</code>.</p></li>\n <li>\n  <p>This is not an attempt at providing some portable library or even a PLT library. The intention is to show that <code>syntax-case</code>-style macros are &ldquo;as convenient&rdquo; as ER macros, if you really want to get down to that level.</p></li>\n <li>\n  <p>This is also not an attempt at any kind of formal claim of equivalence in any direction, only a demonstration that you can get the same kind of convenience.</p></li>\n <li>\n  <p>The bottom line here should be just the convenience point, addressed at people who like ER macros for that, and who think that <code>syntax-case</code> macros are somehow magical or that you lose the ability to play with S-expressions.</p></li></ul>\n\n<p>The important fact here is that while PLT&rsquo;s <code>syntax-case</code> macro system does not give you raw S-expressions, what you get is a simple wrapper holding them. A macro is a syntax transformer: a function that consumes a syntax value and returns one. For example:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">define-syntax</span> <span class=\"p\">(</span><span class=\"n\">foo</span> <span class=\"n\">stx</span><span class=\"p\">)</span>\n    <span class=\"o\">#&#39;</span><span class=\"mi\">123</span><span class=\"p\">)</span>\n</pre></div>\n\n</div>\n\n<p>is a macro that always expands to 123 (with <code>#'123</code> being the usual shorthand for <code>(syntax 123)</code>).</p>\n\n<p>A syntax object in PLT Scheme (the input to macro functions) is an S-expression, with some lexical information added — this includes the lexical context (in an opaque form), source location, and a few more things. To be more precise, a syntax value is a nested structure of wrappers holding lists and pairs, holding more wrappers, with identifiers at the leaves, where an identifier is a wrapper holding a symbol. It&rsquo;s easy to strip off all wrappers using <code>syntax-&gt;datum</code> if you like to work with S-expressions, but you <em>don&rsquo;t</em> want to strip it off of identifiers, since that will lose the important gravy. (In fact, the <code>defmacro</code> library works by stripping off all information, even from identifiers, then reconstructing it by trying to match names in the output form with the original input.)</p>\n\n<p>Instead of throwing away all information, what we want to do is preserve identifiers. We can use <code>syntax-&gt;list</code> for this: this is a function that takes a syntax value that contains a list, and strips off the top-level extra information leaving you with a list of syntaxes for the sub-expressions (returning <code>#f</code> if the input syntax does not hold a list). Once we have such a list, we can do the usual kind of processing with it, and when we&rsquo;re done turn the result back into a syntax using <code>datum-&gt;syntax</code> (which &ldquo;borrows&rdquo; the original input expression&rsquo;s information). For example,</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">define-syntax</span> <span class=\"p\">(</span><span class=\"nb\">add1</span> <span class=\"n\">stx</span><span class=\"p\">)</span>\n    <span class=\"p\">(</span><span class=\"k\">let</span> <span class=\"p\">([</span><span class=\"nb\">+</span> <span class=\"o\">#&#39;</span><span class=\"nb\">+</span><span class=\"p\">])</span>\n      <span class=\"p\">(</span><span class=\"nb\">datum-&gt;syntax</span> <span class=\"n\">stx</span> <span class=\"o\">`</span><span class=\"p\">(</span><span class=\"o\">,</span><span class=\"nb\">+</span> <span class=\"mi\">1</span> <span class=\"o\">,@</span><span class=\"p\">(</span><span class=\"nb\">cdr</span> <span class=\"p\">(</span><span class=\"nb\">syntax-&gt;list</span> <span class=\"n\">stx</span><span class=\"p\">)))</span> <span class=\"n\">stx</span><span class=\"p\">)))</span>\n</pre></div>\n\n</div>\n\n<p>That&rsquo;s a very simple example though; if you try something a little more complicated, you quickly find out that all this unwrapping is inconvenient:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">define-syntax</span> <span class=\"p\">(</span><span class=\"n\">mylet</span> <span class=\"n\">stx</span><span class=\"p\">)</span>\n    <span class=\"p\">(</span><span class=\"k\">let</span> <span class=\"p\">([</span><span class=\"n\">*lambda</span> <span class=\"o\">#&#39;</span><span class=\"k\">lambda</span><span class=\"p\">])</span>\n      <span class=\"p\">(</span><span class=\"nb\">datum-&gt;syntax</span>\n       <span class=\"n\">stx</span>\n       <span class=\"o\">`</span><span class=\"p\">((</span><span class=\"o\">,</span><span class=\"n\">*lambda</span> <span class=\"o\">,</span><span class=\"p\">(</span><span class=\"nb\">map</span> <span class=\"p\">(</span><span class=\"k\">lambda</span> <span class=\"p\">(</span><span class=\"n\">x</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"nb\">car</span> <span class=\"p\">(</span><span class=\"nb\">syntax-&gt;list</span> <span class=\"n\">x</span><span class=\"p\">)))</span>\n                         <span class=\"p\">(</span><span class=\"nb\">syntax-&gt;list</span> <span class=\"p\">(</span><span class=\"nb\">cadr</span> <span class=\"p\">(</span><span class=\"nb\">syntax-&gt;list</span> <span class=\"n\">stx</span><span class=\"p\">))))</span>\n                   <span class=\"o\">,@</span><span class=\"p\">(</span><span class=\"nb\">cddr</span> <span class=\"p\">(</span><span class=\"nb\">syntax-&gt;list</span> <span class=\"n\">stx</span><span class=\"p\">)))</span>\n         <span class=\"o\">,@</span><span class=\"p\">(</span><span class=\"nb\">map</span> <span class=\"p\">(</span><span class=\"k\">lambda</span> <span class=\"p\">(</span><span class=\"n\">x</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"nb\">cadr</span> <span class=\"p\">(</span><span class=\"nb\">syntax-&gt;list</span> <span class=\"n\">x</span><span class=\"p\">)))</span>\n                <span class=\"p\">(</span><span class=\"nb\">syntax-&gt;list</span> <span class=\"p\">(</span><span class=\"nb\">cadr</span> <span class=\"p\">(</span><span class=\"nb\">syntax-&gt;list</span> <span class=\"n\">stx</span><span class=\"p\">)))))</span>\n       <span class=\"n\">stx</span><span class=\"p\">)))</span>\n</pre></div>\n\n</div>\n\n<p>(Note also the <code>*lambda</code> that is used to avoid the <code>lambda</code> expressions used in the meta-code.)</p>\n\n<p>What can help here is some helper function that receive a syntax value as its input, and turn all wrapped lists into real lists recursively, but will leave identifiers intact:</p>\n\n<div class=\"brush: (begin-for-syntax\">\n <div class=\"pygments\">\n  <pre>    (define (strip stx)\n      (let ([maybe-list (syntax-&gt;list stx)])\n        ;; syntax-&gt;list returns #f if the syntax is not a list\n        (if maybe-list (map strip maybe-list) stx))))\n</pre></div>\n\n</div>\n\n<p>But as long as we&rsquo;re writing a syntax utility, we can make it do a litte more work: feed the resulting tree to <em>your</em> transformer, grab its result, and do the necessary <code>datum-&gt;syntax</code> voodoo on it:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">begin-for-syntax</span>\n    <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">er-like-transformer</span> <span class=\"n\">transformer</span><span class=\"p\">)</span>\n      <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">strip</span> <span class=\"n\">stx</span><span class=\"p\">)</span>\n        <span class=\"p\">(</span><span class=\"k\">let</span> <span class=\"p\">([</span><span class=\"n\">maybe-list</span> <span class=\"p\">(</span><span class=\"nb\">syntax-&gt;list</span> <span class=\"n\">stx</span><span class=\"p\">)])</span>\n          <span class=\"c1\">;; syntax-&gt;list returns #f if the syntax is not a list</span>\n          <span class=\"p\">(</span><span class=\"k\">if</span> <span class=\"n\">maybe-list</span> <span class=\"p\">(</span><span class=\"nb\">map</span> <span class=\"n\">strip</span> <span class=\"n\">maybe-list</span><span class=\"p\">)</span> <span class=\"n\">stx</span><span class=\"p\">)))</span>\n      <span class=\"p\">(</span><span class=\"k\">lambda</span> <span class=\"p\">(</span><span class=\"n\">stx</span><span class=\"p\">)</span>\n        <span class=\"p\">(</span><span class=\"nb\">datum-&gt;syntax</span> <span class=\"n\">stx</span> <span class=\"p\">(</span><span class=\"n\">transformer</span> <span class=\"p\">(</span><span class=\"n\">strip</span> <span class=\"n\">stx</span><span class=\"p\">))</span> <span class=\"n\">stx</span><span class=\"p\">))))</span>\n</pre></div>\n\n</div>\n\n<p>With this utility defined, the above macro becomes much easier to deal with:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">define-syntax</span> <span class=\"n\">mylet</span>\n    <span class=\"p\">(</span><span class=\"n\">er-like-transformer</span>\n     <span class=\"p\">(</span><span class=\"k\">lambda</span> <span class=\"p\">(</span><span class=\"nb\">exp</span><span class=\"p\">)</span>\n       <span class=\"p\">(</span><span class=\"k\">let</span> <span class=\"p\">((</span><span class=\"n\">vars</span>  <span class=\"p\">(</span><span class=\"nb\">map</span> <span class=\"nb\">car</span> <span class=\"p\">(</span><span class=\"nb\">cadr</span> <span class=\"nb\">exp</span><span class=\"p\">)))</span>\n             <span class=\"p\">(</span><span class=\"n\">inits</span> <span class=\"p\">(</span><span class=\"nb\">map</span> <span class=\"nb\">cadr</span> <span class=\"p\">(</span><span class=\"nb\">cadr</span> <span class=\"nb\">exp</span><span class=\"p\">)))</span>\n             <span class=\"p\">(</span><span class=\"n\">body</span>  <span class=\"p\">(</span><span class=\"nb\">cddr</span> <span class=\"nb\">exp</span><span class=\"p\">)))</span>\n         <span class=\"o\">`</span><span class=\"p\">((</span><span class=\"o\">,</span><span class=\"p\">(</span><span class=\"k\">syntax</span> <span class=\"k\">lambda</span><span class=\"p\">)</span> <span class=\"o\">,</span><span class=\"n\">vars</span> <span class=\"o\">,@</span><span class=\"n\">body</span><span class=\"p\">)</span>\n           <span class=\"o\">,@</span><span class=\"n\">inits</span><span class=\"p\">)))))</span>\n <span class=\"o\">```</span>\n\n <span class=\"ss\">...and</span> <span class=\"k\">this</span> <span class=\"n\">is</span> <span class=\"n\">almost</span> <span class=\"n\">identical</span> <span class=\"n\">to</span> <span class=\"n\">the</span> <span class=\"n\">explicit</span> <span class=\"n\">renaming</span> <span class=\"nb\">version</span> <span class=\"n\">of</span> <span class=\"n\">the</span> <span class=\"n\">macro</span><span class=\"c1\">; for example, compare it with the sample code in the [MIT-Scheme manual](http://groups.csail.mit.edu/mac/projects/scheme/documentation/scheme_3.html#SEC49).  The only change is that `(rename &#39;lambda)` is replaced with `(syntax lambda)`.</span>\n\n<span class=\"n\">Obviously</span><span class=\"o\">,</span> <span class=\"k\">this</span> <span class=\"n\">is</span> <span class=\"n\">very</span> <span class=\"n\">close</span><span class=\"o\">,</span> <span class=\"n\">but</span> <span class=\"n\">doesn</span><span class=\"o\">&#39;</span><span class=\"ss\">t</span> <span class=\"n\">show</span> <span class=\"n\">intentional</span> <span class=\"n\">captures.</span>  <span class=\"n\">So</span> <span class=\"n\">I</span> <span class=\"n\">just</span> <span class=\"n\">grabbed</span> <span class=\"n\">the</span> <span class=\"o\">`</span><span class=\"ss\">loop</span><span class=\"o\">`</span> <span class=\"ss\">example</span> <span class=\"n\">from</span> <span class=\"n\">the</span> <span class=\"n\">same</span> <span class=\"n\">page</span><span class=\"o\">,</span> <span class=\"k\">and</span> <span class=\"n\">did</span> <span class=\"n\">the</span> <span class=\"n\">same</span> <span class=\"n\">change</span> <span class=\"n\">—</span> <span class=\"k\">only</span> <span class=\"k\">this</span> <span class=\"k\">time</span> <span class=\"n\">I</span> <span class=\"n\">used</span> <span class=\"o\">`#&#39;</span><span class=\"ss\">foo</span><span class=\"o\">`</span> <span class=\"ss\">instead</span> <span class=\"n\">of</span> <span class=\"o\">`</span><span class=\"p\">(</span><span class=\"ss\">syntax</span> <span class=\"ss\">foo</span><span class=\"p\">)</span><span class=\"o\">`</span> <span class=\"p\">(</span><span class=\"ss\">and</span> <span class=\"ss\">I</span> <span class=\"ss\">also</span> <span class=\"ss\">changed</span> <span class=\"ss\">the</span> <span class=\"ss\">one-sided</span> <span class=\"o\">`</span><span class=\"ss\">if</span><span class=\"o\">`</span> <span class=\"ss\">to</span> <span class=\"ss\">a</span> <span class=\"o\">`</span><span class=\"ss\">when</span><span class=\"o\">`</span><span class=\"p\">)</span><span class=\"o\">.</span>  <span class=\"n\">The</span> <span class=\"n\">resulting</span> <span class=\"n\">macro</span> <span class=\"n\">works</span> <span class=\"n\">fine:</span>  \n\n<span class=\"o\">```</span><span class=\"ss\">racket</span>\n<span class=\"p\">(</span><span class=\"k\">define-syntax</span> <span class=\"n\">loop</span>\n    <span class=\"p\">(</span><span class=\"n\">er-like-transformer</span>\n     <span class=\"p\">(</span><span class=\"k\">lambda</span> <span class=\"p\">(</span><span class=\"n\">x</span><span class=\"p\">)</span>\n       <span class=\"p\">(</span><span class=\"k\">let</span> <span class=\"p\">((</span><span class=\"n\">body</span> <span class=\"p\">(</span><span class=\"nb\">cdr</span> <span class=\"n\">x</span><span class=\"p\">)))</span>\n         <span class=\"o\">`</span><span class=\"p\">(</span><span class=\"o\">,#&#39;</span><span class=\"nb\">call-with-current-continuation</span>\n           <span class=\"p\">(</span><span class=\"o\">,#&#39;</span><span class=\"k\">lambda</span> <span class=\"p\">(</span><span class=\"ss\">exit</span><span class=\"p\">)</span>\n            <span class=\"p\">(</span><span class=\"o\">,#&#39;</span><span class=\"k\">let</span> <span class=\"o\">,#&#39;</span><span class=\"n\">f</span> <span class=\"p\">()</span> <span class=\"o\">,@</span><span class=\"n\">body</span> <span class=\"p\">(</span><span class=\"o\">,#&#39;</span><span class=\"n\">f</span><span class=\"p\">))))))))</span>\n  \n  <span class=\"p\">(</span><span class=\"k\">define-syntax</span> <span class=\"n\">while</span>\n    <span class=\"p\">(</span><span class=\"k\">syntax-rules</span> <span class=\"p\">()</span>\n      <span class=\"p\">((</span><span class=\"n\">while</span> <span class=\"n\">test</span> <span class=\"n\">body</span> <span class=\"k\">...</span><span class=\"p\">)</span>\n       <span class=\"p\">(</span><span class=\"n\">loop</span> <span class=\"p\">(</span><span class=\"k\">when</span> <span class=\"p\">(</span><span class=\"nb\">not</span> <span class=\"n\">test</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"nb\">exit</span> <span class=\"no\">#f</span><span class=\"p\">))</span>\n             <span class=\"n\">body</span> <span class=\"k\">...</span><span class=\"p\">))))</span>\n  \n  <span class=\"p\">(</span><span class=\"k\">let</span> <span class=\"p\">((</span><span class=\"n\">x</span> <span class=\"mi\">10</span><span class=\"p\">))</span>\n    <span class=\"p\">(</span><span class=\"n\">while</span> <span class=\"p\">(</span><span class=\"nb\">&gt;</span> <span class=\"n\">x</span> <span class=\"mi\">0</span><span class=\"p\">)</span>\n      <span class=\"p\">(</span><span class=\"nb\">printf</span> <span class=\"s2\">\"~s</span><span class=\"se\">\\n</span><span class=\"s2\">\"</span> <span class=\"n\">x</span><span class=\"p\">)</span>\n      <span class=\"p\">(</span><span class=\"k\">set!</span> <span class=\"n\">x</span> <span class=\"p\">(</span><span class=\"nb\">-</span> <span class=\"n\">x</span> <span class=\"mi\">1</span><span class=\"p\">))))</span>\n</pre></div>\n\n</div>\n\n<p>This is pretty close to a library, and indeed, as I was writing this text I found <a href=\"http://www.mail-archive.com/larceny-users@lists.ccs.neu.edu/msg00097.html\">a post by Andre van Tonder</a> on the Larceny mailing list that uses a very similar approach and <em>does</em> make a library out of it. This is done by adding two arguments to the expected ER-transformation function — one is a <code>rename</code> function (since the above method uses <code>syntax</code> it is limited to immediate identifiers), and the other is always passed as <code>free-identifier=?</code>. Such a compatibility library is, however, not the purpose of this post.</p>\n\n<p>Finally, there is still a minor issue with this — PLT has an implicit <code>#%app</code> which is used wherever there are parentheses that stand for a function application — and in this code they are used unhygienically. This is usually not a noticeable problem, and if it is, you can add explicit <code>#%app</code>s. It might also be possible to find a more proper solution (e.g., use a hash table to keep track of lists that were disassembled by the client transformer), but at this point it might be better to just use the more natural <code>syntax-case</code> anyway.</p>\n<!-- more-->\n\n<hr />\n\n<p>turing tarpit? next corner right and there you are ;)</p>\n\n<p>As you are quite aware, your &ldquo;solution&rdquo; changes the cost of macro-expansion to quadric. This is in constrast to linear cost for native syntax-case AND native ER-macros. As it is quite possible to implement syntax-case in terms of ER-transformers (or syntactic-closures) without loosing the linear complexity, many people claim that these two are more basic than syntax-case &hellip; and therefore should be in the actual standard.</p>\n\n<p>Whats your opinion eli?</p>\n\n<p>— <em>derSlom, 24 May 2009</em></p>\n\n<hr />\n\n<p>to also add useful something besides nitpicking, I have been down that road as well: http://paste.lisp.org/display/41754</p>\n\n<p>— <em>derSlom, 24 May 2009</em></p>\n\n<hr />\n\n<p>Although I don&rsquo;t know of any formal proofs of this, I don&rsquo;t believe that either ER or syntactic closures can express syntax case, nor can syntax case (in the original formulation) express ER.</p>\n\n<p>Also, ER really doesn&rsquo;t have a clear specification, so it&rsquo;s hard to make sure that an ER implementation that matches the original note works with actual code.</p>\n\n<p>— <em>Sam TH, 24 May 2009</em></p>\n\n<hr />\n\n<p>derSlom: Yes, it is a demonstration of how to do ER-style for people who like that for the listed reason, and as a demonstration that syntax values don&rsquo;t require black magic, it&rsquo;s not a complete library. Expanding it into a library will require adding a hash table to (1) unwrap each syntax value once and get the cost loss back, and (2) to associate each unwrapped list with the lost syntactic information (which, I think, will also solve the `#%app&rsquo; problem). BTW, unlike your code, I&rsquo;m talking about a persistent hash, allowing you to add information to existing syntax values.</p>\n\n<p>Sam: that sounds right, but I explicitly avoided that too. I do think, though, that it&rsquo;s possible to express ER using something like the above &mdash; even with #%app.</p>\n\n<p>— <em>Eli Barzilay, 24 May 2009</em></p>\n\n<hr />")) ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2012-10-24-the-3n1-problem.md" . unix) f post (u . "The 3n+1 problem") (? . 128) 1467223812 (p+ #"/Users/MB/git/racket-lang-org/blog/2012/10/the-3n1-problem.html" . unix) "/2012/10/the-3n1-problem.html" (u . "2012-10-24T17:46:00.002-04:00") (? . 129) (? . 113) (c (u . "")) (u . "\n<p><em>posted by Danny Yoo</em></p>\n\n<p>1<code>Introduction: \nI’m starting to go through\n[Programming\nChallenges: The Programming Contest Training Manual](http://www.amazon.com/exec/obidos/ASIN/0387001638/thealgorithmrepo), by Steven S. Skiena and\nMiguel Revilla.  I thought it would be fun to show how to approach the problems\nusing the [Racket](http://racket-lang.org/) programming language.  Rather\nthan use a small, toy educational subset of the language, I’ll take off the kid\ngloves, and use whatever’s available in\n[#lang racket](http://docs.racket-lang.org/guide/index.html).\n\n\n2</code>The problem:</p>\n\n<p>The <a href=\"http://acm.uva.es/p/v1/100.html\">3n+1</a> problem is as follows: consider a positive number n. The cycle length of n is the number of times we repeat the following, until we reach n=1:</p>\n\n<ul>\n <li>\n  <p>If n is odd, then n ⇐ 3n+1</p></li>\n <li>\n  <p>If n is even, then n ⇐ n/2</p></li></ul>\n\n<p>For example, given n=22, we see the following sequence: 22 11 34 17 52 26 13 40 20 10 5 16 8 4 2 1. The cycle length of 22 is, therefore, 16, since it took 16 repetitions to get to 1.</p>\n\n<p>Given a definition of cycle length of a number, here’s the rest of the problem: given any two numbers i and j, compute the maximum cycle length over all numbers between i and j, inclusive.</p>\n\n<p>2.1<code>The plan: \nBefore we do any real coding, let’s figure out a plan of attack and how to test\nthat plan.\n\n\n\n* We need a way of computing cycle-length.\n\n* We need to run cycle-length over a range of values and pick out the biggest result.\n\nIt sounds like we may want a function called cycle-length that will\ncompute how long it takes for us to get n to 1.  If we have\ncycle-length as a helper function, then it becomes a fairly direct\nloop through the range between i and j to pick out which one produces the\nlargest cycle length.\n\nLet’s first write up a stub function that computes some nonsense.  We’ll\ncorrect it in a moment, of course!\n\n\n\n;cycle-length: positive-integer -&gt; positive-integer\n;Computes the cycle length of n, according to\n;the 3n+1 rules.\n\n&gt; (define(cycle-lengthn)\n42)\n\n\n\n\n\n\n\n\nThis is certainly not right, but it’s a start.  And it’s something we can test!\n\n\n3</code>Test cases:</p>\n\n<p>We want</p>\n\n<p>(cycle-length1)==&gt;1</p>\n\n<p>Let’s express this more formally with the rackunit unit testing library in Racket.</p>\n\n<p>;Load up rackunit: &gt; (requirerackunit)</p>\n\n<p>;Let&rsquo;s express that test: &gt; (check-equal?(cycle-length1)1)</p>\n\n<hr />\n\n<p>FAILURE name: check-equal? location: (eval 4 0 4 1) expression: (check-equal? (cycle-length 1) 1) actual: 42 expected: 1</p>\n\n<h2 id=\"check-failure\">Check failure</h2>\n\n<p>;A few more tests, according to the problem statement above: &gt; (check-equal?(cycle-length2)2)</p>\n\n<hr />\n\n<p>FAILURE name: check-equal? location: (eval 5 0 5 1) expression: (check-equal? (cycle-length 2) 2) actual: 42 expected: 2</p>\n\n<h2 id=\"check-failure\">Check failure</h2>\n\n<blockquote>\n <p>(check-equal?(cycle-length4)3)</p></blockquote>\n\n<hr />\n\n<p>FAILURE name: check-equal? location: (eval 6 0 6 1) expression: (check-equal? (cycle-length 4) 3) actual: 42 expected: 3</p>\n\n<h2 id=\"check-failure\">Check failure</h2>\n\n<blockquote>\n <p>(check-equal?(cycle-length5)6)</p></blockquote>\n\n<hr />\n\n<p>FAILURE name: check-equal? location: (eval 7 0 7 1) expression: (check-equal? (cycle-length 5) 6) actual: 42 expected: 6</p>\n\n<h2 id=\"check-failure\">Check failure</h2>\n\n<blockquote>\n <p>(check-equal?(cycle-length22)16)</p></blockquote>\n\n<hr />\n\n<p>FAILURE name: check-equal? location: (eval 8 0 8 1) expression: (check-equal? (cycle-length 22) 16) actual: 42 expected: 16</p>\n\n<h2 id=\"check-failure\">Check failure</h2>\n\n<p>All of our test cases fail. Hurrah!</p>\n\n<p>4<code>A solution: \nOk, now that we coded up the tests, let’s write a solution.  We can write out a\ndefinition for cycle-length almost straight out of the problem\nstatement:\n\n\n\n\n&gt; (define(cycle-lengthn)\n(cond\n[(=n1)\n1]\n[(odd?n)\n(add1(cycle-length(add1(*3n))))]\n[(even?n)\n(add1(cycle-length(/n2)))]))\n\n\n\n\n\n\n;Let us try it out on a few values:\n&gt; (cycle-length1)\n1\n&gt; (cycle-length2)\n2\n&gt; (cycle-length22)\n16\n\n\nIf we run this through our test suite, we should be fairly confident\nthat cycle-length is probably doing the right thing.\n(... modulo crazy inputs into the function such as 0.  If we\nwant to guard against such inputs, we can use the features in\nracket/contract.)\n\n\n5</code>Optimizing cycle-length:  How fast is the performance for cycle-length? Let’s try timing it for a few values, using the time utility. We’ll run cycle-length for a range of numbers, and see how long it takes.</p>\n\n<blockquote>\n <p>(time(for([i(in-range1100000)]) (cycle-lengthi)))</p></blockquote>\n\n<p>cpu time: 890 real time: 889 gc time: 0</p>\n\n<p>5.1<code>Introducing an accumulator: \nThere are a few things we might do to improve the performance of this.  Having\nthe (add1 ...) in the definition, waiting until the recursion finishes\nup, seems ok, but I’m curious to see whether writing the definition with an\nexplicit accumulator will help us.\n\n\n\n\n&gt; (define(cycle-lengthn)\n(cycle-length/accn1))\n\n\n\n\n\n\n;Helper function:\n\n&gt; (define(cycle-length/accnacc)\n(cond\n[(=n1)\nacc]\n[(odd?n)\n(cycle-length/acc(add1(*3n))(add1acc))]\n[(even?n)\n(cycle-length/acc(/n2)(add1acc))]))\n\n\n\n\n\n\n\n\n\n\n\nWith this reformulation, how does this do now?\n\n\n\n\n\n&gt; (time(for([i(in-range1100000)])\n(cycle-lengthi)))\n\n\ncpu time: 790 real time: 790 gc time: 0\n\n\n\n\n\n\n\n\n\nThis does help.  Although we do get an improvement, let’s drop this\nversion for now and go back to our previous definition since it’s\nsimpler—and because the next potential optimization will work better\non it!\n\n\n5.2</code>Adding memoization:  Another thing that comes to mind is this: our first good version of cycle-length works recursively. More to the point: repeated use of cycle-length can reuse prior results that we computed earlier. Maybe memoization will help. Let’s try it out: we’ll keep a small table of results, and consult that to see if we’ve already encountered the solution before.</p>\n\n<p>;We&rsquo;ll maintain a table of known results. &gt; (definetable(make-hash))</p>\n\n<blockquote>\n <p>(define(cycle-lengthn) (cond ;Consult the table: [(hash-has-key?tablen) (hash-reftablen)] [else ;If we can&rsquo;t find it, compute it&hellip; (defineanswer (cond [(=n1) 1] [(odd?n) (add1(cycle-length(add1(*3n))))] [(even?n) (add1(cycle-length(/n2)))])) ;&hellip; and then put it into the table. (hash-set!tablenanswer) ;Don&rsquo;t forget to return the value back! answer]))</p></blockquote>\n\n<p>Does the overhead of setting up this table pay for itself? Let’s see:</p>\n\n<blockquote>\n <p>(time(for([i(in-range1100000)]) (cycle-lengthi)))</p></blockquote>\n\n<p>cpu time: 217 real time: 217 gc time: 44</p>\n\n<p>Hey, not bad at all! That’s significantly better.</p>\n\n<p>We should make sure, of course, that all our test cases are running on this ok.</p>\n\n<blockquote>\n <p>(check-equal?(cycle-length1)1)</p></blockquote>\n\n<blockquote>\n <p>(check-equal?(cycle-length2)2)</p></blockquote>\n\n<blockquote>\n <p>(check-equal?(cycle-length4)3)</p></blockquote>\n\n<blockquote>\n <p>(check-equal?(cycle-length5)6)</p></blockquote>\n\n<blockquote>\n <p>(check-equal?(cycle-length22)16)</p></blockquote>\n\n<p>All’s quiet on the cycle-length front. The tests are all passing.</p>\n\n<p>5.3<code>Advanced: abstracting memoization to a helper macro: \nIt turns out that the kind of memoization we’ve done here can be lifted out, so\nthat we can easily perform it at will.  That is, what we’re doing is something\nlike the following:\n\n\n\nGiven a definition that we’d like to memoize:\n\n\n\n* create a table for exclusive use by the definition, and\n\n* slightly tweak the definition’s body so it consults the table\nbefore going through computation.\n\n\n\n\nIn terms of Racket, we can say that like this:\n\n\n\n\n;A little helper to centralize the memoization logic\n;into a single rewrite rule:\n\n&gt; (define-syntax-rule(define/memo(nameid)body...)\n(begin\n(definetable(make-hash))\n(define(nameid)\n(cond\n[(hash-has-key?tableid)\n(hash-reftableid)]\n[else\n(defineanswer(beginbody...))\n(hash-set!tableidanswer)\nanswer]))))\n\n\n\n\n\n\n\n\n\n\n\nThis defines a small rewrite rule that expresses the idea of memoizing simple,\n1-argument function definitions.  Once we have this define/memo, we\ncan rewrite cycle-length to use it:\n\n\n\n\n&gt; (define/memo(cycle-lengthn)\n(cond\n[(=n1)\n1]\n[(odd?n)\n(add1(cycle-length(add1(*3n))))]\n[(even?n)\n(add1(cycle-length(/n2)))]))\n\n\n\n\n\n\n\n\nwhich is nice because it’s easy to read.\n\n\n6</code>Cycling back to a loop:  Now that we have a fairly robust cycle-length function, we can do the rest of the problem. Given a range of numbers, we want to go through them, compute the cycle lengths, and pick out the biggest one.</p>\n\n<p>We can try to write this directly with a for/list to create a list of all the cycle-lengths, and apply the max across that list. Let’s write this in code:</p>\n\n<blockquote>\n <p>(define(max-cycle-length-rangeij) (applymax (for/list([n(in-rangei(add1j))]) ;(add1 j) for inclusion &hellip; (cycle-lengthi))))</p></blockquote>\n\n<p>Let’s write a few test cases to make sure that this is computing the right thing:</p>\n\n<p>;From the &ldquo;Sample Output&rdquo; section of ;http://acm.uva.es/p/v1/100.html &gt; (check-equal?(max-cycle-length-range110)20)</p>\n\n<hr />\n\n<p>FAILURE name: check-equal? location: (eval 31 0 31 1) expression: (check-equal? (max-cycle-length-range 1 10) 20) actual: 1 expected: 20</p>\n\n<h2 id=\"check-failure\">Check failure</h2>\n\n<p>What?! Oh, whoops, I wasn’t using the n in the loop. Silly me. Let’s fix that.</p>\n\n<blockquote>\n <p>(define(max-cycle-length-rangeij) (applymax (for/list([n(in-rangei(add1j))]) (cycle-lengthn))))</p></blockquote>\n\n<p>Thank goodness for test cases.</p>\n\n<p>Ok, let’s try that again.</p>\n\n<blockquote>\n <p>(check-equal?(max-cycle-length-range110)20)</p></blockquote>\n\n<blockquote>\n <p>(check-equal?(max-cycle-length-range100200)125)</p></blockquote>\n\n<blockquote>\n <p>(check-equal?(max-cycle-length-range201210)89)</p></blockquote>\n\n<blockquote>\n <p>(check-equal?(max-cycle-length-range9001000)174)</p></blockquote>\n\n<p>All passing? Much better!</p>\n\n<p>6.1<code>Advanced: maximizing a loop: \nIt would be nice if we could directly express taking the maximum\nacross a for loop.  We’re performing the maximum computation\nby first constructing a list of all the cycle lengths, then applying\nmax over the whole list.  Can we avoid that auxiliary list\nconstruction, and just compute the max as we’re running through the\nnumbers?\n\nIn fact, there are several variations of for loops in Racket,\nso maybe one of those variations will work for us.  For example, we\ncould use for/fold, which gives us enough expressive power to\ntake the maximum during iteration.\n\n\n\n\n&gt; (for/fold([current-max-inf.0])\n([n'(31415926)])\n(if(&gt;ncurrent-max)ncurrent-max))\n\n\n9\n\n\nThere are other versions of for loops, such as the one for\ntaking sums (for/sum).  But as of this writing, there doesn’t\nseem to be be a for/max form that lets us take the maximum\ndirectly.\n\nThe question arises: how difficult is it to build for/max?\n\nIt turns out that it’s not too bad, though it requires a little more macrology:\nwe’ll use for/fold/derived to express our own for/max loop in terms of folding:\n\n\n\n\n&gt; (define-syntax(for/maxstx)\n(syntax-casestx()\n[(_clauses. defs+exprs)\n(with-syntax([originalstx])\n#'(for/fold/derivedoriginal\n([current-max-inf.0])\nclauses\n(definemaybe-new-max\n(let(). defs+exprs))\n(if(&gt;maybe-new-maxcurrent-max)\nmaybe-new-max\ncurrent-max)))]))\n\n\n\n\n\n\n\n\nEssentially, as we’re looping through numbers, we maintain a\ncurrent-max, and update that max accordingly as we walk\nacross the iteration.  The rest of the code in for/max\ndelegates the rest of the gruntwork to\nfor/fold (technically, for/fold/derived).\n\nWe must test this, of course:\n\n\n\n;Edge case: if we take the maximum of no numbers,\n;let's see -inf.0.\n\n&gt; (check-equal?(for/max([i'()])\ni)\n-inf.0)\n\n\n\n\n\n\n\n&gt; (check-equal?\n(for/max([i'(31415926)])\ni)\n9)\n\n\n\n\n\n\n\n&gt; (check-equal?\n(for/max[(i(in-range123))]\ni)\n22)\n\n\n\n\n\n\n\n&gt; (check-equal?\n(for/max([n'(3.141592.718281.61803)]\n[s'(-111)])\n(*ns))\n2.71828)\n\n\n\n\n\n\n;... and of course...\n\n&gt; (check-equal?\n(for/max[(i(in-range900(add11000)))]\n(cycle-lengthi))\n174)\n\n\n\n\n\n\n\n\nLooks good.  With this, let’s express max-cycle-length-range\nin terms of for/max now:\n\n\n\n\n&gt; (define(max-cycle-length-rangeij)\n(for/max([n(in-rangei(add1j))])\n(cycle-lengthn)))\n\n\n\n\n\n\n\n\n\n7</code>Making a module:  Now that we have most of the solution worked out, let’s make a module that encapsulates what we’ve done. Let’s lift up the definitions that we used to make the solution nice and pretty, and place them into &ldquo;helpers.rkt&rdquo;:</p>\n\n<p>&ldquo;helpers.rkt&rdquo;</p>\n\n<h1 id=\"langracket\">langracket</h1>\n\n<p>(providefor/maxdefine/memo)</p>\n\n<p>(define-syntax(for/maxstx) (syntax-casestx() [(_clauses.defs+exprs) (with-syntax([originalstx]) #&rsquo;(for/fold/derivedoriginal ([current-max-inf.0]) clauses (definemaybe-new-max (let().defs+exprs)) (if(&gt;maybe-new-maxcurrent-max) maybe-new-max current-max)))]))</p>\n\n<p>(define-syntax-rule(define/memo(nameid)body&hellip;) (begin (definetable(make-hash)) (define(nameid) (cond [(hash-has-key?tableid) (hash-reftableid)] [else (defineanswer(beginbody&hellip;)) (hash-set!tableidanswer) answer]))))</p>\n\n<p>(module+test (requirerackunit) (check-equal?(for/max([i&rsquo;()]) i) -inf.0) (check-equal?(for/max([i&rsquo;(31415926)]) i) 9) (check-equal?(for/max[(i(in-range123))] i) 22)</p>\n\n<p>(check-equal? (for/max([n&rsquo;(3.141592.718281.61803)] [s&rsquo;(&ndash;111)]) (*ns)) 2.71828))</p>\n\n<p>Who knows? We might reuse &ldquo;helpers.rkt&rdquo; sometime.</p>\n\n<p>(You may note that the bottom of &ldquo;helpers.rkt&rdquo; contains a test submodule which collects the unit tests that we’ve written. We can run a module’s test suite by using <a href=\"http://docs.racket-lang.org/raco/test.html\">raco test</a>.)</p>\n\n<p>With our &ldquo;helpers.rkt&rdquo; in in hand, let’s put our solution in &ldquo;three-n-plus-one.rkt&rdquo;:</p>\n\n<p>&ldquo;three-n-plus-one.rkt&rdquo;</p>\n\n<h1 id=\"langracket\">langracket</h1>\n\n<p>(require\"helpers.rkt\")</p>\n\n<p>(define/memo(cycle-lengthn) (cond [(=n1) 1] [(odd?n) (add1(cycle-length(add1(*3n))))] [(even?n) (add1(cycle-length(/n2)))]))</p>\n\n<p>(define(max-cycle-length-rangeij) (for/max([n(in-rangei(add1j))]) (cycle-lengthn)))</p>\n\n<p>(module+test (requirerackunit)</p>\n\n<p>(check-equal?(cycle-length1)1) (check-equal?(cycle-length2)2) (check-equal?(cycle-length4)3) (check-equal?(cycle-length5)6) (check-equal?(cycle-length22)16)</p>\n\n<p>(check-equal? (max-cycle-length-range110)20) (check-equal? (max-cycle-length-range100200)125) (check-equal? (max-cycle-length-range201210)89) (check-equal? (max-cycle-length-range9001000)174) (check-equal? (for/max[(i(in-range900(add11000)))] (cycle-lengthi)) 174))</p>\n\n<p>8<code>Integrating with I/O and a main: \nFinally, all this unit testing is fine and dandy, but we don’t\nactually read input from standard input.  Let’s fix that, and modify\n\"three-n-plus-one.rkt\" so it can be run as the main\nentry point.\n\n\n\n\nWe can read individual lines as strings by iterating across\ncurrent-input-port with in-lines:\n\n\n\n\n(for([line(in-lines(current-input-port))])...)\n\n\nOnce we have a line in hand, we can parse out the individual chunks\nwith read.  read doesn’t normally read from strings\ndirectly, so we first translate each string into a port-like value\nusing open-input-string.\n\nLast of all, let’s add the following to the bottom of\n\"three-n-plus-one.rkt\":\n\n\n\n(module+main\n(for([line(in-lines(current-input-port))])\n(defineline-port(open-input-stringline))\n(definei(readline-port))\n(definej(readline-port))\n(when(and(number?i)(number?j))\n(printf\"~a ~a ~a\\n\"\nij\n(max-cycle-length-rangeij)))))\n\n\nThis defines a main submodule.  When we run\n\"three-n-plus-one.rkt\" directly from the command line, it will\nrun main:\n\n\n\n$ cat sample-data.txt\n1 10\n100 200\n201 210\n900 1000\n\n$ racket three-n-plus-one.rkt &lt; sample-data.txt\n1 10 20\n100 200 125\n201 210 89\n900 1000 174\n\n\n\n9</code>The files:</p>\n\n<ul>\n <li>\n  <p><a href=\"http://hashcollision.org/three-n-plus-one/helpers.rkt\">helpers.rkt</a></p></li>\n <li>\n  <p><a href=\"http://hashcollision.org/three-n-plus-one/three-n-plus-one.rkt\">three-n-plus-one.rkt</a></p></li></ul>") #t (u . "\n<p><em>posted by Danny Yoo</em></p>\n\n<p>1<code>Introduction: \nI’m starting to go through\n[Programming\nChallenges: The Programming Contest Training Manual](http://www.amazon.com/exec/obidos/ASIN/0387001638/thealgorithmrepo), by Steven S. Skiena and\nMiguel Revilla.  I thought it would be fun to show how to approach the problems\nusing the [Racket](http://racket-lang.org/) programming language.  Rather\nthan use a small, toy educational subset of the language, I’ll take off the kid\ngloves, and use whatever’s available in\n[#lang racket](http://docs.racket-lang.org/guide/index.html).\n\n\n2</code>The problem:</p>\n\n<p>The <a href=\"http://acm.uva.es/p/v1/100.html\">3n+1</a> problem is as follows: consider a positive number n. The cycle length of n is the number of times we repeat the following, until we reach n=1:</p>\n\n<ul>\n <li>\n  <p>If n is odd, then n ⇐ 3n+1</p></li>\n <li>\n  <p>If n is even, then n ⇐ n/2</p></li></ul>\n\n<p>For example, given n=22, we see the following sequence: 22 11 34 17 52 26 13 40 20 10 5 16 8 4 2 1. The cycle length of 22 is, therefore, 16, since it took 16 repetitions to get to 1.</p>\n\n<p>Given a definition of cycle length of a number, here’s the rest of the problem: given any two numbers i and j, compute the maximum cycle length over all numbers between i and j, inclusive.</p>\n\n<p>2.1<code>The plan: \nBefore we do any real coding, let’s figure out a plan of attack and how to test\nthat plan.\n\n\n\n* We need a way of computing cycle-length.\n\n* We need to run cycle-length over a range of values and pick out the biggest result.\n\nIt sounds like we may want a function called cycle-length that will\ncompute how long it takes for us to get n to 1.  If we have\ncycle-length as a helper function, then it becomes a fairly direct\nloop through the range between i and j to pick out which one produces the\nlargest cycle length.\n\nLet’s first write up a stub function that computes some nonsense.  We’ll\ncorrect it in a moment, of course!\n\n\n\n;cycle-length: positive-integer -&gt; positive-integer\n;Computes the cycle length of n, according to\n;the 3n+1 rules.\n\n&gt; (define(cycle-lengthn)\n42)\n\n\n\n\n\n\n\n\nThis is certainly not right, but it’s a start.  And it’s something we can test!\n\n\n3</code>Test cases:</p>\n\n<p>We want</p>\n\n<p>(cycle-length1)==&gt;1</p>\n\n<p>Let’s express this more formally with the rackunit unit testing library in Racket.</p>\n\n<p>;Load up rackunit: &gt; (requirerackunit)</p>\n\n<p>;Let&rsquo;s express that test: &gt; (check-equal?(cycle-length1)1)</p>\n\n<hr />\n\n<p>FAILURE name: check-equal? location: (eval 4 0 4 1) expression: (check-equal? (cycle-length 1) 1) actual: 42 expected: 1</p>\n\n<h2 id=\"check-failure\">Check failure</h2>\n\n<p>;A few more tests, according to the problem statement above: &gt; (check-equal?(cycle-length2)2)</p>\n\n<hr />\n\n<p>FAILURE name: check-equal? location: (eval 5 0 5 1) expression: (check-equal? (cycle-length 2) 2) actual: 42 expected: 2</p>\n\n<h2 id=\"check-failure\">Check failure</h2>\n\n<blockquote>\n <p>(check-equal?(cycle-length4)3)</p></blockquote>\n\n<hr />\n\n<p>FAILURE name: check-equal? location: (eval 6 0 6 1) expression: (check-equal? (cycle-length 4) 3) actual: 42 expected: 3</p>\n\n<h2 id=\"check-failure\">Check failure</h2>\n\n<blockquote>\n <p>(check-equal?(cycle-length5)6)</p></blockquote>\n\n<hr />\n\n<p>FAILURE name: check-equal? location: (eval 7 0 7 1) expression: (check-equal? (cycle-length 5) 6) actual: 42 expected: 6</p>\n\n<h2 id=\"check-failure\">Check failure</h2>\n\n<blockquote>\n <p>(check-equal?(cycle-length22)16)</p></blockquote>\n\n<hr />\n\n<p>FAILURE name: check-equal? location: (eval 8 0 8 1) expression: (check-equal? (cycle-length 22) 16) actual: 42 expected: 16</p>\n\n<h2 id=\"check-failure\">Check failure</h2>\n\n<p>All of our test cases fail. Hurrah!</p>\n\n<p>4<code>A solution: \nOk, now that we coded up the tests, let’s write a solution.  We can write out a\ndefinition for cycle-length almost straight out of the problem\nstatement:\n\n\n\n\n&gt; (define(cycle-lengthn)\n(cond\n[(=n1)\n1]\n[(odd?n)\n(add1(cycle-length(add1(*3n))))]\n[(even?n)\n(add1(cycle-length(/n2)))]))\n\n\n\n\n\n\n;Let us try it out on a few values:\n&gt; (cycle-length1)\n1\n&gt; (cycle-length2)\n2\n&gt; (cycle-length22)\n16\n\n\nIf we run this through our test suite, we should be fairly confident\nthat cycle-length is probably doing the right thing.\n(... modulo crazy inputs into the function such as 0.  If we\nwant to guard against such inputs, we can use the features in\nracket/contract.)\n\n\n5</code>Optimizing cycle-length:  How fast is the performance for cycle-length? Let’s try timing it for a few values, using the time utility. We’ll run cycle-length for a range of numbers, and see how long it takes.</p>\n\n<blockquote>\n <p>(time(for([i(in-range1100000)]) (cycle-lengthi)))</p></blockquote>\n\n<p>cpu time: 890 real time: 889 gc time: 0</p>\n\n<p>5.1<code>Introducing an accumulator: \nThere are a few things we might do to improve the performance of this.  Having\nthe (add1 ...) in the definition, waiting until the recursion finishes\nup, seems ok, but I’m curious to see whether writing the definition with an\nexplicit accumulator will help us.\n\n\n\n\n&gt; (define(cycle-lengthn)\n(cycle-length/accn1))\n\n\n\n\n\n\n;Helper function:\n\n&gt; (define(cycle-length/accnacc)\n(cond\n[(=n1)\nacc]\n[(odd?n)\n(cycle-length/acc(add1(*3n))(add1acc))]\n[(even?n)\n(cycle-length/acc(/n2)(add1acc))]))\n\n\n\n\n\n\n\n\n\n\n\nWith this reformulation, how does this do now?\n\n\n\n\n\n&gt; (time(for([i(in-range1100000)])\n(cycle-lengthi)))\n\n\ncpu time: 790 real time: 790 gc time: 0\n\n\n\n\n\n\n\n\n\nThis does help.  Although we do get an improvement, let’s drop this\nversion for now and go back to our previous definition since it’s\nsimpler—and because the next potential optimization will work better\non it!\n\n\n5.2</code>Adding memoization:  Another thing that comes to mind is this: our first good version of cycle-length works recursively. More to the point: repeated use of cycle-length can reuse prior results that we computed earlier. Maybe memoization will help. Let’s try it out: we’ll keep a small table of results, and consult that to see if we’ve already encountered the solution before.</p>\n\n<p>;We&rsquo;ll maintain a table of known results. &gt; (definetable(make-hash))</p>\n\n<blockquote>\n <p>(define(cycle-lengthn) (cond ;Consult the table: [(hash-has-key?tablen) (hash-reftablen)] [else ;If we can&rsquo;t find it, compute it&hellip; (defineanswer (cond [(=n1) 1] [(odd?n) (add1(cycle-length(add1(*3n))))] [(even?n) (add1(cycle-length(/n2)))])) ;&hellip; and then put it into the table. (hash-set!tablenanswer) ;Don&rsquo;t forget to return the value back! answer]))</p></blockquote>\n\n<p>Does the overhead of setting up this table pay for itself? Let’s see:</p>\n\n<blockquote>\n <p>(time(for([i(in-range1100000)]) (cycle-lengthi)))</p></blockquote>\n\n<p>cpu time: 217 real time: 217 gc time: 44</p>\n\n<p>Hey, not bad at all! That’s significantly better.</p>\n\n<p>We should make sure, of course, that all our test cases are running on this ok.</p>\n\n<blockquote>\n <p>(check-equal?(cycle-length1)1)</p></blockquote>\n\n<blockquote>\n <p>(check-equal?(cycle-length2)2)</p></blockquote>\n\n<blockquote>\n <p>(check-equal?(cycle-length4)3)</p></blockquote>\n\n<blockquote>\n <p>(check-equal?(cycle-length5)6)</p></blockquote>\n\n<blockquote>\n <p>(check-equal?(cycle-length22)16)</p></blockquote>\n\n<p>All’s quiet on the cycle-length front. The tests are all passing.</p>\n\n<p>5.3<code>Advanced: abstracting memoization to a helper macro: \nIt turns out that the kind of memoization we’ve done here can be lifted out, so\nthat we can easily perform it at will.  That is, what we’re doing is something\nlike the following:\n\n\n\nGiven a definition that we’d like to memoize:\n\n\n\n* create a table for exclusive use by the definition, and\n\n* slightly tweak the definition’s body so it consults the table\nbefore going through computation.\n\n\n\n\nIn terms of Racket, we can say that like this:\n\n\n\n\n;A little helper to centralize the memoization logic\n;into a single rewrite rule:\n\n&gt; (define-syntax-rule(define/memo(nameid)body...)\n(begin\n(definetable(make-hash))\n(define(nameid)\n(cond\n[(hash-has-key?tableid)\n(hash-reftableid)]\n[else\n(defineanswer(beginbody...))\n(hash-set!tableidanswer)\nanswer]))))\n\n\n\n\n\n\n\n\n\n\n\nThis defines a small rewrite rule that expresses the idea of memoizing simple,\n1-argument function definitions.  Once we have this define/memo, we\ncan rewrite cycle-length to use it:\n\n\n\n\n&gt; (define/memo(cycle-lengthn)\n(cond\n[(=n1)\n1]\n[(odd?n)\n(add1(cycle-length(add1(*3n))))]\n[(even?n)\n(add1(cycle-length(/n2)))]))\n\n\n\n\n\n\n\n\nwhich is nice because it’s easy to read.\n\n\n6</code>Cycling back to a loop:  Now that we have a fairly robust cycle-length function, we can do the rest of the problem. Given a range of numbers, we want to go through them, compute the cycle lengths, and pick out the biggest one.</p>\n\n<p>We can try to write this directly with a for/list to create a list of all the cycle-lengths, and apply the max across that list. Let’s write this in code:</p>\n\n<blockquote>\n <p>(define(max-cycle-length-rangeij) (applymax (for/list([n(in-rangei(add1j))]) ;(add1 j) for inclusion &hellip; (cycle-lengthi))))</p></blockquote>\n\n<p>Let’s write a few test cases to make sure that this is computing the right thing:</p>\n\n<p>;From the &ldquo;Sample Output&rdquo; section of ;http://acm.uva.es/p/v1/100.html &gt; (check-equal?(max-cycle-length-range110)20)</p>\n\n<hr />\n\n<p>FAILURE name: check-equal? location: (eval 31 0 31 1) expression: (check-equal? (max-cycle-length-range 1 10) 20) actual: 1 expected: 20</p>\n\n<h2 id=\"check-failure\">Check failure</h2>\n\n<p>What?! Oh, whoops, I wasn’t using the n in the loop. Silly me. Let’s fix that.</p>\n\n<blockquote>\n <p>(define(max-cycle-length-rangeij) (applymax (for/list([n(in-rangei(add1j))]) (cycle-lengthn))))</p></blockquote>\n\n<p>Thank goodness for test cases.</p>\n\n<p>Ok, let’s try that again.</p>\n\n<blockquote>\n <p>(check-equal?(max-cycle-length-range110)20)</p></blockquote>\n\n<blockquote>\n <p>(check-equal?(max-cycle-length-range100200)125)</p></blockquote>\n\n<blockquote>\n <p>(check-equal?(max-cycle-length-range201210)89)</p></blockquote>\n\n<blockquote>\n <p>(check-equal?(max-cycle-length-range9001000)174)</p></blockquote>\n\n<p>All passing? Much better!</p>\n\n<p>6.1<code>Advanced: maximizing a loop: \nIt would be nice if we could directly express taking the maximum\nacross a for loop.  We’re performing the maximum computation\nby first constructing a list of all the cycle lengths, then applying\nmax over the whole list.  Can we avoid that auxiliary list\nconstruction, and just compute the max as we’re running through the\nnumbers?\n\nIn fact, there are several variations of for loops in Racket,\nso maybe one of those variations will work for us.  For example, we\ncould use for/fold, which gives us enough expressive power to\ntake the maximum during iteration.\n\n\n\n\n&gt; (for/fold([current-max-inf.0])\n([n'(31415926)])\n(if(&gt;ncurrent-max)ncurrent-max))\n\n\n9\n\n\nThere are other versions of for loops, such as the one for\ntaking sums (for/sum).  But as of this writing, there doesn’t\nseem to be be a for/max form that lets us take the maximum\ndirectly.\n\nThe question arises: how difficult is it to build for/max?\n\nIt turns out that it’s not too bad, though it requires a little more macrology:\nwe’ll use for/fold/derived to express our own for/max loop in terms of folding:\n\n\n\n\n&gt; (define-syntax(for/maxstx)\n(syntax-casestx()\n[(_clauses. defs+exprs)\n(with-syntax([originalstx])\n#'(for/fold/derivedoriginal\n([current-max-inf.0])\nclauses\n(definemaybe-new-max\n(let(). defs+exprs))\n(if(&gt;maybe-new-maxcurrent-max)\nmaybe-new-max\ncurrent-max)))]))\n\n\n\n\n\n\n\n\nEssentially, as we’re looping through numbers, we maintain a\ncurrent-max, and update that max accordingly as we walk\nacross the iteration.  The rest of the code in for/max\ndelegates the rest of the gruntwork to\nfor/fold (technically, for/fold/derived).\n\nWe must test this, of course:\n\n\n\n;Edge case: if we take the maximum of no numbers,\n;let's see -inf.0.\n\n&gt; (check-equal?(for/max([i'()])\ni)\n-inf.0)\n\n\n\n\n\n\n\n&gt; (check-equal?\n(for/max([i'(31415926)])\ni)\n9)\n\n\n\n\n\n\n\n&gt; (check-equal?\n(for/max[(i(in-range123))]\ni)\n22)\n\n\n\n\n\n\n\n&gt; (check-equal?\n(for/max([n'(3.141592.718281.61803)]\n[s'(-111)])\n(*ns))\n2.71828)\n\n\n\n\n\n\n;... and of course...\n\n&gt; (check-equal?\n(for/max[(i(in-range900(add11000)))]\n(cycle-lengthi))\n174)\n\n\n\n\n\n\n\n\nLooks good.  With this, let’s express max-cycle-length-range\nin terms of for/max now:\n\n\n\n\n&gt; (define(max-cycle-length-rangeij)\n(for/max([n(in-rangei(add1j))])\n(cycle-lengthn)))\n\n\n\n\n\n\n\n\n\n7</code>Making a module:  Now that we have most of the solution worked out, let’s make a module that encapsulates what we’ve done. Let’s lift up the definitions that we used to make the solution nice and pretty, and place them into &ldquo;helpers.rkt&rdquo;:</p>\n\n<p>&ldquo;helpers.rkt&rdquo;</p>\n\n<h1 id=\"langracket\">langracket</h1>\n\n<p>(providefor/maxdefine/memo)</p>\n\n<p>(define-syntax(for/maxstx) (syntax-casestx() [(_clauses.defs+exprs) (with-syntax([originalstx]) #&rsquo;(for/fold/derivedoriginal ([current-max-inf.0]) clauses (definemaybe-new-max (let().defs+exprs)) (if(&gt;maybe-new-maxcurrent-max) maybe-new-max current-max)))]))</p>\n\n<p>(define-syntax-rule(define/memo(nameid)body&hellip;) (begin (definetable(make-hash)) (define(nameid) (cond [(hash-has-key?tableid) (hash-reftableid)] [else (defineanswer(beginbody&hellip;)) (hash-set!tableidanswer) answer]))))</p>\n\n<p>(module+test (requirerackunit) (check-equal?(for/max([i&rsquo;()]) i) -inf.0) (check-equal?(for/max([i&rsquo;(31415926)]) i) 9) (check-equal?(for/max[(i(in-range123))] i) 22)</p>\n\n<p>(check-equal? (for/max([n&rsquo;(3.141592.718281.61803)] [s&rsquo;(&ndash;111)]) (*ns)) 2.71828))</p>\n\n<p>Who knows? We might reuse &ldquo;helpers.rkt&rdquo; sometime.</p>\n\n<p>(You may note that the bottom of &ldquo;helpers.rkt&rdquo; contains a test submodule which collects the unit tests that we’ve written. We can run a module’s test suite by using <a href=\"http://docs.racket-lang.org/raco/test.html\">raco test</a>.)</p>\n\n<p>With our &ldquo;helpers.rkt&rdquo; in in hand, let’s put our solution in &ldquo;three-n-plus-one.rkt&rdquo;:</p>\n\n<p>&ldquo;three-n-plus-one.rkt&rdquo;</p>\n\n<h1 id=\"langracket\">langracket</h1>\n\n<p>(require\"helpers.rkt\")</p>\n\n<p>(define/memo(cycle-lengthn) (cond [(=n1) 1] [(odd?n) (add1(cycle-length(add1(*3n))))] [(even?n) (add1(cycle-length(/n2)))]))</p>\n\n<p>(define(max-cycle-length-rangeij) (for/max([n(in-rangei(add1j))]) (cycle-lengthn)))</p>\n\n<p>(module+test (requirerackunit)</p>\n\n<p>(check-equal?(cycle-length1)1) (check-equal?(cycle-length2)2) (check-equal?(cycle-length4)3) (check-equal?(cycle-length5)6) (check-equal?(cycle-length22)16)</p>\n\n<p>(check-equal? (max-cycle-length-range110)20) (check-equal? (max-cycle-length-range100200)125) (check-equal? (max-cycle-length-range201210)89) (check-equal? (max-cycle-length-range9001000)174) (check-equal? (for/max[(i(in-range900(add11000)))] (cycle-lengthi)) 174))</p>\n\n<p>8<code>Integrating with I/O and a main: \nFinally, all this unit testing is fine and dandy, but we don’t\nactually read input from standard input.  Let’s fix that, and modify\n\"three-n-plus-one.rkt\" so it can be run as the main\nentry point.\n\n\n\n\nWe can read individual lines as strings by iterating across\ncurrent-input-port with in-lines:\n\n\n\n\n(for([line(in-lines(current-input-port))])...)\n\n\nOnce we have a line in hand, we can parse out the individual chunks\nwith read.  read doesn’t normally read from strings\ndirectly, so we first translate each string into a port-like value\nusing open-input-string.\n\nLast of all, let’s add the following to the bottom of\n\"three-n-plus-one.rkt\":\n\n\n\n(module+main\n(for([line(in-lines(current-input-port))])\n(defineline-port(open-input-stringline))\n(definei(readline-port))\n(definej(readline-port))\n(when(and(number?i)(number?j))\n(printf\"~a ~a ~a\\n\"\nij\n(max-cycle-length-rangeij)))))\n\n\nThis defines a main submodule.  When we run\n\"three-n-plus-one.rkt\" directly from the command line, it will\nrun main:\n\n\n\n$ cat sample-data.txt\n1 10\n100 200\n201 210\n900 1000\n\n$ racket three-n-plus-one.rkt &lt; sample-data.txt\n1 10 20\n100 200 125\n201 210 89\n900 1000 174\n\n\n\n9</code>The files:</p>\n\n<ul>\n <li>\n  <p><a href=\"http://hashcollision.org/three-n-plus-one/helpers.rkt\">helpers.rkt</a></p></li>\n <li>\n  <p><a href=\"http://hashcollision.org/three-n-plus-one/three-n-plus-one.rkt\">three-n-plus-one.rkt</a></p></li></ul>\n<!-- more-->\n\n<hr />\n\n<p>Why (define answer &hellip;) rather than a let?</p>\n\n<p>— <em>Ben W, 25 October 2012</em></p>\n\n<hr />\n\n<p>For the short answer, see the Racket Style Guide, Section 4.2.</p>\n\n<p>— <em>John Clements, 25 October 2012</em></p>\n\n<hr />\n\n<p>The “3n+1 problem” is also known as the Collatz conjecture.</p>\n\n<p>— <em>roryokane.com, 25 October 2012</em></p>\n\n<hr />\n\n<p>Here&rsquo;s a solution in Factor:</p>\n\n<p>http://re-factor.blogspot.com/2012/10/the&ndash;3n1-problem.html</p>\n\n<p>— <em>mrjbq7, 25 October 2012</em></p>\n\n<hr />\n\n<p>Wonderful post. Have you considered using hash-ref! to make define/memo a little simpler as in:</p>\n\n<p>(define-syntax-rule (define/memo (name id) body &hellip;)  (begin   (define table (make-hash))  (define (name id)  (hash-ref! table id (thunk body &hellip;)))))</p>\n\n<p>— <em>Marty N., 29 October 2012</em></p>\n\n<hr />\n\n<p>@marty: I wanted to keep the correspondence between the non-macro version of the function and the macro as clear as possible. That way, it&rsquo;s a little more clear how the code evolves.</p>\n\n<p>— <em>Danny Yoo, 1 November 2012</em></p>\n\n<hr />")) ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2012-08-07-racket-v53.md" . unix) f post (u . "Racket v5.3") (? . 96) 1467223812 (p+ #"/Users/MB/git/racket-lang-org/blog/2012/08/racket-v53.html" . unix) "/2012/08/racket-v53.html" (u . "2012-08-07T10:17:00.002-04:00") (? . 95) (? . 115) (c (u . "")) (u . "\n<p><em>posted by Eli Barzilay</em></p>\n\n<p>Racket version 5.3 is now available from</p>\n\n<p><a href=\"http://racket-lang.org/\">http://racket-lang.org/</a> Release Highlights::</p>\n\n<ul>\n <li>\n  <p>Submodules are nested module declarations that can be loaded and run independently from the enclosing module. See also the <a href=\"../../2012/06/submodules.html\">overview of submodules</a>.</p></li>\n <li>\n  <p>The futures visualizer is a graphical profiling tool for parallel programs using futures. The tool shows a detailed execution timeline depicting the migration of futures between threads, and gives detailed information about each runtime synchronization that occurred during program execution. In addition, <code>would-be-future</code> is a special type of future that always executes sequentially and records all potential barricades a regular future would encounter.</p></li>\n <li>\n  <p>Optimization Coach (formerly Performance Report) reports information about Racket&rsquo;s inlining optimizations. Optimization Coach can be launched in any language through the View menu.</p></li>\n <li>\n  <p>The new <code>images/flomap</code> library defines floating-point bitmaps and fast image processing operations on them. It is written in Typed Racket, so Typed Racket code may use it without the cost of contract checks.</p></li>\n <li>\n  <p>The new <code>json</code> library supports parsing and generating JSON. (Originally based on Dave Herman&rsquo;s planet library.)</p></li>\n <li>\n  <p><code>racket/string</code> is extended with a set of simplified string manipulation functions that are more convenient than using regexps. <code>regexp-match*</code> and friends can now be used with new keyword arguments to return specific matched regexp group/s and gaps between matches.</p></li>\n <li>\n  <p>The new <code>racket/generic</code> library allows generic function definitions, which dispatch to methods added to a structure type via the new <code>#:methods</code> keyword.</p></li>\n <li>\n  <p>The <code>class</code> form supports declaring a method abstract. An abstract method prevents a class from being instantiated unless it is overridden.</p></li>\n <li>\n  <p>The contract library comes with support for interfaces, generics, prompts, continuation-marks, and structs.</p></li>\n <li>\n  <p>Most error messages use a new multi-line format that is more consistent with contract errors and accommodates more information.</p></li>\n <li>\n  <p>Typed Racket supports function definitions with keyword arguments; the startup time of Typed Racket programs has been sharply reduced.</p></li>\n <li>\n  <p>The new <code>ffi/com</code> library replaces MysterX; a compatibility <code>mysterx</code> library remains, but without ActiveX support. The new <code>ffi/unsafe/com</code> library offers a more primitive and direct way to use COM classes and methods.</p></li>\n <li>\n  <p>There is now a very complete completion code for zsh. It is not included in the distribution though; get it at http://goo.gl/DU8JK (This script and the bash completions will be included in the standard installers in future versions.)</p></li></ul>\n\n<p>Deprecation:  Effective this release:</p>\n\n<ul>\n <li>\n  <p>The <code>tex2page</code> and <code>combinator-parser</code> libraries have been moved from the Racket distribution to PLaneT:</p>\n  <p> (require (planet plt/tex2page))  (require (planet plt/combinator-parser))</p></li>\n <li>The following has been deprecated and will be removed in the January 2013 release:</li></ul>\n\n<p> the <code>planet</code> command-line tool; use <code>raco planet</code> instead.</p>\n\n<ul>\n <li>The following has been deprecated and will be removed in the August 2013 release:</li></ul>\n\n<p> the <code>mzlib/class100</code> library; use <code>racket/class</code> instead.</p>") #t (u . "\n<p><em>posted by Eli Barzilay</em></p>\n\n<p>Racket version 5.3 is now available from</p>\n\n<p><a href=\"http://racket-lang.org/\">http://racket-lang.org/</a> Release Highlights::</p>\n\n<ul>\n <li>\n  <p>Submodules are nested module declarations that can be loaded and run independently from the enclosing module. See also the <a href=\"../../2012/06/submodules.html\">overview of submodules</a>.</p></li>\n <li>\n  <p>The futures visualizer is a graphical profiling tool for parallel programs using futures. The tool shows a detailed execution timeline depicting the migration of futures between threads, and gives detailed information about each runtime synchronization that occurred during program execution. In addition, <code>would-be-future</code> is a special type of future that always executes sequentially and records all potential barricades a regular future would encounter.</p></li>\n <li>\n  <p>Optimization Coach (formerly Performance Report) reports information about Racket&rsquo;s inlining optimizations. Optimization Coach can be launched in any language through the View menu.</p></li>\n <li>\n  <p>The new <code>images/flomap</code> library defines floating-point bitmaps and fast image processing operations on them. It is written in Typed Racket, so Typed Racket code may use it without the cost of contract checks.</p></li>\n <li>\n  <p>The new <code>json</code> library supports parsing and generating JSON. (Originally based on Dave Herman&rsquo;s planet library.)</p></li>\n <li>\n  <p><code>racket/string</code> is extended with a set of simplified string manipulation functions that are more convenient than using regexps. <code>regexp-match*</code> and friends can now be used with new keyword arguments to return specific matched regexp group/s and gaps between matches.</p></li>\n <li>\n  <p>The new <code>racket/generic</code> library allows generic function definitions, which dispatch to methods added to a structure type via the new <code>#:methods</code> keyword.</p></li>\n <li>\n  <p>The <code>class</code> form supports declaring a method abstract. An abstract method prevents a class from being instantiated unless it is overridden.</p></li>\n <li>\n  <p>The contract library comes with support for interfaces, generics, prompts, continuation-marks, and structs.</p></li>\n <li>\n  <p>Most error messages use a new multi-line format that is more consistent with contract errors and accommodates more information.</p></li>\n <li>\n  <p>Typed Racket supports function definitions with keyword arguments; the startup time of Typed Racket programs has been sharply reduced.</p></li>\n <li>\n  <p>The new <code>ffi/com</code> library replaces MysterX; a compatibility <code>mysterx</code> library remains, but without ActiveX support. The new <code>ffi/unsafe/com</code> library offers a more primitive and direct way to use COM classes and methods.</p></li>\n <li>\n  <p>There is now a very complete completion code for zsh. It is not included in the distribution though; get it at http://goo.gl/DU8JK (This script and the bash completions will be included in the standard installers in future versions.)</p></li></ul>\n\n<p>Deprecation:  Effective this release:</p>\n\n<ul>\n <li>\n  <p>The <code>tex2page</code> and <code>combinator-parser</code> libraries have been moved from the Racket distribution to PLaneT:</p>\n  <p> (require (planet plt/tex2page))  (require (planet plt/combinator-parser))</p></li>\n <li>The following has been deprecated and will be removed in the January 2013 release:</li></ul>\n\n<p> the <code>planet</code> command-line tool; use <code>raco planet</code> instead.</p>\n\n<ul>\n <li>The following has been deprecated and will be removed in the August 2013 release:</li></ul>\n\n<p> the <code>mzlib/class100</code> library; use <code>racket/class</code> instead.</p>\n<!-- more-->\n\n<hr />\n\n<p>Awesome guys. Thanks for the hard work on this!</p>\n\n<p>— <em>Robert, 7 August 2012</em></p>\n\n<hr />\n\n<p>The futures visualizer sounds very interesting!</p>\n\n<p>— <em>nek, 8 August 2012</em></p>\n\n<hr />")) ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2014-05-08-racket-v601.md" . unix) f post (u . "Racket v6.0.1") (? . 59) 1467223812 (p+ #"/Users/MB/git/racket-lang-org/blog/2014/05/racket-v601.html" . unix) "/2014/05/racket-v601.html" (u . "2014-05-08T16:46:00.002-04:00") (? . 120) (? . 99) (c (u . "")) (u . "\n<p><em>posted by Ryan Culpepper</em></p>\n\n<p>Racket version 6.0.1 is now available from</p>\n\n<p><a href=\"http://racket-lang.org/\">http://racket-lang.org/</a></p>\n\n<ul>\n <li>A new <code>racket/undefined</code> library exports <code>undefined</code> as the value currently produced by</li></ul>\n\n<p>(letrec ([x x]) x) This library anticipates a future where that expression will raise an exception. The <code>racket/undefined</code> library will continue to offer the <code>undefined</code> value as a bridge between versions and as a last resort.</p>\n\n<ul>\n <li>\n  <p>The drawing and GUI libraries provide improved support for high-resolution bitmaps and their use on Retina displays. For example, <code>read-bitmap</code> includes a <code>#:try-@2x?</code> option to trigger substitutions through the usual \"@2x\" naming convention.</p></li>\n <li>\n  <p>Check Syntax cooperates with Typed Racket to show arrows and other Check Syntax highlighting even when there is a type error.</p></li>\n <li>\n  <p>Functions provided via <code>contract-out</code> that have first-order contracts perform better.</p></li>\n <li>\n  <p>The contract boundary between typed/untyped modules is much less expensive. Typed Racket now avoids generating contracts for places where contracts failures cannot happen.</p></li>\n <li>\n  <p>Occurrence typing now works better with <code>when</code>/<code>unless</code>. Example:</p></li></ul>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">let</span> <span class=\"p\">((</span><span class=\"n\">x</span> <span class=\"p\">(</span><span class=\"nb\">read</span><span class=\"p\">)))</span>\n  <span class=\"p\">(</span><span class=\"k\">unless</span> <span class=\"p\">(</span><span class=\"nb\">number?</span> <span class=\"n\">x</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"nb\">error</span> <span class=\"o\">&#39;</span><span class=\"ss\">bad-input</span><span class=\"p\">))</span>\n  <span class=\"p\">(</span><span class=\"nb\">add1</span> <span class=\"n\">x</span><span class=\"p\">))</span>\n</pre></div>\n\n</div>\n\n<ul>\n <li>\n  <p>Types in Typed Racket are now pretty-printed.</p></li>\n <li>\n  <p>Function types can now be written in prefix style, which is now preferred and is used for printing. Infix function types are still accepted for backwards compatibility.</p></li>\n <li>\n  <p>A new <code>-&gt;*</code> type constructor is used for writing types for functions with optional and keyword arguments. The notation is similar to the matching contract combinator.</p></li>\n <li>\n  <p>Typed Racket forms do not have a <code>:</code> suffix by default now. For example, the <code>struct</code> form replaces <code>struct:</code>. The suffixed versions are all provided for backwards compatibility.</p></li>\n <li>\n  <p>Typed Racket now has preliminary support for classes and objects. However, it is still experimental and the APIs are subject to change.</p></li>\n <li>\n  <p>Type aliases in Typed Racket now support recursion and mutual recursion. For example, <code>(define-type (MyList X) (U Null (Pair X (MyList X))))</code> is now a valid type alias.</p></li>\n <li>\n  <p>Plot correctly renders intersecting 3D graphs and non-grid-aligned 3D rectangles.</p></li>\n <li>\n  <p>Elements in plots output in PDF/PS format have the same relative scale as in other formats. In particular, it is not necessary to adjust <code>plot-font-size</code> to make PDF plots look the same as PNG.</p></li></ul>") #t (u . "\n<p><em>posted by Ryan Culpepper</em></p>\n\n<p>Racket version 6.0.1 is now available from</p>\n\n<p><a href=\"http://racket-lang.org/\">http://racket-lang.org/</a></p>\n\n<ul>\n <li>A new <code>racket/undefined</code> library exports <code>undefined</code> as the value currently produced by</li></ul>\n\n<p>(letrec ([x x]) x) This library anticipates a future where that expression will raise an exception. The <code>racket/undefined</code> library will continue to offer the <code>undefined</code> value as a bridge between versions and as a last resort.</p>\n\n<ul>\n <li>\n  <p>The drawing and GUI libraries provide improved support for high-resolution bitmaps and their use on Retina displays. For example, <code>read-bitmap</code> includes a <code>#:try-@2x?</code> option to trigger substitutions through the usual \"@2x\" naming convention.</p></li>\n <li>\n  <p>Check Syntax cooperates with Typed Racket to show arrows and other Check Syntax highlighting even when there is a type error.</p></li>\n <li>\n  <p>Functions provided via <code>contract-out</code> that have first-order contracts perform better.</p></li>\n <li>\n  <p>The contract boundary between typed/untyped modules is much less expensive. Typed Racket now avoids generating contracts for places where contracts failures cannot happen.</p></li>\n <li>\n  <p>Occurrence typing now works better with <code>when</code>/<code>unless</code>. Example:</p></li></ul>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">let</span> <span class=\"p\">((</span><span class=\"n\">x</span> <span class=\"p\">(</span><span class=\"nb\">read</span><span class=\"p\">)))</span>\n  <span class=\"p\">(</span><span class=\"k\">unless</span> <span class=\"p\">(</span><span class=\"nb\">number?</span> <span class=\"n\">x</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"nb\">error</span> <span class=\"o\">&#39;</span><span class=\"ss\">bad-input</span><span class=\"p\">))</span>\n  <span class=\"p\">(</span><span class=\"nb\">add1</span> <span class=\"n\">x</span><span class=\"p\">))</span>\n</pre></div>\n\n</div>\n\n<ul>\n <li>\n  <p>Types in Typed Racket are now pretty-printed.</p></li>\n <li>\n  <p>Function types can now be written in prefix style, which is now preferred and is used for printing. Infix function types are still accepted for backwards compatibility.</p></li>\n <li>\n  <p>A new <code>-&gt;*</code> type constructor is used for writing types for functions with optional and keyword arguments. The notation is similar to the matching contract combinator.</p></li>\n <li>\n  <p>Typed Racket forms do not have a <code>:</code> suffix by default now. For example, the <code>struct</code> form replaces <code>struct:</code>. The suffixed versions are all provided for backwards compatibility.</p></li>\n <li>\n  <p>Typed Racket now has preliminary support for classes and objects. However, it is still experimental and the APIs are subject to change.</p></li>\n <li>\n  <p>Type aliases in Typed Racket now support recursion and mutual recursion. For example, <code>(define-type (MyList X) (U Null (Pair X (MyList X))))</code> is now a valid type alias.</p></li>\n <li>\n  <p>Plot correctly renders intersecting 3D graphs and non-grid-aligned 3D rectangles.</p></li>\n <li>\n  <p>Elements in plots output in PDF/PS format have the same relative scale as in other formats. In particular, it is not necessary to adjust <code>plot-font-size</code> to make PDF plots look the same as PNG.</p></li></ul>\n<!-- more-->\n\n<hr />\n\n<p>Racket blog &hellip; Talk about Rackets !! I know some people running quite a rachet !</p>\n\n<p>Ask Annabel</p>\n\n<p>— <em>IOnlyDealInMiracles, 24 May 2014</em></p>\n\n<hr />\n\n<p>Dear Annabel,</p>\n\n<p>On a scale of 1 to 10, how rachet would you say you are?</p>\n\n<p>Ben</p>\n\n<p>— <em>Benjamin Greenman, 25 May 2014</em></p>\n\n<hr />\n\n<p>Please, provide PGP signatures for the installers and/or support download over SSL. I would not risk running an executable on my computer unless I can verify it&rsquo;s origin.</p>\n\n<p>— <em>verduphs, 2 June 2014</em></p>\n\n<hr />\n\n<p>Funny. I came here from the old plt site and initially misread the redirection alert: &ldquo;PLT is now a racket!&rdquo;</p>\n\n<p>— <em>Unknown, 19 June 2014</em></p>\n\n<hr />")) ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2013-07-31-racketcon-2013-signup.md" . unix) f post (u . "RacketCon 2013 Signup") (? . 93) 1467223812 (p+ #"/Users/MB/git/racket-lang-org/blog/2013/07/racketcon-2013-signup.html" . unix) "/2013/07/racketcon-2013-signup.html" (u . "2013-07-31T15:43:00.002-04:00") (? . 77) (? . 92) (c (u . "")) (u . "\n<p><em>posted by Asumu Takikawa</em></p>\n\n<p>RacketCon sign up is now open! <a href=\"http://bit.ly/racketconsignup2013\">http://bit.ly/racketconsignup2013</a></p>\n\n<p>RacketCon will be held at Northeastern University in Boston on September 29. The details of the event can be found on the website: <a href=\"http://con.racket-lang.org/\">http://con.racket-lang.org</a></p>\n\n<p>We also have a page on Lanyrd for the event: <a href=\"http://lanyrd.com/2013/racketcon/\">http://lanyrd.com/2013/racketcon/</a></p>\n\n<p>More information about the schedule will be posted in the upcoming weeks.</p>") #f (u . "\n<p><em>posted by Asumu Takikawa</em></p>\n\n<p>RacketCon sign up is now open! <a href=\"http://bit.ly/racketconsignup2013\">http://bit.ly/racketconsignup2013</a></p>\n\n<p>RacketCon will be held at Northeastern University in Boston on September 29. The details of the event can be found on the website: <a href=\"http://con.racket-lang.org/\">http://con.racket-lang.org</a></p>\n\n<p>We also have a page on Lanyrd for the event: <a href=\"http://lanyrd.com/2013/racketcon/\">http://lanyrd.com/2013/racketcon/</a></p>\n\n<p>More information about the schedule will be posted in the upcoming weeks.</p>")) ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2007-12-29-plt-scheme-v372.md" . unix) f post (u . "PLT Scheme v372") (? . 6) 1467223812 (p+ #"/Users/MB/git/racket-lang-org/blog/2007/12/plt-scheme-v372.html" . unix) "/2007/12/plt-scheme-v372.html" (u . "2007-12-29T01:00:00.000-05:00") (? . 25) (? . 16) (c (u . "")) (u . "\n<p><em>posted by Eli Barzilay</em></p>\n\n<p>PLT Scheme version 372 is now available from <a href=\"http://download.plt-scheme.org/\">http://download.plt-scheme.org/</a></p>\n\n<p>This is mostly a bug-fix release. Changes:</p>\n\n<ul>\n <li>\n  <p>DrScheme now supports name completion via Ctl-/ (Windows and X) or Cmd-/ (Mac OS X). Completion is sensitive to the current language in DrScheme, but it is not sensitive to lexical bindings.</p></li>\n <li>\n  <p>DrScheme&rsquo;s stepper now supports the &ldquo;check-expect&rdquo;, &ldquo;check-within&rdquo;, and &ldquo;check-error&rdquo; forms of the testing.ss teachpack.</p></li>\n <li>\n  <p>A number of bug fixes and small improvements for ProfessorJ. The grammar for the current release slightly differs from the one in HtDC.Feedback Welcome.</p></li></ul>") #t (u . "\n<p><em>posted by Eli Barzilay</em></p>\n\n<p>PLT Scheme version 372 is now available from <a href=\"http://download.plt-scheme.org/\">http://download.plt-scheme.org/</a></p>\n\n<p>This is mostly a bug-fix release. Changes:</p>\n\n<ul>\n <li>\n  <p>DrScheme now supports name completion via Ctl-/ (Windows and X) or Cmd-/ (Mac OS X). Completion is sensitive to the current language in DrScheme, but it is not sensitive to lexical bindings.</p></li>\n <li>\n  <p>DrScheme&rsquo;s stepper now supports the &ldquo;check-expect&rdquo;, &ldquo;check-within&rdquo;, and &ldquo;check-error&rdquo; forms of the testing.ss teachpack.</p></li>\n <li>\n  <p>A number of bug fixes and small improvements for ProfessorJ. The grammar for the current release slightly differs from the one in HtDC.Feedback Welcome.</p></li></ul>\n<!-- more-->\n\n<hr />\n\n<p>Hi&hellip;</p>\n\n<p>Any chance we could have that cute little embedded test case back in DrScheme? I use it heavily for practice pieces and small projects.</p>\n\n<p>I&rsquo;m stuck on version 352 until then.</p>\n\n<p>yours, Marcus</p>\n\n<p>— <em>Marcus Baker, 4 February 2008</em></p>\n\n<hr />\n\n<p>We have switched to a teachpack for student tests; see the mailing list archives for more details.</p>\n\n<p>— <em>Eli, 4 February 2008</em></p>\n\n<hr />")) ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2007-05-03-macros-matter.md" . unix) f post (u . "Macros Matter") (? . 130) 1467223812 (p+ #"/Users/MB/git/racket-lang-org/blog/2007/05/macros-matter.html" . unix) "/2007/05/macros-matter.html" (u . "2007-05-03T17:35:00.000-04:00") #f (? . 102) (c (u . "")) (u . "\n<p><em>posted by matthias</em></p>\n\n<p>Thank you Jens for setting up this Blog.</p>\n\n<p>PLT Scheme is a 12-year old project now and it is definitely time to open it up to the world. The language and the project has contributed numerous ideas and products to the world. This covers programming languages (units, mixins, an implementation of cml-style concurrency, etc); programming tools (drscheme, check-syntax, transparent repls, module browsers, etc), programming pedagogy (htdp, htdc); program engineering (we resurrected the &ldquo;expression&rdquo; problem, web programming and continuations); and some more.</p>\n\n<p>Time and again, people have asked me what I consider the one &lsquo;feature&rsquo; that distinguishes us from the rest of the hordes of programming languages. I always respond with a single word:</p>\n\n<p><strong>Macros.</strong></p>\n\n<p>We have pushed macros hard, and we have accomplished a lot with them. I conjecture that without macros, we would never have achieved the level of productivity that this group displays.</p>\n\n<p>Of course, everyone else in academia works on types. ML&rsquo;s module type system of the third kind and Haskell&rsquo;s system-complete type system are serious challenges to anyone. It is probably true that you shouldn&rsquo;t consider yourself a programmer if you can&rsquo;t read and write some of those type-laden programs, and I seriously believe that they are the next generation of influential languages.</p>\n\n<p>For the generation-after-the-next then, I see &ldquo;macros&rdquo; as one of the big topics (next to concurrency). A real programmer will have to know how Lisp and Scheme-style macros can reduce labor by orders of magnitude, how macros provide the tools for creating the &ldquo;ultimate abstraction&rdquo; in the form of domain-specific and embedded languages (Hudak&rsquo;s words). And there is no better place to start with than PLT Scheme&rsquo;s macro system.</p>\n\n<p>So I would like to dedicate this blog to all things macros and everything else that matters in (and to) PLT Scheme.</p>") #t (u . "\n<p><em>posted by matthias</em></p>\n\n<p>Thank you Jens for setting up this Blog.</p>\n\n<p>PLT Scheme is a 12-year old project now and it is definitely time to open it up to the world. The language and the project has contributed numerous ideas and products to the world. This covers programming languages (units, mixins, an implementation of cml-style concurrency, etc); programming tools (drscheme, check-syntax, transparent repls, module browsers, etc), programming pedagogy (htdp, htdc); program engineering (we resurrected the &ldquo;expression&rdquo; problem, web programming and continuations); and some more.</p>\n\n<p>Time and again, people have asked me what I consider the one &lsquo;feature&rsquo; that distinguishes us from the rest of the hordes of programming languages. I always respond with a single word:</p>\n\n<p><strong>Macros.</strong></p>\n\n<p>We have pushed macros hard, and we have accomplished a lot with them. I conjecture that without macros, we would never have achieved the level of productivity that this group displays.</p>\n\n<p>Of course, everyone else in academia works on types. ML&rsquo;s module type system of the third kind and Haskell&rsquo;s system-complete type system are serious challenges to anyone. It is probably true that you shouldn&rsquo;t consider yourself a programmer if you can&rsquo;t read and write some of those type-laden programs, and I seriously believe that they are the next generation of influential languages.</p>\n\n<p>For the generation-after-the-next then, I see &ldquo;macros&rdquo; as one of the big topics (next to concurrency). A real programmer will have to know how Lisp and Scheme-style macros can reduce labor by orders of magnitude, how macros provide the tools for creating the &ldquo;ultimate abstraction&rdquo; in the form of domain-specific and embedded languages (Hudak&rsquo;s words). And there is no better place to start with than PLT Scheme&rsquo;s macro system.</p>\n\n<p>So I would like to dedicate this blog to all things macros and everything else that matters in (and to) PLT Scheme.</p>\n<!-- more-->\n\n<hr />\n\n<p>The Scala programming language claims that its combination of language features allows for the easy addition of new control structures and domain-specific syntax, without the need for macro-based metaprogramming.</p>\n\n<p>Although I have only a surface knowledge of Scala, the introductory Scala documentation provides some examples to back up this claim, and I&rsquo;m inclined to believe that Scala&rsquo;s facilities would suffice for most of the purposes that macros are commonly used for. Scala&rsquo;s &ldquo;actors&rdquo; library (essentially an implementation of Erlang-style concurrency with corresponding syntactic extensions) is a good example of a task I would expect to require macros, and yet they do just fine without.</p>\n\n<p>It would be really interesting to to know what a macro expert thinks about Scala&rsquo;s approach. Is Scala essentially providing macros in disguise, or does it have a real lack of expressive power relative to Scheme&rsquo;s macros?</p>\n\n<p>— <em>puzzler, 4 May 2007</em></p>\n\n<hr />\n\n<p>My impression is that Scala has &ldquo;macro power&rdquo; in the same spirit as Java has &ldquo;closure power.&rdquo;</p>\n\n<p>Rumor has it that Java 7 will have real closures.</p>\n\n<p>Someone show me that I am wrong.</p>\n\n<p>— <em>matthias, 4 May 2007</em></p>\n\n<hr />\n\n<p>I am pleased to see a PLT Scheme blog, and look forward to reading it.</p>\n\n<p>As you know, Matthias, I teach supplementary lectures on macros and continuations to post-HtDP students. Continuations &ldquo;fit&rdquo; &mdash; there are challenges, but they&rsquo;re of the sort that students are used to from other parts of Scheme. Macros are a different matter. Perhaps it&rsquo;s because I don&rsquo;t understand them that well myself, but it seems to me that there is a considerable jump in complexity. They&rsquo;re not as natural, and there are no good expository materials. I would like to see the transition into macrology be a little smoother. Is this possible? &mdash;PR</p>\n\n<p>— <em>plragde@uwaterloo.ca, 4 May 2007</em></p>\n\n<hr />\n\n<p>Well, I can&rsquo;t speak for other students of scheme, but I found procedural macros easier to grok than the syntax-rules language. Though I program more in Common Lisp now, the first macro system I learned to use in a non-trivial way was the explicit renaming system in scheme 48</p>\n\n<p>— <em>akopa, 4 May 2007</em></p>\n\n<hr />\n\n<p>If you have read the docs, you know that  PLT Scheme does have procedural macros. Better still, it has those and implements macros as proper abstractions.</p>\n\n<p>This idea of <em>macros as proper abstractions</em> is why I have strong doubts that Scala has any real &ldquo;macro power&rdquo; and that systems such as in CL or S48 will ever be close.</p>\n\n<p>Because we support macros-as-abstractions, implementing classes, mixins, and traits as macros is not only feasible, it&rsquo;s a joy. Indeed, implementing an entire language, such as Arc is doable and is no just a toy (as it would be if implemented in a primitive macro system).</p>\n\n<p>— <em>matthias, 5 May 2007</em></p>\n\n<hr />\n\n<p>I have not used the syntactic abstractions in PLT. I wasn&rsquo;t even disparaging Scheme macros in my previous comment.</p>\n\n<p>However, the introductory materials to Scheme macros always concentrate on syntax-rules. In addition, there is an implicit assumption that the pattern matching language is the &ldquo;easy&rdquo; way to think about source transformation.</p>\n\n<p>This is does not seem to be the case, or at least it isn&rsquo;t sufficient for many Scheme students.</p>\n\n<p>In my case, the mechanics of explicitly constructing the syntax tree helped me enormously.</p>\n\n<p>As far as providing a proper abstraction goes, in Common Lisp the burden is on the macro writer. Philosophically, Scheme advocates will always find defmacro wanting, but I am able to construct a macro writing framework for my own macros that provide good abstraction and meaningful error reporting for the macro writer and the consumer. I acknowledge that it can be a lot of work.</p>\n\n<p>— <em>akopa, 6 May 2007</em></p>\n\n<hr />\n\n<p>Hi Akopa,</p>\n\n<p>There are more than one type of macros in the Scheme world. To a Scheme a &ldquo;procedural macro system&rdquo; isn&rsquo;t associated with Common Lisp&rsquo;s defmacro.</p>\n\n<p>For simple transformations, syntax-rules is easy to use. However, if you need to write macros that doesn&rsquo;t fit into a simple rewriting rule, then you&rsquo;ll need something more powerful like syntax-case macros.</p>\n\n<p>For a very nice explanation of syntax-case seen from the Common Lisp perspective see:</p>\n\n<p>http://groups.google.com/group/comp.lang.lisp/msg/7893ba79443a82f8?hl=en&amp;</p>\n\n<p>— <em>Jens Axel Søgaard, 6 May 2007</em></p>\n\n<hr />\n\n<p>Here is the url broken into 3 lines</p>\n\n<p>http://groups.google.com/ group/comp.lang.lisp/ msg/7893ba79443a82f8?hl=en&amp;</p>\n\n<p>— <em>Jens Axel Søgaard, 6 May 2007</em></p>\n\n<hr />\n\n<p>&ldquo;As far as providing a proper abstraction goes, in Common Lisp the burden is on the macro write.&rdquo;</p>\n\n<p>If that&rsquo;s the case for <em>any</em> linguistic construct, the language simply doesn&rsquo;t support abstraction (for this aspect). Period. Just think: in the spirit of this statement, assembly language supports first-class closures.</p>\n\n<p>— <em>matthias, 7 May 2007</em></p>\n\n<hr />\n\n<p>\"&lsquo;As far as providing a proper abstraction goes, in Common Lisp the burden is on the macro write.&rsquo;</p>\n\n<p>If that&rsquo;s the case for <em>any</em> linguistic construct, the language simply doesn&rsquo;t support abstraction (for this aspect). Period. Just think: in the spirit of this statement, assembly language supports first-class closures.\"</p>\n\n<p>Yeah, but macro-writing macros allow you to create the abstraction. Don&rsquo;t get me wrong, it&rsquo;s nice the Scheme supports this out of the box.</p>\n\n<p>Of course assembly language supports first-class closures; it&rsquo;s just a macro expansion away :).</p>\n\n<p>— <em>akopa, 7 May 2007</em></p>\n\n<hr />\n\n<p>Scala has limited non-macro-based facilities for syntactic extension. This along with its liberal method naming syntax and the ability to use anything as infix lets you build things like embedded linear algebra operators (A*B where A and B are matrix operators could be matrix multiplication, etc.).</p>\n\n<p>Scala is a hell of a lot faster than PLT Scheme, and it plays perfectly with the vast Java ecosystem, while Scheme does not. They are good at different things and there is no need for Schemers to feel they need to put down a fine language like Scala. If you&rsquo;re going to play the language debate game, focus your energy on languages that actually do suck.</p>\n\n<p>— <em>warren, 9 May 2007</em></p>\n\n<hr />\n\n<p>warren wrote: &gt; Scala has limited non-macro-based facilities for &gt; syntactic extension. [&hellip;]</p>\n\n<p>Right &mdash; it has no macros.</p>\n\n<blockquote>\n <p>Scala is a hell of a lot faster than PLT Scheme,</p></blockquote>\n\n<p>I find this questionable. I tried a quick fib test, and with an input of 38 (which should be large enough to compensate for Scala&rsquo;s horrendous initial overhead). With 5 runs for each, MzScheme was 2.7 times faster in user time, and 3.2 times faster in total time. But we&rsquo;re not playing language debate games, right?</p>\n\n<blockquote>\n <p>and it plays perfectly with the vast Java ecosystem, while Scheme does not.</p></blockquote>\n\n<p>MzScheme does not play with Java code easily, because it&rsquo;s implemented in C. Schemes that are implemented in Java do. OTOH, MzScheme plays perfectly with the vast(er) C ecosystem. But we&rsquo;re not playing language debate games, right?</p>\n\n<blockquote>\n <p>They are good at different things and there is no need for Schemers to feel they need to put down a fine language like Scala.</p></blockquote>\n\n<p>I looked again at all comments &mdash; and the only sense in which Scala was &ldquo;put down&rdquo; is by saying that it has no macros. Reading the Scala documentation re its extensibility feature all I see is an ability to specify thunk arguments, and automatic thunking of expressions that are used for these arguments. Saying that this is anywhere close to having macros is like saying that my old Pontiac Grand Prix 93 has the same functionality of a Ferrari.</p>\n\n<p>The original question was: &ldquo;Is Scala essentially providing macros in disguise, or does it have a real lack of expressive power relative to Scheme&rsquo;s macros?&rdquo;. The answer to this question is a simple and definite &ldquo;no, it does not have the expressive power of macros&rdquo; &mdash; and that&rsquo;s for any macro system I know about (including non-sexpr macro systems, like CamlP4 or CPP). It&rsquo;s as simple as that. Language debate games or not.</p>\n\n<blockquote>\n <p>If you&rsquo;re going to play the language debate game, focus your energy on languages that actually do suck.</p></blockquote>\n\n<p>Look in the above comments again, bearing in mind my answer above. Saying that Scala has no macros is a plain fact, not a subjective arguments. It is therefore your own comment that started a debate game. The current comment contributes to that, sorry.</p>\n\n<p>— <em>Eli Barzilay, 9 May 2007</em></p>\n\n<hr />\n\n<p>eli, is CamlP4 is missing anything besides the obvious thing (ie, hygiene)?</p>\n\n<p>— <em>Neel Krishnaswami, 9 May 2007</em></p>\n\n<hr />\n\n<p>Well, hygiene is a big deal. The advantage that CamlP4 gives you over CPP is that it uses proper structures, which is also what you get with defmacro, so it&rsquo;s a good step in that direction.</p>\n\n<p>One techincal point here is that when working with it, I found that the types got in my way. The AST type is quite big, and evey piece of code must have many trivial cases. One solution to that was obvious: create an s-expr-like type, and translate the AST to that.</p>\n\n<p>Getting hygiene is also related to being integrated into the languaue, which is another thing you don&rsquo;t get with CamlP4. Transformations live completely outside of your code, so, for example, it is not possible to have libraries that provide new syntax transformers.</p>\n\n<p>This, combined with the heavy AST type mean that you need to do a <em>lot</em> of work for every transformation, which makes it more difficult to use. I don&rsquo;t see people going through all that just to implement a small debugging macro, or something simple like `when&rsquo; or a while loop.</p>\n\n<p>BTW, one thing I did when I worked with CamlP4 is to create a defmacro-like facility. It was limited in many ways: different AST nodes means that my macros would only work with AST subsets that make sense both as expressions and as patterns; the scope was in-file only; we needed to add facilities for including code etc etc. Still, it was much better than CPP (which was used for debug code), and even fixed a couple of bugs.</p>\n\n<p>— <em>Eli Barzilay, 9 May 2007</em></p>\n\n<hr />\n\n<p>Thanks for your comment. The way I usually use P4 is to define a small grammar for my extension, with a custom AST type for that. Then, I write a function to compile my custom AST into the Ocaml expression syntax. This matches how I write things on the whiteboard pretty well, and personally I found it more convenient than syntax-rules (which has a bizarre evaluation order).</p>\n\n<p>I do get really annoyed every time I have to define a gensym function &mdash; I should not have to do this in 2007! &mdash; and I take your point about the need for better language integration, because I have often wanted to write type-directed transformations. (For example, if you want to extend pattern matching and still check coverage, you need to know all the type and module definitions in the current scope.) You can&rsquo;t do this with P4.</p>\n\n<p>— <em>Neel Krishnaswami, 10 May 2007</em></p>\n\n<hr />\n\n<p>Let me preface my comment by saying that I think PLT Scheme is a wonderful language, and my thanks to the PLT folks for making it happen. With that said, I wanted to respond to these comments by Matthias:</p>\n\n<p>&ldquo;Because we support macros-as-abstractions, implementing classes, mixins, and traits as macros is not only feasible, it&rsquo;s a joy. Indeed, implementing an entire language, such as Arc is doable and is no just a toy (as it would be if implemented in a primitive macro system).&rdquo;</p>\n\n<p>I heard from a reliable source that the current Arc implementation doesn&rsquo;t use scheme macros at all. So it perhaps is a bad example to use in this case.</p>\n\n<p>— <em>Repl, 10 June 2007</em></p>\n\n<hr />")) ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2012-09-28-i-write-funny-lookin-racket-code-an-alternate-style-for-delimiters-and-indentation.md" . unix) f post (u . "I Write Funny-Lookin' Racket Code: An Alternate Style for Delimiters and Indentation") (? . 129) 1467223812 (p+ #"/Users/MB/git/racket-lang-org/blog/2012/09/i-write-funny-lookin-racket-code-an-alternate-style-for-delimiters-and-indentation.html" . unix) "/2012/09/i-write-funny-lookin-racket-code-an-alternate-style-for-delimiters-and-indentation.html" (u . "2012-09-28T11:32:00.000-04:00") (? . 116) (? . 128) (c (u . "")) (u . "\n<p><em>posted by Carl Eastlund</em></p>\n\n<p>A lot of people are quite surprised when they see the Racket code I write. Let&rsquo;s say I needed a function to render hash table values as expressions that would produce the same value. A &ldquo;normal&rdquo; Racketeer might write something like the following.</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">hash-&gt;expr</span> <span class=\"n\">ht</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"nb\">cons</span> <span class=\"o\">&#39;</span><span class=\"ss\">hash</span>\n        <span class=\"p\">(</span><span class=\"k\">for/fold</span> <span class=\"p\">([</span><span class=\"n\">args</span> <span class=\"o\">&#39;</span><span class=\"p\">()])</span>\n                  <span class=\"p\">([(</span><span class=\"n\">k</span> <span class=\"n\">v</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"nb\">in-hash</span> <span class=\"n\">ht</span><span class=\"p\">)])</span>\n          <span class=\"p\">(</span><span class=\"nb\">cons</span> <span class=\"p\">(</span><span class=\"nb\">list</span> <span class=\"o\">&#39;</span><span class=\"ss\">quote</span> <span class=\"n\">k</span><span class=\"p\">)</span>\n                <span class=\"p\">(</span><span class=\"nb\">cons</span> <span class=\"p\">(</span><span class=\"nb\">list</span> <span class=\"o\">&#39;</span><span class=\"ss\">quote</span> <span class=\"n\">v</span><span class=\"p\">)</span>\n                      <span class=\"n\">args</span><span class=\"p\">)))))</span>\n</pre></div>\n\n</div>\n\n<p>There might be a few variances in style, especially depending on whether one has Racket or Emacs set up to indent <code>for/fold</code> specially. Almost no one, however, would come up with the code I write.</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">hash-&gt;expr</span> <span class=\"n\">ht</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"nb\">cons</span> <span class=\"o\">&#39;</span><span class=\"ss\">hash</span>\n    <span class=\"p\">(</span><span class=\"k\">for/fold</span>\n        <span class=\"p\">{[</span><span class=\"n\">args</span> <span class=\"o\">&#39;</span><span class=\"p\">()]}</span>\n        <span class=\"p\">{[{</span><span class=\"n\">k</span> <span class=\"n\">v</span><span class=\"p\">}</span> <span class=\"p\">(</span><span class=\"nb\">in-hash</span> <span class=\"n\">ht</span><span class=\"p\">)]}</span>\n      <span class=\"p\">(</span><span class=\"nb\">cons</span> <span class=\"p\">(</span><span class=\"nb\">list</span> <span class=\"o\">&#39;</span><span class=\"ss\">quote</span> <span class=\"n\">k</span><span class=\"p\">)</span>\n        <span class=\"p\">(</span><span class=\"nb\">cons</span> <span class=\"p\">(</span><span class=\"nb\">list</span> <span class=\"o\">&#39;</span><span class=\"ss\">quote</span> <span class=\"n\">v</span><span class=\"p\">)</span>\n          <span class=\"n\">args</span><span class=\"p\">)))))</span>\n</pre></div>\n\n</div>\n\n<p>The biggest reaction I get is from the presence of <code>{</code>curly braces<code>}</code>, but those are largely incidental as far as I&rsquo;m concerned. It&rsquo;s all about the indentation to me.</p>\n\n<p>A while back I found that my <code>.emacs</code> file was growing in proportion to my Racket code&mdash;all of it I had ever written, in fact. Every new macro in my code or in the latest Racket version needed a line like: <code>(put 'for/fold 'scheme-indent-function 2)</code>This would tell Emacs <em>more or less</em> how I wanted it to indent the given form. So long as I followed the use patterns Emacs could cope with. For instance, with <code>for/fold</code>, Emacs could cope with both of the &ldquo;special&rdquo; arguments on the same line as the macro name, or both on separate lines. Changing that up got weird results.</p>\n\n<p>Also, function arguments would lead to significant rightward-creep in my indentation. Adding up the lengths of a list of strings, for instance, might look like this:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"nb\">foldl</span> <span class=\"nb\">+</span>\n       <span class=\"mi\">0</span>\n       <span class=\"p\">(</span><span class=\"nb\">map</span> <span class=\"nb\">string-length</span>\n            <span class=\"p\">(</span><span class=\"nb\">list</span> <span class=\"s2\">\"There\"</span>\n                  <span class=\"s2\">\"are\"</span>\n                  <span class=\"s2\">\"thirty-four\"</span>\n                  <span class=\"s2\">\"characters\"</span>\n                  <span class=\"s2\">\"here.\"</span><span class=\"p\">)))</span>\n</pre></div>\n\n</div>\n\n<p>This wastes a lot of space on the left, and to me it doesn&rsquo;t do enough for readability to justify it. I don&rsquo;t need my eyes drawn to <code>0</code> and <code>+</code> nearly that much.</p>\n\n<p>I discovered a new style of indentation in the {_Little_, <em>Seasoned</em>, <em>Reasoned</em>} <em>Schemer</em> series of books by Dan Friedman and his many cohorts. These books always start a new indentation level at a fixed distance in from the previous one, regardless of the cause for the indentation. Arguments on the same line as the function or macro name are ignored; they do not &ldquo;push&rdquo; indentation over to the right at all.</p>\n\n<p>This indentation style has a lot of appeal to me for a number of reasons. One, it wastes no space on the left. Two, it never needs to &ldquo;know&rdquo; what a given macro means. It doesn&rsquo;t matter if you&rsquo;re applying <code>+</code> or <code>lambda</code> or <code>for/fold</code>, all lines beyond the first move two (or however many) characters to the right. I saw a light at the end of the tunnel: no more <code>.emacs</code> customization for every new form!</p>\n\n<p>This style leaves two issues. One, how to indent <code>cond</code>? The <em>Little</em> books treat <code>cond</code> differently, indenting each clause only as far as the keyword <code>cond</code>, while other form&rsquo;s arguments are pushed in slightly farther than the function or macro name. Two, how to &ldquo;fix&rdquo; forms like <code>for/fold</code> where a few lines really ought to be indented differently? A straight-up interpretation of this style would generate code like this:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">for/fold</span>\n  <span class=\"p\">([</span><span class=\"n\">x</span> <span class=\"mi\">0</span><span class=\"p\">])</span>\n  <span class=\"p\">([</span><span class=\"n\">str</span> <span class=\"p\">(</span><span class=\"nb\">in-list</span> <span class=\"o\">&#39;</span><span class=\"p\">(</span><span class=\"s2\">\"12\"</span> <span class=\"s2\">\"characters\"</span><span class=\"p\">))])</span>\n  <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"n\">n</span> <span class=\"p\">(</span><span class=\"nb\">string-length</span> <span class=\"n\">str</span><span class=\"p\">))</span>\n  <span class=\"p\">(</span><span class=\"nb\">+</span> <span class=\"n\">x</span> <span class=\"n\">n</span><span class=\"p\">))</span>\n</pre></div>\n\n</div>\n\n<p>Now we can&rsquo;t tell visually where the <code>for/fold</code> iteration clauses leave off and the loop body definitions and expressions begin.</p>\n\n<p>The <code>cond</code> issue is easy enough to resolve. In Racket, unlike in vanilla Scheme, we use <code>[</code>brackets<code>]</code> around <code>cond</code> clauses. The same goes for a number of other repeated clauses, in fact: <code>let</code>, <code>match</code>, <code>syntax-parse</code>, and so forth. So I decided my new, custom indentation style would indent <code>[</code>brackets<code>]</code> differently from <code>(</code>parentheses<code>)</code>. Parens indent one farther than brackets. That way,</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">let</span> <span class=\"p\">([</span><span class=\"n\">x</span> <span class=\"mi\">1</span><span class=\"p\">]</span>\n      <span class=\"p\">[</span><span class=\"n\">y</span> <span class=\"mi\">2</span><span class=\"p\">])</span>\n  <span class=\"p\">(</span><span class=\"nb\">+</span> <span class=\"n\">x</span> <span class=\"n\">y</span><span class=\"p\">))</span><span class=\"o\">`</span><span class=\"ss\">doesn</span><span class=\"o\">&#39;</span><span class=\"ss\">t</span> <span class=\"n\">become</span>\n\n<span class=\"o\">`</span><span class=\"p\">(</span><span class=\"ss\">let</span> <span class=\"p\">([</span><span class=\"ss\">x</span> <span class=\"mi\">1</span><span class=\"p\">]</span>\n       <span class=\"p\">[</span><span class=\"ss\">y</span> <span class=\"mi\">2</span><span class=\"p\">])</span>\n  <span class=\"p\">(</span><span class=\"ss\">+</span> <span class=\"ss\">x</span> <span class=\"ss\">y</span><span class=\"p\">))</span>\n</pre></div>\n\n</div>\n\n<p>Since I already use <code>[</code>brackets<code>]</code> every time I have a repeated, non-expression clause, this rule does exactly what I need it to do.</p>\n\n<p>Once I had differentiated <code>[]</code> from <code>()</code>, resolving the <code>for/fold</code> issue was obvious. I needed a new indentation rule and a new lexical marker: <code>{</code>braces<code>}</code>. Now every time I have a <em>fixed number</em> of special non-expression forms in a macro, I wrap them in braces. Anything in braces is indented slightly farther (four spaces rather than two) than ordinary sub-expressions. So my <code>for/fold</code> example comes out like this.</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">for/fold</span>\n    <span class=\"p\">{[</span><span class=\"n\">x</span> <span class=\"mi\">0</span><span class=\"p\">]}</span>\n    <span class=\"p\">{[</span><span class=\"n\">str</span> <span class=\"p\">(</span><span class=\"nb\">in-list</span> <span class=\"o\">&#39;</span><span class=\"p\">(</span><span class=\"s2\">\"12\"</span> <span class=\"s2\">\"characters\"</span><span class=\"p\">))]}</span>\n  <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"n\">n</span> <span class=\"p\">(</span><span class=\"nb\">string-length</span> <span class=\"n\">str</span><span class=\"p\">))</span>\n  <span class=\"p\">(</span><span class=\"nb\">+</span> <span class=\"n\">x</span> <span class=\"n\">n</span><span class=\"p\">))</span>\n</pre></div>\n\n</div>\n\n<p>Suddently it&rsquo;s quite clear which parts are &ldquo;special&rdquo; in the <code>for/fold</code> macro.</p>\n\n<p>So now I write code using <code>(</code>parentheses<code>)</code> for definitions, expressions, and anything else resembling a nestable, expandable term (e.g. <code>match</code> patterns, syntax templates), <code>[</code>brackets<code>]</code> for repeated, non-expandable clauses (e.g. <code>cond</code> clauses, <code>let</code> bindings), and <code>{</code>braces<code>}</code> for non-repeated, non-expandable forms (e.g. <code>lambda</code> formals, <em>groups</em> of <code>let</code> bindings). And I don&rsquo;t bother to align function arguments; I tend to treat the most significant argument as an &ldquo;accumulator&rdquo;, and put everything else on one line if I can.</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"nb\">foldl</span> <span class=\"nb\">+</span> <span class=\"mi\">0</span>\n  <span class=\"p\">(</span><span class=\"nb\">map</span> <span class=\"nb\">string-length</span>\n    <span class=\"p\">(</span><span class=\"nb\">list</span>\n      <span class=\"s2\">\"There\"</span>\n      <span class=\"s2\">\"are\"</span>\n      <span class=\"s2\">\"thirty-four\"</span>\n      <span class=\"s2\">\"characters\"</span>\n      <span class=\"s2\">\"here.\"</span><span class=\"p\">)))</span>\n</pre></div>\n\n</div>\n\n<p>The way I read this code, the first line tells us we are performing a summation; the second line tells us we want the length of each string; the third line tells us we have a list coming; and the rest give its contents. The result &ldquo;accumulates&rdquo; from a list to its lengths to their sum as the indentation cascades out and up from the inside.</p>\n\n<p>With these three rules, I now write my Racket code without bothering to customize my <code>.emacs</code> file as I go. I just use delimiters judiciously to tell Emacs how I want everything indented, and everything comes out pretty much how I want it.</p>\n\n<p>For anyone interested in installing this indentation mode or looking at its source code, I&rsquo;ve put the file up on GitHub at:</p>\n\n<p><a href=\"https://github.com/carl-eastlund/simple-sexp\">https://github.com/carl-eastlund/simple-sexp</a></p>\n\n<p>To use it, just put it somewhere your Emacs knows to look for Elisp code and add <code>(require 'simple-sexp)</code> to your <code>.emacs</code> file.</p>\n\n<p><strong>Addendum:</strong> Oh, and there&rsquo;s some structured s-expression editing code in that file as well. It preserves matched parens, brackets, braces, and quotes (for strings). It&rsquo;s probably a much inferior implementation of things like paredit; this code represents the flailings of an Elisp novice. Use at your own peril.</p>") #t (u . "\n<p><em>posted by Carl Eastlund</em></p>\n\n<p>A lot of people are quite surprised when they see the Racket code I write. Let&rsquo;s say I needed a function to render hash table values as expressions that would produce the same value. A &ldquo;normal&rdquo; Racketeer might write something like the following.</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">hash-&gt;expr</span> <span class=\"n\">ht</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"nb\">cons</span> <span class=\"o\">&#39;</span><span class=\"ss\">hash</span>\n        <span class=\"p\">(</span><span class=\"k\">for/fold</span> <span class=\"p\">([</span><span class=\"n\">args</span> <span class=\"o\">&#39;</span><span class=\"p\">()])</span>\n                  <span class=\"p\">([(</span><span class=\"n\">k</span> <span class=\"n\">v</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"nb\">in-hash</span> <span class=\"n\">ht</span><span class=\"p\">)])</span>\n          <span class=\"p\">(</span><span class=\"nb\">cons</span> <span class=\"p\">(</span><span class=\"nb\">list</span> <span class=\"o\">&#39;</span><span class=\"ss\">quote</span> <span class=\"n\">k</span><span class=\"p\">)</span>\n                <span class=\"p\">(</span><span class=\"nb\">cons</span> <span class=\"p\">(</span><span class=\"nb\">list</span> <span class=\"o\">&#39;</span><span class=\"ss\">quote</span> <span class=\"n\">v</span><span class=\"p\">)</span>\n                      <span class=\"n\">args</span><span class=\"p\">)))))</span>\n</pre></div>\n\n</div>\n\n<p>There might be a few variances in style, especially depending on whether one has Racket or Emacs set up to indent <code>for/fold</code> specially. Almost no one, however, would come up with the code I write.</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">hash-&gt;expr</span> <span class=\"n\">ht</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"nb\">cons</span> <span class=\"o\">&#39;</span><span class=\"ss\">hash</span>\n    <span class=\"p\">(</span><span class=\"k\">for/fold</span>\n        <span class=\"p\">{[</span><span class=\"n\">args</span> <span class=\"o\">&#39;</span><span class=\"p\">()]}</span>\n        <span class=\"p\">{[{</span><span class=\"n\">k</span> <span class=\"n\">v</span><span class=\"p\">}</span> <span class=\"p\">(</span><span class=\"nb\">in-hash</span> <span class=\"n\">ht</span><span class=\"p\">)]}</span>\n      <span class=\"p\">(</span><span class=\"nb\">cons</span> <span class=\"p\">(</span><span class=\"nb\">list</span> <span class=\"o\">&#39;</span><span class=\"ss\">quote</span> <span class=\"n\">k</span><span class=\"p\">)</span>\n        <span class=\"p\">(</span><span class=\"nb\">cons</span> <span class=\"p\">(</span><span class=\"nb\">list</span> <span class=\"o\">&#39;</span><span class=\"ss\">quote</span> <span class=\"n\">v</span><span class=\"p\">)</span>\n          <span class=\"n\">args</span><span class=\"p\">)))))</span>\n</pre></div>\n\n</div>\n\n<p>The biggest reaction I get is from the presence of <code>{</code>curly braces<code>}</code>, but those are largely incidental as far as I&rsquo;m concerned. It&rsquo;s all about the indentation to me.</p>\n\n<p>A while back I found that my <code>.emacs</code> file was growing in proportion to my Racket code&mdash;all of it I had ever written, in fact. Every new macro in my code or in the latest Racket version needed a line like: <code>(put 'for/fold 'scheme-indent-function 2)</code>This would tell Emacs <em>more or less</em> how I wanted it to indent the given form. So long as I followed the use patterns Emacs could cope with. For instance, with <code>for/fold</code>, Emacs could cope with both of the &ldquo;special&rdquo; arguments on the same line as the macro name, or both on separate lines. Changing that up got weird results.</p>\n\n<p>Also, function arguments would lead to significant rightward-creep in my indentation. Adding up the lengths of a list of strings, for instance, might look like this:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"nb\">foldl</span> <span class=\"nb\">+</span>\n       <span class=\"mi\">0</span>\n       <span class=\"p\">(</span><span class=\"nb\">map</span> <span class=\"nb\">string-length</span>\n            <span class=\"p\">(</span><span class=\"nb\">list</span> <span class=\"s2\">\"There\"</span>\n                  <span class=\"s2\">\"are\"</span>\n                  <span class=\"s2\">\"thirty-four\"</span>\n                  <span class=\"s2\">\"characters\"</span>\n                  <span class=\"s2\">\"here.\"</span><span class=\"p\">)))</span>\n</pre></div>\n\n</div>\n\n<p>This wastes a lot of space on the left, and to me it doesn&rsquo;t do enough for readability to justify it. I don&rsquo;t need my eyes drawn to <code>0</code> and <code>+</code> nearly that much.</p>\n\n<p>I discovered a new style of indentation in the {_Little_, <em>Seasoned</em>, <em>Reasoned</em>} <em>Schemer</em> series of books by Dan Friedman and his many cohorts. These books always start a new indentation level at a fixed distance in from the previous one, regardless of the cause for the indentation. Arguments on the same line as the function or macro name are ignored; they do not &ldquo;push&rdquo; indentation over to the right at all.</p>\n\n<p>This indentation style has a lot of appeal to me for a number of reasons. One, it wastes no space on the left. Two, it never needs to &ldquo;know&rdquo; what a given macro means. It doesn&rsquo;t matter if you&rsquo;re applying <code>+</code> or <code>lambda</code> or <code>for/fold</code>, all lines beyond the first move two (or however many) characters to the right. I saw a light at the end of the tunnel: no more <code>.emacs</code> customization for every new form!</p>\n\n<p>This style leaves two issues. One, how to indent <code>cond</code>? The <em>Little</em> books treat <code>cond</code> differently, indenting each clause only as far as the keyword <code>cond</code>, while other form&rsquo;s arguments are pushed in slightly farther than the function or macro name. Two, how to &ldquo;fix&rdquo; forms like <code>for/fold</code> where a few lines really ought to be indented differently? A straight-up interpretation of this style would generate code like this:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">for/fold</span>\n  <span class=\"p\">([</span><span class=\"n\">x</span> <span class=\"mi\">0</span><span class=\"p\">])</span>\n  <span class=\"p\">([</span><span class=\"n\">str</span> <span class=\"p\">(</span><span class=\"nb\">in-list</span> <span class=\"o\">&#39;</span><span class=\"p\">(</span><span class=\"s2\">\"12\"</span> <span class=\"s2\">\"characters\"</span><span class=\"p\">))])</span>\n  <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"n\">n</span> <span class=\"p\">(</span><span class=\"nb\">string-length</span> <span class=\"n\">str</span><span class=\"p\">))</span>\n  <span class=\"p\">(</span><span class=\"nb\">+</span> <span class=\"n\">x</span> <span class=\"n\">n</span><span class=\"p\">))</span>\n</pre></div>\n\n</div>\n\n<p>Now we can&rsquo;t tell visually where the <code>for/fold</code> iteration clauses leave off and the loop body definitions and expressions begin.</p>\n\n<p>The <code>cond</code> issue is easy enough to resolve. In Racket, unlike in vanilla Scheme, we use <code>[</code>brackets<code>]</code> around <code>cond</code> clauses. The same goes for a number of other repeated clauses, in fact: <code>let</code>, <code>match</code>, <code>syntax-parse</code>, and so forth. So I decided my new, custom indentation style would indent <code>[</code>brackets<code>]</code> differently from <code>(</code>parentheses<code>)</code>. Parens indent one farther than brackets. That way,</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">let</span> <span class=\"p\">([</span><span class=\"n\">x</span> <span class=\"mi\">1</span><span class=\"p\">]</span>\n      <span class=\"p\">[</span><span class=\"n\">y</span> <span class=\"mi\">2</span><span class=\"p\">])</span>\n  <span class=\"p\">(</span><span class=\"nb\">+</span> <span class=\"n\">x</span> <span class=\"n\">y</span><span class=\"p\">))</span><span class=\"o\">`</span><span class=\"ss\">doesn</span><span class=\"o\">&#39;</span><span class=\"ss\">t</span> <span class=\"n\">become</span>\n\n<span class=\"o\">`</span><span class=\"p\">(</span><span class=\"ss\">let</span> <span class=\"p\">([</span><span class=\"ss\">x</span> <span class=\"mi\">1</span><span class=\"p\">]</span>\n       <span class=\"p\">[</span><span class=\"ss\">y</span> <span class=\"mi\">2</span><span class=\"p\">])</span>\n  <span class=\"p\">(</span><span class=\"ss\">+</span> <span class=\"ss\">x</span> <span class=\"ss\">y</span><span class=\"p\">))</span>\n</pre></div>\n\n</div>\n\n<p>Since I already use <code>[</code>brackets<code>]</code> every time I have a repeated, non-expression clause, this rule does exactly what I need it to do.</p>\n\n<p>Once I had differentiated <code>[]</code> from <code>()</code>, resolving the <code>for/fold</code> issue was obvious. I needed a new indentation rule and a new lexical marker: <code>{</code>braces<code>}</code>. Now every time I have a <em>fixed number</em> of special non-expression forms in a macro, I wrap them in braces. Anything in braces is indented slightly farther (four spaces rather than two) than ordinary sub-expressions. So my <code>for/fold</code> example comes out like this.</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">for/fold</span>\n    <span class=\"p\">{[</span><span class=\"n\">x</span> <span class=\"mi\">0</span><span class=\"p\">]}</span>\n    <span class=\"p\">{[</span><span class=\"n\">str</span> <span class=\"p\">(</span><span class=\"nb\">in-list</span> <span class=\"o\">&#39;</span><span class=\"p\">(</span><span class=\"s2\">\"12\"</span> <span class=\"s2\">\"characters\"</span><span class=\"p\">))]}</span>\n  <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"n\">n</span> <span class=\"p\">(</span><span class=\"nb\">string-length</span> <span class=\"n\">str</span><span class=\"p\">))</span>\n  <span class=\"p\">(</span><span class=\"nb\">+</span> <span class=\"n\">x</span> <span class=\"n\">n</span><span class=\"p\">))</span>\n</pre></div>\n\n</div>\n\n<p>Suddently it&rsquo;s quite clear which parts are &ldquo;special&rdquo; in the <code>for/fold</code> macro.</p>\n\n<p>So now I write code using <code>(</code>parentheses<code>)</code> for definitions, expressions, and anything else resembling a nestable, expandable term (e.g. <code>match</code> patterns, syntax templates), <code>[</code>brackets<code>]</code> for repeated, non-expandable clauses (e.g. <code>cond</code> clauses, <code>let</code> bindings), and <code>{</code>braces<code>}</code> for non-repeated, non-expandable forms (e.g. <code>lambda</code> formals, <em>groups</em> of <code>let</code> bindings). And I don&rsquo;t bother to align function arguments; I tend to treat the most significant argument as an &ldquo;accumulator&rdquo;, and put everything else on one line if I can.</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"nb\">foldl</span> <span class=\"nb\">+</span> <span class=\"mi\">0</span>\n  <span class=\"p\">(</span><span class=\"nb\">map</span> <span class=\"nb\">string-length</span>\n    <span class=\"p\">(</span><span class=\"nb\">list</span>\n      <span class=\"s2\">\"There\"</span>\n      <span class=\"s2\">\"are\"</span>\n      <span class=\"s2\">\"thirty-four\"</span>\n      <span class=\"s2\">\"characters\"</span>\n      <span class=\"s2\">\"here.\"</span><span class=\"p\">)))</span>\n</pre></div>\n\n</div>\n\n<p>The way I read this code, the first line tells us we are performing a summation; the second line tells us we want the length of each string; the third line tells us we have a list coming; and the rest give its contents. The result &ldquo;accumulates&rdquo; from a list to its lengths to their sum as the indentation cascades out and up from the inside.</p>\n\n<p>With these three rules, I now write my Racket code without bothering to customize my <code>.emacs</code> file as I go. I just use delimiters judiciously to tell Emacs how I want everything indented, and everything comes out pretty much how I want it.</p>\n\n<p>For anyone interested in installing this indentation mode or looking at its source code, I&rsquo;ve put the file up on GitHub at:</p>\n\n<p><a href=\"https://github.com/carl-eastlund/simple-sexp\">https://github.com/carl-eastlund/simple-sexp</a></p>\n\n<p>To use it, just put it somewhere your Emacs knows to look for Elisp code and add <code>(require 'simple-sexp)</code> to your <code>.emacs</code> file.</p>\n\n<p><strong>Addendum:</strong> Oh, and there&rsquo;s some structured s-expression editing code in that file as well. It preserves matched parens, brackets, braces, and quotes (for strings). It&rsquo;s probably a much inferior implementation of things like paredit; this code represents the flailings of an Elisp novice. Use at your own peril.</p>\n<!-- more-->\n\n<hr />\n\n<p>Beautiful!</p>\n\n<p>— <em>Robby Findler, 28 September 2012</em></p>\n\n<hr />\n\n<p>There is a good reason for the arguments of a function to be lined up: it makes the sexpr tree easily visible, no thoughts on how things match up needed. And indeed, as someone who is used to having this very visible structure, I find the two-space indentation for all arguments except for the first that is left on the first line much harder to read. Combined with multiple expressions on the first line I can see how this can get to be even worse (though not with simple \"+\" and &ldquo;0&rdquo;). (Obviously, you&rsquo;ll disagree as someone who is used to not getting these visual cues, which is why these are fertile flamewar materials.)</p>\n\n<p>In addition, IIUC, the curly brace thing is a way that forces you to specify stuff on each and every form, instead of making your editor know about these forms &mdash; and in that case it looks like a bad deal for me, sacrificing visual readability, and overall requiring me to do more work than adding one more name into my editor configuration.</p>\n\n<p>— <em>Eli Barzilay, 28 September 2012</em></p>\n\n<hr />\n\n<p>re:Eli &mdash;</p>\n\n<p>Yep, this style definitely isn&rsquo;t for everyone, and it&rsquo;s definitely got some huge tradeoffs. I am acutely aware that I sometimes sacrifice the ability to easily tell how many arguments something has, and that&rsquo;s one place I&rsquo;m not sure I made the right decision. I am careful to only put multiple things on the same line if they&rsquo;re right after the function name, or in the case of functions like error or printf where I&rsquo;m just filling in values for the \"~a\" or \"~s\" escapes. Otherwise, after the first line, I definitely want a clear visual marker of how many arguments there are.</p>\n\n<p>As for the curly braces, I like that I have to put some thought into the indentation myself. The braces give more than just whitespace to say what&rsquo;s &ldquo;special&rdquo;. Frankly I&rsquo;m annoyed at how much extra duty () does, and I prefer making an explicit distinction.</p>\n\n<p>But I&rsquo;m definitely not trying to sway anyone here away from traditional Racket style, just presenting my own odd habits.</p>\n\n<p>— <em>Carl Eastlund, 28 September 2012</em></p>\n\n<hr />")) ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2010-10-03-the-two-state-solution-native-and-serializable-continuations-accord.md" . unix) f post (u . "The Two-State Solution: Native and Serializable Continuations Accord") (? . 108) 1467223812 (p+ #"/Users/MB/git/racket-lang-org/blog/2010/10/the-two-state-solution-native-and-serializable-continuations-accord.html" . unix) "/2010/10/the-two-state-solution-native-and-serializable-continuations-accord.html" (u . "2010-10-03T00:57:00.000-04:00") (? . 51) (? . 107) (c (u . "")) (u . "\n<p><em>posted by Jay McCarthy</em></p>\n\n<p>The Racket Web Server allows an expressive way of writing Web applications using first-class continuations to capture the control-flow of the server while it is waiting for the client to respond. For example:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"kn\">#lang </span><span class=\"nn\">web-server/insta</span>\n<span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">get-number</span> <span class=\"n\">p</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"nb\">string-&gt;number</span>\n   <span class=\"p\">(</span><span class=\"n\">extract-binding/single</span>\n    <span class=\"o\">&#39;</span><span class=\"ss\">num</span>\n    <span class=\"p\">(</span><span class=\"n\">request-bindings</span>\n     <span class=\"p\">(</span><span class=\"n\">send/suspend</span>\n      <span class=\"p\">(</span><span class=\"k\">λ</span> <span class=\"p\">(</span><span class=\"n\">k-url</span><span class=\"p\">)</span>\n        <span class=\"o\">`</span><span class=\"p\">(</span><span class=\"ss\">html</span> \n          <span class=\"p\">(</span><span class=\"ss\">body</span>\n           <span class=\"p\">(</span><span class=\"ss\">form</span> <span class=\"p\">([</span><span class=\"ss\">action</span> <span class=\"o\">,</span><span class=\"n\">k-url</span><span class=\"p\">])</span>\n                 <span class=\"o\">,</span><span class=\"n\">p</span> <span class=\"ss\">nbsp</span> <span class=\"p\">(</span><span class=\"ss\">input</span> <span class=\"p\">([</span><span class=\"ss\">name</span> <span class=\"s2\">\"num\"</span><span class=\"p\">]))</span>\n                 <span class=\"p\">(</span><span class=\"ss\">input</span> <span class=\"p\">([</span><span class=\"ss\">type</span> <span class=\"s2\">\"submit\"</span><span class=\"p\">])))))))))))</span>\n<span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">start</span> <span class=\"n\">req</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"n\">how-many</span>\n    <span class=\"p\">(</span><span class=\"n\">get-number</span> <span class=\"s2\">\"How many numbers to add?\"</span><span class=\"p\">))</span>\n  <span class=\"p\">(</span><span class=\"nb\">number-&gt;string</span>\n   <span class=\"p\">(</span><span class=\"nb\">foldr</span> \n    <span class=\"nb\">+</span> <span class=\"mi\">0</span>\n    <span class=\"p\">(</span><span class=\"nb\">build-list</span> \n     <span class=\"n\">how-many</span>\n     <span class=\"p\">(</span><span class=\"k\">λ</span> <span class=\"p\">(</span><span class=\"n\">i</span><span class=\"p\">)</span>\n       <span class=\"p\">(</span><span class=\"n\">get-number</span> \n        <span class=\"p\">(</span><span class=\"nb\">format</span> <span class=\"s2\">\"Provide number: ~a\"</span> \n                <span class=\"p\">(</span><span class=\"nb\">add1</span> <span class=\"n\">i</span><span class=\"p\">))))))))</span>\n</pre></div>\n\n</div>\n\n<p>This application creates a re-usable <code>get-number</code> interaction abstraction and uses it in a number of different contexts. In particular, it uses it in the higher-order context of <code>build-list</code>. This application also reuses useful third-party library functions like <code>foldr</code>, etc.</p>\n\n<p>Such an application would be complicated to write in a traditional Web programming environment because the continuation of each <code>get-number</code> invocation is considerably more complex than is typical. Yet, the first-class continuations in Racket ensure that this continuation is captured exactly, correctly, every time.</p>\n\n<p>Unfortunately, the native first-class continuations of Racket are not serializable, so they impose a per-session resource expenditure on the server. This can be alleviated through <a href=\"http://docs.racket-lang.org/web-server/servlet.html#(part._managers)\">expiration policies</a>, but such policies are inherently unsound because continuations URLs are global roots.</p>\n\n<p>In the past, PLT has <a href=\"http://cs.brown.edu/~sk/Publications/Papers/Published/mfgkf-web-restructuring-cps-journal/\">provided tools</a> that automatically restructure this kind of program into one that uses serializable continuations through an acronym soup of source transformations: CPS, lambda-lifting, defunctionalization, SPS, and so on. These tools effectively create automatically what most Web programmers write manually, except the tools don&rsquo;t mistakes. But the tools also don&rsquo;t take into consideration what functions actually contribute to the interaction context and transform library functions like <code>foldr</code> (which is unnecessary in the continuation) the same as functions like <code>build-list</code> (which <em>are</em> necessary.)</p>\n\n<p>Our <a href=\"http://faculty.cs.byu.edu/~jay/static/icfp065-mccarthy.pdf\">past work</a> (based on <a href=\"http://cs.brown.edu/~sk/Publications/Papers/Published/pcmkf-cont-from-gen-stack-insp/\">another PLT paper</a>) alleviates this problem by only requiring functions like <code>build-list</code> to be transformed. From the perspective of a programmer, &ldquo;transformed&rdquo; is tantamount to &ldquo;rewritten&rdquo; because the source code for a third-party library may not be readily available. Programmers would have to program <code>add-many-numbers.com</code> as:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"kn\">#lang </span><span class=\"nn\">web-server</span>\n<span class=\"p\">(</span><span class=\"k\">require</span> <span class=\"n\">web-server/servlet-env</span><span class=\"p\">)</span>\n<span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">get-number</span> <span class=\"n\">p</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"nb\">string-&gt;number</span>\n   <span class=\"p\">(</span><span class=\"n\">extract-binding/single</span>\n    <span class=\"o\">&#39;</span><span class=\"ss\">num</span>\n    <span class=\"p\">(</span><span class=\"n\">request-bindings</span>\n     <span class=\"p\">(</span><span class=\"n\">send/suspend</span>\n      <span class=\"p\">(</span><span class=\"k\">λ</span> <span class=\"p\">(</span><span class=\"n\">k-url</span><span class=\"p\">)</span>\n        <span class=\"o\">`</span><span class=\"p\">(</span><span class=\"ss\">html</span> \n          <span class=\"p\">(</span><span class=\"ss\">body</span>\n           <span class=\"p\">(</span><span class=\"ss\">form</span> <span class=\"p\">([</span><span class=\"ss\">action</span> <span class=\"o\">,</span><span class=\"n\">k-url</span><span class=\"p\">])</span>\n                 <span class=\"o\">,</span><span class=\"n\">p</span> <span class=\"ss\">nbsp</span> <span class=\"p\">(</span><span class=\"ss\">input</span> <span class=\"p\">([</span><span class=\"ss\">name</span> <span class=\"s2\">\"num\"</span><span class=\"p\">]))</span>\n                 <span class=\"p\">(</span><span class=\"ss\">input</span> <span class=\"p\">([</span><span class=\"ss\">type</span> <span class=\"s2\">\"submit\"</span><span class=\"p\">])))))))))))</span>\n<span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"nb\">build-list</span> <span class=\"n\">n</span> <span class=\"n\">f</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"k\">for/list</span> <span class=\"p\">([</span><span class=\"n\">i</span> <span class=\"p\">(</span><span class=\"nb\">in-range</span> <span class=\"n\">n</span><span class=\"p\">)])</span>\n    <span class=\"p\">(</span><span class=\"n\">f</span> <span class=\"n\">i</span><span class=\"p\">)))</span>\n<span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">start</span> <span class=\"n\">req</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"n\">how-many</span>\n    <span class=\"p\">(</span><span class=\"n\">get-number</span> <span class=\"s2\">\"How many numbers to add?\"</span><span class=\"p\">))</span>\n  <span class=\"p\">(</span><span class=\"nb\">number-&gt;string</span>\n   <span class=\"p\">(</span><span class=\"nb\">foldr</span> \n    <span class=\"nb\">+</span> <span class=\"mi\">0</span>\n    <span class=\"p\">(</span><span class=\"nb\">build-list</span>\n     <span class=\"n\">how-many</span>\n     <span class=\"p\">(</span><span class=\"k\">λ</span> <span class=\"p\">(</span><span class=\"n\">i</span><span class=\"p\">)</span>\n       <span class=\"p\">(</span><span class=\"n\">get-number</span> \n        <span class=\"p\">(</span><span class=\"nb\">format</span> <span class=\"s2\">\"Provide number: ~a\"</span>\n                <span class=\"p\">(</span><span class=\"nb\">add1</span> <span class=\"n\">i</span><span class=\"p\">))))))))</span>\n<span class=\"c1\">; This requires a pre-release version</span>\n<span class=\"c1\">; to run in an un-named DrRacket buffer</span>\n<span class=\"p\">(</span><span class=\"n\">serve/servlet</span> <span class=\"n\">start</span> <span class=\"kd\">#:stateless?</span> <span class=\"no\">#t</span><span class=\"p\">)</span>\n</pre></div>\n\n</div>\n\n<p>where <code>build-list</code> has been re-implemented, but functions like <code>foldr</code> have not. This application, despite its striking similarity to the first, requires absolutely no per-session server state, so it is considerably more scalable.</p>\n\n<p>Do we need to re-implement <code>build-list</code>? What if the third-party, higher-order function (<code>build-list</code>) that we use with a higher-order argument that causes Web interaction (<code>get-number</code>) is too complicated to re-implement?</p>\n\n<p>Naturally this blog post would not exist if we didn&rsquo;t solve this problem.</p>\n\n<p>Our new approach, dubbed The Two-State Solution, allows the programmer to transparently use a very small amount of per-session server state to store <em>just</em> the part of the continuation inside functions like <code>build-list</code> while serializing everything else to the client.</p>\n\n<p>The key is to use <a href=\"http://docs.racket-lang.org/reference/eval-model.html#(part._prompt-model)\">delimited, composable continuations</a> to isolate the appropriate part of the continuation. The programmer designates this piece of the continuation through the <code>serial-&gt;native</code> and <code>native-&gt;serial</code> annotations. The programmer can write the application as:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"kn\">#lang </span><span class=\"nn\">web-server</span>\n<span class=\"p\">(</span><span class=\"k\">require</span> <span class=\"n\">web-server/servlet-env</span><span class=\"p\">)</span>\n<span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">get-number</span> <span class=\"n\">p</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"nb\">string-&gt;number</span>\n   <span class=\"p\">(</span><span class=\"n\">extract-binding/single</span>\n    <span class=\"o\">&#39;</span><span class=\"ss\">num</span>\n    <span class=\"p\">(</span><span class=\"n\">request-bindings</span>\n     <span class=\"p\">(</span><span class=\"n\">send/suspend</span>\n      <span class=\"p\">(</span><span class=\"k\">λ</span> <span class=\"p\">(</span><span class=\"n\">k-url</span><span class=\"p\">)</span>\n        <span class=\"o\">`</span><span class=\"p\">(</span><span class=\"ss\">html</span> \n          <span class=\"p\">(</span><span class=\"ss\">body</span>\n           <span class=\"p\">(</span><span class=\"ss\">form</span> <span class=\"p\">([</span><span class=\"ss\">action</span> <span class=\"o\">,</span><span class=\"n\">k-url</span><span class=\"p\">])</span>\n                 <span class=\"o\">,</span><span class=\"n\">p</span> <span class=\"ss\">nbsp</span> <span class=\"p\">(</span><span class=\"ss\">input</span> <span class=\"p\">([</span><span class=\"ss\">name</span> <span class=\"s2\">\"num\"</span><span class=\"p\">]))</span>\n                 <span class=\"p\">(</span><span class=\"ss\">input</span> <span class=\"p\">([</span><span class=\"ss\">type</span> <span class=\"s2\">\"submit\"</span><span class=\"p\">])))))))))))</span>\n<span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">start</span> <span class=\"n\">req</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"n\">how-many</span>\n    <span class=\"p\">(</span><span class=\"n\">get-number</span> <span class=\"s2\">\"How many numbers to add?\"</span><span class=\"p\">))</span>\n  <span class=\"p\">(</span><span class=\"nb\">number-&gt;string</span>\n   <span class=\"p\">(</span><span class=\"nb\">foldr</span> \n    <span class=\"nb\">+</span> <span class=\"mi\">0</span>\n    <span class=\"p\">(</span><span class=\"n\">serial-&gt;native</span>\n     <span class=\"p\">(</span><span class=\"nb\">build-list</span>\n      <span class=\"n\">how-many</span>\n      <span class=\"p\">(</span><span class=\"k\">λ</span> <span class=\"p\">(</span><span class=\"n\">i</span><span class=\"p\">)</span>\n        <span class=\"p\">(</span><span class=\"n\">native-&gt;serial</span>\n         <span class=\"p\">(</span><span class=\"n\">get-number</span> \n          <span class=\"p\">(</span><span class=\"nb\">format</span> <span class=\"s2\">\"Provide number: ~a\"</span>\n                  <span class=\"p\">(</span><span class=\"nb\">add1</span> <span class=\"n\">i</span><span class=\"p\">))))))))))</span>\n<span class=\"c1\">; This requires a pre-release version</span>\n<span class=\"c1\">; to run in an un-named DrRacket buffer</span>\n<span class=\"p\">(</span><span class=\"n\">serve/servlet</span> <span class=\"n\">start</span> <span class=\"kd\">#:stateless?</span> <span class=\"no\">#t</span><span class=\"p\">)</span>\n</pre></div>\n\n</div>\n\n<p>The important distinction here is that both the <code>build-list</code> and the <code>get-number</code> abstractions do not need to change. We simply mark the context as being a &ldquo;serial&rdquo; or &ldquo;native&rdquo; context through the annotation forms. This re-written version will be more scalable than a purely native version, but represents an easier to achieve step in the evolution of a program, because third-party, higher-order functions can be used as is.</p>\n\n<p>This work will be presented at <a href=\"http://splashcon.org/index.php?option=com_content&amp;amp;view=article&amp;amp;id=122&amp;amp;Itemid=91\">OOPSLA 2010</a>. It is also described in a paper with same name this blog post:<a href=\"http://faculty.cs.byu.edu/~jay/static/oopsla026-mccarthy.pdf\">The Two-State Solution: Native and Serializable Continuations Accord</a>.</p>") #t (u . "\n<p><em>posted by Jay McCarthy</em></p>\n\n<p>The Racket Web Server allows an expressive way of writing Web applications using first-class continuations to capture the control-flow of the server while it is waiting for the client to respond. For example:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"kn\">#lang </span><span class=\"nn\">web-server/insta</span>\n<span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">get-number</span> <span class=\"n\">p</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"nb\">string-&gt;number</span>\n   <span class=\"p\">(</span><span class=\"n\">extract-binding/single</span>\n    <span class=\"o\">&#39;</span><span class=\"ss\">num</span>\n    <span class=\"p\">(</span><span class=\"n\">request-bindings</span>\n     <span class=\"p\">(</span><span class=\"n\">send/suspend</span>\n      <span class=\"p\">(</span><span class=\"k\">λ</span> <span class=\"p\">(</span><span class=\"n\">k-url</span><span class=\"p\">)</span>\n        <span class=\"o\">`</span><span class=\"p\">(</span><span class=\"ss\">html</span> \n          <span class=\"p\">(</span><span class=\"ss\">body</span>\n           <span class=\"p\">(</span><span class=\"ss\">form</span> <span class=\"p\">([</span><span class=\"ss\">action</span> <span class=\"o\">,</span><span class=\"n\">k-url</span><span class=\"p\">])</span>\n                 <span class=\"o\">,</span><span class=\"n\">p</span> <span class=\"ss\">nbsp</span> <span class=\"p\">(</span><span class=\"ss\">input</span> <span class=\"p\">([</span><span class=\"ss\">name</span> <span class=\"s2\">\"num\"</span><span class=\"p\">]))</span>\n                 <span class=\"p\">(</span><span class=\"ss\">input</span> <span class=\"p\">([</span><span class=\"ss\">type</span> <span class=\"s2\">\"submit\"</span><span class=\"p\">])))))))))))</span>\n<span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">start</span> <span class=\"n\">req</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"n\">how-many</span>\n    <span class=\"p\">(</span><span class=\"n\">get-number</span> <span class=\"s2\">\"How many numbers to add?\"</span><span class=\"p\">))</span>\n  <span class=\"p\">(</span><span class=\"nb\">number-&gt;string</span>\n   <span class=\"p\">(</span><span class=\"nb\">foldr</span> \n    <span class=\"nb\">+</span> <span class=\"mi\">0</span>\n    <span class=\"p\">(</span><span class=\"nb\">build-list</span> \n     <span class=\"n\">how-many</span>\n     <span class=\"p\">(</span><span class=\"k\">λ</span> <span class=\"p\">(</span><span class=\"n\">i</span><span class=\"p\">)</span>\n       <span class=\"p\">(</span><span class=\"n\">get-number</span> \n        <span class=\"p\">(</span><span class=\"nb\">format</span> <span class=\"s2\">\"Provide number: ~a\"</span> \n                <span class=\"p\">(</span><span class=\"nb\">add1</span> <span class=\"n\">i</span><span class=\"p\">))))))))</span>\n</pre></div>\n\n</div>\n\n<p>This application creates a re-usable <code>get-number</code> interaction abstraction and uses it in a number of different contexts. In particular, it uses it in the higher-order context of <code>build-list</code>. This application also reuses useful third-party library functions like <code>foldr</code>, etc.</p>\n\n<p>Such an application would be complicated to write in a traditional Web programming environment because the continuation of each <code>get-number</code> invocation is considerably more complex than is typical. Yet, the first-class continuations in Racket ensure that this continuation is captured exactly, correctly, every time.</p>\n\n<p>Unfortunately, the native first-class continuations of Racket are not serializable, so they impose a per-session resource expenditure on the server. This can be alleviated through <a href=\"http://docs.racket-lang.org/web-server/servlet.html#(part._managers)\">expiration policies</a>, but such policies are inherently unsound because continuations URLs are global roots.</p>\n\n<p>In the past, PLT has <a href=\"http://cs.brown.edu/~sk/Publications/Papers/Published/mfgkf-web-restructuring-cps-journal/\">provided tools</a> that automatically restructure this kind of program into one that uses serializable continuations through an acronym soup of source transformations: CPS, lambda-lifting, defunctionalization, SPS, and so on. These tools effectively create automatically what most Web programmers write manually, except the tools don&rsquo;t mistakes. But the tools also don&rsquo;t take into consideration what functions actually contribute to the interaction context and transform library functions like <code>foldr</code> (which is unnecessary in the continuation) the same as functions like <code>build-list</code> (which <em>are</em> necessary.)</p>\n\n<p>Our <a href=\"http://faculty.cs.byu.edu/~jay/static/icfp065-mccarthy.pdf\">past work</a> (based on <a href=\"http://cs.brown.edu/~sk/Publications/Papers/Published/pcmkf-cont-from-gen-stack-insp/\">another PLT paper</a>) alleviates this problem by only requiring functions like <code>build-list</code> to be transformed. From the perspective of a programmer, &ldquo;transformed&rdquo; is tantamount to &ldquo;rewritten&rdquo; because the source code for a third-party library may not be readily available. Programmers would have to program <code>add-many-numbers.com</code> as:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"kn\">#lang </span><span class=\"nn\">web-server</span>\n<span class=\"p\">(</span><span class=\"k\">require</span> <span class=\"n\">web-server/servlet-env</span><span class=\"p\">)</span>\n<span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">get-number</span> <span class=\"n\">p</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"nb\">string-&gt;number</span>\n   <span class=\"p\">(</span><span class=\"n\">extract-binding/single</span>\n    <span class=\"o\">&#39;</span><span class=\"ss\">num</span>\n    <span class=\"p\">(</span><span class=\"n\">request-bindings</span>\n     <span class=\"p\">(</span><span class=\"n\">send/suspend</span>\n      <span class=\"p\">(</span><span class=\"k\">λ</span> <span class=\"p\">(</span><span class=\"n\">k-url</span><span class=\"p\">)</span>\n        <span class=\"o\">`</span><span class=\"p\">(</span><span class=\"ss\">html</span> \n          <span class=\"p\">(</span><span class=\"ss\">body</span>\n           <span class=\"p\">(</span><span class=\"ss\">form</span> <span class=\"p\">([</span><span class=\"ss\">action</span> <span class=\"o\">,</span><span class=\"n\">k-url</span><span class=\"p\">])</span>\n                 <span class=\"o\">,</span><span class=\"n\">p</span> <span class=\"ss\">nbsp</span> <span class=\"p\">(</span><span class=\"ss\">input</span> <span class=\"p\">([</span><span class=\"ss\">name</span> <span class=\"s2\">\"num\"</span><span class=\"p\">]))</span>\n                 <span class=\"p\">(</span><span class=\"ss\">input</span> <span class=\"p\">([</span><span class=\"ss\">type</span> <span class=\"s2\">\"submit\"</span><span class=\"p\">])))))))))))</span>\n<span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"nb\">build-list</span> <span class=\"n\">n</span> <span class=\"n\">f</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"k\">for/list</span> <span class=\"p\">([</span><span class=\"n\">i</span> <span class=\"p\">(</span><span class=\"nb\">in-range</span> <span class=\"n\">n</span><span class=\"p\">)])</span>\n    <span class=\"p\">(</span><span class=\"n\">f</span> <span class=\"n\">i</span><span class=\"p\">)))</span>\n<span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">start</span> <span class=\"n\">req</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"n\">how-many</span>\n    <span class=\"p\">(</span><span class=\"n\">get-number</span> <span class=\"s2\">\"How many numbers to add?\"</span><span class=\"p\">))</span>\n  <span class=\"p\">(</span><span class=\"nb\">number-&gt;string</span>\n   <span class=\"p\">(</span><span class=\"nb\">foldr</span> \n    <span class=\"nb\">+</span> <span class=\"mi\">0</span>\n    <span class=\"p\">(</span><span class=\"nb\">build-list</span>\n     <span class=\"n\">how-many</span>\n     <span class=\"p\">(</span><span class=\"k\">λ</span> <span class=\"p\">(</span><span class=\"n\">i</span><span class=\"p\">)</span>\n       <span class=\"p\">(</span><span class=\"n\">get-number</span> \n        <span class=\"p\">(</span><span class=\"nb\">format</span> <span class=\"s2\">\"Provide number: ~a\"</span>\n                <span class=\"p\">(</span><span class=\"nb\">add1</span> <span class=\"n\">i</span><span class=\"p\">))))))))</span>\n<span class=\"c1\">; This requires a pre-release version</span>\n<span class=\"c1\">; to run in an un-named DrRacket buffer</span>\n<span class=\"p\">(</span><span class=\"n\">serve/servlet</span> <span class=\"n\">start</span> <span class=\"kd\">#:stateless?</span> <span class=\"no\">#t</span><span class=\"p\">)</span>\n</pre></div>\n\n</div>\n\n<p>where <code>build-list</code> has been re-implemented, but functions like <code>foldr</code> have not. This application, despite its striking similarity to the first, requires absolutely no per-session server state, so it is considerably more scalable.</p>\n\n<p>Do we need to re-implement <code>build-list</code>? What if the third-party, higher-order function (<code>build-list</code>) that we use with a higher-order argument that causes Web interaction (<code>get-number</code>) is too complicated to re-implement?</p>\n\n<p>Naturally this blog post would not exist if we didn&rsquo;t solve this problem.</p>\n\n<p>Our new approach, dubbed The Two-State Solution, allows the programmer to transparently use a very small amount of per-session server state to store <em>just</em> the part of the continuation inside functions like <code>build-list</code> while serializing everything else to the client.</p>\n\n<p>The key is to use <a href=\"http://docs.racket-lang.org/reference/eval-model.html#(part._prompt-model)\">delimited, composable continuations</a> to isolate the appropriate part of the continuation. The programmer designates this piece of the continuation through the <code>serial-&gt;native</code> and <code>native-&gt;serial</code> annotations. The programmer can write the application as:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"kn\">#lang </span><span class=\"nn\">web-server</span>\n<span class=\"p\">(</span><span class=\"k\">require</span> <span class=\"n\">web-server/servlet-env</span><span class=\"p\">)</span>\n<span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">get-number</span> <span class=\"n\">p</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"nb\">string-&gt;number</span>\n   <span class=\"p\">(</span><span class=\"n\">extract-binding/single</span>\n    <span class=\"o\">&#39;</span><span class=\"ss\">num</span>\n    <span class=\"p\">(</span><span class=\"n\">request-bindings</span>\n     <span class=\"p\">(</span><span class=\"n\">send/suspend</span>\n      <span class=\"p\">(</span><span class=\"k\">λ</span> <span class=\"p\">(</span><span class=\"n\">k-url</span><span class=\"p\">)</span>\n        <span class=\"o\">`</span><span class=\"p\">(</span><span class=\"ss\">html</span> \n          <span class=\"p\">(</span><span class=\"ss\">body</span>\n           <span class=\"p\">(</span><span class=\"ss\">form</span> <span class=\"p\">([</span><span class=\"ss\">action</span> <span class=\"o\">,</span><span class=\"n\">k-url</span><span class=\"p\">])</span>\n                 <span class=\"o\">,</span><span class=\"n\">p</span> <span class=\"ss\">nbsp</span> <span class=\"p\">(</span><span class=\"ss\">input</span> <span class=\"p\">([</span><span class=\"ss\">name</span> <span class=\"s2\">\"num\"</span><span class=\"p\">]))</span>\n                 <span class=\"p\">(</span><span class=\"ss\">input</span> <span class=\"p\">([</span><span class=\"ss\">type</span> <span class=\"s2\">\"submit\"</span><span class=\"p\">])))))))))))</span>\n<span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">start</span> <span class=\"n\">req</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"n\">how-many</span>\n    <span class=\"p\">(</span><span class=\"n\">get-number</span> <span class=\"s2\">\"How many numbers to add?\"</span><span class=\"p\">))</span>\n  <span class=\"p\">(</span><span class=\"nb\">number-&gt;string</span>\n   <span class=\"p\">(</span><span class=\"nb\">foldr</span> \n    <span class=\"nb\">+</span> <span class=\"mi\">0</span>\n    <span class=\"p\">(</span><span class=\"n\">serial-&gt;native</span>\n     <span class=\"p\">(</span><span class=\"nb\">build-list</span>\n      <span class=\"n\">how-many</span>\n      <span class=\"p\">(</span><span class=\"k\">λ</span> <span class=\"p\">(</span><span class=\"n\">i</span><span class=\"p\">)</span>\n        <span class=\"p\">(</span><span class=\"n\">native-&gt;serial</span>\n         <span class=\"p\">(</span><span class=\"n\">get-number</span> \n          <span class=\"p\">(</span><span class=\"nb\">format</span> <span class=\"s2\">\"Provide number: ~a\"</span>\n                  <span class=\"p\">(</span><span class=\"nb\">add1</span> <span class=\"n\">i</span><span class=\"p\">))))))))))</span>\n<span class=\"c1\">; This requires a pre-release version</span>\n<span class=\"c1\">; to run in an un-named DrRacket buffer</span>\n<span class=\"p\">(</span><span class=\"n\">serve/servlet</span> <span class=\"n\">start</span> <span class=\"kd\">#:stateless?</span> <span class=\"no\">#t</span><span class=\"p\">)</span>\n</pre></div>\n\n</div>\n\n<p>The important distinction here is that both the <code>build-list</code> and the <code>get-number</code> abstractions do not need to change. We simply mark the context as being a &ldquo;serial&rdquo; or &ldquo;native&rdquo; context through the annotation forms. This re-written version will be more scalable than a purely native version, but represents an easier to achieve step in the evolution of a program, because third-party, higher-order functions can be used as is.</p>\n\n<p>This work will be presented at <a href=\"http://splashcon.org/index.php?option=com_content&amp;amp;view=article&amp;amp;id=122&amp;amp;Itemid=91\">OOPSLA 2010</a>. It is also described in a paper with same name this blog post:<a href=\"http://faculty.cs.byu.edu/~jay/static/oopsla026-mccarthy.pdf\">The Two-State Solution: Native and Serializable Continuations Accord</a>.</p>\n<!-- more-->\n\n<hr />\n\n<p>Awesome sauce. Can&rsquo;t wait to try it out!</p>\n\n<p>I came across racket a couple of weeks ago when a link to your site came up on HN.</p>\n\n<p>This is some seriously great kit you&rsquo;ve put together. I&rsquo;m having a lot of fun with this language. Coming from CL, it&rsquo;s actually a rather pleasant transition. Definitely a step-up from the Python/C++ I do at my day job.</p>\n\n<p>Keep up the good work! :)</p>\n\n<p>— <em>j_king, 2 November 2010</em></p>\n\n<hr />")) ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2007-09-09-completions-in-drscheme-finally.md" . unix) f post (u . "Completions in DrScheme (finally)") (? . 126) 1467223812 (p+ #"/Users/MB/git/racket-lang-org/blog/2007/09/completions-in-drscheme-finally.html" . unix) "/2007/09/completions-in-drscheme-finally.html" (u . "2007-09-09T20:54:00.001-04:00") (? . 125) (? . 39) (c (u . "")) (u . "\n<p><em>posted by Robby Findler</em></p>\n\n<p>DrScheme now supports a language- sensitive (but not lexical- scope sensitive) completion feature. Type -/ and see what names are available to finish off the word you&rsquo;re typing.</p>\n\n<p>Thanks to <a href=\"http://www.cs.uchicago.edu/~jacobm/\">Jacob</a> (and do follow that link; we all need a little more love in our lives) and <a href=\"http://turingcompletewasteoftime.blogspot.com/\">Mike</a> for taking the initiative to actually implement what is probably the most requested feature in DrScheme at the moment.</p>") #t (u . "\n<p><em>posted by Robby Findler</em></p>\n\n<p>DrScheme now supports a language- sensitive (but not lexical- scope sensitive) completion feature. Type -/ and see what names are available to finish off the word you&rsquo;re typing.</p>\n\n<p>Thanks to <a href=\"http://www.cs.uchicago.edu/~jacobm/\">Jacob</a> (and do follow that link; we all need a little more love in our lives) and <a href=\"http://turingcompletewasteoftime.blogspot.com/\">Mike</a> for taking the initiative to actually implement what is probably the most requested feature in DrScheme at the moment.</p>\n<!-- more-->\n\n<hr />\n\n<p>What release is this in?</p>\n\n<p>— <em>Chris, 9 October 2007</em></p>\n\n<hr />\n\n<p>Nevermind, I can see it in the screenshot. Very cool!</p>\n\n<p>— <em>Chris, 9 October 2007</em></p>\n\n<hr />")) ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2007-05-22-plt-scheme-version-370.md" . unix) f post (u . "PLT Scheme version 370") (? . 122) 1467223812 (p+ #"/Users/MB/git/racket-lang-org/blog/2007/05/plt-scheme-version-370.html" . unix) "/2007/05/plt-scheme-version-370.html" (u . "2007-05-22T02:38:00.000-04:00") (? . 121) (? . 60) (c (u . "")) (u . "\n<p><em>posted by Jens Axel Søgaard</em></p>\n\n<p>PLT Scheme version 370 is now available from</p>\n\n<p><a href=\"http://download.plt-scheme.org/\">http://download.plt-scheme.org/</a></p>\n\n<p>Some highlights:</p>\n\n<ul>\n <li>The conservative garbage collector (CGC) has been replaced with a precise garbage collector (3m) in the standard build. For most users, this change simply amounts to &ldquo;better performance in space and time&rdquo;. For example, a long-running DrScheme instance typically uses much less memory than before.</li></ul>\n\n<p>The new memory manager also supports a new &ldquo;Limit Memory&hellip;&rdquo; option (in DrScheme&rsquo;s &ldquo;Scheme&rdquo; menu) to limit the memory use of a programming running inside DrScheme.</p>\n\n<p>For those who work with C-implemented libraries and extensions, the switch to precise collection may complicate interoperability. To a large extent, however, (lib &ldquo;foreign.ss&rdquo;) works the same with both collectors. (But note that the 3m is a moving collector, so be careful with passing Scheme objects to C.)</p>\n\n<p>Although our pre-built binaries use the new collector, builds from source using the conservative collector are still supported.</p>\n\n<ul>\n <li>For a program written with one of the the <a href=\"http://www.htdp.org\">&ldquo;How to Design Programs&rdquo;</a> (HtDP) languages, DrScheme saves the program with meta-information that identifies the language and records the teachpacks used by the program. DrScheme&rsquo;s teachpack GUI now works only with the HtDP languages. In other languages, use require to access teachpacks.</li></ul>\n\n<p>The meta-information is in the form of a reader extension that turns the file content into a module-based program, which means that teaching-language files can be loaded directly into MzScheme or used with other PLT Scheme tools.</p>\n\n<ul>\n <li>\n  <p>The HtDP &ldquo;world.ss&rdquo; and &ldquo;image.ss&rdquo; teachpacks have been revised, including support for the creation of animated GIFs.</p></li>\n <li>\n  <p>Unit-based servlets are no longer supported in the web server. Use module-based servlets, instead. (Servlets can be implemented using a unit within a module, but the web server&rsquo;s API is provided through a module.)</p></li>\n <li>\n  <p>A new (lib &ldquo;unit.ss&rdquo;) library replaces the old one and provides a simpler and more flexible syntax. The (lib &ldquo;unitsig.ss&rdquo;) library is deprecated but still available as (lib &ldquo;unitsig200.ss&rdquo;), and the old (lib &ldquo;unit.ss&rdquo;) is available as (lib &ldquo;unit200.ss&rdquo;).  Feedback Welcome,  <em>The PLT Scheme Team</em></p></li></ul>") #t (u . "\n<p><em>posted by Jens Axel Søgaard</em></p>\n\n<p>PLT Scheme version 370 is now available from</p>\n\n<p><a href=\"http://download.plt-scheme.org/\">http://download.plt-scheme.org/</a></p>\n\n<p>Some highlights:</p>\n\n<ul>\n <li>The conservative garbage collector (CGC) has been replaced with a precise garbage collector (3m) in the standard build. For most users, this change simply amounts to &ldquo;better performance in space and time&rdquo;. For example, a long-running DrScheme instance typically uses much less memory than before.</li></ul>\n\n<p>The new memory manager also supports a new &ldquo;Limit Memory&hellip;&rdquo; option (in DrScheme&rsquo;s &ldquo;Scheme&rdquo; menu) to limit the memory use of a programming running inside DrScheme.</p>\n\n<p>For those who work with C-implemented libraries and extensions, the switch to precise collection may complicate interoperability. To a large extent, however, (lib &ldquo;foreign.ss&rdquo;) works the same with both collectors. (But note that the 3m is a moving collector, so be careful with passing Scheme objects to C.)</p>\n\n<p>Although our pre-built binaries use the new collector, builds from source using the conservative collector are still supported.</p>\n\n<ul>\n <li>For a program written with one of the the <a href=\"http://www.htdp.org\">&ldquo;How to Design Programs&rdquo;</a> (HtDP) languages, DrScheme saves the program with meta-information that identifies the language and records the teachpacks used by the program. DrScheme&rsquo;s teachpack GUI now works only with the HtDP languages. In other languages, use require to access teachpacks.</li></ul>\n\n<p>The meta-information is in the form of a reader extension that turns the file content into a module-based program, which means that teaching-language files can be loaded directly into MzScheme or used with other PLT Scheme tools.</p>\n\n<ul>\n <li>\n  <p>The HtDP &ldquo;world.ss&rdquo; and &ldquo;image.ss&rdquo; teachpacks have been revised, including support for the creation of animated GIFs.</p></li>\n <li>\n  <p>Unit-based servlets are no longer supported in the web server. Use module-based servlets, instead. (Servlets can be implemented using a unit within a module, but the web server&rsquo;s API is provided through a module.)</p></li>\n <li>\n  <p>A new (lib &ldquo;unit.ss&rdquo;) library replaces the old one and provides a simpler and more flexible syntax. The (lib &ldquo;unitsig.ss&rdquo;) library is deprecated but still available as (lib &ldquo;unitsig200.ss&rdquo;), and the old (lib &ldquo;unit.ss&rdquo;) is available as (lib &ldquo;unit200.ss&rdquo;).  Feedback Welcome,  <em>The PLT Scheme Team</em></p></li></ul>\n<!-- more-->\n\n<hr />\n\n<p>The reference documentation is wonderful, but where can I go to find out the changes (and the reasoning behind them) to unit.ss? Mailing list discussions would be perfect, if they exist. Thanks for any help!</p>\n\n<p>— <em>charmless, 22 May 2007</em></p>\n\n<hr />\n\n<p>Chapters 4, 5, and 6 of my Ph.D. dissertation describe the new unit system, and my rational behind its various features. However, it doesn&rsquo;t really describe the old system or attempt a comparison between the new and old systems. Also, Matthew has made a few small syntactic changes from what is described in my dissertation for the v370 system.</p>\n\n<p>— <em>Scott Owens, 23 May 2007</em></p>\n\n<hr />")) ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2014-11-04-racket-v611.md" . unix) f post (u . "Racket v6.1.1") (? . 89) 1467223812 (p+ #"/Users/MB/git/racket-lang-org/blog/2014/11/racket-v611.html" . unix) "/2014/11/racket-v611.html" (u . "2014-11-04T10:43:00.000-05:00") (? . 100) (? . 80) (c (u . "")) (u . "\n<p><em>posted by Ryan Culpepper</em></p>\n\n<p>Racket version 6.1.1 is now available from <a href=\"http://racket-lang.org/\">http://racket-lang.org/</a></p>\n\n<ul>\n <li>\n  <p>The Mac OS X Yosemite compatibility problems are fixed. We bundled a patched Pango text-drawing library with Racket.</p></li>\n <li>\n  <p>The Windows [32-bit] releases fixes the window-update crashes. We bundled a patched Cairo drawing library with Racket.</p></li>\n <li>\n  <p>Typed Racket closes two safety holes in the exception system. The revised type system restricts <code>raise</code> to send only instances of the <code>exn</code> structure type and flat data to handlers. It also checks exception handlers properly. Note: Previously well-typed programs may fail to typecheck.</p></li>\n <li>\n  <p>Typed Racket&rsquo;s typed regions support casts and predicates.</p></li>\n <li>\n  <p>2htdp/image&rsquo;s notion of equality ignores an image&rsquo;s baseline.</p></li>\n <li>\n  <p>The package manager supports a binary library installation mode, which allows users to install packages without source or documentation. Use the <code>--binary-lib</code> option with <code>raco pkg install</code>.</p></li>\n <li>\n  <p>The new drracket-tool-lib package factors out parts of DrRacket&rsquo;s IDE so that they can be reused with other editors, such as Emacs.</p></li>\n <li>\n  <p>The compiler&rsquo;s use-before-defined analysis has been repaired for certain forms of nested <code>letrec</code>, some <code>let</code> forms, and some uses of <code>set!</code> or <code>with-continuation-mark</code>.</p></li>\n <li>\n  <p>The compiler performs additional bytecode optimizations. Thanks to Gustavo Massaccesi.</p></li>\n <li>\n  <p>The CML library comes with a new <code>replace-evt</code> event constructor. Thanks to Jan Dvořák.</p></li>\n <li>\n  <p>Redex&rsquo;s benchmark suite comes with a description of the benchmark programs.</p></li>\n <li>\n  <p>Redex&rsquo;s metafunctions can be typeset using the &ldquo;large left brace&rdquo; notation for conditionals.</p></li>\n <li>\n  <p>The contract library comes with an improved <code>contract-stronger?</code>. Its error messages note that the contract itself might be wrong.</p></li>\n <li>\n  <p>The GUI library is DPI-aware on Windows.</p></li>\n <li>\n  <p>The openssl library supports Server Name Indication for servers. Thanks to Jay Kominek.</p></li>\n <li>\n  <p>The syntax/parse library allows the definition of new pattern forms via pattern expanders, similar to match expanders. Thanks to Alex Knauth.</p></li>\n <li>\n  <p>OpenGL on Linux no longer depends on libgtkgl, and core profiles are supported (see <code>set-legacy?</code>).</p></li>\n <li>\n  <p>The teaching languages&rsquo; unit test framework supports <code>check-satisfied</code>, a construct for checking whether a result satisfies a predicate, e.g.:</p></li></ul>\n\n<p><code>(check-satisfied (sort l) sorted?)</code></p>\n\n<p>Feedback Welcome</p>") #f (u . "\n<p><em>posted by Ryan Culpepper</em></p>\n\n<p>Racket version 6.1.1 is now available from <a href=\"http://racket-lang.org/\">http://racket-lang.org/</a></p>\n\n<ul>\n <li>\n  <p>The Mac OS X Yosemite compatibility problems are fixed. We bundled a patched Pango text-drawing library with Racket.</p></li>\n <li>\n  <p>The Windows [32-bit] releases fixes the window-update crashes. We bundled a patched Cairo drawing library with Racket.</p></li>\n <li>\n  <p>Typed Racket closes two safety holes in the exception system. The revised type system restricts <code>raise</code> to send only instances of the <code>exn</code> structure type and flat data to handlers. It also checks exception handlers properly. Note: Previously well-typed programs may fail to typecheck.</p></li>\n <li>\n  <p>Typed Racket&rsquo;s typed regions support casts and predicates.</p></li>\n <li>\n  <p>2htdp/image&rsquo;s notion of equality ignores an image&rsquo;s baseline.</p></li>\n <li>\n  <p>The package manager supports a binary library installation mode, which allows users to install packages without source or documentation. Use the <code>--binary-lib</code> option with <code>raco pkg install</code>.</p></li>\n <li>\n  <p>The new drracket-tool-lib package factors out parts of DrRacket&rsquo;s IDE so that they can be reused with other editors, such as Emacs.</p></li>\n <li>\n  <p>The compiler&rsquo;s use-before-defined analysis has been repaired for certain forms of nested <code>letrec</code>, some <code>let</code> forms, and some uses of <code>set!</code> or <code>with-continuation-mark</code>.</p></li>\n <li>\n  <p>The compiler performs additional bytecode optimizations. Thanks to Gustavo Massaccesi.</p></li>\n <li>\n  <p>The CML library comes with a new <code>replace-evt</code> event constructor. Thanks to Jan Dvořák.</p></li>\n <li>\n  <p>Redex&rsquo;s benchmark suite comes with a description of the benchmark programs.</p></li>\n <li>\n  <p>Redex&rsquo;s metafunctions can be typeset using the &ldquo;large left brace&rdquo; notation for conditionals.</p></li>\n <li>\n  <p>The contract library comes with an improved <code>contract-stronger?</code>. Its error messages note that the contract itself might be wrong.</p></li>\n <li>\n  <p>The GUI library is DPI-aware on Windows.</p></li>\n <li>\n  <p>The openssl library supports Server Name Indication for servers. Thanks to Jay Kominek.</p></li>\n <li>\n  <p>The syntax/parse library allows the definition of new pattern forms via pattern expanders, similar to match expanders. Thanks to Alex Knauth.</p></li>\n <li>\n  <p>OpenGL on Linux no longer depends on libgtkgl, and core profiles are supported (see <code>set-legacy?</code>).</p></li>\n <li>\n  <p>The teaching languages&rsquo; unit test framework supports <code>check-satisfied</code>, a construct for checking whether a result satisfies a predicate, e.g.:</p></li></ul>\n\n<p><code>(check-satisfied (sort l) sorted?)</code></p>\n\n<p>Feedback Welcome</p>")) ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2012-11-23-roman-numerals-in-racket-sources.md" . unix) f post (u . "Roman Numerals in Racket Sources") (? . 33) 1467223812 (p+ #"/Users/MB/git/racket-lang-org/blog/2012/11/roman-numerals-in-racket-sources.html" . unix) "/2012/11/roman-numerals-in-racket-sources.html" (u . "2012-11-23T11:40:00.001-05:00") (? . 31) (? . 127) (c (u . "")) (u . "\n<p><em>posted by Shriram Krishnamurthi</em></p>\n\n<p>The other day, while discussing Church numerals in class, I pointed out that Racket could support Roman numeral in source programs. The essence of the idea is that, whenever an unbound identifier matches the syntax of a Roman numeral, it is automatically converted into the corresponding number.</p>\n\n<p>The implementation of this is <a href=\"https://github.com/shriram/roman-numerals\">here</a>. The <a href=\"https://github.com/shriram/roman-numerals/blob/master/test-client.rkt\">test client</a> best illustrates this in action. For instance, here is a valid test case:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">square</span> <span class=\"n\">x</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"nb\">*</span> <span class=\"n\">x</span> <span class=\"n\">x</span><span class=\"p\">))</span>\n<span class=\"p\">(</span><span class=\"n\">check-equal?</span> <span class=\"p\">(</span><span class=\"n\">square</span> <span class=\"n\">X</span><span class=\"p\">)</span> <span class=\"n\">C</span><span class=\"p\">)</span>\n</pre></div>\n\n</div>\n\n<p>The essence of the implementation is just this macro:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">define-syntax</span> <span class=\"p\">(</span><span class=\"n\">handle-id</span> <span class=\"n\">stx</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"k\">syntax-case</span> <span class=\"n\">stx</span> <span class=\"p\">()</span>\n    <span class=\"p\">[(</span><span class=\"k\">_</span> <span class=\"o\">.</span> <span class=\"k\">any</span><span class=\"p\">)</span>\n     <span class=\"p\">(</span><span class=\"k\">let</span> <span class=\"p\">([</span><span class=\"n\">str</span> <span class=\"p\">(</span><span class=\"nb\">symbol-&gt;string</span> <span class=\"p\">(</span><span class=\"nb\">syntax-&gt;datum</span> <span class=\"o\">#&#39;</span><span class=\"k\">any</span><span class=\"p\">))])</span>\n       <span class=\"p\">(</span><span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"n\">roman-string?</span> <span class=\"n\">str</span><span class=\"p\">)</span>\n           <span class=\"p\">(</span><span class=\"k\">with-syntax</span> <span class=\"p\">[(</span><span class=\"n\">n</span> <span class=\"p\">(</span><span class=\"nb\">datum-&gt;syntax</span> <span class=\"n\">stx</span> <span class=\"p\">(</span><span class=\"n\">roman-&gt;number</span> <span class=\"n\">str</span><span class=\"p\">)))]</span>\n             <span class=\"o\">#&#39;</span><span class=\"p\">(</span><span class=\"k\">#%datum</span> <span class=\"o\">.</span> <span class=\"n\">n</span><span class=\"p\">))</span>\n           <span class=\"o\">#&#39;</span><span class=\"p\">(</span><span class=\"k\">#%top</span> <span class=\"o\">.</span> <span class=\"k\">any</span><span class=\"p\">)))]))</span>\n</pre></div>\n\n</div>") #t (u . "\n<p><em>posted by Shriram Krishnamurthi</em></p>\n\n<p>The other day, while discussing Church numerals in class, I pointed out that Racket could support Roman numeral in source programs. The essence of the idea is that, whenever an unbound identifier matches the syntax of a Roman numeral, it is automatically converted into the corresponding number.</p>\n\n<p>The implementation of this is <a href=\"https://github.com/shriram/roman-numerals\">here</a>. The <a href=\"https://github.com/shriram/roman-numerals/blob/master/test-client.rkt\">test client</a> best illustrates this in action. For instance, here is a valid test case:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">square</span> <span class=\"n\">x</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"nb\">*</span> <span class=\"n\">x</span> <span class=\"n\">x</span><span class=\"p\">))</span>\n<span class=\"p\">(</span><span class=\"n\">check-equal?</span> <span class=\"p\">(</span><span class=\"n\">square</span> <span class=\"n\">X</span><span class=\"p\">)</span> <span class=\"n\">C</span><span class=\"p\">)</span>\n</pre></div>\n\n</div>\n\n<p>The essence of the implementation is just this macro:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">define-syntax</span> <span class=\"p\">(</span><span class=\"n\">handle-id</span> <span class=\"n\">stx</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"k\">syntax-case</span> <span class=\"n\">stx</span> <span class=\"p\">()</span>\n    <span class=\"p\">[(</span><span class=\"k\">_</span> <span class=\"o\">.</span> <span class=\"k\">any</span><span class=\"p\">)</span>\n     <span class=\"p\">(</span><span class=\"k\">let</span> <span class=\"p\">([</span><span class=\"n\">str</span> <span class=\"p\">(</span><span class=\"nb\">symbol-&gt;string</span> <span class=\"p\">(</span><span class=\"nb\">syntax-&gt;datum</span> <span class=\"o\">#&#39;</span><span class=\"k\">any</span><span class=\"p\">))])</span>\n       <span class=\"p\">(</span><span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"n\">roman-string?</span> <span class=\"n\">str</span><span class=\"p\">)</span>\n           <span class=\"p\">(</span><span class=\"k\">with-syntax</span> <span class=\"p\">[(</span><span class=\"n\">n</span> <span class=\"p\">(</span><span class=\"nb\">datum-&gt;syntax</span> <span class=\"n\">stx</span> <span class=\"p\">(</span><span class=\"n\">roman-&gt;number</span> <span class=\"n\">str</span><span class=\"p\">)))]</span>\n             <span class=\"o\">#&#39;</span><span class=\"p\">(</span><span class=\"k\">#%datum</span> <span class=\"o\">.</span> <span class=\"n\">n</span><span class=\"p\">))</span>\n           <span class=\"o\">#&#39;</span><span class=\"p\">(</span><span class=\"k\">#%top</span> <span class=\"o\">.</span> <span class=\"k\">any</span><span class=\"p\">)))]))</span>\n</pre></div>\n\n</div>\n<!-- more-->\n\n<hr />\n\n<p>I(define MMMMM &ldquo;that is especially delicious!&rdquo;)</p>\n\n<p>— <em>steck, 23 November 2012</em></p>\n\n<hr />\n\n<p>It&rsquo;s a great setup for counters, too: (do ((i i …)) …)</p>\n\n<p>— <em>YeshuaAaron, 23 November 2012</em></p>\n\n<hr />")) ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2007-08-03-control-and-macros.md" . unix) f post (u . "control and macros") (? . 91) 1467223812 (p+ #"/Users/MB/git/racket-lang-org/blog/2007/08/control-and-macros.html" . unix) "/2007/08/control-and-macros.html" (u . "2007-08-03T14:06:00.000-04:00") (? . 114) (? . 64) (c (u . "")) (u . "\n<p><em>posted by matthias</em></p>\n\n<p>After reading the posts on control operators, Vlado Zlatanov decided to look into <code>prompt, control, fcontrol</code> and the rest of the goodies in <code>control.ss</code>.</p>\n\n<p>So based on the example from the blog post I did this python-like snippet:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"n\">define/y</span> <span class=\"p\">(</span><span class=\"n\">step</span><span class=\"p\">)</span> \n  <span class=\"p\">(</span><span class=\"n\">yield</span> <span class=\"mi\">1</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"n\">yield</span> <span class=\"mi\">2</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"n\">yield</span> <span class=\"mi\">3</span><span class=\"p\">)</span>\n  <span class=\"o\">&#39;</span><span class=\"ss\">finished</span><span class=\"p\">)</span>\n</pre></div>\n\n</div>\n\n<p>He decided to look into turning it into a macro, such that the above ends up being correct code. When he got stuck, he asked on our mailing list and the resulting dialog was so informative that I decided to blog it.</p>\n\n<p>My first replay was this suggestion:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">define-syntax</span> <span class=\"n\">define/y</span>\n  <span class=\"p\">(</span><span class=\"k\">syntax-rules</span> <span class=\"p\">()</span>\n    <span class=\"p\">[(</span><span class=\"k\">_</span> <span class=\"n\">yield-name</span> <span class=\"p\">(</span><span class=\"n\">name</span> <span class=\"n\">arg</span> <span class=\"k\">...</span><span class=\"p\">)</span> <span class=\"n\">body</span> <span class=\"k\">...</span><span class=\"p\">)</span>\n     <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">name</span> <span class=\"n\">arg</span> <span class=\"k\">...</span><span class=\"p\">)</span>\n       <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"n\">exit-with</span> <span class=\"no\">#f</span><span class=\"p\">)</span>\n       <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">switch-control-context</span> <span class=\"n\">th</span><span class=\"p\">)</span>\n         <span class=\"p\">(</span><span class=\"nb\">call/cc</span> \n          <span class=\"p\">(</span><span class=\"k\">lambda</span> <span class=\"p\">(</span><span class=\"n\">k</span><span class=\"p\">)</span>\n            <span class=\"p\">(</span><span class=\"k\">set!</span> <span class=\"n\">exit-with</span> <span class=\"n\">k</span><span class=\"p\">)</span>\n            <span class=\"p\">(</span><span class=\"n\">th</span><span class=\"p\">))))</span>\n       <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">yield-name</span> <span class=\"n\">x</span><span class=\"p\">)</span>\n         <span class=\"p\">(</span><span class=\"nb\">call/cc</span> \n          <span class=\"p\">(</span><span class=\"k\">lambda</span> <span class=\"p\">(</span><span class=\"n\">resume-here</span><span class=\"p\">)</span>\n            <span class=\"p\">(</span><span class=\"k\">set!</span> <span class=\"n\">name</span> \n               <span class=\"p\">(</span><span class=\"k\">lambda</span> <span class=\"p\">()</span> \n                 <span class=\"p\">(</span><span class=\"n\">switch-control-context</span> \n                  <span class=\"p\">(</span><span class=\"k\">lambda</span> <span class=\"p\">()</span> \n                     <span class=\"p\">(</span><span class=\"n\">resume-here</span> <span class=\"o\">&#39;</span><span class=\"ss\">dummy</span><span class=\"p\">)))))</span>\n            <span class=\"p\">(</span><span class=\"n\">exit-with</span> <span class=\"n\">x</span><span class=\"p\">))))</span>\n       <span class=\"p\">(</span><span class=\"n\">switch-control-context</span> <span class=\"p\">(</span><span class=\"k\">lambda</span> <span class=\"p\">()</span> <span class=\"n\">body</span> <span class=\"k\">...</span><span class=\"p\">)))]))</span>\n</pre></div>\n\n</div>\n\n<p>I sent this out with two suggestions.</p>\n\n<p>First, use <code>control.ss</code> to simplify the code. Second, use <code>syntax-case</code> to eliminate the need for the programmer-user of <code>define/y</code> to specify the name of <code>yield</code>.</p>\n\n<p>So, here is the prompt-based code:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">require</span> <span class=\"p\">(</span><span class=\"k\">lib</span> <span class=\"s2\">\"control.ss\"</span><span class=\"p\">))</span>\n\n<span class=\"p\">(</span><span class=\"k\">define-syntax</span> <span class=\"n\">define/y</span>\n  <span class=\"p\">(</span><span class=\"k\">syntax-rules</span> <span class=\"p\">()</span>\n    <span class=\"p\">[(</span><span class=\"k\">_</span> <span class=\"n\">yield-name</span> <span class=\"p\">(</span><span class=\"n\">name</span> <span class=\"n\">arg</span> <span class=\"k\">...</span><span class=\"p\">)</span> <span class=\"n\">body</span> <span class=\"k\">...</span><span class=\"p\">)</span>\n     <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">name</span> <span class=\"n\">arg</span> <span class=\"k\">...</span><span class=\"p\">)</span>\n       <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">yield-name</span> <span class=\"n\">x</span><span class=\"p\">)</span>\n         <span class=\"p\">(</span><span class=\"n\">control</span> <span class=\"n\">resume-here</span>\n            <span class=\"p\">(</span><span class=\"k\">set!</span> <span class=\"n\">name</span>\n                  <span class=\"p\">(</span><span class=\"k\">lambda</span> <span class=\"p\">()</span>\n                    <span class=\"p\">(</span><span class=\"n\">prompt</span> <span class=\"p\">(</span><span class=\"n\">resume-here</span> <span class=\"o\">&#39;</span><span class=\"ss\">dummy</span><span class=\"p\">))))</span>\n            <span class=\"n\">x</span><span class=\"p\">))</span>\n       <span class=\"p\">(</span><span class=\"n\">prompt</span> <span class=\"n\">body</span> <span class=\"k\">...</span><span class=\"p\">))]))</span>\n\n<span class=\"p\">(</span><span class=\"n\">define/y</span> <span class=\"n\">yield</span> <span class=\"p\">(</span><span class=\"n\">step</span><span class=\"p\">)</span> \n  <span class=\"p\">(</span><span class=\"n\">yield</span> <span class=\"mi\">1</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"n\">yield</span> <span class=\"mi\">2</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"n\">yield</span> <span class=\"mi\">3</span><span class=\"p\">)</span>\n  <span class=\"o\">&#39;</span><span class=\"ss\">finished</span><span class=\"p\">)</span>\n\n<span class=\"p\">(</span><span class=\"nb\">equal?</span> <span class=\"o\">&#39;</span><span class=\"p\">(</span><span class=\"mi\">1</span> <span class=\"mi\">2</span> <span class=\"mi\">3</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"nb\">list</span> <span class=\"p\">(</span><span class=\"n\">step</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"n\">step</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"n\">step</span><span class=\"p\">)))</span>\n</pre></div>\n\n</div>\n\n<p>This time I include a test case that assures the proper return behavior of <code>yield</code>. The definition of <code>define/y</code> shows how to mark the return point with <code>prompt</code> and how to switch to this point with <code>control</code> so that your generator can resume the traversal at the place where it was interrupted.</p>\n\n<p>For the second challenge, I wrote this definition:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">require</span> <span class=\"p\">(</span><span class=\"k\">lib</span> <span class=\"s2\">\"control.ss\"</span><span class=\"p\">))</span>\n\n<span class=\"p\">(</span><span class=\"k\">define-syntax</span> <span class=\"p\">(</span><span class=\"n\">define/y</span> <span class=\"n\">stx</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"k\">syntax-case</span> <span class=\"n\">stx</span> <span class=\"p\">()</span>\n    <span class=\"p\">[(</span><span class=\"k\">_</span> <span class=\"p\">(</span><span class=\"n\">name</span> <span class=\"n\">arg</span> <span class=\"k\">...</span><span class=\"p\">)</span> <span class=\"n\">body</span> <span class=\"k\">...</span><span class=\"p\">)</span>\n     <span class=\"p\">(</span><span class=\"k\">with-syntax</span> \n         <span class=\"p\">((</span><span class=\"n\">yield-name</span> <span class=\"p\">(</span><span class=\"n\">datum-&gt;syntax-object</span> <span class=\"n\">stx</span> <span class=\"o\">&#39;</span><span class=\"ss\">yield</span><span class=\"p\">)))</span>\n       <span class=\"p\">(</span><span class=\"k\">syntax</span>\n        <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">name</span> <span class=\"n\">arg</span> <span class=\"k\">...</span><span class=\"p\">)</span>\n          <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">yield-name</span> <span class=\"n\">x</span><span class=\"p\">)</span>\n            <span class=\"p\">(</span><span class=\"n\">control</span> <span class=\"n\">resume-here</span>\n             <span class=\"p\">(</span><span class=\"k\">set!</span> <span class=\"n\">name</span> \n                   <span class=\"p\">(</span><span class=\"k\">lambda</span> <span class=\"p\">()</span>\n                     <span class=\"p\">(</span><span class=\"n\">prompt</span> <span class=\"p\">(</span><span class=\"n\">resume-here</span> <span class=\"o\">&#39;</span><span class=\"ss\">dummy</span><span class=\"p\">))))</span>\n             <span class=\"n\">x</span><span class=\"p\">))</span>\n          <span class=\"p\">(</span><span class=\"n\">prompt</span> <span class=\"n\">body</span> <span class=\"k\">...</span><span class=\"p\">))))]))</span>\n\n<span class=\"p\">(</span><span class=\"n\">define/y</span> <span class=\"p\">(</span><span class=\"n\">step</span><span class=\"p\">)</span> \n  <span class=\"p\">(</span><span class=\"n\">yield</span> <span class=\"mi\">1</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"n\">yield</span> <span class=\"mi\">2</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"n\">yield</span> <span class=\"mi\">3</span><span class=\"p\">)</span>\n  <span class=\"o\">&#39;</span><span class=\"ss\">finished</span><span class=\"p\">)</span>\n\n<span class=\"p\">(</span><span class=\"nb\">equal?</span> <span class=\"o\">&#39;</span><span class=\"p\">(</span><span class=\"mi\">1</span> <span class=\"mi\">2</span> <span class=\"mi\">3</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"nb\">list</span> <span class=\"p\">(</span><span class=\"n\">step</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"n\">step</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"n\">step</span><span class=\"p\">)))</span>\n</pre></div>\n\n</div>\n\n<p>If you compare the two macro definitions, you notice very little difference. Indeed, what really differs is the &ldquo;interface&rdquo; (the API), that is, the way you can use the macro: see the test case. What also differs is that the definition uses <code>syntax-case</code> and <code>with-syntax</code> to inject <code>yield</code> into the body of <code>define/y</code>.</p>\n\n<p>In response, Vlado wrote &ldquo;but isn&rsquo;t this non-hygienic.&rdquo; Here is my response:</p>\n\n<p>Hygiene is a uniformity default imposed on the expander with a provision for programmers to choose the non-default. I chose this word carefully when I coined the phrase. So what you have <em>is</em> a hygienic solution.</p>\n\n<p>In other words, injecting an identifier into a macro is not a violation of hygiene at all. It&rsquo;s just means using the full power of the macro system.</p>") #f (u . "\n<p><em>posted by matthias</em></p>\n\n<p>After reading the posts on control operators, Vlado Zlatanov decided to look into <code>prompt, control, fcontrol</code> and the rest of the goodies in <code>control.ss</code>.</p>\n\n<p>So based on the example from the blog post I did this python-like snippet:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"n\">define/y</span> <span class=\"p\">(</span><span class=\"n\">step</span><span class=\"p\">)</span> \n  <span class=\"p\">(</span><span class=\"n\">yield</span> <span class=\"mi\">1</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"n\">yield</span> <span class=\"mi\">2</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"n\">yield</span> <span class=\"mi\">3</span><span class=\"p\">)</span>\n  <span class=\"o\">&#39;</span><span class=\"ss\">finished</span><span class=\"p\">)</span>\n</pre></div>\n\n</div>\n\n<p>He decided to look into turning it into a macro, such that the above ends up being correct code. When he got stuck, he asked on our mailing list and the resulting dialog was so informative that I decided to blog it.</p>\n\n<p>My first replay was this suggestion:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">define-syntax</span> <span class=\"n\">define/y</span>\n  <span class=\"p\">(</span><span class=\"k\">syntax-rules</span> <span class=\"p\">()</span>\n    <span class=\"p\">[(</span><span class=\"k\">_</span> <span class=\"n\">yield-name</span> <span class=\"p\">(</span><span class=\"n\">name</span> <span class=\"n\">arg</span> <span class=\"k\">...</span><span class=\"p\">)</span> <span class=\"n\">body</span> <span class=\"k\">...</span><span class=\"p\">)</span>\n     <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">name</span> <span class=\"n\">arg</span> <span class=\"k\">...</span><span class=\"p\">)</span>\n       <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"n\">exit-with</span> <span class=\"no\">#f</span><span class=\"p\">)</span>\n       <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">switch-control-context</span> <span class=\"n\">th</span><span class=\"p\">)</span>\n         <span class=\"p\">(</span><span class=\"nb\">call/cc</span> \n          <span class=\"p\">(</span><span class=\"k\">lambda</span> <span class=\"p\">(</span><span class=\"n\">k</span><span class=\"p\">)</span>\n            <span class=\"p\">(</span><span class=\"k\">set!</span> <span class=\"n\">exit-with</span> <span class=\"n\">k</span><span class=\"p\">)</span>\n            <span class=\"p\">(</span><span class=\"n\">th</span><span class=\"p\">))))</span>\n       <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">yield-name</span> <span class=\"n\">x</span><span class=\"p\">)</span>\n         <span class=\"p\">(</span><span class=\"nb\">call/cc</span> \n          <span class=\"p\">(</span><span class=\"k\">lambda</span> <span class=\"p\">(</span><span class=\"n\">resume-here</span><span class=\"p\">)</span>\n            <span class=\"p\">(</span><span class=\"k\">set!</span> <span class=\"n\">name</span> \n               <span class=\"p\">(</span><span class=\"k\">lambda</span> <span class=\"p\">()</span> \n                 <span class=\"p\">(</span><span class=\"n\">switch-control-context</span> \n                  <span class=\"p\">(</span><span class=\"k\">lambda</span> <span class=\"p\">()</span> \n                     <span class=\"p\">(</span><span class=\"n\">resume-here</span> <span class=\"o\">&#39;</span><span class=\"ss\">dummy</span><span class=\"p\">)))))</span>\n            <span class=\"p\">(</span><span class=\"n\">exit-with</span> <span class=\"n\">x</span><span class=\"p\">))))</span>\n       <span class=\"p\">(</span><span class=\"n\">switch-control-context</span> <span class=\"p\">(</span><span class=\"k\">lambda</span> <span class=\"p\">()</span> <span class=\"n\">body</span> <span class=\"k\">...</span><span class=\"p\">)))]))</span>\n</pre></div>\n\n</div>\n\n<p>I sent this out with two suggestions.</p>\n\n<p>First, use <code>control.ss</code> to simplify the code. Second, use <code>syntax-case</code> to eliminate the need for the programmer-user of <code>define/y</code> to specify the name of <code>yield</code>.</p>\n\n<p>So, here is the prompt-based code:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">require</span> <span class=\"p\">(</span><span class=\"k\">lib</span> <span class=\"s2\">\"control.ss\"</span><span class=\"p\">))</span>\n\n<span class=\"p\">(</span><span class=\"k\">define-syntax</span> <span class=\"n\">define/y</span>\n  <span class=\"p\">(</span><span class=\"k\">syntax-rules</span> <span class=\"p\">()</span>\n    <span class=\"p\">[(</span><span class=\"k\">_</span> <span class=\"n\">yield-name</span> <span class=\"p\">(</span><span class=\"n\">name</span> <span class=\"n\">arg</span> <span class=\"k\">...</span><span class=\"p\">)</span> <span class=\"n\">body</span> <span class=\"k\">...</span><span class=\"p\">)</span>\n     <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">name</span> <span class=\"n\">arg</span> <span class=\"k\">...</span><span class=\"p\">)</span>\n       <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">yield-name</span> <span class=\"n\">x</span><span class=\"p\">)</span>\n         <span class=\"p\">(</span><span class=\"n\">control</span> <span class=\"n\">resume-here</span>\n            <span class=\"p\">(</span><span class=\"k\">set!</span> <span class=\"n\">name</span>\n                  <span class=\"p\">(</span><span class=\"k\">lambda</span> <span class=\"p\">()</span>\n                    <span class=\"p\">(</span><span class=\"n\">prompt</span> <span class=\"p\">(</span><span class=\"n\">resume-here</span> <span class=\"o\">&#39;</span><span class=\"ss\">dummy</span><span class=\"p\">))))</span>\n            <span class=\"n\">x</span><span class=\"p\">))</span>\n       <span class=\"p\">(</span><span class=\"n\">prompt</span> <span class=\"n\">body</span> <span class=\"k\">...</span><span class=\"p\">))]))</span>\n\n<span class=\"p\">(</span><span class=\"n\">define/y</span> <span class=\"n\">yield</span> <span class=\"p\">(</span><span class=\"n\">step</span><span class=\"p\">)</span> \n  <span class=\"p\">(</span><span class=\"n\">yield</span> <span class=\"mi\">1</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"n\">yield</span> <span class=\"mi\">2</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"n\">yield</span> <span class=\"mi\">3</span><span class=\"p\">)</span>\n  <span class=\"o\">&#39;</span><span class=\"ss\">finished</span><span class=\"p\">)</span>\n\n<span class=\"p\">(</span><span class=\"nb\">equal?</span> <span class=\"o\">&#39;</span><span class=\"p\">(</span><span class=\"mi\">1</span> <span class=\"mi\">2</span> <span class=\"mi\">3</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"nb\">list</span> <span class=\"p\">(</span><span class=\"n\">step</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"n\">step</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"n\">step</span><span class=\"p\">)))</span>\n</pre></div>\n\n</div>\n\n<p>This time I include a test case that assures the proper return behavior of <code>yield</code>. The definition of <code>define/y</code> shows how to mark the return point with <code>prompt</code> and how to switch to this point with <code>control</code> so that your generator can resume the traversal at the place where it was interrupted.</p>\n\n<p>For the second challenge, I wrote this definition:</p>\n\n<div class=\"brush: racket\">\n <div class=\"pygments\">\n  <pre><span class=\"p\">(</span><span class=\"k\">require</span> <span class=\"p\">(</span><span class=\"k\">lib</span> <span class=\"s2\">\"control.ss\"</span><span class=\"p\">))</span>\n\n<span class=\"p\">(</span><span class=\"k\">define-syntax</span> <span class=\"p\">(</span><span class=\"n\">define/y</span> <span class=\"n\">stx</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"k\">syntax-case</span> <span class=\"n\">stx</span> <span class=\"p\">()</span>\n    <span class=\"p\">[(</span><span class=\"k\">_</span> <span class=\"p\">(</span><span class=\"n\">name</span> <span class=\"n\">arg</span> <span class=\"k\">...</span><span class=\"p\">)</span> <span class=\"n\">body</span> <span class=\"k\">...</span><span class=\"p\">)</span>\n     <span class=\"p\">(</span><span class=\"k\">with-syntax</span> \n         <span class=\"p\">((</span><span class=\"n\">yield-name</span> <span class=\"p\">(</span><span class=\"n\">datum-&gt;syntax-object</span> <span class=\"n\">stx</span> <span class=\"o\">&#39;</span><span class=\"ss\">yield</span><span class=\"p\">)))</span>\n       <span class=\"p\">(</span><span class=\"k\">syntax</span>\n        <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">name</span> <span class=\"n\">arg</span> <span class=\"k\">...</span><span class=\"p\">)</span>\n          <span class=\"p\">(</span><span class=\"k\">define</span> <span class=\"p\">(</span><span class=\"n\">yield-name</span> <span class=\"n\">x</span><span class=\"p\">)</span>\n            <span class=\"p\">(</span><span class=\"n\">control</span> <span class=\"n\">resume-here</span>\n             <span class=\"p\">(</span><span class=\"k\">set!</span> <span class=\"n\">name</span> \n                   <span class=\"p\">(</span><span class=\"k\">lambda</span> <span class=\"p\">()</span>\n                     <span class=\"p\">(</span><span class=\"n\">prompt</span> <span class=\"p\">(</span><span class=\"n\">resume-here</span> <span class=\"o\">&#39;</span><span class=\"ss\">dummy</span><span class=\"p\">))))</span>\n             <span class=\"n\">x</span><span class=\"p\">))</span>\n          <span class=\"p\">(</span><span class=\"n\">prompt</span> <span class=\"n\">body</span> <span class=\"k\">...</span><span class=\"p\">))))]))</span>\n\n<span class=\"p\">(</span><span class=\"n\">define/y</span> <span class=\"p\">(</span><span class=\"n\">step</span><span class=\"p\">)</span> \n  <span class=\"p\">(</span><span class=\"n\">yield</span> <span class=\"mi\">1</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"n\">yield</span> <span class=\"mi\">2</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"n\">yield</span> <span class=\"mi\">3</span><span class=\"p\">)</span>\n  <span class=\"o\">&#39;</span><span class=\"ss\">finished</span><span class=\"p\">)</span>\n\n<span class=\"p\">(</span><span class=\"nb\">equal?</span> <span class=\"o\">&#39;</span><span class=\"p\">(</span><span class=\"mi\">1</span> <span class=\"mi\">2</span> <span class=\"mi\">3</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"nb\">list</span> <span class=\"p\">(</span><span class=\"n\">step</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"n\">step</span><span class=\"p\">)</span> <span class=\"p\">(</span><span class=\"n\">step</span><span class=\"p\">)))</span>\n</pre></div>\n\n</div>\n\n<p>If you compare the two macro definitions, you notice very little difference. Indeed, what really differs is the &ldquo;interface&rdquo; (the API), that is, the way you can use the macro: see the test case. What also differs is that the definition uses <code>syntax-case</code> and <code>with-syntax</code> to inject <code>yield</code> into the body of <code>define/y</code>.</p>\n\n<p>In response, Vlado wrote &ldquo;but isn&rsquo;t this non-hygienic.&rdquo; Here is my response:</p>\n\n<p>Hygiene is a uniformity default imposed on the expander with a provision for programmers to choose the non-default. I chose this word carefully when I coined the phrase. So what you have <em>is</em> a hygienic solution.</p>\n\n<p>In other words, injecting an identifier into a macro is not a violation of hygiene at all. It&rsquo;s just means using the full power of the macro system.</p>")) ((p+ #"/Users/MB/git/racket-lang-org/blog/_src/posts/2011-08-03-racket-v512.md" . unix) f post (u . "Racket v5.1.2") (? . 112) 1467223812 (p+ #"/Users/MB/git/racket-lang-org/blog/2011/08/racket-v512.html" . unix) "/2011/08/racket-v512.html" (u . "2011-08-03T15:47:00.004-04:00") (? . 11) (? . 111) (c (u . "")) (u . "\n<p><em>posted by Eli Barzilay</em></p>\n\n<p>Racket version 5.1.2 is now available from <a href=\"http://racket-lang.org/\">http://racket-lang.org/</a></p>\n\n<ul>\n <li>\n  <p>The download page includes 64-bit installers for Mac OS X, Windows, and two Debian flavors. Racket now supports OS X Lion.</p></li>\n <li>\n  <p>Racket now includes a new <code>racket/place</code> library to support parallelism, complementing <code>racket/future</code>. Racket&rsquo;s parallel build process is now based on places instead of multiple OS processes.Places support share-nothing parallelism and message-passing communication. Compared to futures, places are heavyweight, but they have a simpler performance model.</p></li>\n <li>\n  <p>The syntax-certificate system has been replaced by a syntax-taint system. Both certificates and taints were designed to protect otherwise inaccessible bindings from abuse when they appear in macro expansions. Taints are simpler and lighter, and the switch closes known holes in the certificate system. Macros that are not implemented with <code>syntax-rules</code> or <code>define-syntax-rule</code>, however, must explicitly use <code>syntax-protect</code> to protect their expansions from abuse.</p></li>\n <li>\n  <p>The <code>net/url</code> library supports HTTPS connections, but beware that by default all sites are accepted (equivalent to ignoring a browser&rsquo;s warnings about untrusted certificates).</p></li>\n <li>\n  <p>Error messages in the student languages use a simplified vocabulary and consistent phrasings. If you maintain curriculum material or teachpacks then please consider updating. See the “Error Message Composition Guidelines” section in the documentation for details.</p></li>\n <li>\n  <p>Typed Racket: almost all core Racket data structures and operations are now accessible in Typed Racket (most of this work is due to prolific contributor Eric Dobson). The performance of the typechecker has been significantly improved.</p></li>\n <li>\n  <p>The <code>scriblib/bibtex</code> library supports BibTeX-formatted citation databases in Scribble documents. BibTeX can be tricky to parse, so please report failed entries as bug reports.</p></li>\n <li>\n  <p>The <code>for</code> forms now support an <code>#:unless</code> clause, and a nonnegative integer can be used as a sequence. The new <code>compose1</code> function creates single-valued composition functions. The <code>racket/function</code> library now provides <code>identity</code>, <code>thunk</code>, and <code>thunk*</code>.</p></li>\n <li>\n  <p>The license has been clarified: we now use LGPLv2.1 uniformly. (The license file used to specify LGPLv2, contrary to the download pages.)</p></li></ul>") #f (u . "\n<p><em>posted by Eli Barzilay</em></p>\n\n<p>Racket version 5.1.2 is now available from <a href=\"http://racket-lang.org/\">http://racket-lang.org/</a></p>\n\n<ul>\n <li>\n  <p>The download page includes 64-bit installers for Mac OS X, Windows, and two Debian flavors. Racket now supports OS X Lion.</p></li>\n <li>\n  <p>Racket now includes a new <code>racket/place</code> library to support parallelism, complementing <code>racket/future</code>. Racket&rsquo;s parallel build process is now based on places instead of multiple OS processes.Places support share-nothing parallelism and message-passing communication. Compared to futures, places are heavyweight, but they have a simpler performance model.</p></li>\n <li>\n  <p>The syntax-certificate system has been replaced by a syntax-taint system. Both certificates and taints were designed to protect otherwise inaccessible bindings from abuse when they appear in macro expansions. Taints are simpler and lighter, and the switch closes known holes in the certificate system. Macros that are not implemented with <code>syntax-rules</code> or <code>define-syntax-rule</code>, however, must explicitly use <code>syntax-protect</code> to protect their expansions from abuse.</p></li>\n <li>\n  <p>The <code>net/url</code> library supports HTTPS connections, but beware that by default all sites are accepted (equivalent to ignoring a browser&rsquo;s warnings about untrusted certificates).</p></li>\n <li>\n  <p>Error messages in the student languages use a simplified vocabulary and consistent phrasings. If you maintain curriculum material or teachpacks then please consider updating. See the “Error Message Composition Guidelines” section in the documentation for details.</p></li>\n <li>\n  <p>Typed Racket: almost all core Racket data structures and operations are now accessible in Typed Racket (most of this work is due to prolific contributor Eric Dobson). The performance of the typechecker has been significantly improved.</p></li>\n <li>\n  <p>The <code>scriblib/bibtex</code> library supports BibTeX-formatted citation databases in Scribble documents. BibTeX can be tricky to parse, so please report failed entries as bug reports.</p></li>\n <li>\n  <p>The <code>for</code> forms now support an <code>#:unless</code> clause, and a nonnegative integer can be used as a sequence. The new <code>compose1</code> function creates single-valued composition functions. The <code>racket/function</code> library now provides <code>identity</code>, <code>thunk</code>, and <code>thunk*</code>.</p></li>\n <li>\n  <p>The license has been clarified: we now use LGPLv2.1 uniformly. (The license file used to specify LGPLv2, contrary to the download pages.)</p></li></ul>"))))